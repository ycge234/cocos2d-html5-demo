var cc=cc||{};cc._tmp=cc._tmp||{};cc._LogInfos={};window._p;_p=window;_p.gl;_p.WebGLRenderingContext;_p.DeviceOrientationEvent;_p.DeviceMotionEvent;_p.AudioContext;_p.webkitAudioContext;_p.mozAudioContext;_p=Object.prototype;_p._super;_p.ctor;delete window._p;cc.newElement=function(a){return document.createElement(a)};cc._addEventListener=function(a,b,c,d){a.addEventListener(b,c,d)};cc._isNodeJs="undefined"!=typeof require&&require("fs");
cc.each=function(a,b,c){if(a)if(a instanceof Array)for(var d=0,e=a.length;e>d&&!1!==b.call(c,a[d],d);d++);else for(d in a)if(!1===b.call(c,a[d],d))break};cc.isCrossOrigin=function(a){if(!a)return cc.log("invalid URL"),!1;var b=a.indexOf("://");if(-1==b)return!1;b=a.indexOf("/",b+3);return(-1==b?a:a.substring(0,b))!=location.origin};
cc.AsyncPool=function(a,b,c,d,e){var f=this;f._srcObj=a;f._limit=b;f._pool=[];f._iterator=c;f._iteratorTarget=e;f._onEnd=d;f._onEndTarget=e;f._results=a instanceof Array?[]:{};f._isErr=!1;cc.each(a,function(a,b){f._pool.push({index:b,value:a})});f.size=f._pool.length;f.finishedSize=0;f._workingSize=0;f._limit=f._limit||f.size;f.onIterator=function(a,b){f._iterator=a;f._iteratorTarget=b};f.onEnd=function(a,b){f._onEnd=a;f._onEndTarget=b};f._handleItem=function(){var a=this;if(0!=a._pool.length&&!(a._workingSize>=
a._limit)){var b=a._pool.shift(),c=b.value,d=b.index;a._workingSize++;a._iterator.call(a._iteratorTarget,c,d,function(b){if(!a._isErr){if(a.finishedSize++,a._workingSize--,b)return a._isErr=!0,void(a._onEnd&&a._onEnd.call(a._onEndTarget,b));var c=Array.prototype.slice.call(arguments,1);return a._results[this.index]=c[0],a.finishedSize==a.size?void(a._onEnd&&a._onEnd.call(a._onEndTarget,null,a._results)):void a._handleItem()}}.bind(b),a)}};f.flow=function(){if(0==this._pool.length)return void(this._onEnd&&
this._onEnd.call(this._onEndTarget,null,[]));for(var a=0;a<this._limit;a++)this._handleItem()}};
cc.async={series:function(a,b,c){a=new cc.AsyncPool(a,1,function(a,b,f){a.call(c,f)},b,c);return a.flow(),a},parallel:function(a,b,c){a=new cc.AsyncPool(a,0,function(a,b,f){a.call(c,f)},b,c);return a.flow(),a},waterfall:function(a,b,c){var d=[];a=new cc.AsyncPool(a,1,function(a,b,g){d.push(function(){d=Array.prototype.slice.call(arguments,1);g.apply(null,arguments)});a.apply(c,d)},function(a,d){return b?a?b.call(c,a):void b.call(c,null,d[d.length-1]):void 0});return a.flow(),a},map:function(a,b,c,
d){var e=b;"object"==typeof b&&(c=b.cb,d=b.iteratorTarget,e=b.iterator);a=new cc.AsyncPool(a,0,e,c,d);return a.flow(),a},mapLimit:function(a,b,c,d,e){a=new cc.AsyncPool(a,b,c,d,e);return a.flow(),a}};
cc.path={join:function(){for(var a=arguments.length,b="",c=0;a>c;c++)b=(b+(""==b?"":"/")+arguments[c]).replace(/(\/|\\\\)$/,"");return b},extname:function(a){return(a=/(\.[^\.\/\?\\]*)(\?.*)?$/.exec(a))?a[1]:null},mainFileName:function(a){if(a){var b=a.lastIndexOf(".");if(-1!==b)return a.substring(0,b)}return a},basename:function(a,b){var c=a.indexOf("?");0<c&&(a=a.substring(0,c));c=/(\/|\\\\)([^(\/|\\\\)]+)$/g.exec(a.replace(/(\/|\\\\)$/,""));if(!c)return null;c=c[2];return b&&a.substring(a.length-
b.length).toLowerCase()==b.toLowerCase()?c.substring(0,c.length-b.length):c},dirname:function(a){return a.replace(/((.*)(\/|\\|\\\\))?(.*?\..*$)?/,"$2")},changeExtname:function(a,b){b=b||"";var c=a.indexOf("?"),d="";return 0<c&&(d=a.substring(c),a=a.substring(0,c)),c=a.lastIndexOf("."),0>c?a+b+d:a.substring(0,c)+b+d},changeBasename:function(a,b,c){if(0==b.indexOf("."))return this.changeExtname(a,b);var d=a.indexOf("?"),e="";c=c?this.extname(a):"";return 0<d&&(e=a.substring(d),a=a.substring(0,d)),
d=a.lastIndexOf("/"),d=0>=d?0:d+1,a.substring(0,d)+b+c+e}};
cc.loader={_jsCache:{},_register:{},_langPathCache:{},_aliases:{},resPath:"",audioPath:"",cache:{},getXMLHttpRequest:function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},_getArgs4Js:function(a){var b=a[0],c=a[1],d=a[2],e=["",null,null];if(1===a.length)e[1]=b instanceof Array?b:[b];else if(2===a.length)"function"==typeof c?(e[1]=b instanceof Array?b:[b],e[2]=c):(e[0]=b||"",e[1]=c instanceof Array?c:[c]);else{if(3!==a.length)throw"arguments error to load js!";
e[0]=b||"";e[1]=c instanceof Array?c:[c];e[2]=d}return e},loadJs:function(){var a=this,b=a._jsCache,c=a._getArgs4Js(arguments),d=c[0],e=c[1],c=c[2];-1<navigator.userAgent.indexOf("Trident/5")?a._loadJs4Dependency(d,e,0,c):cc.async.map(e,function(c,e,h){c=cc.path.join(d,c);return b[c]?h(null):void a._createScript(c,!1,h)},c)},loadJsWithImg:function(){var a=this._loadJsImg(),b=this._getArgs4Js(arguments);this.loadJs(b[0],b[1],function(c){if(c)throw c;a.parentNode.removeChild(a);b[2]&&b[2]()})},_createScript:function(a,
b,c){var d=document,e=cc.newElement("script");e.async=b;e.src=a;this._jsCache[a]=!0;cc._addEventListener(e,"load",function(){e.parentNode.removeChild(e);this.removeEventListener("load",arguments.callee,!1);c()},!1);cc._addEventListener(e,"error",function(){e.parentNode.removeChild(e);c("Load "+a+" failed!")},!1);d.body.appendChild(e)},_loadJs4Dependency:function(a,b,c,d){if(c>=b.length)return void(d&&d());var e=this;e._createScript(cc.path.join(a,b[c]),!1,function(f){return f?d(f):void e._loadJs4Dependency(a,
b,c+1,d)})},_loadJsImg:function(){var a=document,b=a.getElementById("cocos2d_loadJsImg");if(!b){b=cc.newElement("img");cc._loadingImage&&(b.src=cc._loadingImage);a=a.getElementById(cc.game.config.id);a.style.backgroundColor="black";a.parentNode.appendChild(b);var c=getComputedStyle?getComputedStyle(a):a.currentStyle;c||(c={width:a.width,height:a.height});b.style.left=a.offsetLeft+(parseFloat(c.width)-b.width)/2+"px";b.style.top=a.offsetTop+(parseFloat(c.height)-b.height)/2+"px";b.style.position="absolute"}return b},
loadTxt:function(a,b){if(cc._isNodeJs)require("fs").readFile(a,function(a,c){a?b(a):b(null,c.toString())});else{var c=this.getXMLHttpRequest(),d="load "+a+" failed!";c.open("GET",a,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(c.setRequestHeader("Accept-Charset","utf-8"),c.onreadystatechange=function(){4==c.readyState&&(200==c.status?b(null,c.responseText):b(d))}):(c.overrideMimeType&&c.overrideMimeType("text/plain; charset=utf-8"),c.onload=function(){4==c.readyState&&
(200==c.status?b(null,c.responseText):b(d))});c.send(null)}},_loadTxtSync:function(a){if(cc._isNodeJs)return require("fs").readFileSync(a).toString();var b=this.getXMLHttpRequest();return b.open("GET",a,!1),/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?b.setRequestHeader("Accept-Charset","utf-8"):b.overrideMimeType&&b.overrideMimeType("text/plain; charset=utf-8"),b.send(null),4==!b.readyState||200!=b.status?null:b.responseText},loadJson:function(a,b){this.loadTxt(a,function(c,
d){try{c?b(c):b(null,JSON.parse(d))}catch(e){throw"load json ["+a+"] failed : "+e;}})},_checkIsImageURL:function(a){return null!=/(\.png)|(\.jpg)|(\.bmp)|(\.jpeg)|(\.gif)/.exec(a)},loadImg:function(a,b,c){var d=!0;void 0!==c?d=null==b.isCrossOrigin?d:b.isCrossOrigin:void 0!==b&&(c=b);var e=new Image;return d&&"file://"!=location.origin&&(e.crossOrigin="Anonymous"),cc._addEventListener(e,"load",function(){this.removeEventListener("load",arguments.callee,!1);this.removeEventListener("error",arguments.callee,
!1);c&&c(null,e)}),cc._addEventListener(e,"error",function(){this.removeEventListener("error",arguments.callee,!1);c&&c("load image failed")}),e.src=a,e},_loadResIterator:function(a,b,c){var d=this,e=null,f=a.type;f?(f="."+f.toLowerCase(),e=a.src?a.src:a.name+f):(e=a,f=cc.path.extname(e));if(b=d.cache[e])return c(null,b);b=d._register[f.toLowerCase()];if(!b)return cc.error("loader for ["+f+"] not exists!"),c();f=b.getBasePath?b.getBasePath():d.resPath;f=d.getUrl(f,e);b.load(f,e,a,function(a,b){a?
(cc.log(a),d.cache[e]=null,delete d.cache[e],c()):(d.cache[e]=b,c(null,b))})},getUrl:function(a,b){var c=this._langPathCache,d=cc.path;if(void 0!==a&&void 0===b){b=a;var e=d.extname(b),e=e?e.toLowerCase():"";a=(e=this._register[e])&&e.getBasePath?e.getBasePath():this.resPath}if(b=cc.path.join(a||"",b),b.match(/[\/(\\\\)]lang[\/(\\\\)]/i)){if(c[b])return c[b];d=d.extname(b)||"";b=c[b]=b.substring(0,b.length-d.length)+"_"+cc.sys.language+d}return b},load:function(a,b,c){var d=this,e=arguments.length;
if(0==e)throw"arguments error!";3==e?"function"==typeof b&&(b="function"==typeof c?{trigger:b,cb:c}:{cb:b,cbTarget:c}):2==e?"function"==typeof b&&(b={cb:b}):1==e&&(b={});a instanceof Array||(a=[a]);e=new cc.AsyncPool(a,0,function(a,c,e,k){d._loadResIterator(a,c,function(a){if(a)return e(a);var c=Array.prototype.slice.call(arguments,1);b.trigger&&b.trigger.call(b.triggerTarget,c[0],k.size,k.finishedSize);e(null,c[0])})},b.cb,b.cbTarget);return e.flow(),e},_handleAliases:function(a,b){var c=this._aliases,
d=[],e;for(e in a){var f=a[e];c[e]=f;d.push(f)}this.load(d,b)},loadAliases:function(a,b){var c=this,d=c.getRes(a);d?c._handleAliases(d.filenames,b):c.load(a,function(a,d){c._handleAliases(d[0].filenames,b)})},register:function(a,b){if(a&&b){if("string"==typeof a)return this._register[a.trim().toLowerCase()]=b;for(var c=0,d=a.length;d>c;c++)this._register["."+a[c].trim().toLowerCase()]=b}},getRes:function(a){return this.cache[a]||this.cache[this._aliases[a]]},release:function(a){var b=this.cache,c=
this._aliases;delete b[a];delete b[c[a]];delete c[a]},releaseAll:function(){var a=this.cache,b=this._aliases,c;for(c in a)delete a[c];for(c in b)delete b[c]}};
cc.formatStr=function(){var a=arguments,b=a.length;if(1>b)return"";var c=a[0],d=!0;"object"==typeof c&&(c=JSON.stringify(c),d=!1);for(var e=1;b>e;++e){var f=a[e];if(f="object"==typeof f?JSON.stringify(f):f,d)for(;;){var g=null;if("number"==typeof f&&c.match(/(%d)|(%s)/)){c=c.replace(/(%d)|(%s)/,f);break}(g=c.match(/%s/))?c=c.replace(/%s/,f):c+="    "+f;break}else c+="    "+f}return c};
(function(){var a,b,c=window;"undefined"!==typeof document.hidden?(a="hidden",b="visibilitychange"):"undefined"!==typeof document.mozHidden?(a="mozHidden",b="mozvisibilitychange"):"undefined"!==typeof document.msHidden?(a="msHidden",b="msvisibilitychange"):"undefined"!==typeof document.webkitHidden&&(a="webkitHidden",b="webkitvisibilitychange");var d=function(){cc.eventManager&&cc.game._eventHide&&cc.eventManager.dispatchEvent(cc.game._eventHide)},e=function(){cc.eventManager&&cc.game._eventShow&&
cc.eventManager.dispatchEvent(cc.game._eventShow);cc.game._intervalId&&(window.cancelAnimationFrame(cc.game._intervalId),cc.game._runMainLoop())};a?cc._addEventListener(document,b,function(){document[a]?d():e()},!1):(cc._addEventListener(c,"blur",d,!1),cc._addEventListener(c,"focus",e,!1));-1<navigator.userAgent.indexOf("MicroMessenger")&&(c.onfocus=function(){e()});"onpageshow"in window&&"onpagehide"in window&&(cc._addEventListener(c,"pagehide",d,!1),cc._addEventListener(c,"pageshow",e,!1));b=c=
null})();cc.log=cc.warn=cc.error=cc.assert=function(){};cc.create3DContext=function(a,b){for(var c=["webgl","experimental-webgl","webkit-3d","moz-webgl"],d=null,e=0;e<c.length;++e){try{d=a.getContext(c[e],b)}catch(f){}if(d)break}return d};
cc._initSys=function(a,b){cc._RENDER_TYPE_CANVAS=0;cc._RENDER_TYPE_WEBGL=1;cc.sys={};var c=cc.sys;c.LANGUAGE_ENGLISH="en";c.LANGUAGE_CHINESE="zh";c.LANGUAGE_FRENCH="fr";c.LANGUAGE_ITALIAN="it";c.LANGUAGE_GERMAN="de";c.LANGUAGE_SPANISH="es";c.LANGUAGE_RUSSIAN="ru";c.LANGUAGE_KOREAN="ko";c.LANGUAGE_JAPANESE="ja";c.LANGUAGE_HUNGARIAN="hu";c.LANGUAGE_PORTUGUESE="pt";c.LANGUAGE_ARABIC="ar";c.LANGUAGE_NORWEGIAN="no";c.LANGUAGE_POLISH="pl";c.OS_WINDOWS="Windows";c.OS_IOS="iOS";c.OS_OSX="OS X";c.OS_UNIX=
"UNIX";c.OS_LINUX="Linux";c.OS_ANDROID="Android";c.OS_UNKNOWN="Unknown";c.WINDOWS=0;c.LINUX=1;c.MACOS=2;c.ANDROID=3;c.IPHONE=4;c.IPAD=5;c.BLACKBERRY=6;c.NACL=7;c.EMSCRIPTEN=8;c.TIZEN=9;c.WINRT=10;c.WP8=11;c.MOBILE_BROWSER=100;c.DESKTOP_BROWSER=101;c.BROWSER_TYPE_WECHAT="wechat";c.BROWSER_TYPE_ANDROID="androidbrowser";c.BROWSER_TYPE_IE="ie";c.BROWSER_TYPE_QQ="qqbrowser";c.BROWSER_TYPE_MOBILE_QQ="mqqbrowser";c.BROWSER_TYPE_UC="ucbrowser";c.BROWSER_TYPE_360="360browser";c.BROWSER_TYPE_BAIDU_APP="baiduboxapp";
c.BROWSER_TYPE_BAIDU="baidubrowser";c.BROWSER_TYPE_MAXTHON="maxthon";c.BROWSER_TYPE_OPERA="opera";c.BROWSER_TYPE_MIUI="miuibrowser";c.BROWSER_TYPE_FIREFOX="firefox";c.BROWSER_TYPE_SAFARI="safari";c.BROWSER_TYPE_CHROME="chrome";c.BROWSER_TYPE_UNKNOWN="unknown";c.isNative=!1;var d=[c.BROWSER_TYPE_BAIDU,c.BROWSER_TYPE_OPERA,c.BROWSER_TYPE_FIREFOX,c.BROWSER_TYPE_CHROME,c.BROWSER_TYPE_SAFARI],e=[c.BROWSER_TYPE_BAIDU,c.BROWSER_TYPE_OPERA,c.BROWSER_TYPE_FIREFOX,c.BROWSER_TYPE_CHROME,c.BROWSER_TYPE_SAFARI,
c.BROWSER_TYPE_UC,c.BROWSER_TYPE_QQ,c.BROWSER_TYPE_MOBILE_QQ,c.BROWSER_TYPE_IE],f=window,g=f.navigator,h=document.documentElement,k=g.userAgent.toLowerCase();c.isMobile=-1!=k.indexOf("mobile")||-1!=k.indexOf("android");c.platform=c.isMobile?c.MOBILE_BROWSER:c.DESKTOP_BROWSER;var m=g.language,m=(m=m?m:g.browserLanguage)?m.split("-")[0]:c.LANGUAGE_ENGLISH;c.language=m;var m=c.BROWSER_TYPE_UNKNOWN,n=k.match(/micromessenger|qqbrowser|mqqbrowser|ucbrowser|360browser|baiduboxapp|baidubrowser|maxthon|trident|opera|miuibrowser|firefox/i)||
k.match(/chrome|safari/i);n&&0<n.length&&(m=n[0].toLowerCase(),"micromessenger"==m?m=c.BROWSER_TYPE_WECHAT:"safari"===m&&k.match(/android.*applewebkit/)?m=c.BROWSER_TYPE_ANDROID:"trident"==m&&(m=c.BROWSER_TYPE_IE));c.browserType=m;c._supportMultipleAudio=-1<e.indexOf(c.browserType);e=parseInt(a[b.renderMode]);m=cc._RENDER_TYPE_WEBGL;n=cc.newElement("Canvas");cc._supportRender=!0;d=-1==d.indexOf(c.browserType);if((1===e||0===e&&(c.isMobile||d)||"file://"==location.origin)&&(m=cc._RENDER_TYPE_CANVAS),
c._canUseCanvasNewBlendModes=function(){var a=document.createElement("canvas");a.width=1;a.height=1;a=a.getContext("2d");return a.fillStyle="#000",a.fillRect(0,0,1,1),a.globalCompositeOperation="multiply",a.fillStyle="#fff",a.fillRect(0,0,1,1),0===a.getImageData(0,0,1,1).data[0]},c._supportCanvasNewBlendModes=c._canUseCanvasNewBlendModes(),m==cc._RENDER_TYPE_WEBGL&&(f.WebGLRenderingContext&&cc.create3DContext(n,{stencil:!0,preserveDrawingBuffer:!0})||(0==e?m=cc._RENDER_TYPE_CANVAS:cc._supportRender=
!1)),m==cc._RENDER_TYPE_CANVAS)try{n.getContext("2d")}catch(q){cc._supportRender=!1}cc._renderType=m;try{c._supportWebAudio=!!new (f.AudioContext||f.webkitAudioContext||f.mozAudioContext)}catch(r){c._supportWebAudio=!1}try{var s=c.localStorage=f.localStorage;s.setItem("storage","");s.removeItem("storage");s=null}catch(u){"SECURITY_ERR"!==u.name&&"QuotaExceededError"!==u.name||cc.warn("Warning: localStorage isn't enabled. Please confirm browser cookie or privacy option"),c.localStorage=function(){}}s=
c.capabilities={canvas:!0};cc._renderType==cc._RENDER_TYPE_WEBGL&&(s.opengl=!0);(void 0!==h.ontouchstart||g.msPointerEnabled)&&(s.touches=!0);void 0!==h.onmouseup&&(s.mouse=!0);void 0!==h.onkeyup&&(s.keyboard=!0);(f.DeviceMotionEvent||f.DeviceOrientationEvent)&&(s.accelerometer=!0);f=k.match(/(iPad|iPhone|iPod)/i)?!0:!1;k=k.match(/android/i)||g.platform.match(/android/i)?!0:!1;h=c.OS_UNKNOWN;-1!=g.appVersion.indexOf("Win")?h=c.OS_WINDOWS:f?h=c.OS_IOS:-1!=g.appVersion.indexOf("Mac")?h=c.OS_OSX:-1!=
g.appVersion.indexOf("X11")?h=c.OS_UNIX:k?h=c.OS_ANDROID:-1!=g.appVersion.indexOf("Linux")&&(h=c.OS_LINUX);c.os=h;c.garbageCollect=function(){};c.dumpRoot=function(){};c.restartVM=function(){};c.dump=function(){var a;a=""+("isMobile : "+this.isMobile+"\r\n");a+="language : "+this.language+"\r\n";a+="browserType : "+this.browserType+"\r\n";a+="capabilities : "+JSON.stringify(this.capabilities)+"\r\n";a+="os : "+this.os+"\r\n";a+="platform : "+this.platform+"\r\n";cc.log(a)}};
cc.ORIENTATION_PORTRAIT=0;cc.ORIENTATION_PORTRAIT_UPSIDE_DOWN=1;cc.ORIENTATION_LANDSCAPE_LEFT=2;cc.ORIENTATION_LANDSCAPE_RIGHT=3;cc._drawingUtil=null;cc._renderContext=null;cc._canvas=null;cc._gameDiv=null;cc._rendererInitialized=!1;cc._setupCalled=!1;
cc._setup=function(a,b,c){if(!cc._setupCalled){cc._setupCalled=!0;var d=window,e=new Date,f=1E3/cc.game.config[cc.game.CONFIG_KEY.frameRate],g=function(a){var b=(new Date).getTime(),c=Math.max(0,f-(b-e)),d=window.setTimeout(function(){a()},c);return e=b+c,d},h=function(a){clearTimeout(a)};cc.sys.os===cc.sys.OS_IOS&&cc.sys.browserType===cc.sys.BROWSER_TYPE_WECHAT?(d.requestAnimFrame=g,d.cancelAnimationFrame=h):60!=cc.game.config[cc.game.CONFIG_KEY.frameRate]?(d.requestAnimFrame=g,d.cancelAnimationFrame=
h):(d.requestAnimFrame=d.requestAnimationFrame||d.webkitRequestAnimationFrame||d.mozRequestAnimationFrame||d.oRequestAnimationFrame||d.msRequestAnimationFrame||g,d.cancelAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||
window.oCancelAnimationFrame||h);var k,m,n;a=cc.$(a)||cc.$("#"+a);if("CANVAS"==a.tagName?(b=b||a.width,c=c||a.height,m=cc.container=cc.newElement("DIV"),k=cc._canvas=a,k.parentNode.insertBefore(m,k),k.appendTo(m),m.setAttribute("id","Cocos2dGameContainer")):("DIV"!=a.tagName&&cc.log("Warning: target element is not a DIV or CANVAS"),b=b||a.clientWidth,c=c||a.clientHeight,m=cc.container=a,k=cc._canvas=cc.$(cc.newElement("CANVAS")),a.appendChild(k)),k.addClass("gameCanvas"),k.setAttribute("width",b||
480),k.setAttribute("height",c||320),k.setAttribute("tabindex",99),k.style.outline="none",n=m.style,n.width=(b||480)+"px",n.height=(c||320)+"px",n.margin="0 auto",n.position="relative",n.overflow="hidden",m.top="100%",cc._renderType==cc._RENDER_TYPE_WEBGL&&(cc._renderContext=cc.webglContext=cc.create3DContext(k,{stencil:!0,preserveDrawingBuffer:!0,antialias:!cc.sys.isMobile,alpha:!1})),cc._renderContext?(d.gl=cc._renderContext,cc._drawingUtil=new cc.DrawingPrimitiveWebGL(cc._renderContext),cc._rendererInitialized=
!0,cc.textureCache._initializingRenderer(),cc.shaderCache._init()):(cc._renderContext=k.getContext("2d"),cc._mainRenderContextBackup=cc._renderContext,cc._renderContext.translate(0,k.height),cc._drawingUtil=cc.DrawingPrimitiveCanvas?new cc.DrawingPrimitiveCanvas(cc._renderContext):null),cc._gameDiv=m,cc.log(cc.ENGINE_VERSION),cc._setContextMenuEnable(!1),cc.sys.isMobile)b=cc.newElement("style"),b.type="text/css",document.body.appendChild(b),b.textContent="body,canvas,div{ -moz-user-select: none;-webkit-user-select: none;-ms-user-select: none;-khtml-user-select: none;-webkit-tap-highlight-color:rgba(0,0,0,0);}";
cc.view=cc.EGLView._getInstance();cc.inputManager.registerSystemEvent(cc._canvas);cc.director=cc.Director._getInstance();cc.director.setOpenGLView&&cc.director.setOpenGLView(cc.view);cc.winSize=cc.director.getWinSize();cc.saxParser=new cc.SAXParser;cc.plistParser=new cc.PlistParser}};cc._checkWebGLRenderMode=function(){if(cc._renderType!==cc._RENDER_TYPE_WEBGL)throw"This feature supports WebGL render mode only.";};cc._isContextMenuEnable=!1;
cc._setContextMenuEnable=function(a){cc._isContextMenuEnable=a;cc._canvas.oncontextmenu=function(){return cc._isContextMenuEnable?void 0:!1}};
cc.game={DEBUG_MODE_NONE:0,DEBUG_MODE_INFO:1,DEBUG_MODE_WARN:2,DEBUG_MODE_ERROR:3,DEBUG_MODE_INFO_FOR_WEB_PAGE:4,DEBUG_MODE_WARN_FOR_WEB_PAGE:5,DEBUG_MODE_ERROR_FOR_WEB_PAGE:6,EVENT_HIDE:"game_on_hide",EVENT_SHOW:"game_on_show",_eventHide:null,_eventShow:null,_onBeforeStartArr:[],CONFIG_KEY:{engineDir:"engineDir",dependencies:"dependencies",debugMode:"debugMode",showFPS:"showFPS",frameRate:"frameRate",id:"id",renderMode:"renderMode",jsList:"jsList",classReleaseMode:"classReleaseMode"},_prepareCalled:!1,
_prepared:!1,_paused:!0,_intervalId:null,config:null,onStart:null,onStop:null,setFrameRate:function(a){this.config[this.CONFIG_KEY.frameRate]=a;this._intervalId&&window.cancelAnimationFrame(this._intervalId);this._paused=!0;this._runMainLoop()},_runMainLoop:function(){var a,b=this,c=cc.director;c.setDisplayStats(b.config[b.CONFIG_KEY.showFPS]);a=function(){b._paused||(c.mainLoop(),b._intervalId=window.requestAnimFrame(a))};window.requestAnimFrame(a);b._paused=!1},run:function(a){var b=this,c=function(){a&&
(b.config[b.CONFIG_KEY.id]=a);b._prepareCalled||b.prepare(function(){b._prepared=!0});cc._supportRender&&(b._checkPrepare=setInterval(function(){b._prepared&&(cc._setup(b.config[b.CONFIG_KEY.id]),b._runMainLoop(),b._eventHide=b._eventHide||new cc.EventCustom(b.EVENT_HIDE),b._eventHide.setUserData(b),b._eventShow=b._eventShow||new cc.EventCustom(b.EVENT_SHOW),b._eventShow.setUserData(b),b.onStart(),clearInterval(b._checkPrepare))},10))};document.body?c():cc._addEventListener(window,"load",function(){this.removeEventListener("load",
arguments.callee,!1);c()},!1)},_initConfig:function(){var a=this.CONFIG_KEY,b=function(b){return b[a.engineDir]=b[a.engineDir]||"frameworks/cocos2d-html5",null==b[a.debugMode]&&(b[a.debugMode]=0),b[a.frameRate]=b[a.frameRate]||60,null==b[a.renderMode]&&(b[a.renderMode]=1),b};if(document.ccConfig)this.config=b(document.ccConfig);else try{for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var e=c[d].getAttribute("cocos");if(""==e||e)break}var f,g,h;d<c.length&&(f=c[d].src,f&&(h=/(.*)\//.exec(f)[0],
cc.loader.resPath=h,f=cc.path.join(h,"project.json")),g=cc.loader._loadTxtSync(f));g||(g=cc.loader._loadTxtSync("project.json"));var k=JSON.parse(g);this.config=b(k||{})}catch(m){cc.log("Failed to read or parse project.json"),this.config=b({})}cc._initSys(this.config,a)},_jsAddedCache:{},_getJsListOfModule:function(a,b,c){var d=this._jsAddedCache;if(d[b])return null;c=c||"";var e=[],f=a[b];if(!f)throw"can not find module ["+b+"]";b=cc.path;for(var g=0,h=f.length;h>g;g++){var k=f[g];if(!d[k]){var m=
b.extname(k);m?".js"==m.toLowerCase()&&e.push(b.join(c,k)):(m=this._getJsListOfModule(a,k,c))&&(e=e.concat(m));d[k]=1}}return e},prepare:function(a){var b=this,c=b.config,d=b.CONFIG_KEY,e=c[d.engineDir],f=cc.loader;if(!cc._supportRender)throw"The renderer doesn't support the renderMode "+c[d.renderMode];b._prepareCalled=!0;var g=c[d.jsList]||[];cc.Class?f.loadJsWithImg("",g,function(c){if(c)throw c;b._prepared=!0;a&&a()}):(d=cc.path.join(e,"moduleConfig.json"),f.loadJson(d,function(d,f){if(d)throw d;
var m=c.modules||[],n=f.module,q=[];cc._renderType==cc._RENDER_TYPE_WEBGL?m.splice(0,0,"shaders"):0>m.indexOf("core")&&m.splice(0,0,"core");for(var r=0,s=m.length;s>r;r++){var u=b._getJsListOfModule(n,m[r],e);u&&(q=q.concat(u))}q=q.concat(g);cc.loader.loadJsWithImg(q,function(c){if(c)throw c;b._prepared=!0;a&&a()})}))}};cc.game._initConfig();
Function.prototype.bind=Function.prototype.bind||function(a){var b=this;return function(){var c=Array.prototype.slice.call(arguments);return b.apply(a||null,c)}};cc=cc||{};cc._loadingImage="";
cc.loader.loadBinary=function(a,b){var c=this,d=this.getXMLHttpRequest(),e="load "+a+" failed!";d.open("GET",a,!0);/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)?(d.setRequestHeader("Accept-Charset","x-user-defined"),d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var a=cc._convertResponseBodyToText(d.responseBody);b(null,c._str2Uint8Array(a))}else b(e)}):(d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined"),d.onload=function(){4==
d.readyState&&200==d.status?b(null,c._str2Uint8Array(d.responseText)):b(e)});d.send(null)};cc.loader._str2Uint8Array=function(a){if(!a)return null;for(var b=new Uint8Array(a.length),c=0;c<a.length;c++)b[c]=255&a.charCodeAt(c);return b};
cc.loader.loadBinarySync=function(a){var b=this.getXMLHttpRequest(),c="load "+a+" failed!";b.open("GET",a,!1);a=null;if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){if(b.setRequestHeader("Accept-Charset","x-user-defined"),b.send(null),200!=b.status)return cc.log(c),null;(b=cc._convertResponseBodyToText(b.responseBody))&&(a=this._str2Uint8Array(b))}else{if(b.overrideMimeType&&b.overrideMimeType("text/plain; charset=x-user-defined"),b.send(null),200!=b.status)return cc.log(c),
null;a=this._str2Uint8Array(b.responseText)}return a};var Uint8Array=Uint8Array||Array;
if(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent)){var IEBinaryToArray_ByteStr_Script='\x3c!-- IEBinaryToArray_ByteStr --\x3e\r\nFunction IEBinaryToArray_ByteStr(Binary)\r\n   IEBinaryToArray_ByteStr = CStr(Binary)\r\nEnd Function\r\nFunction IEBinaryToArray_ByteStr_Last(Binary)\r\n   Dim lastIndex\r\n   lastIndex = LenB(Binary)\r\n   if lastIndex mod 2 Then\r\n       IEBinaryToArray_ByteStr_Last = Chr( AscB( MidB( Binary, lastIndex, 1 ) ) )\r\n   Else\r\n       IEBinaryToArray_ByteStr_Last = ""\r\n   End If\r\nEnd Function\r\n',myVBScript=
cc.newElement("script");myVBScript.type="text/vbscript";myVBScript.textContent=IEBinaryToArray_ByteStr_Script;document.body.appendChild(myVBScript);cc._convertResponseBodyToText=function(a){for(var b={},c=0;256>c;c++)for(var d=0;256>d;d++)b[String.fromCharCode(c+256*d)]=String.fromCharCode(c)+String.fromCharCode(d);c=IEBinaryToArray_ByteStr(a);a=IEBinaryToArray_ByteStr_Last(a);return c.replace(/[\s\S]/g,function(a){return b[a]})+a}}
var cc=cc||{},ClassManager={id:0|998*Math.random(),instanceId:0|998*Math.random(),compileSuper:function(a,b,c){a=a.toString();var d=a.indexOf("("),e=a.indexOf(")"),d=a.substring(d+1,e),d=d.trim(),e=a.indexOf("{"),f=a.lastIndexOf("}");for(a=a.substring(e+1,f);-1!=a.indexOf("this._super");){var e=a.indexOf("this._super"),f=a.indexOf("(",e),g=a.indexOf(")",f),g=a.substring(f+1,g),g=(g=g.trim())?",":"";a=a.substring(0,e)+"ClassManager["+c+"]."+b+".call(this"+g+a.substring(f+1)}return Function(d,a)},getNewID:function(){return this.id++},
getNewInstanceId:function(){return this.instanceId++}};
switch(ClassManager.compileSuper.ClassManager=ClassManager,function(){var a=/\b_super\b/,b=cc.game.config[cc.game.CONFIG_KEY.classReleaseMode];b&&console.log("release Mode");cc.Class=function(){};cc.Class.extend=function(){function c(){this.__instanceId=ClassManager.getNewInstanceId();this.ctor&&this.ctor.apply(this,arguments)}var d=this.prototype,e=Object.create(d),f=ClassManager.getNewID();ClassManager[f]=d;var g={writable:!0,enumerable:!1,configurable:!0};e.__instanceId=null;c.id=f;g.value=f;Object.defineProperty(e,
"__pid",g);c.prototype=e;g.value=c;Object.defineProperty(c.prototype,"constructor",g);this.__getters__&&(c.__getters__=cc.clone(this.__getters__));this.__setters__&&(c.__setters__=cc.clone(this.__setters__));for(var h=0,k=arguments.length;k>h;++h){var m=arguments[h],n;for(n in m){var q="function"==typeof m[n],r="function"==typeof d[n],s=a.test(m[n]);if(b&&q&&r&&s?(g.value=ClassManager.compileSuper(m[n],n,f),Object.defineProperty(e,n,g)):q&&r&&s?(g.value=function(a,b){return function(){var c=this._super;
this._super=d[a];var e=b.apply(this,arguments);return this._super=c,e}}(n,m[n]),Object.defineProperty(e,n,g)):q?(g.value=m[n],Object.defineProperty(e,n,g)):e[n]=m[n],q){var u,t;if(this.__getters__&&this.__getters__[n]){var q=this.__getters__[n],v;for(v in this.__setters__)if(this.__setters__[v]==q){t=v;break}cc.defineGetterSetter(e,q,m[n],m[t]?m[t]:e[t],n,t)}if(this.__setters__&&this.__setters__[n]){q=this.__setters__[n];for(v in this.__getters__)if(this.__getters__[v]==q){u=v;break}cc.defineGetterSetter(e,
q,m[u]?m[u]:e[u],m[n],u,n)}}}}return c.extend=cc.Class.extend,c.implement=function(a){for(var b in a)e[b]=a[b]},c}}(),cc.defineGetterSetter=function(a,b,c,d,e,f){if(a.__defineGetter__)c&&a.__defineGetter__(b,c),d&&a.__defineSetter__(b,d);else{if(!Object.defineProperty)throw Error("browser does not support getters");var g={enumerable:!1,configurable:!0};c&&(g.get=c);d&&(g.set=d);Object.defineProperty(a,b,g)}if(!e&&!f)for(var g=null!=c,h=void 0!=d,k=Object.getOwnPropertyNames(a),m=0;m<k.length;m++){var n=
k[m];if((a.__lookupGetter__?!a.__lookupGetter__(n):!Object.getOwnPropertyDescriptor(a,n))&&"function"==typeof a[n]){var q=a[n];if(g&&q===c&&(e=n,!h||f))break;if(h&&q===d&&(f=n,!g||e))break}}a=a.constructor;e&&(a.__getters__||(a.__getters__={}),a.__getters__[e]=b);f&&(a.__setters__||(a.__setters__={}),a.__setters__[f]=b)},cc.clone=function(a){var b=a.constructor?new a.constructor:{},c;for(c in a){var d=a[c];b[c]="object"!=typeof d||!d||d instanceof cc.Node||d instanceof HTMLElement?d:cc.clone(d)}return b},
cc.Point=function(a,b){this.x=a||0;this.y=b||0},cc.p=function(a,b){return void 0==a?{x:0,y:0}:void 0==b?{x:a.x,y:a.y}:{x:a,y:b}},cc.pointEqualToPoint=function(a,b){return a&&b&&a.x===b.x&&a.y===b.y},cc.Size=function(a,b){this.width=a||0;this.height=b||0},cc.size=function(a,b){return void 0===a?{width:0,height:0}:void 0===b?{width:a.width,height:a.height}:{width:a,height:b}},cc.sizeEqualToSize=function(a,b){return a&&b&&a.width==b.width&&a.height==b.height},cc.Rect=function(a,b,c,d){this.x=a||0;this.y=
b||0;this.width=c||0;this.height=d||0},cc.rect=function(a,b,c,d){return void 0===a?{x:0,y:0,width:0,height:0}:void 0===b?{x:a.x,y:a.y,width:a.width,height:a.height}:{x:a,y:b,width:c,height:d}},cc.rectEqualToRect=function(a,b){return a&&b&&a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height},cc._rectEqualToZero=function(a){return a&&0===a.x&&0===a.y&&0===a.width&&0===a.height},cc.rectContainsRect=function(a,b){return a&&b?!(a.x>=b.x||a.y>=b.y||a.x+a.width<=b.x+b.width||a.y+a.height<=b.y+b.height):
!1},cc.rectGetMaxX=function(a){return a.x+a.width},cc.rectGetMidX=function(a){return a.x+a.width/2},cc.rectGetMinX=function(a){return a.x},cc.rectGetMaxY=function(a){return a.y+a.height},cc.rectGetMidY=function(a){return a.y+a.height/2},cc.rectGetMinY=function(a){return a.y},cc.rectContainsPoint=function(a,b){return b.x>=cc.rectGetMinX(a)&&b.x<=cc.rectGetMaxX(a)&&b.y>=cc.rectGetMinY(a)&&b.y<=cc.rectGetMaxY(a)},cc.rectIntersectsRect=function(a,b){var c=a.y+a.height,d=b.x+b.width,e=b.y+b.height;return!(a.x+
a.width<b.x||d<a.x||c<b.y||e<a.y)},cc.rectOverlapsRect=function(a,b){return!(a.x+a.width<b.x||b.x+b.width<a.x||a.y+a.height<b.y||b.y+b.height<a.y)},cc.rectUnion=function(a,b){var c=cc.rect(0,0,0,0);return c.x=Math.min(a.x,b.x),c.y=Math.min(a.y,b.y),c.width=Math.max(a.x+a.width,b.x+b.width)-c.x,c.height=Math.max(a.y+a.height,b.y+b.height)-c.y,c},cc.rectIntersection=function(a,b){var c=cc.rect(Math.max(cc.rectGetMinX(a),cc.rectGetMinX(b)),Math.max(cc.rectGetMinY(a),cc.rectGetMinY(b)),0,0);return c.width=
Math.min(cc.rectGetMaxX(a),cc.rectGetMaxX(b))-cc.rectGetMinX(c),c.height=Math.min(cc.rectGetMaxY(a),cc.rectGetMaxY(b))-cc.rectGetMinY(c),c},cc.SAXParser=cc.Class.extend({_parser:null,_isSupportDOMParser:null,ctor:function(){window.DOMParser?(this._isSupportDOMParser=!0,this._parser=new DOMParser):this._isSupportDOMParser=!1},parse:function(a){return this._parseXML(a)},_parseXML:function(a){var b;return this._isSupportDOMParser?b=this._parser.parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),
b.async="false",b.loadXML(a)),b}}),cc.PlistParser=cc.SAXParser.extend({parse:function(a){a=this._parseXML(a).documentElement;if("plist"!=a.tagName)throw"Not a plist file!";for(var b=null,c=0,d=a.childNodes.length;d>c&&(b=a.childNodes[c],1!=b.nodeType);c++);return this._parseNode(b)},_parseNode:function(a){var b=null,c=a.tagName;if("dict"==c)b=this._parseDict(a);else if("array"==c)b=this._parseArray(a);else if("string"==c)if(1==a.childNodes.length)b=a.firstChild.nodeValue;else for(b="",c=0;c<a.childNodes.length;c++)b+=
a.childNodes[c].nodeValue;else"false"==c?b=!1:"true"==c?b=!0:"real"==c?b=parseFloat(a.firstChild.nodeValue):"integer"==c&&(b=parseInt(a.firstChild.nodeValue,10));return b},_parseArray:function(a){for(var b=[],c=0,d=a.childNodes.length;d>c;c++){var e=a.childNodes[c];1==e.nodeType&&b.push(this._parseNode(e))}return b},_parseDict:function(a){for(var b={},c=null,d=0,e=a.childNodes.length;e>d;d++){var f=a.childNodes[d];1==f.nodeType&&("key"==f.tagName?c=f.firstChild.nodeValue:b[c]=this._parseNode(f))}return b}}),
cc._txtLoader={load:function(a,b,c,d){cc.loader.loadTxt(a,d)}},cc.loader.register(["txt","xml","vsh","fsh","atlas"],cc._txtLoader),cc._jsonLoader={load:function(a,b,c,d){cc.loader.loadJson(a,d)}},cc.loader.register(["json","ExportJson"],cc._jsonLoader),cc._imgLoader={load:function(a,b,c,d){cc.loader.cache[b]=cc.loader.loadImg(a,function(a,c){return a?d(a):(cc.textureCache.handleLoadedTexture(b),void d(null,c))})}},cc.loader.register("png jpg bmp jpeg gif ico".split(" "),cc._imgLoader),cc._serverImgLoader=
{load:function(a,b,c,d){cc.loader.cache[b]=cc.loader.loadImg(c.src,function(a,c){return a?d(a):(cc.textureCache.handleLoadedTexture(b),void d(null,c))})}},cc.loader.register(["serverImg"],cc._serverImgLoader),cc._plistLoader={load:function(a,b,c,d){cc.loader.loadTxt(a,function(a,b){return a?d(a):void d(null,cc.plistParser.parse(b))})}},cc.loader.register(["plist"],cc._plistLoader),cc._fontLoader={TYPE:{".eot":"embedded-opentype",".ttf":"truetype",".woff":"woff",".svg":"svg"},_loadFont:function(a,
b,c){var d=document,e=cc.path,f=this.TYPE,g=cc.newElement("style");g.type="text/css";d.body.appendChild(g);var h="@font-face { font-family:"+a+"; src:";if(b instanceof Array)for(var k=0,m=b.length;m>k;k++)c=e.extname(b[k]).toLowerCase(),h+="url('"+b[k]+"') format('"+f[c]+"')",h+=k==m-1?";":",";else h+="url('"+b+"') format('"+f[c]+"');";g.textContent+=h+"};";b=cc.newElement("div");c=b.style;c.fontFamily=a;b.innerHTML=".";c.position="absolute";c.left="-100px";c.top="-100px";d.body.appendChild(b)},load:function(a,
b,c,d){a=c.type;b=c.name;var e=c.srcs;"string"==typeof c?(a=cc.path.extname(c),b=cc.path.basename(c,a),this._loadFont(b,c,a)):this._loadFont(b,e);d(null,!0)}},cc.loader.register(["font","eot","ttf","woff","svg"],cc._fontLoader),cc._binaryLoader={load:function(a,b,c,d){cc.loader.loadBinary(a,d)}},window.CocosEngine=cc.ENGINE_VERSION="Cocos2d-JS v3.0 RC3",cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL=0,cc.DIRECTOR_STATS_POSITION=cc.p(0,0),cc.DIRECTOR_FPS_INTERVAL=.5,cc.COCOSNODE_RENDER_SUBPIXEL=1,cc.SPRITEBATCHNODE_RENDER_SUBPIXEL=
1,cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA=0,cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP=0,cc.TEXTURE_ATLAS_USE_VAO=0,cc.TEXTURE_NPOT_SUPPORT=0,cc.RETINA_DISPLAY_SUPPORT=1,cc.RETINA_DISPLAY_FILENAME_SUFFIX="-hd",cc.USE_LA88_LABELS=1,cc.SPRITE_DEBUG_DRAW=0,cc.SPRITEBATCHNODE_DEBUG_DRAW=0,cc.LABELBMFONT_DEBUG_DRAW=0,cc.LABELATLAS_DEBUG_DRAW=0,cc.IS_RETINA_DISPLAY_SUPPORTED=1,cc.DEFAULT_ENGINE=cc.ENGINE_VERSION+"-canvas",cc.ENABLE_STACKABLE_ACTIONS=1,cc.ENABLE_GL_STATE_CACHE=1,cc.$=function(a){var b=this==
cc?document:this;a=a instanceof HTMLElement?a:b.querySelector(a);return a&&(a.find=a.find||cc.$,a.hasClass=a.hasClass||function(a){return this.className.match(new RegExp("(\\s|^)"+a+"(\\s|$)"))},a.addClass=a.addClass||function(a){return this.hasClass(a)||(this.className&&(this.className+=" "),this.className+=a),this},a.removeClass=a.removeClass||function(a){return this.hasClass(a)&&(this.className=this.className.replace(a,"")),this},a.remove=a.remove||function(){return this.parentNode&&this.parentNode.removeChild(this),
this},a.appendTo=a.appendTo||function(a){return a.appendChild(this),this},a.prependTo=a.prependTo||function(a){return a.childNodes[0]?a.insertBefore(this,a.childNodes[0]):a.appendChild(this),this},a.transforms=a.transforms||function(){return this.style[cc.$.trans]=cc.$.translate(this.position)+cc.$.rotate(this.rotation)+cc.$.scale(this.scale)+cc.$.skew(this.skew),this},a.position=a.position||{x:0,y:0},a.rotation=a.rotation||0,a.scale=a.scale||{x:1,y:1},a.skew=a.skew||{x:0,y:0},a.translates=function(a,
b){return this.position.x=a,this.position.y=b,this.transforms(),this},a.rotate=function(a){return this.rotation=a,this.transforms(),this},a.resize=function(a,b){return this.scale.x=a,this.scale.y=b,this.transforms(),this},a.setSkew=function(a,b){return this.skew.x=a,this.skew.y=b,this.transforms(),this}),a},cc.sys.browserType){case cc.sys.BROWSER_TYPE_FIREFOX:cc.$.pfx="Moz";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_CHROME:case cc.sys.BROWSER_TYPE_SAFARI:cc.$.pfx="webkit";cc.$.hd=!0;break;case cc.sys.BROWSER_TYPE_OPERA:cc.$.pfx=
"O";cc.$.hd=!1;break;case cc.sys.BROWSER_TYPE_IE:cc.$.pfx="ms";cc.$.hd=!1;break;default:cc.$.pfx="webkit",cc.$.hd=!0}
if(cc.$.trans=cc.$.pfx+"Transform",cc.$.translate=cc.$.hd?function(a){return"translate3d("+a.x+"px, "+a.y+"px, 0) "}:function(a){return"translate("+a.x+"px, "+a.y+"px) "},cc.$.rotate=cc.$.hd?function(a){return"rotateZ("+a+"deg) "}:function(a){return"rotate("+a+"deg) "},cc.$.scale=function(a){return"scale("+a.x+", "+a.y+") "},cc.$.skew=function(a){return"skewX("+-a.x+"deg) skewY("+a.y+"deg)"},cc.$new=function(a){return cc.$(document.createElement(a))},cc.$.findpos=function(a){var b=0,c=0;do b+=a.offsetLeft,
c+=a.offsetTop;while(a=a.offsetParent);return{x:b,y:c}},cc.INVALID_INDEX=-1,cc.PI=Math.PI,cc.FLT_MAX=parseFloat("3.402823466e+38F"),cc.FLT_MIN=parseFloat("1.175494351e-38F"),cc.RAD=cc.PI/180,cc.DEG=180/cc.PI,cc.UINT_MAX=4294967295,cc.swap=function(a,b,c){if("object"==typeof c&&"undefined"!=typeof c.x&&"undefined"!=typeof c.y){var d=c[a];c[a]=c[b];c[b]=d}else cc.log(cc._LogInfos.swap)},cc.lerp=function(a,b,c){return a+(b-a)*c},cc.rand=function(){return 16777215*Math.random()},cc.randomMinus1To1=function(){return 2*
(Math.random()-.5)},cc.random0To1=Math.random,cc.degreesToRadians=function(a){return a*cc.RAD},cc.radiansToDegrees=function(a){return a*cc.DEG},cc.radiansToDegress=function(a){return cc.log(cc._LogInfos.radiansToDegress),a*cc.DEG},cc.REPEAT_FOREVER=Number.MAX_VALUE-1,cc.BLEND_SRC=cc.OPTIMIZE_BLEND_FUNC_FOR_PREMULTIPLIED_ALPHA?1:770,cc.BLEND_DST=771,cc.nodeDrawSetup=function(a){a._shaderProgram&&(a._shaderProgram.use(),a._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4())},cc.enableDefaultGLStates=
function(){},cc.disableDefaultGLStates=function(){},cc.incrementGLDraws=function(a){cc.g_NumberOfDraws+=a},cc.FLT_EPSILON=1.192092896E-7,cc.contentScaleFactor=cc.IS_RETINA_DISPLAY_SUPPORTED?function(){return cc.director.getContentScaleFactor()}:function(){return 1},cc.pointPointsToPixels=function(a){var b=cc.contentScaleFactor();return cc.p(a.x*b,a.y*b)},cc.pointPixelsToPoints=function(a){var b=cc.contentScaleFactor();return cc.p(a.x/b,a.y/b)},cc._pointPixelsToPointsOut=function(a,b){var c=cc.contentScaleFactor();
b.x=a.x/c;b.y=a.y/c},cc.sizePointsToPixels=function(a){var b=cc.contentScaleFactor();return cc.size(a.width*b,a.height*b)},cc.sizePixelsToPoints=function(a){var b=cc.contentScaleFactor();return cc.size(a.width/b,a.height/b)},cc._sizePixelsToPointsOut=function(a,b){var c=cc.contentScaleFactor();b.width=a.width/c;b.height=a.height/c},cc.rectPixelsToPoints=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var b=cc.contentScaleFactor();return cc.rect(a.x/b,a.y/b,a.width/b,a.height/b)}:function(a){return a},
cc.rectPointsToPixels=cc.IS_RETINA_DISPLAY_SUPPORTED?function(a){var b=cc.contentScaleFactor();return cc.rect(a.x*b,a.y*b,a.width*b,a.height*b)}:function(a){return a},cc.ONE=1,cc.ZERO=0,cc.SRC_ALPHA=770,cc.SRC_ALPHA_SATURATE=776,cc.SRC_COLOR=768,cc.DST_ALPHA=772,cc.DST_COLOR=774,cc.ONE_MINUS_SRC_ALPHA=771,cc.ONE_MINUS_SRC_COLOR=769,cc.ONE_MINUS_DST_ALPHA=773,cc.ONE_MINUS_DST_COLOR=775,cc.ONE_MINUS_CONSTANT_ALPHA=32772,cc.ONE_MINUS_CONSTANT_COLOR=32770,cc.checkGLErrorDebug=function(){if(cc.renderMode==
cc._RENDER_TYPE_WEBGL){var a=cc._renderContext.getError();a&&cc.log(cc._LogInfos.checkGLErrorDebug,a)}},cc.DEVICE_ORIENTATION_PORTRAIT=0,cc.DEVICE_ORIENTATION_LANDSCAPE_LEFT=1,cc.DEVICE_ORIENTATION_PORTRAIT_UPSIDE_DOWN=2,cc.DEVICE_ORIENTATION_LANDSCAPE_RIGHT=3,cc.DEVICE_MAX_ORIENTATIONS=2,cc.VERTEX_ATTRIB_FLAG_NONE=0,cc.VERTEX_ATTRIB_FLAG_POSITION=1,cc.VERTEX_ATTRIB_FLAG_COLOR=2,cc.VERTEX_ATTRIB_FLAG_TEX_COORDS=4,cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX=cc.VERTEX_ATTRIB_FLAG_POSITION|cc.VERTEX_ATTRIB_FLAG_COLOR|
cc.VERTEX_ATTRIB_FLAG_TEX_COORDS,cc.GL_ALL=0,cc.VERTEX_ATTRIB_POSITION=0,cc.VERTEX_ATTRIB_COLOR=1,cc.VERTEX_ATTRIB_TEX_COORDS=2,cc.VERTEX_ATTRIB_MAX=3,cc.UNIFORM_PMATRIX=0,cc.UNIFORM_MVMATRIX=1,cc.UNIFORM_MVPMATRIX=2,cc.UNIFORM_TIME=3,cc.UNIFORM_SINTIME=4,cc.UNIFORM_COSTIME=5,cc.UNIFORM_RANDOM01=6,cc.UNIFORM_SAMPLER=7,cc.UNIFORM_MAX=8,cc.SHADER_POSITION_TEXTURECOLOR="ShaderPositionTextureColor",cc.SHADER_POSITION_TEXTURECOLORALPHATEST="ShaderPositionTextureColorAlphaTest",cc.SHADER_POSITION_COLOR=
"ShaderPositionColor",cc.SHADER_POSITION_TEXTURE="ShaderPositionTexture",cc.SHADER_POSITION_TEXTURE_UCOLOR="ShaderPositionTexture_uColor",cc.SHADER_POSITION_TEXTUREA8COLOR="ShaderPositionTextureA8Color",cc.SHADER_POSITION_UCOLOR="ShaderPosition_uColor",cc.SHADER_POSITION_LENGTHTEXTURECOLOR="ShaderPositionLengthTextureColor",cc.UNIFORM_PMATRIX_S="CC_PMatrix",cc.UNIFORM_MVMATRIX_S="CC_MVMatrix",cc.UNIFORM_MVPMATRIX_S="CC_MVPMatrix",cc.UNIFORM_TIME_S="CC_Time",cc.UNIFORM_SINTIME_S="CC_SinTime",cc.UNIFORM_COSTIME_S=
"CC_CosTime",cc.UNIFORM_RANDOM01_S="CC_Random01",cc.UNIFORM_SAMPLER_S="CC_Texture0",cc.UNIFORM_ALPHA_TEST_VALUE_S="CC_alpha_value",cc.ATTRIBUTE_NAME_COLOR="a_color",cc.ATTRIBUTE_NAME_POSITION="a_position",cc.ATTRIBUTE_NAME_TEX_COORD="a_texCoord",cc.ITEM_SIZE=32,cc.CURRENT_ITEM=3233828865,cc.ZOOM_ACTION_TAG=3233828866,cc.NORMAL_TAG=8801,cc.SELECTED_TAG=8802,cc.DISABLE_TAG=8803,cc.arrayVerifyType=function(a,b){if(a&&0<a.length)for(var c=0;c<a.length;c++)if(!(a[c]instanceof b))return cc.log("element type is wrong!"),
!1;return!0},cc.arrayRemoveObject=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]==b){a.splice(c,1);break}},cc.arrayRemoveArray=function(a,b){for(var c=0,d=b.length;d>c;c++)cc.arrayRemoveObject(a,b[c])},cc.arrayAppendObjectsToIndex=function(a,b,c){return a.splice.apply(a,[c,0].concat(b)),a},cc.copyArray=function(a){var b,c=a.length,d=Array(c);for(b=0;c>b;b+=1)d[b]=a[b];return d},cc._tmp.PrototypeColor=function(){var a=cc.color;a._getWhite=function(){return a(255,255,255)};a._getYellow=function(){return a(255,
255,0)};a._getBlue=function(){return a(0,0,255)};a._getGreen=function(){return a(0,255,0)};a._getRed=function(){return a(255,0,0)};a._getMagenta=function(){return a(255,0,255)};a._getBlack=function(){return a(0,0,0)};a._getOrange=function(){return a(255,127,0)};a._getGray=function(){return a(166,166,166)};a.WHITE;cc.defineGetterSetter(a,"WHITE",a._getWhite);a.YELLOW;cc.defineGetterSetter(a,"YELLOW",a._getYellow);a.BLUE;cc.defineGetterSetter(a,"BLUE",a._getBlue);a.GREEN;cc.defineGetterSetter(a,"GREEN",
a._getGreen);a.RED;cc.defineGetterSetter(a,"RED",a._getRed);a.MAGENTA;cc.defineGetterSetter(a,"MAGENTA",a._getMagenta);a.BLACK;cc.defineGetterSetter(a,"BLACK",a._getBlack);a.ORANGE;cc.defineGetterSetter(a,"ORANGE",a._getOrange);a.GRAY;cc.defineGetterSetter(a,"GRAY",a._getGray);cc.BlendFunc._disable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)};cc.BlendFunc._alphaPremultiplied=function(){return new cc.BlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._alphaNonPremultiplied=function(){return new cc.BlendFunc(cc.SRC_ALPHA,
cc.ONE_MINUS_SRC_ALPHA)};cc.BlendFunc._additive=function(){return new cc.BlendFunc(cc.SRC_ALPHA,cc.ONE)};cc.BlendFunc.DISABLE;cc.defineGetterSetter(cc.BlendFunc,"DISABLE",cc.BlendFunc._disable);cc.BlendFunc.ALPHA_PREMULTIPLIED;cc.defineGetterSetter(cc.BlendFunc,"ALPHA_PREMULTIPLIED",cc.BlendFunc._alphaPremultiplied);cc.BlendFunc.ALPHA_NON_PREMULTIPLIED;cc.defineGetterSetter(cc.BlendFunc,"ALPHA_NON_PREMULTIPLIED",cc.BlendFunc._alphaNonPremultiplied);cc.BlendFunc.ADDITIVE;cc.defineGetterSetter(cc.BlendFunc,
"ADDITIVE",cc.BlendFunc._additive)},cc.Color=function(a,b,c,d){this.r=a||0;this.g=b||0;this.b=c||0;this.a=null==d?255:d},cc.color=function(a,b,c){return void 0===a?{r:0,g:0,b:0,a:255}:"string"==typeof a?cc.hexToColor(a):"object"==typeof a?{r:a.r,g:a.g,b:a.b,a:null==a.a?255:a.a}:{r:a,g:b,b:c,a:null==a.a?255:a.a}},cc.colorEqual=function(a,b){return a.r===b.r&&a.g===b.g&&a.b===b.b},cc.Acceleration=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.timestamp=d||0},cc.Vertex2F=function(a,b){this.x=
a||0;this.y=b||0},cc.vertex2=function(a,b){return new cc.Vertex2F(a,b)},cc.Vertex3F=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0},cc.vertex3=function(a,b,c){return new cc.Vertex3F(a,b,c)},cc.Tex2F=function(a,b){this.u=a||0;this.v=b||0},cc.tex2=function(a,b){return new cc.Tex2F(a,b)},cc.BlendFunc=function(a,b){this.src=a;this.dst=b},cc.blendFuncDisable=function(){return new cc.BlendFunc(cc.ONE,cc.ZERO)},cc.hexToColor=function(a){a=a.replace(/^#?/,"0x");a=parseInt(a);return cc.color(a>>16,(a>>
8)%256,a%256)},cc.colorToHex=function(a){var b=a.r.toString(16),c=a.g.toString(16),d=a.b.toString(16);return"#"+(16>a.r?"0"+b:b)+(16>a.g?"0"+c:c)+(16>a.b?"0"+d:d)},cc.TEXT_ALIGNMENT_LEFT=0,cc.TEXT_ALIGNMENT_CENTER=1,cc.TEXT_ALIGNMENT_RIGHT=2,cc.VERTICAL_TEXT_ALIGNMENT_TOP=0,cc.VERTICAL_TEXT_ALIGNMENT_CENTER=1,cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM=2,cc._Dictionary=cc.Class.extend({_keyMapTb:null,_valueMapTb:null,__currId:0,ctor:function(){this._keyMapTb={};this._valueMapTb={};this.__currId=2<<(0|10*Math.random())},
__getKey:function(){return this.__currId++,"key_"+this.__currId},setObject:function(a,b){if(null!=b){var c=this.__getKey();this._keyMapTb[c]=b;this._valueMapTb[c]=a}},objectForKey:function(a){if(null==a)return null;var b=this._keyMapTb,c;for(c in b)if(b[c]===a)return this._valueMapTb[c];return null},valueForKey:function(a){return this.objectForKey(a)},removeObjectForKey:function(a){if(null!=a){var b=this._keyMapTb,c;for(c in b)if(b[c]===a)return delete this._valueMapTb[c],void delete b[c]}},removeObjectsForKeys:function(a){if(null!=
a)for(var b=0;b<a.length;b++)this.removeObjectForKey(a[b])},allKeys:function(){var a=[],b=this._keyMapTb,c;for(c in b)a.push(b[c]);return a},removeAllObjects:function(){this._keyMapTb={};this._valueMapTb={}},count:function(){return this.allKeys().length}}),cc.FontDefinition=function(){this.fontName="Arial";this.fontSize=12;this.textAlign=cc.TEXT_ALIGNMENT_CENTER;this.verticalAlign=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this.fillStyle=cc.color(255,255,255,255);this.boundingHeight=this.boundingWidth=0;this.strokeEnabled=
!1;this.strokeStyle=cc.color(255,255,255,255);this.lineWidth=1;this.shadowEnabled=!1;this.shadowBlur=this.shadowOffsetY=this.shadowOffsetX=0;this.shadowOpacity=1},cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert("function"==typeof cc._tmp.WebGLColor,cc._LogInfos.MissingFile,"CCTypesWebGL.js"),cc._tmp.WebGLColor(),delete cc._tmp.WebGLColor),cc.assert("function"==typeof cc._tmp.PrototypeColor,cc._LogInfos.MissingFile,"CCTypesPropertyDefine.js"),cc._tmp.PrototypeColor(),delete cc._tmp.PrototypeColor,
cc.Touches=[],cc.TouchesIntergerDict={},cc.EGLView=cc.Class.extend({_delegate:null,_frameSize:null,_designResolutionSize:null,_originalDesignResolutionSize:null,_viewPortRect:null,_visibleRect:null,_retinaEnabled:!1,_autoFullScreen:!0,_devicePixelRatio:1,_viewName:"",_resizeCallback:null,_scaleX:1,_originalScaleX:1,_scaleY:1,_originalScaleY:1,_indexBitsUsed:0,_maxTouches:5,_resolutionPolicy:null,_rpExactFit:null,_rpShowAll:null,_rpNoBorder:null,_rpFixedHeight:null,_rpFixedWidth:null,_initialized:!1,
_captured:!1,_wnd:null,_hDC:null,_hRC:null,_supportTouch:!1,_contentTranslateLeftTop:null,_frame:null,_frameZoomFactor:1,__resizeWithBrowserSize:!1,_isAdjustViewPort:!0,ctor:function(){var a=document,b=cc.ContainerStrategy,c=cc.ContentStrategy;this._frame=cc.container.parentNode===a.body?a.documentElement:cc.container.parentNode;this._frameSize=cc.size(0,0);this._initFrameSize();var a=cc._canvas.width,d=cc._canvas.height;this._designResolutionSize=cc.size(a,d);this._originalDesignResolutionSize=cc.size(a,
d);this._viewPortRect=cc.rect(0,0,a,d);this._visibleRect=cc.rect(0,0,a,d);this._contentTranslateLeftTop={left:0,top:0};this._viewName="Cocos2dHTML5";a=cc.sys;this.enableRetina(a.os==a.OS_IOS||a.os==a.OS_OSX);cc.visibleRect&&cc.visibleRect.init(this._visibleRect);this._rpExactFit=new cc.ResolutionPolicy(b.EQUAL_TO_FRAME,c.EXACT_FIT);this._rpShowAll=new cc.ResolutionPolicy(b.PROPORTION_TO_FRAME,c.SHOW_ALL);this._rpNoBorder=new cc.ResolutionPolicy(b.EQUAL_TO_FRAME,c.NO_BORDER);this._rpFixedHeight=new cc.ResolutionPolicy(b.EQUAL_TO_FRAME,
c.FIXED_HEIGHT);this._rpFixedWidth=new cc.ResolutionPolicy(b.EQUAL_TO_FRAME,c.FIXED_WIDTH);this._hDC=cc._canvas;this._hRC=cc._renderContext},_resizeEvent:function(){var a=this._originalDesignResolutionSize.width,b=this._originalDesignResolutionSize.height;this._resizeCallback&&(this._initFrameSize(),this._resizeCallback.call());0<a&&this.setDesignResolutionSize(a,b,this._resolutionPolicy)},resizeWithBrowserSize:function(a){var b;a?this.__resizeWithBrowserSize||(this.__resizeWithBrowserSize=!0,b=this._resizeEvent.bind(this),
cc._addEventListener(window,"resize",b,!1)):this.__resizeWithBrowserSize&&(this.__resizeWithBrowserSize=!0,b=this._resizeEvent.bind(this),window.removeEventListener("resize",b,!1))},setResizeCallback:function(a){"function"!=typeof a&&null!=a||(this._resizeCallback=a)},_initFrameSize:function(){var a=this._frameSize;a.width=this._frame.clientWidth;a.height=this._frame.clientHeight},_adjustSizeKeepCanvasSize:function(){var a=this._originalDesignResolutionSize.width,b=this._originalDesignResolutionSize.height;
0<a&&this.setDesignResolutionSize(a,b,this._resolutionPolicy)},_setViewPortMeta:function(){if(this._isAdjustViewPort){var a,b,c={"user-scalable":"no","maximum-scale":"1.0","initial-scale":"1.0"};b=document.getElementsByName("viewport");if(0==b.length?(a=cc.newElement("meta"),a.name="viewport",a.content="",document.head.appendChild(a)):a=b[0],cc.sys.isMobile&&cc.sys.browserType==cc.sys.BROWSER_TYPE_FIREFOX)return void(a.content="initial-scale:1");b=a.content;for(var d in c)(new RegExp(d)).test(b)||
(b+=(""==b?"":",")+d+"="+c[d]);a.content=b}},_setScaleXYForRenderTexture:function(){var a=cc.contentScaleFactor();this._scaleY=this._scaleX=a},_resetScale:function(){this._scaleX=this._originalScaleX;this._scaleY=this._originalScaleY},_adjustSizeToBrowser:function(){},initialize:function(){this._initialized=!0},adjustViewPort:function(a){this._isAdjustViewPort=a},enableRetina:function(a){this._retinaEnabled=a?!0:!1},isRetinaEnabled:function(){return this._retinaEnabled},enableAutoFullScreen:function(a){this._autoFullScreen=
a?!0:!1},isAutoFullScreenEnabled:function(){return this._autoFullScreen},end:function(){},isOpenGLReady:function(){return null!=this._hDC&&null!=this._hRC},setFrameZoomFactor:function(a){this._frameZoomFactor=a;this.centerWindow();cc.director.setProjection(cc.director.getProjection())},swapBuffers:function(){},setIMEKeyboardState:function(){},setContentTranslateLeftTop:function(a,b){this._contentTranslateLeftTop={left:a,top:b}},getContentTranslateLeftTop:function(){return this._contentTranslateLeftTop},
getFrameSize:function(){return cc.size(this._frameSize.width,this._frameSize.height)},setFrameSize:function(a,b){this._frameSize.width=a;this._frameSize.height=b;this._frame.style.width=a+"px";this._frame.style.height=b+"px";this._resizeEvent();cc.director.setProjection(cc.director.getProjection())},centerWindow:function(){},getVisibleSize:function(){return cc.size(this._visibleRect.width,this._visibleRect.height)},getVisibleOrigin:function(){return cc.p(this._visibleRect.x,this._visibleRect.y)},
canSetContentScaleFactor:function(){return!0},getResolutionPolicy:function(){return this._resolutionPolicy},setResolutionPolicy:function(a){if(a instanceof cc.ResolutionPolicy)this._resolutionPolicy=a;else{var b=cc.ResolutionPolicy;a===b.EXACT_FIT&&(this._resolutionPolicy=this._rpExactFit);a===b.SHOW_ALL&&(this._resolutionPolicy=this._rpShowAll);a===b.NO_BORDER&&(this._resolutionPolicy=this._rpNoBorder);a===b.FIXED_HEIGHT&&(this._resolutionPolicy=this._rpFixedHeight);a===b.FIXED_WIDTH&&(this._resolutionPolicy=
this._rpFixedWidth)}},setDesignResolutionSize:function(a,b,c){if(isNaN(a)||0==a||isNaN(b)||0==b)return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize);this.setResolutionPolicy(c);var d=this._resolutionPolicy;if(!d)return void cc.log(cc._LogInfos.EGLView_setDesignResolutionSize_2);d.preApply(this);var e=this._frameSize.width,f=this._frameSize.height;if(cc.sys.isMobile&&this._setViewPortMeta(this._frameSize.width,this._frameSize.height),this._initFrameSize(),c!=this._resolutionPolicy||a!=
this._originalDesignResolutionSize.width||b!=this._originalDesignResolutionSize.height||e!=this._frameSize.width||f!=this._frameSize.height){this._designResolutionSize=cc.size(a,b);this._originalDesignResolutionSize=cc.size(a,b);a=d.apply(this,this._designResolutionSize);if(a.scale&&2==a.scale.length&&(this._scaleX=a.scale[0],this._scaleY=a.scale[1]),a.viewport)a=this._viewPortRect=a.viewport,b=this._visibleRect,b.width=cc._canvas.width/this._scaleX,b.height=cc._canvas.height/this._scaleY,b.x=-a.x/
this._scaleX,b.y=-a.y/this._scaleY;a=cc.director;cc.winSize.width=a._winSizeInPoints.width=this._visibleRect.width;cc.winSize.height=a._winSizeInPoints.height=this._visibleRect.height;d.postApply(this);cc._renderType==cc._RENDER_TYPE_WEBGL&&(a._createStatsLabel(),a.setGLDefaultValues());this._originalScaleX=this._scaleX;this._originalScaleY=this._scaleY;cc.DOM&&cc.DOM._resetEGLViewDiv();cc.visibleRect&&cc.visibleRect.init(this._visibleRect)}},getDesignResolutionSize:function(){return cc.size(this._designResolutionSize.width,
this._designResolutionSize.height)},setViewPortInPoints:function(a,b,c,d){var e=this._frameZoomFactor,f=this._scaleX,g=this._scaleY;cc._renderContext.viewport(a*f*e+this._viewPortRect.x*e,b*g*e+this._viewPortRect.y*e,c*f*e,d*g*e)},setScissorInPoints:function(a,b,c,d){var e=this._frameZoomFactor,f=this._scaleX,g=this._scaleY;cc._renderContext.scissor(a*f*e+this._viewPortRect.x*e,b*g*e+this._viewPortRect.y*e,c*f*e,d*g*e)},isScissorEnabled:function(){var a=cc._renderContext;return a.isEnabled(a.SCISSOR_TEST)},
getScissorRect:function(){var a=cc._renderContext,b=this._scaleX,c=this._scaleY,a=a.getParameter(a.SCISSOR_BOX);return cc.rect((a[0]-this._viewPortRect.x)/b,(a[1]-this._viewPortRect.y)/c,a[2]/b,a[3]/c)},setViewName:function(a){null!=a&&0<a.length&&(this._viewName=a)},getViewName:function(){return this._viewName},getViewPortRect:function(){return this._viewPortRect},getScaleX:function(){return this._scaleX},getScaleY:function(){return this._scaleY},getDevicePixelRatio:function(){return this._devicePixelRatio},
convertToLocationInView:function(a,b,c){return{x:this._devicePixelRatio*(a-c.left),y:this._devicePixelRatio*(c.top+c.height-b)}},_convertMouseToLocationInView:function(a,b){var c=this._viewPortRect;a.x=(this._devicePixelRatio*(a.x-b.left)-c.x)/this._scaleX;a.y=(this._devicePixelRatio*(b.top+b.height-a.y)-c.y)/this._scaleY},_convertTouchesWithScale:function(a){for(var b,c,d,e=this._viewPortRect,f=this._scaleX,g=this._scaleY,h=0;h<a.length;h++)b=a[h],c=b._point,d=b._prevPoint,b._setPoint((c.x-e.x)/
f,(c.y-e.y)/g),b._setPrevPoint((d.x-e.x)/f,(d.y-e.y)/g)}}),cc.EGLView._getInstance=function(){return this._instance||(this._instance=this._instance||new cc.EGLView,this._instance.initialize()),this._instance},cc.ContainerStrategy=cc.Class.extend({preApply:function(){},apply:function(){},postApply:function(){},_setupContainer:function(a,b,c){var d=a._frame;cc.view._autoFullScreen&&cc.sys.isMobile&&d==document.documentElement&&cc.screen.autoFullScreen(d);var d=cc._canvas,e=cc.container;e.style.width=
d.style.width=b+"px";e.style.height=d.style.height=c+"px";e=a._devicePixelRatio=1;a.isRetinaEnabled()&&(e=a._devicePixelRatio=window.devicePixelRatio||1);d.width=b*e;d.height=c*e;var f;(a=document.body)&&(f=a.style)&&(f.paddingTop=f.paddingTop||"0px",f.paddingRight=f.paddingRight||"0px",f.paddingBottom=f.paddingBottom||"0px",f.paddingLeft=f.paddingLeft||"0px",f.borderTop=f.borderTop||"0px",f.borderRight=f.borderRight||"0px",f.borderBottom=f.borderBottom||"0px",f.borderLeft=f.borderLeft||"0px",f.marginTop=
f.marginTop||"0px",f.marginRight=f.marginRight||"0px",f.marginBottom=f.marginBottom||"0px",f.marginLeft=f.marginLeft||"0px")},_fixContainer:function(){document.body.insertBefore(cc.container,document.body.firstChild);var a=document.body.style;a.width=window.innerWidth+"px";a.height=window.innerHeight+"px";a.overflow="hidden";a=cc.container.style;a.position="fixed";a.left=a.top="0px";document.body.scrollTop=0}}),cc.ContentStrategy=cc.Class.extend({_result:{scale:[1,1],viewport:null},_buildResult:function(a,
b,c,d,e,f){2>Math.abs(a-c)&&(c=a);2>Math.abs(b-d)&&(d=b);a=cc.rect(Math.round((a-c)/2),Math.round((b-d)/2),c,d);return cc._renderType==cc._RENDER_TYPE_CANVAS&&cc._renderContext.translate(a.x,a.y+d),this._result.scale=[e,f],this._result.viewport=a,this._result},preApply:function(){},apply:function(){return{scale:[1,1]}},postApply:function(){}}),function(){var a=cc.ContainerStrategy.extend({apply:function(a){this._setupContainer(a,a._frameSize.width,a._frameSize.height)}}),b=cc.ContainerStrategy.extend({apply:function(a,
b){var c,d,e=a._frameSize.width,n=a._frameSize.height,q=cc.container.style,r=b.width,s=b.height,u=e/r,t=n/s;t>u?(c=e,d=s*u):(c=r*t,d=n);c=Math.round((e-c)/2);d=Math.round((n-d)/2);this._setupContainer(a,e-2*c,n-2*d);q.marginLeft=c+"px";q.marginRight=c+"px";q.marginTop=d+"px";q.marginBottom=d+"px"}}),c=(a.extend({preApply:function(a){this._super(a);a._frame=document.documentElement},apply:function(a){this._super(a);this._fixContainer()}}),b.extend({preApply:function(a){this._super(a);a._frame=document.documentElement},
apply:function(a,b){this._super(a,b);this._fixContainer()}}),cc.ContainerStrategy.extend({apply:function(a){this._setupContainer(a,cc._canvas.width,cc._canvas.height)}}));cc.ContainerStrategy.EQUAL_TO_FRAME=new a;cc.ContainerStrategy.PROPORTION_TO_FRAME=new b;cc.ContainerStrategy.ORIGINAL_CONTAINER=new c;var a=cc.ContentStrategy.extend({apply:function(a,b){var c=cc._canvas.width,d=cc._canvas.height;return this._buildResult(c,d,c,d,c/b.width,d/b.height)}}),b=cc.ContentStrategy.extend({apply:function(a,
b){var c,d,e=cc._canvas.width,n=cc._canvas.height,q=b.width,r=b.height,s=e/q,u=n/r,t=0;return u>s?(t=s,c=e,d=r*t):(t=u,c=q*t,d=n),this._buildResult(e,n,c,d,t,t)}}),c=cc.ContentStrategy.extend({apply:function(a,b){var c,d,e,n=cc._canvas.width,q=cc._canvas.height,r=b.width,s=b.height,u=n/r,t=q/s;return t>u?(c=t,d=r*c,e=q):(c=u,d=n,e=s*c),this._buildResult(n,q,d,e,c,c)}}),d=cc.ContentStrategy.extend({apply:function(a,b){var c=cc._canvas.width,d=cc._canvas.height,e=d/b.height;return this._buildResult(c,
d,c,d,e,e)},postApply:function(a){cc.director._winSizeInPoints=a.getVisibleSize()}}),e=cc.ContentStrategy.extend({apply:function(a,b){var c=cc._canvas.width,d=cc._canvas.height,e=c/b.width;return this._buildResult(c,d,c,d,e,e)},postApply:function(a){cc.director._winSizeInPoints=a.getVisibleSize()}});cc.ContentStrategy.EXACT_FIT=new a;cc.ContentStrategy.SHOW_ALL=new b;cc.ContentStrategy.NO_BORDER=new c;cc.ContentStrategy.FIXED_HEIGHT=new d;cc.ContentStrategy.FIXED_WIDTH=new e}(),cc.ResolutionPolicy=
cc.Class.extend({_containerStrategy:null,_contentStrategy:null,ctor:function(a,b){this.setContainerStrategy(a);this.setContentStrategy(b)},preApply:function(a){this._containerStrategy.preApply(a);this._contentStrategy.preApply(a)},apply:function(a,b){return this._containerStrategy.apply(a,b),this._contentStrategy.apply(a,b)},postApply:function(a){this._containerStrategy.postApply(a);this._contentStrategy.postApply(a)},setContainerStrategy:function(a){a instanceof cc.ContainerStrategy&&(this._containerStrategy=
a)},setContentStrategy:function(a){a instanceof cc.ContentStrategy&&(this._contentStrategy=a)}}),cc.ResolutionPolicy.EXACT_FIT=0,cc.ResolutionPolicy.NO_BORDER=1,cc.ResolutionPolicy.SHOW_ALL=2,cc.ResolutionPolicy.FIXED_HEIGHT=3,cc.ResolutionPolicy.FIXED_WIDTH=4,cc.ResolutionPolicy.UNKNOWN=5,cc.screen={_supportsFullScreen:!1,_preOnFullScreenChange:null,_touchEvent:"",_fn:null,_fnMap:[["requestFullscreen","exitFullscreen","fullscreenchange","fullscreenEnabled","fullscreenElement"],["requestFullScreen",
"exitFullScreen","fullScreenchange","fullScreenEnabled","fullScreenElement"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitfullscreenchange","webkitIsFullScreen","webkitCurrentFullScreenElement"],["mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozFullScreen","mozFullScreenElement"],["msRequestFullscreen","msExitFullscreen","MSFullscreenChange","msFullscreenEnabled","msFullscreenElement"]],init:function(){this._fn={};var a,b,c,d=this._fnMap;a=0;for(l=d.length;l>a;a++)if(b=
d[a],b&&b[1]in document){a=0;for(c=b.length;c>a;a++)this._fn[d[0][a]]=b[a];break}this._supportsFullScreen=void 0!=this._fn.requestFullscreen;this._touchEvent="ontouchstart"in window?"touchstart":"mousedown"},fullScreen:function(){return this._supportsFullScreen&&document[this._fn.fullscreenEnabled]},requestFullScreen:function(a,b){if(this._supportsFullScreen){if(a=a||document.documentElement,a[this._fn.requestFullscreen](),b){var c=this._fn.fullscreenchange;this._preOnFullScreenChange&&document.removeEventListener(c,
this._preOnFullScreenChange);this._preOnFullScreenChange=b;cc._addEventListener(document,c,b,!1)}return a[this._fn.requestFullscreen]()}},exitFullScreen:function(){return this._supportsFullScreen?document[this._fn.exitFullscreen]():!0},autoFullScreen:function(a,b){function c(){e.requestFullScreen(a,b);d.removeEventListener(e._touchEvent,c)}a=a||document.body;var d=cc._canvas||a,e=this;this.requestFullScreen(a,b);cc._addEventListener(d,this._touchEvent,c)}},cc.screen.init(),cc.visibleRect={topLeft:cc.p(0,
0),topRight:cc.p(0,0),top:cc.p(0,0),bottomLeft:cc.p(0,0),bottomRight:cc.p(0,0),bottom:cc.p(0,0),center:cc.p(0,0),left:cc.p(0,0),right:cc.p(0,0),width:0,height:0,init:function(a){var b=this.width=a.width,c=this.height=a.height,d=a.x;a=a.y;var e=a+c,f=d+b;this.topLeft.x=d;this.topLeft.y=e;this.topRight.x=f;this.topRight.y=e;this.top.x=d+b/2;this.top.y=e;this.bottomLeft.x=d;this.bottomLeft.y=a;this.bottomRight.x=f;this.bottomRight.y=a;this.bottom.x=d+b/2;this.bottom.y=a;this.center.x=d+b/2;this.center.y=
a+c/2;this.left.x=d;this.left.y=a+c/2;this.right.x=f;this.right.y=a+c/2}},cc.UIInterfaceOrientationLandscapeLeft=-90,cc.UIInterfaceOrientationLandscapeRight=90,cc.UIInterfaceOrientationPortraitUpsideDown=180,cc.UIInterfaceOrientationPortrait=0,cc.inputManager={_mousePressed:!1,_isRegisterEvent:!1,_preTouchPoint:cc.p(0,0),_prevMousePoint:cc.p(0,0),_preTouchPool:[],_preTouchPoolPointer:0,_touches:[],_touchesIntegerDict:{},_indexBitsUsed:0,_maxTouches:5,_accelEnabled:!1,_accelInterval:1/30,_accelMinus:1,
_accelCurTime:0,_acceleration:null,_accelDeviceEvent:null,_getUnUsedIndex:function(){for(var a=this._indexBitsUsed,b=0;b<this._maxTouches;b++){if(!(1&a))return this._indexBitsUsed|=1<<b,b;a>>=1}return-1},_removeUsedIndexBit:function(a){0>a||a>=this._maxTouches||(a=~(1<<a),this._indexBitsUsed&=a)},_glView:null,handleTouchesBegin:function(a){for(var b,c,d,e,f=[],g=this._touchesIntegerDict,h=0,k=a.length;k>h;h++)if(b=a[h],e=b.getID(),c=g[e],null==c){var m=this._getUnUsedIndex();-1==m?cc.log(cc._LogInfos.inputManager_handleTouchesBegin,
m):(d=this._touches[m]=new cc.Touch(b._point.x,b._point.y,b.getID()),d._setPrevPoint(b._prevPoint),g[e]=m,f.push(d))}0<f.length&&(this._glView._convertTouchesWithScale(f),a=new cc.EventTouch(f),a._eventCode=cc.EventTouch.EventCode.BEGAN,cc.eventManager.dispatchEvent(a))},handleTouchesMove:function(a){for(var b,c,d=[],e=this._touches,f=0,g=a.length;g>f;f++)b=a[f],c=b.getID(),c=this._touchesIntegerDict[c],null!=c&&e[c]&&(e[c]._setPoint(b._point),e[c]._setPrevPoint(b._prevPoint),d.push(e[c]));0<d.length&&
(this._glView._convertTouchesWithScale(d),a=new cc.EventTouch(d),a._eventCode=cc.EventTouch.EventCode.MOVED,cc.eventManager.dispatchEvent(a))},handleTouchesEnd:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.EventTouch(a),a._eventCode=cc.EventTouch.EventCode.ENDED,cc.eventManager.dispatchEvent(a))},handleTouchesCancel:function(a){a=this.getSetOfTouchesEndOrCancel(a);0<a.length&&(this._glView._convertTouchesWithScale(a),a=new cc.EventTouch(a),
a._eventCode=cc.EventTouch.EventCode.CANCELLED,cc.eventManager.dispatchEvent(a))},getSetOfTouchesEndOrCancel:function(a){for(var b,c,d,e=[],f=this._touches,g=this._touchesIntegerDict,h=0,k=a.length;k>h;h++)b=a[h],d=b.getID(),c=g[d],null!=c&&f[c]&&(f[c]._setPoint(b._point),f[c]._setPrevPoint(b._prevPoint),e.push(f[c]),this._removeUsedIndexBit(c),delete g[d]);return e},getHTMLElementPosition:function(a){var b=document.documentElement,c=window,d=null;return d="function"==typeof a.getBoundingClientRect?
a.getBoundingClientRect():a instanceof HTMLCanvasElement?{left:0,top:0,width:a.width,height:a.height}:{left:0,top:0,width:parseInt(a.style.width),height:parseInt(a.style.height)},{left:d.left+c.pageXOffset-b.clientLeft,top:d.top+c.pageYOffset-b.clientTop,width:d.width,height:d.height}},getPreTouch:function(a){for(var b=null,c=this._preTouchPool,d=a.getID(),e=c.length-1;0<=e;e--)if(c[e].getID()==d){b=c[e];break}return b||(b=a),b},setPreTouch:function(a){for(var b=!1,c=this._preTouchPool,d=a.getID(),
e=c.length-1;0<=e;e--)if(c[e].getID()==d){c[e]=a;b=!0;break}b||(50>=c.length?c.push(a):(c[this._preTouchPoolPointer]=a,this._preTouchPoolPointer=(this._preTouchPoolPointer+1)%50))},getTouchByXY:function(a,b,c){var d=this._preTouchPoint;a=this._glView.convertToLocationInView(a,b,c);b=new cc.Touch(a.x,a.y);return b._setPrevPoint(d.x,d.y),d.x=a.x,d.y=a.y,b},getMouseEvent:function(a,b,c){var d=this._prevMousePoint;this._glView._convertMouseToLocationInView(a,b);b=new cc.EventMouse(c);return b.setLocation(a.x,
a.y),b._setPrevCursor(d.x,d.y),d.x=a.x,d.y=a.y,b},getPointByEvent:function(a,b){return null!=a.pageX?{x:a.pageX,y:a.pageY}:(b.left-=document.body.scrollLeft,b.top-=document.body.scrollTop,{x:a.clientX,y:a.clientY})},getTouchesByEvent:function(a,b){for(var c,d,e,f=[],g=this._glView,h=this._preTouchPoint,k=a.changedTouches.length,m=0;k>m;m++)if(c=a.changedTouches[m]){var n;n=cc.sys.BROWSER_TYPE_FIREFOX===cc.sys.browserType?g.convertToLocationInView(c.pageX,c.pageY,b):g.convertToLocationInView(c.clientX,
c.clientY,b);null!=c.identifier?(d=new cc.Touch(n.x,n.y,c.identifier),e=this.getPreTouch(d).getLocation(),d._setPrevPoint(e.x,e.y),this.setPreTouch(d)):(d=new cc.Touch(n.x,n.y),d._setPrevPoint(h.x,h.y));h.x=n.x;h.y=n.y;f.push(d)}return f},registerSystemEvent:function(a){if(!this._isRegisterEvent){var b=this._glView=cc.view,c=this,d="touches"in cc.sys.capabilities;if("mouse"in cc.sys.capabilities&&(cc._addEventListener(window,"mousedown",function(){c._mousePressed=!0},!1),cc._addEventListener(window,
"mouseup",function(b){var e=c._mousePressed;if(c._mousePressed=!1,e){var e=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,e);cc.rectContainsPoint(new cc.Rect(e.left,e.top,e.width,e.height),f)||(d||c.handleTouchesEnd([c.getTouchByXY(f.x,f.y,e)]),e=c.getMouseEvent(f,e,cc.EventMouse.UP),e.setButton(b.button),cc.eventManager.dispatchEvent(e))}},!1),cc._addEventListener(a,"mousedown",function(b){c._mousePressed=!0;var e=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,e);d||c.handleTouchesBegin([c.getTouchByXY(f.x,
f.y,e)]);e=c.getMouseEvent(f,e,cc.EventMouse.DOWN);e.setButton(b.button);cc.eventManager.dispatchEvent(e);b.stopPropagation();b.preventDefault();a.focus()},!1),cc._addEventListener(a,"mouseup",function(b){c._mousePressed=!1;var e=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,e);d||c.handleTouchesEnd([c.getTouchByXY(f.x,f.y,e)]);e=c.getMouseEvent(f,e,cc.EventMouse.UP);e.setButton(b.button);cc.eventManager.dispatchEvent(e);b.stopPropagation();b.preventDefault()},!1),cc._addEventListener(a,"mousemove",
function(b){var e=c.getHTMLElementPosition(a),f=c.getPointByEvent(b,e);d||c.handleTouchesMove([c.getTouchByXY(f.x,f.y,e)]);e=c.getMouseEvent(f,e,cc.EventMouse.MOVE);e.setButton(c._mousePressed?b.button:null);cc.eventManager.dispatchEvent(e);b.stopPropagation();b.preventDefault()},!1),cc._addEventListener(a,"mousewheel",function(b){var d=c.getHTMLElementPosition(a),e=c.getPointByEvent(b,d),d=c.getMouseEvent(e,d,cc.EventMouse.SCROLL);d.setButton(b.button);d.setScrollData(0,b.wheelDelta);cc.eventManager.dispatchEvent(d);
b.stopPropagation();b.preventDefault()},!1),cc._addEventListener(a,"DOMMouseScroll",function(b){var d=c.getHTMLElementPosition(a),e=c.getPointByEvent(b,d),d=c.getMouseEvent(e,d,cc.EventMouse.SCROLL);d.setButton(b.button);d.setScrollData(0,-120*b.detail);cc.eventManager.dispatchEvent(d);b.stopPropagation();b.preventDefault()},!1)),window.navigator.msPointerEnabled){var e={MSPointerDown:c.handleTouchesBegin,MSPointerMove:c.handleTouchesMove,MSPointerUp:c.handleTouchesEnd,MSPointerCancel:c.handleTouchesCancel},
f;for(f in e)!function(b,d){cc._addEventListener(a,b,function(b){var e=c.getHTMLElementPosition(a);e.left-=document.documentElement.scrollLeft;e.top-=document.documentElement.scrollTop;d.call(c,[c.getTouchByXY(b.clientX,b.clientY,e)]);b.stopPropagation()},!1)}(f,e[f])}d&&(cc._addEventListener(a,"touchstart",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesBegin(c.getTouchesByEvent(b,d));b.stopPropagation();
b.preventDefault();a.focus()}},!1),cc._addEventListener(a,"touchmove",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesMove(c.getTouchesByEvent(b,d));b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(a,"touchend",function(b){if(b.changedTouches){var d=c.getHTMLElementPosition(a);d.left-=document.body.scrollLeft;d.top-=document.body.scrollTop;c.handleTouchesEnd(c.getTouchesByEvent(b,d));
b.stopPropagation();b.preventDefault()}},!1),cc._addEventListener(a,"touchcancel",function(d){if(d.changedTouches){var e=c.getHTMLElementPosition(a);e.left-=document.body.scrollLeft;e.top-=document.body.scrollTop;b.handleTouchesCancel(c.getTouchesByEvent(d,e));d.stopPropagation();d.preventDefault()}},!1));this._registerKeyboardEvent();this._registerAccelerometerEvent();this._isRegisterEvent=!0}},_registerKeyboardEvent:function(){},_registerAccelerometerEvent:function(){},update:function(a){this._accelCurTime>
this._accelInterval&&(this._accelCurTime-=this._accelInterval,cc.eventManager.dispatchEvent(new cc.EventAcceleration(this._acceleration)));this._accelCurTime+=a}},cc.AffineTransform=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.d=d;this.tx=e;this.ty=f},cc.affineTransformMake=function(a,b,c,d,e,f){return{a:a,b:b,c:c,d:d,tx:e,ty:f}},cc.pointApplyAffineTransform=function(a,b){return{x:b.a*a.x+b.c*a.y+b.tx,y:b.b*a.x+b.d*a.y+b.ty}},cc._pointApplyAffineTransform=function(a,b,c){return{x:c.a*a+c.c*
b+c.tx,y:c.b*a+c.d*b+c.ty}},cc.sizeApplyAffineTransform=function(a,b){return{width:b.a*a.width+b.c*a.height,height:b.b*a.width+b.d*a.height}},cc.affineTransformMakeIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.affineTransformIdentity=function(){return{a:1,b:0,c:0,d:1,tx:0,ty:0}},cc.rectApplyAffineTransform=function(a,b){var c=cc.rectGetMinY(a),d=cc.rectGetMinX(a),e=cc.rectGetMaxX(a),f=cc.rectGetMaxY(a),g=cc._pointApplyAffineTransform(d,c,b),c=cc._pointApplyAffineTransform(e,c,b),d=cc._pointApplyAffineTransform(d,
f,b),h=cc._pointApplyAffineTransform(e,f,b),e=Math.min(g.x,c.x,d.x,h.x),f=Math.max(g.x,c.x,d.x,h.x),k=Math.min(g.y,c.y,d.y,h.y),g=Math.max(g.y,c.y,d.y,h.y);return cc.rect(e,k,f-e,g-k)},cc._rectApplyAffineTransformIn=function(a,b){var c=cc.rectGetMinY(a),d=cc.rectGetMinX(a),e=cc.rectGetMaxX(a),f=cc.rectGetMaxY(a),g=cc._pointApplyAffineTransform(d,c,b),c=cc._pointApplyAffineTransform(e,c,b),d=cc._pointApplyAffineTransform(d,f,b),h=cc._pointApplyAffineTransform(e,f,b),e=Math.min(g.x,c.x,d.x,h.x),f=Math.max(g.x,
c.x,d.x,h.x),k=Math.min(g.y,c.y,d.y,h.y),g=Math.max(g.y,c.y,d.y,h.y);return a.x=e,a.y=k,a.width=f-e,a.height=g-k,a},cc.affineTransformTranslate=function(a,b,c){return{a:a.a,b:a.b,c:a.c,d:a.d,tx:a.tx+a.a*b+a.c*c,ty:a.ty+a.b*b+a.d*c}},cc.affineTransformScale=function(a,b,c){return{a:a.a*b,b:a.b*b,c:a.c*c,d:a.d*c,tx:a.tx,ty:a.ty}},cc.affineTransformRotate=function(a,b){var c=Math.sin(b),d=Math.cos(b);return{a:a.a*d+a.c*c,b:a.b*d+a.d*c,c:a.c*d-a.a*c,d:a.d*d-a.b*c,tx:a.tx,ty:a.ty}},cc.affineTransformConcat=
function(a,b){return{a:a.a*b.a+a.b*b.c,b:a.a*b.b+a.b*b.d,c:a.c*b.a+a.d*b.c,d:a.c*b.b+a.d*b.d,tx:a.tx*b.a+a.ty*b.c+b.tx,ty:a.tx*b.b+a.ty*b.d+b.ty}},cc.affineTransformEqualToTransform=function(a,b){return a.a===b.a&&a.b===b.b&&a.c===b.c&&a.d===b.d&&a.tx===b.tx&&a.ty===b.ty},cc.affineTransformInvert=function(a){var b=1/(a.a*a.d-a.b*a.c);return{a:b*a.d,b:-b*a.b,c:-b*a.c,d:b*a.a,tx:b*(a.c*a.ty-a.d*a.tx),ty:b*(a.b*a.tx-a.a*a.ty)}},cc.POINT_EPSILON=parseFloat("1.192092896e-07F"),cc.pNeg=function(a){return cc.p(-a.x,
-a.y)},cc.pAdd=function(a,b){return cc.p(a.x+b.x,a.y+b.y)},cc.pSub=function(a,b){return cc.p(a.x-b.x,a.y-b.y)},cc.pMult=function(a,b){return cc.p(a.x*b,a.y*b)},cc.pMidpoint=function(a,b){return cc.pMult(cc.pAdd(a,b),.5)},cc.pDot=function(a,b){return a.x*b.x+a.y*b.y},cc.pCross=function(a,b){return a.x*b.y-a.y*b.x},cc.pPerp=function(a){return cc.p(-a.y,a.x)},cc.pRPerp=function(a){return cc.p(a.y,-a.x)},cc.pProject=function(a,b){return cc.pMult(b,cc.pDot(a,b)/cc.pDot(b,b))},cc.pRotate=function(a,b){return cc.p(a.x*
b.x-a.y*b.y,a.x*b.y+a.y*b.x)},cc.pUnrotate=function(a,b){return cc.p(a.x*b.x+a.y*b.y,a.y*b.x-a.x*b.y)},cc.pLengthSQ=function(a){return cc.pDot(a,a)},cc.pDistanceSQ=function(a,b){return cc.pLengthSQ(cc.pSub(a,b))},cc.pLength=function(a){return Math.sqrt(cc.pLengthSQ(a))},cc.pDistance=function(a,b){return cc.pLength(cc.pSub(a,b))},cc.pNormalize=function(a){return cc.pMult(a,1/cc.pLength(a))},cc.pForAngle=function(a){return cc.p(Math.cos(a),Math.sin(a))},cc.pToAngle=function(a){return Math.atan2(a.y,
a.x)},cc.clampf=function(a,b,c){if(b>c){var d=b;b=c;c=d}return b>a?b:c>a?a:c},cc.pClamp=function(a,b,c){return cc.p(cc.clampf(a.x,b.x,c.x),cc.clampf(a.y,b.y,c.y))},cc.pFromSize=function(a){return cc.p(a.width,a.height)},cc.pCompOp=function(a,b){return cc.p(b(a.x),b(a.y))},cc.pLerp=function(a,b,c){return cc.pAdd(cc.pMult(a,1-c),cc.pMult(b,c))},cc.pFuzzyEqual=function(a,b,c){return a.x-c<=b.x&&b.x<=a.x+c&&a.y-c<=b.y&&b.y<=a.y+c?!0:!1},cc.pCompMult=function(a,b){return cc.p(a.x*b.x,a.y*b.y)},cc.pAngleSigned=
function(a,b){var c=cc.pNormalize(a),d=cc.pNormalize(b),c=Math.atan2(c.x*d.y-c.y*d.x,cc.pDot(c,d));return Math.abs(c)<cc.POINT_EPSILON?0:c},cc.pAngle=function(a,b){var c=Math.acos(cc.pDot(cc.pNormalize(a),cc.pNormalize(b)));return Math.abs(c)<cc.POINT_EPSILON?0:c},cc.pRotateByAngle=function(a,b,c){a=cc.pSub(a,b);var d=Math.cos(c);c=Math.sin(c);var e=a.x;return a.x=e*d-a.y*c+b.x,a.y=e*c+a.y*d+b.y,a},cc.pLineIntersect=function(a,b,c,d,e){if(a.x==b.x&&a.y==b.y||c.x==d.x&&c.y==d.y)return!1;var f=b.x-
a.x;b=b.y-a.y;var g=d.x-c.x;d=d.y-c.y;var h=a.x-c.x;a=a.y-c.y;c=d*f-g*b;return e.x=g*a-d*h,e.y=f*a-b*h,0==c?0==e.x||0==e.y?!0:!1:(e.x/=c,e.y/=c,!0)},cc.pSegmentIntersect=function(a,b,c,d){var e=cc.p(0,0);return cc.pLineIntersect(a,b,c,d,e)&&0<=e.x&&1>=e.x&&0<=e.y&&1>=e.y?!0:!1},cc.pIntersectPoint=function(a,b,c,d){var e=cc.p(0,0);return cc.pLineIntersect(a,b,c,d,e)?(c=cc.p(0,0),c.x=a.x+e.x*(b.x-a.x),c.y=a.y+e.x*(b.y-a.y),c):cc.p(0,0)},cc.pSameAs=function(a,b){return null!=a&&null!=b?a.x==b.x&&a.y==
b.y:!1},cc.pZeroIn=function(a){a.x=0;a.y=0},cc.pIn=function(a,b){a.x=b.x;a.y=b.y},cc.pMultIn=function(a,b){a.x*=b;a.y*=b},cc.pSubIn=function(a,b){a.x-=b.x;a.y-=b.y},cc.pAddIn=function(a,b){a.x+=b.x;a.y+=b.y},cc.pNormalizeIn=function(a){cc.pMultIn(a,1/Math.sqrt(a.x*a.x+a.y*a.y))},cc.Touch=cc.Class.extend({_point:null,_prevPoint:null,_id:0,_startPointCaptured:!1,_startPoint:null,ctor:function(a,b,c){this._point=cc.p(a||0,b||0);this._id=c||0},getLocation:function(){return{x:this._point.x,y:this._point.y}},
getLocationX:function(){return this._point.x},getLocationY:function(){return this._point.y},getPreviousLocation:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocation:function(){return{x:this._startPoint.x,y:this._startPoint.y}},getDelta:function(){return cc.pSub(this._point,this._prevPoint)},getLocationInView:function(){return{x:this._point.x,y:this._point.y}},getPreviousLocationInView:function(){return{x:this._prevPoint.x,y:this._prevPoint.y}},getStartLocationInView:function(){return{x:this._startPoint.x,
y:this._startPoint.y}},getID:function(){return this._id},getId:function(){return cc.log("getId is deprecated. Please use getID instead."),this._id},setTouchInfo:function(a,b,c){this._prevPoint=this._point;this._point=cc.p(b||0,c||0);this._id=a;this._startPointCaptured||(this._startPoint=cc.p(this._point),this._startPointCaptured=!0)},_setPoint:function(a,b){void 0===b?(this._point.x=a.x,this._point.y=a.y):(this._point.x=a,this._point.y=b)},_setPrevPoint:function(a,b){this._prevPoint=void 0===b?cc.p(a.x,
a.y):cc.p(a||0,b||0)}}),cc.Event=cc.Class.extend({_type:0,_isStopped:!1,_currentTarget:null,_setCurrentTarget:function(a){this._currentTarget=a},ctor:function(a){this._type=a},getType:function(){return this._type},stopPropagation:function(){this._isStopped=!0},isStopped:function(){return this._isStopped},getCurrentTarget:function(){return this._currentTarget}}),cc.Event.TOUCH=0,cc.Event.KEYBOARD=1,cc.Event.ACCELERATION=2,cc.Event.MOUSE=3,cc.Event.CUSTOM=4,cc.EventCustom=cc.Event.extend({_eventName:null,
_userData:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.CUSTOM);this._eventName=a},setUserData:function(a){this._userData=a},getUserData:function(){return this._userData},getEventName:function(){return this._eventName}}),cc.EventMouse=cc.Event.extend({_eventType:0,_button:0,_x:0,_y:0,_prevX:0,_prevY:0,_scrollX:0,_scrollY:0,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.MOUSE);this._eventType=a},setScrollData:function(a,b){this._scrollX=a;this._scrollY=b},getScrollX:function(){return this._scrollX},
getScrollY:function(){return this._scrollY},setLocation:function(a,b){this._x=a;this._y=b},getLocation:function(){return{x:this._x,y:this._y}},getLocationInView:function(){return{x:this._x,y:cc.view._designResolutionSize.height-this._y}},_setPrevCursor:function(a,b){this._prevX=a;this._prevY=b},getDelta:function(){return{x:this._x-this._prevX,y:this._y-this._prevY}},getDeltaX:function(){return this._x-this._prevX},getDeltaY:function(){return this._y-this._prevY},setButton:function(a){this._button=
a},getButton:function(){return this._button},getLocationX:function(){return this._x},getLocationY:function(){return this._y}}),cc.EventMouse.NONE=0,cc.EventMouse.DOWN=1,cc.EventMouse.UP=2,cc.EventMouse.MOVE=3,cc.EventMouse.SCROLL=4,cc.EventMouse.BUTTON_LEFT=0,cc.EventMouse.BUTTON_RIGHT=2,cc.EventMouse.BUTTON_MIDDLE=1,cc.EventMouse.BUTTON_4=3,cc.EventMouse.BUTTON_5=4,cc.EventMouse.BUTTON_6=5,cc.EventMouse.BUTTON_7=6,cc.EventMouse.BUTTON_8=7,cc.EventTouch=cc.Event.extend({_eventCode:0,_touches:null,
ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.TOUCH);this._touches=a||[]},getEventCode:function(){return this._eventCode},getTouches:function(){return this._touches},_setEventCode:function(a){this._eventCode=a},_setTouches:function(a){this._touches=a}}),cc.EventTouch.MAX_TOUCHES=5,cc.EventTouch.EventCode={BEGAN:0,MOVED:1,ENDED:2,CANCELLED:3},cc.EventListener=cc.Class.extend({_onEvent:null,_type:0,_listenerID:null,_registered:!1,_fixedPriority:0,_node:null,_paused:!1,_isEnabled:!0,ctor:function(a,
b,c){this._onEvent=c;this._type=a||0;this._listenerID=b||""},_setPaused:function(a){this._paused=a},_isPaused:function(){return this._paused},_setRegistered:function(a){this._registered=a},_isRegistered:function(){return this._registered},_getType:function(){return this._type},_getListenerID:function(){return this._listenerID},_setFixedPriority:function(a){this._fixedPriority=a},_getFixedPriority:function(){return this._fixedPriority},_setSceneGraphPriority:function(a){this._node=a},_getSceneGraphPriority:function(){return this._node},
checkAvailable:function(){return null!=this._onEvent},clone:function(){return null},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled},retain:function(){},release:function(){}}),cc.EventListener.UNKNOWN=0,cc.EventListener.TOUCH_ONE_BY_ONE=1,cc.EventListener.TOUCH_ALL_AT_ONCE=2,cc.EventListener.KEYBOARD=3,cc.EventListener.MOUSE=4,cc.EventListener.ACCELERATION=5,cc.EventListener.CUSTOM=6,cc._EventListenerCustom=cc.EventListener.extend({_onCustomEvent:null,ctor:function(a,
b){this._onCustomEvent=b;var c=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.CUSTOM,a,function(a){null!=c._onCustomEvent&&c._onCustomEvent(a)})},checkAvailable:function(){return cc.EventListener.prototype.checkAvailable.call(this)&&null!=this._onCustomEvent},clone:function(){return new cc._EventListenerCustom(this._listenerID,this._onCustomEvent)}}),cc._EventListenerCustom.create=function(a,b){return new cc._EventListenerCustom(a,b)},cc._EventListenerMouse=cc.EventListener.extend({onMouseDown:null,
onMouseUp:null,onMouseMove:null,onMouseScroll:null,ctor:function(){var a=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.MOUSE,cc._EventListenerMouse.LISTENER_ID,function(b){var c=cc.EventMouse;switch(b._eventType){case c.DOWN:a.onMouseDown&&a.onMouseDown(b);break;case c.UP:a.onMouseUp&&a.onMouseUp(b);break;case c.MOVE:a.onMouseMove&&a.onMouseMove(b);break;case c.SCROLL:a.onMouseScroll&&a.onMouseScroll(b)}})},clone:function(){var a=new cc._EventListenerMouse;return a.onMouseDown=this.onMouseDown,
a.onMouseUp=this.onMouseUp,a.onMouseMove=this.onMouseMove,a.onMouseScroll=this.onMouseScroll,a},checkAvailable:function(){return!0}}),cc._EventListenerMouse.LISTENER_ID="__cc_mouse",cc._EventListenerMouse.create=function(){return new cc._EventListenerMouse},cc._EventListenerTouchOneByOne=cc.EventListener.extend({_claimedTouches:null,swallowTouches:!1,onTouchBegan:null,onTouchMoved:null,onTouchEnded:null,onTouchCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ONE_BY_ONE,
cc._EventListenerTouchOneByOne.LISTENER_ID,null);this._claimedTouches=[]},setSwallowTouches:function(a){this.swallowTouches=a},clone:function(){var a=new cc._EventListenerTouchOneByOne;return a.onTouchBegan=this.onTouchBegan,a.onTouchMoved=this.onTouchMoved,a.onTouchEnded=this.onTouchEnded,a.onTouchCancelled=this.onTouchCancelled,a.swallowTouches=this.swallowTouches,a},checkAvailable:function(){return this.onTouchBegan?!0:(cc.log(cc._LogInfos._EventListenerTouchOneByOne_checkAvailable),!1)}}),cc._EventListenerTouchOneByOne.LISTENER_ID=
"__cc_touch_one_by_one",cc._EventListenerTouchOneByOne.create=function(){return new cc._EventListenerTouchOneByOne},cc._EventListenerTouchAllAtOnce=cc.EventListener.extend({onTouchesBegan:null,onTouchesMoved:null,onTouchesEnded:null,onTouchesCancelled:null,ctor:function(){cc.EventListener.prototype.ctor.call(this,cc.EventListener.TOUCH_ALL_AT_ONCE,cc._EventListenerTouchAllAtOnce.LISTENER_ID,null)},clone:function(){var a=new cc._EventListenerTouchAllAtOnce;return a.onTouchesBegan=this.onTouchesBegan,
a.onTouchesMoved=this.onTouchesMoved,a.onTouchesEnded=this.onTouchesEnded,a.onTouchesCancelled=this.onTouchesCancelled,a},checkAvailable:function(){return null==this.onTouchesBegan&&null==this.onTouchesMoved&&null==this.onTouchesEnded&&null==this.onTouchesCancelled?(cc.log(cc._LogInfos._EventListenerTouchAllAtOnce_checkAvailable),!1):!0}}),cc._EventListenerTouchAllAtOnce.LISTENER_ID="__cc_touch_all_at_once",cc._EventListenerTouchAllAtOnce.create=function(){return new cc._EventListenerTouchAllAtOnce},
cc.EventListener.create=function(a){cc.assert(a&&a.event,cc._LogInfos.EventListener_create);var b=a.event;delete a.event;var c=null;b===cc.EventListener.TOUCH_ONE_BY_ONE?c=new cc._EventListenerTouchOneByOne:b===cc.EventListener.TOUCH_ALL_AT_ONCE?c=new cc._EventListenerTouchAllAtOnce:b===cc.EventListener.MOUSE?c=new cc._EventListenerMouse:b===cc.EventListener.CUSTOM?(c=new cc._EventListenerCustom(a.eventName,a.callback),delete a.eventName,delete a.callback):b===cc.EventListener.KEYBOARD?c=new cc._EventListenerKeyboard:
b===cc.EventListener.ACCELERATION&&(c=new cc._EventListenerAcceleration(a.callback),delete a.callback);for(var d in a)c[d]=a[d];return c},cc._EventListenerVector=cc.Class.extend({_fixedListeners:null,_sceneGraphListeners:null,gt0Index:0,ctor:function(){this._fixedListeners=[];this._sceneGraphListeners=[]},size:function(){return this._fixedListeners.length+this._sceneGraphListeners.length},empty:function(){return 0===this._fixedListeners.length&&0===this._sceneGraphListeners.length},push:function(a){0==
a._getFixedPriority()?this._sceneGraphListeners.push(a):this._fixedListeners.push(a)},clearSceneGraphListeners:function(){this._sceneGraphListeners.length=0},clearFixedListeners:function(){this._fixedListeners.length=0},clear:function(){this._sceneGraphListeners.length=0;this._fixedListeners.length=0},getFixedPriorityListeners:function(){return this._fixedListeners},getSceneGraphPriorityListeners:function(){return this._sceneGraphListeners}}),cc.__getListenerID=function(a){var b=cc.Event,c=a.getType();
return c===b.ACCELERATION?cc._EventListenerAcceleration.LISTENER_ID:c===b.CUSTOM?a.getEventName():c===b.KEYBOARD?cc._EventListenerKeyboard.LISTENER_ID:c===b.MOUSE?cc._EventListenerMouse.LISTENER_ID:(c===b.TOUCH&&cc.log(cc._LogInfos.__getListenerID),"")},cc.eventManager={DIRTY_NONE:0,DIRTY_FIXED_PRIORITY:1,DIRTY_SCENE_GRAPH_PRIORITY:2,DIRTY_ALL:3,_listenersMap:{},_priorityDirtyFlagMap:{},_nodeListenersMap:{},_nodePriorityMap:{},_globalZOrderNodeMap:{},_toAddedListeners:[],_dirtyNodes:[],_inDispatch:0,
_isEnabled:!1,_nodePriorityIndex:0,_internalCustomListenerIDs:[cc.game.EVENT_HIDE,cc.game.EVENT_SHOW],_setDirtyForNode:function(a){null!=this._nodeListenersMap[a.__instanceId]&&this._dirtyNodes.push(a);a=a.getChildren();for(var b=0,c=a.length;c>b;b++)this._setDirtyForNode(a[b])},pauseTarget:function(a,b){var c,d,e=this._nodeListenersMap[a.__instanceId];if(e)for(c=0,d=e.length;d>c;c++)e[c]._setPaused(!0);if(!0===b)for(e=a.getChildren(),c=0,d=e.length;d>c;c++)this.pauseTarget(e[c],!0)},resumeTarget:function(a,
b){var c,d,e=this._nodeListenersMap[a.__instanceId];if(e)for(c=0,d=e.length;d>c;c++)e[c]._setPaused(!1);if(this._setDirtyForNode(a),!0===b)for(e=a.getChildren(),c=0,d=e.length;d>c;c++)this.resumeTarget(e[c],!0)},_addListener:function(a){0===this._inDispatch?this._forceAddEventListener(a):this._toAddedListeners.push(a)},_forceAddEventListener:function(a){var b=a._getListenerID(),c=this._listenersMap[b];(c||(c=new cc._EventListenerVector,this._listenersMap[b]=c),c.push(a),0==a._getFixedPriority())?
(this._setDirty(b,this.DIRTY_SCENE_GRAPH_PRIORITY),b=a._getSceneGraphPriority(),null==b&&cc.log(cc._LogInfos.eventManager__forceAddEventListener),this._associateNodeAndEventListener(b,a),b.isRunning()&&this.resumeTarget(b)):this._setDirty(b,this.DIRTY_FIXED_PRIORITY)},_getListeners:function(a){return this._listenersMap[a]},_updateDirtyFlagForSceneGraph:function(){if(0!=this._dirtyNodes.length){for(var a,b,c=this._dirtyNodes,d=this._nodeListenersMap,e=0,f=c.length;f>e;e++)if(a=d[c[e].__instanceId])for(var g=
0,h=a.length;h>g;g++)(b=a[g])&&this._setDirty(b._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY);this._dirtyNodes.length=0}},_removeAllListenersInVector:function(a){if(a)for(var b,c=0;c<a.length;)b=a[c],b._setRegistered(!1),null!=b._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(b._getSceneGraphPriority(),b),b._setSceneGraphPriority(null)),0===this._inDispatch?cc.arrayRemoveObject(a,b):++c},_removeListenersForListenerID:function(a){var b;if(b=this._listenersMap[a]){var c=b.getFixedPriorityListeners(),
d=b.getSceneGraphPriorityListeners();this._removeAllListenersInVector(d);this._removeAllListenersInVector(c);delete this._priorityDirtyFlagMap[a];this._inDispatch||(b.clear(),delete this._listenersMap[a])}d=this._toAddedListeners;for(b=0;b<d.length;)(c=d[b])&&c._getListenerID()==a?cc.arrayRemoveObject(d,c):++b},_sortEventListeners:function(a){var b=this.DIRTY_NONE,c=this._priorityDirtyFlagMap;if(c[a]&&(b=c[a]),b!=this.DIRTY_NONE&&(c[a]=this.DIRTY_NONE,b&this.DIRTY_FIXED_PRIORITY&&this._sortListenersOfFixedPriority(a),
b&this.DIRTY_SCENE_GRAPH_PRIORITY))(b=cc.director.getRunningScene())?this._sortListenersOfSceneGraphPriority(a,b):c[a]=this.DIRTY_SCENE_GRAPH_PRIORITY},_sortListenersOfSceneGraphPriority:function(a,b){var c=this._getListeners(a);if(c){var d=c.getSceneGraphPriorityListeners();d&&0!==d.length&&(this._nodePriorityIndex=0,this._nodePriorityMap={},this._visitTarget(b,!0),c.getSceneGraphPriorityListeners().sort(this._sortEventListenersOfSceneGraphPriorityDes))}},_sortEventListenersOfSceneGraphPriorityDes:function(a,
b){var c=cc.eventManager._nodePriorityMap;return a&&b&&a._getSceneGraphPriority()&&b._getSceneGraphPriority()?c[b._getSceneGraphPriority().__instanceId]-c[a._getSceneGraphPriority().__instanceId]:-1},_sortListenersOfFixedPriority:function(a){if(a=this._listenersMap[a]){var b=a.getFixedPriorityListeners();if(b&&0!==b.length){b.sort(this._sortListenersOfFixedPriorityAsc);for(var c=0,d=b.length;d>c&&!(0<=b[c]._getFixedPriority());)++c;a.gt0Index=c}}},_sortListenersOfFixedPriorityAsc:function(a,b){return a._getFixedPriority()-
b._getFixedPriority()},_onUpdateListeners:function(a){if(a=this._listenersMap[a]){var b,c,d=a.getFixedPriorityListeners(),e=a.getSceneGraphPriorityListeners();if(e)for(b=0;b<e.length;)c=e[b],c._isRegistered()?++b:cc.arrayRemoveObject(e,c);if(d)for(b=0;b<d.length;)c=d[b],c._isRegistered()?++b:cc.arrayRemoveObject(d,c);e&&0===e.length&&a.clearSceneGraphListeners();d&&0===d.length&&a.clearFixedListeners()}},_updateListeners:function(a){var b=this._inDispatch;if(cc.assert(0<b,cc._LogInfos.EventManager__updateListeners),
a.getType()==cc.Event.TOUCH?(this._onUpdateListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),this._onUpdateListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID)):this._onUpdateListeners(cc.__getListenerID(a)),!(1<b)){cc.assert(1==b,cc._LogInfos.EventManager__updateListeners_2);a=this._listenersMap;var b=this._priorityDirtyFlagMap,c;for(c in a)a[c].empty()&&(delete b[c],delete a[c]);c=this._toAddedListeners;if(0!==c.length){a=0;for(b=c.length;b>a;a++)this._forceAddEventListener(c[a]);this._toAddedListeners.length=
0}}},_onTouchEventCallback:function(a,b){if(!a._isRegistered)return!1;var c=b.event,d=b.selTouch;c._setCurrentTarget(a._node);var e,f=!1,g=c.getEventCode(),h=cc.EventTouch.EventCode;return g==h.BEGAN?a.onTouchBegan&&(f=a.onTouchBegan(d,c),f&&a._registered&&a._claimedTouches.push(d)):0<a._claimedTouches.length&&-1!=(e=a._claimedTouches.indexOf(d))&&(f=!0,g===h.MOVED&&a.onTouchMoved?a.onTouchMoved(d,c):g===h.ENDED?(a.onTouchEnded&&a.onTouchEnded(d,c),a._registered&&a._claimedTouches.splice(e,1)):g===
h.CANCELLED&&(a.onTouchCancelled&&a.onTouchCancelled(d,c),a._registered&&a._claimedTouches.splice(e,1))),c.isStopped()?(cc.eventManager._updateListeners(c),!0):f&&a._registered&&a.swallowTouches?(b.needsMutableSet&&b.touches.splice(d,1),!0):!1},_dispatchTouchEvent:function(a){this._sortEventListeners(cc._EventListenerTouchOneByOne.LISTENER_ID);this._sortEventListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);var b=this._getListeners(cc._EventListenerTouchOneByOne.LISTENER_ID),c=this._getListeners(cc._EventListenerTouchAllAtOnce.LISTENER_ID);
if(null!=b||null!=c){var d=a.getTouches(),e=cc.copyArray(d),f={event:a,needsMutableSet:b&&c,touches:e,selTouch:null};if(b)for(var g=0;g<d.length;g++)if(f.selTouch=d[g],this._dispatchEventToListeners(b,this._onTouchEventCallback,f),a.isStopped())return;c&&0<e.length&&(this._dispatchEventToListeners(c,this._onTouchesEventCallback,{event:a,touches:e}),a.isStopped())||this._updateListeners(a)}},_onTouchesEventCallback:function(a,b){if(!a._registered)return!1;var c=cc.EventTouch.EventCode,d=b.event,e=
b.touches,f=d.getEventCode();return d._setCurrentTarget(a._node),f==c.BEGAN&&a.onTouchesBegan?a.onTouchesBegan(e,d):f==c.MOVED&&a.onTouchesMoved?a.onTouchesMoved(e,d):f==c.ENDED&&a.onTouchesEnded?a.onTouchesEnded(e,d):f==c.CANCELLED&&a.onTouchesCancelled&&a.onTouchesCancelled(e,d),d.isStopped()?(cc.eventManager._updateListeners(d),!0):!1},_associateNodeAndEventListener:function(a,b){var c=this._nodeListenersMap[a.__instanceId];c||(c=[],this._nodeListenersMap[a.__instanceId]=c);c.push(b)},_dissociateNodeAndEventListener:function(a,
b){var c=this._nodeListenersMap[a.__instanceId];c&&(cc.arrayRemoveObject(c,b),0===c.length&&delete this._nodeListenersMap[a.__instanceId])},_dispatchEventToListeners:function(a,b,c){var d,e=!1,f=a.getFixedPriorityListeners(),g=a.getSceneGraphPriorityListeners(),h=0;if(f&&0!==f.length)for(;h<a.gt0Index;++h)if(d=f[h],d.isEnabled()&&!d._isPaused()&&d._isRegistered()&&b(d,c)){e=!0;break}if(g&&!e)for(a=0;a<g.length;a++)if(d=g[a],d.isEnabled()&&!d._isPaused()&&d._isRegistered()&&b(d,c)){e=!0;break}if(f&&
!e)for(;h<f.length&&(d=f[h],!d.isEnabled()||d._isPaused()||!d._isRegistered()||!b(d,c));++h);},_setDirty:function(a,b){var c=this._priorityDirtyFlagMap;c[a]=null==c[a]?b:b|c[a]},_visitTarget:function(a,b){var c=a.getChildren(),d=0,e=c.length,f=this._globalZOrderNodeMap,g=this._nodeListenersMap;if(0<e){for(var h;e>d&&(h=c[d],h&&0>h.getLocalZOrder());d++)this._visitTarget(h,!1);for(null!=g[a.__instanceId]&&(f[a.getGlobalZOrder()]||(f[a.getGlobalZOrder()]=[]),f[a.getGlobalZOrder()].push(a.__instanceId));e>
d;d++)(h=c[d])&&this._visitTarget(h,!1)}else null!=g[a.__instanceId]&&(f[a.getGlobalZOrder()]||(f[a.getGlobalZOrder()]=[]),f[a.getGlobalZOrder()].push(a.__instanceId));if(b){var c=[],k;for(k in f)c.push(k);c.sort(this._sortNumberAsc);g=c.length;h=this._nodePriorityMap;for(d=0;g>d;d++)for(k=f[c[d]],e=0;e<k.length;e++)h[k[e]]=++this._nodePriorityIndex;this._globalZOrderNodeMap={}}},_sortNumberAsc:function(a,b){return a-b},addListener:function(a,b){if(cc.assert(a&&b,cc._LogInfos.eventManager_addListener_2),
a instanceof cc.EventListener){if(a._isRegistered())return void cc.log(cc._LogInfos.eventManager_addListener_4)}else cc.assert("number"!=typeof b,cc._LogInfos.eventManager_addListener_3),a=cc.EventListener.create(a);if(a.checkAvailable()){if("number"==typeof b){if(0==b)return void cc.log(cc._LogInfos.eventManager_addListener);a._setSceneGraphPriority(null);a._setFixedPriority(b);a._setRegistered(!0);a._setPaused(!1)}else a._setSceneGraphPriority(b),a._setFixedPriority(0),a._setRegistered(!0);this._addListener(a)}},
addCustomListener:function(a,b){var c=cc._EventListenerCustom.create(a,b);return this.addListener(c,1),c},removeListener:function(a){if(null!=a){var b,c=this._listenersMap,d;for(d in c){var e=c[d],f=e.getFixedPriorityListeners(),g=e.getSceneGraphPriorityListeners();if(b=this._removeListenerInVector(g,a),b?this._setDirty(a._getListenerID(),this.DIRTY_SCENE_GRAPH_PRIORITY):(b=this._removeListenerInVector(f,a),b&&this._setDirty(a._getListenerID(),this.DIRTY_FIXED_PRIORITY)),e.empty()&&(delete this._priorityDirtyFlagMap[a._getListenerID()],
delete c[d]),b)break}if(!b)for(b=this._toAddedListeners,c=0,d=b.length;d>c;c++)if(e=b[c],e==a){cc.arrayRemoveObject(b,e);break}}},_removeListenerInVector:function(a,b){if(null==a)return!1;for(var c=0,d=a.length;d>c;c++){var e=a[c];if(e==b)return e._setRegistered(!1),null!=e._getSceneGraphPriority()&&(this._dissociateNodeAndEventListener(e._getSceneGraphPriority(),e),e._setSceneGraphPriority(null)),0==this._inDispatch&&cc.arrayRemoveObject(a,e),!0}return!1},removeListeners:function(a,b){if(a instanceof
cc.Node){delete this._nodePriorityMap[a.__instanceId];cc.arrayRemoveObject(this._dirtyNodes,a);var c;if(c=this._nodeListenersMap[a.__instanceId]){var d=cc.copyArray(c);for(c=0;c<d.length;c++)this.removeListener(d[c]);d.length=0}d=this._toAddedListeners;for(c=0;c<d.length;){var e=d[c];e._getSceneGraphPriority()==a?(e._setSceneGraphPriority(null),e._setRegistered(!1),d.splice(c,1)):++c}if(!0===b)for(e=a.getChildren(),c=0,d=e.length;d>c;c++)this.removeListeners(e[c],!0)}else a==cc.EventListener.TOUCH_ONE_BY_ONE?
this._removeListenersForListenerID(cc._EventListenerTouchOneByOne.LISTENER_ID):a==cc.EventListener.TOUCH_ALL_AT_ONCE?this._removeListenersForListenerID(cc._EventListenerTouchAllAtOnce.LISTENER_ID):a==cc.EventListener.MOUSE?this._removeListenersForListenerID(cc._EventListenerMouse.LISTENER_ID):a==cc.EventListener.ACCELERATION?this._removeListenersForListenerID(cc._EventListenerAcceleration.LISTENER_ID):a==cc.EventListener.KEYBOARD?this._removeListenersForListenerID(cc._EventListenerKeyboard.LISTENER_ID):
cc.log(cc._LogInfos.eventManager_removeListeners)},removeCustomListeners:function(a){this._removeListenersForListenerID(a)},removeAllListeners:function(){var a=this._listenersMap,b=this._internalCustomListenerIDs,c;for(c in a)-1===b.indexOf(c)&&this._removeListenersForListenerID(c)},setPriority:function(a,b){if(null!=a){var c=this._listenersMap,d;for(d in c){var e=c[d].getFixedPriorityListeners();if(e&&-1!=e.indexOf(a))return null!=a._getSceneGraphPriority()&&cc.log(cc._LogInfos.eventManager_setPriority),
void(a._getFixedPriority()!==b&&(a._setFixedPriority(b),this._setDirty(a._getListenerID(),this.DIRTY_FIXED_PRIORITY)))}}},setEnabled:function(a){this._isEnabled=a},isEnabled:function(){return this._isEnabled},dispatchEvent:function(a){if(this._isEnabled){if(this._updateDirtyFlagForSceneGraph(),this._inDispatch++,!a||!a.getType)throw"event is undefined";if(a.getType()==cc.Event.TOUCH)return this._dispatchTouchEvent(a),void this._inDispatch--;var b=cc.__getListenerID(a);this._sortEventListeners(b);
b=this._listenersMap[b];null!=b&&this._dispatchEventToListeners(b,this._onListenerCallback,a);this._updateListeners(a);this._inDispatch--}},_onListenerCallback:function(a,b){return b._setCurrentTarget(a._getSceneGraphPriority()),a._onEvent(b),b.isStopped()},dispatchCustomEvent:function(a,b){var c=new cc.EventCustom(a);c.setUserData(b);this.dispatchEvent(c)}},cc._tmp.PrototypeCCNode=function(){var a=cc.Node.prototype;cc.defineGetterSetter(a,"x",a.getPositionX,a.setPositionX);cc.defineGetterSetter(a,
"y",a.getPositionY,a.setPositionY);a.width;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);a.height;cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight);a.anchorX;cc.defineGetterSetter(a,"anchorX",a._getAnchorX,a._setAnchorX);a.anchorY;cc.defineGetterSetter(a,"anchorY",a._getAnchorY,a._setAnchorY);a.skewX;cc.defineGetterSetter(a,"skewX",a.getSkewX,a.setSkewX);a.skewY;cc.defineGetterSetter(a,"skewY",a.getSkewY,a.setSkewY);a.zIndex;cc.defineGetterSetter(a,"zIndex",a.getLocalZOrder,a.setLocalZOrder);
a.vertexZ;cc.defineGetterSetter(a,"vertexZ",a.getVertexZ,a.setVertexZ);a.rotation;cc.defineGetterSetter(a,"rotation",a.getRotation,a.setRotation);a.rotationX;cc.defineGetterSetter(a,"rotationX",a.getRotationX,a.setRotationX);a.rotationY;cc.defineGetterSetter(a,"rotationY",a.getRotationY,a.setRotationY);a.scale;cc.defineGetterSetter(a,"scale",a.getScale,a.setScale);a.scaleX;cc.defineGetterSetter(a,"scaleX",a.getScaleX,a.setScaleX);a.scaleY;cc.defineGetterSetter(a,"scaleY",a.getScaleY,a.setScaleY);
a.children;cc.defineGetterSetter(a,"children",a.getChildren);a.childrenCount;cc.defineGetterSetter(a,"childrenCount",a.getChildrenCount);a.parent;cc.defineGetterSetter(a,"parent",a.getParent,a.setParent);a.visible;cc.defineGetterSetter(a,"visible",a.isVisible,a.setVisible);a.running;cc.defineGetterSetter(a,"running",a.isRunning);a.ignoreAnchor;cc.defineGetterSetter(a,"ignoreAnchor",a.isIgnoreAnchorPointForPosition,a.ignoreAnchorPointForPosition);a.tag;a.userData;a.userObject;a.arrivalOrder;a.actionManager;
cc.defineGetterSetter(a,"actionManager",a.getActionManager,a.setActionManager);a.scheduler;cc.defineGetterSetter(a,"scheduler",a.getScheduler,a.setScheduler);a.shaderProgram;cc.defineGetterSetter(a,"shaderProgram",a.getShaderProgram,a.setShaderProgram);a.opacity;cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.opacityModifyRGB;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB);a.cascadeOpacity;cc.defineGetterSetter(a,"cascadeOpacity",a.isCascadeOpacityEnabled,a.setCascadeOpacityEnabled);
a.color;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.cascadeColor;cc.defineGetterSetter(a,"cascadeColor",a.isCascadeColorEnabled,a.setCascadeColorEnabled)},cc.NODE_TAG_INVALID=-1,cc.s_globalOrderOfArrival=1,cc.Node=cc.Class.extend({_localZOrder:0,_globalZOrder:0,_vertexZ:0,_rotationX:0,_rotationY:0,_scaleX:1,_scaleY:1,_position:null,_skewX:0,_skewY:0,_children:null,_visible:!0,_anchorPoint:null,_anchorPointInPoints:null,_contentSize:null,_running:!1,_parent:null,_ignoreAnchorPointForPosition:!1,
tag:cc.NODE_TAG_INVALID,userData:null,userObject:null,_transformDirty:!0,_inverseDirty:!0,_cacheDirty:!0,_cachedParent:null,_transformGLDirty:null,_transform:null,_inverse:null,_reorderChildDirty:!1,_shaderProgram:null,arrivalOrder:0,_actionManager:null,_scheduler:null,_eventDispatcher:null,_initializedNode:!1,_additionalTransformDirty:!1,_additionalTransform:null,_componentContainer:null,_isTransitionFinished:!1,_rotationRadiansX:0,_rotationRadiansY:0,_className:"Node",_showNode:!1,_name:"",_displayedOpacity:255,
_realOpacity:255,_displayedColor:null,_realColor:null,_cascadeColorEnabled:!1,_cascadeOpacityEnabled:!1,_usingNormalizedPosition:!1,_hashOfName:0,_initNode:function(){this._anchorPoint=cc.p(0,0);this._anchorPointInPoints=cc.p(0,0);this._contentSize=cc.size(0,0);this._position=cc.p(0,0);this._children=[];this._transform={a:1,b:0,c:0,d:1,tx:0,ty:0};var a=cc.director;this._actionManager=a.getActionManager();this._scheduler=a.getScheduler();this._initializedNode=!0;this._additionalTransform=cc.affineTransformMakeIdentity();
cc.ComponentContainer&&(this._componentContainer=new cc.ComponentContainer(this));this._realOpacity=this._displayedOpacity=255;this._displayedColor=cc.color(255,255,255,255);this._realColor=cc.color(255,255,255,255);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!1},init:function(){return!1===this._initializedNode&&this._initNode(),!0},_arrayMakeObjectsPerformSelector:function(a,b){if(a&&0!==a.length){var c,d,e=a.length;c=cc.Node._StateCallbackType;switch(b){case c.onEnter:for(c=0;e>c;c++)(d=
a[c])&&d.onEnter();break;case c.onExit:for(c=0;e>c;c++)(d=a[c])&&d.onExit();break;case c.onEnterTransitionDidFinish:for(c=0;e>c;c++)(d=a[c])&&d.onEnterTransitionDidFinish();break;case c.cleanup:for(c=0;e>c;c++)(d=a[c])&&d.cleanup();break;case c.updateTransform:for(c=0;e>c;c++)(d=a[c])&&d.updateTransform();break;case c.onExitTransitionDidStart:for(c=0;e>c;c++)(d=a[c])&&d.onExitTransitionDidStart();break;case c.sortAllChildren:for(c=0;e>c;c++)(d=a[c])&&d.sortAllChildren();break;default:cc.assert(0,
cc._LogInfos.Node__arrayMakeObjectsPerformSelector)}}},setNodeDirty:null,attr:function(a){for(var b in a)this[b]=a[b]},getSkewX:function(){return this._skewX},setSkewX:function(a){this._skewX=a;this.setNodeDirty()},getSkewY:function(){return this._skewY},setSkewY:function(a){this._skewY=a;this.setNodeDirty()},setLocalZOrder:function(a){this._localZOrder=a;this._parent&&this._parent.reorderChild(this,a);cc.eventManager._setDirtyForNode(this)},_setLocalZOrder:function(a){this._localZOrder=a},getLocalZOrder:function(){return this._localZOrder},
getZOrder:function(){return cc.log(cc._LogInfos.Node_getZOrder),this.getLocalZOrder()},setZOrder:function(a){cc.log(cc._LogInfos.Node_setZOrder);this.setLocalZOrder(a)},setGlobalZOrder:function(a){this._globalZOrder!=a&&(this._globalZOrder=a,cc.eventManager._setDirtyForNode(this))},getGlobalZOrder:function(){return this._globalZOrder},getVertexZ:function(){return this._vertexZ},setVertexZ:function(a){this._vertexZ=a},getRotation:function(){return this._rotationX!==this._rotationY&&cc.log(cc._LogInfos.Node_getRotation),
this._rotationX},setRotation:function(a){this._rotationX=this._rotationY=a;this._rotationRadiansX=.017453292519943295*this._rotationX;this._rotationRadiansY=.017453292519943295*this._rotationY;this.setNodeDirty()},getRotationX:function(){return this._rotationX},setRotationX:function(a){this._rotationX=a;this._rotationRadiansX=.017453292519943295*this._rotationX;this.setNodeDirty()},getRotationY:function(){return this._rotationY},setRotationY:function(a){this._rotationY=a;this._rotationRadiansY=.017453292519943295*
this._rotationY;this.setNodeDirty()},getScale:function(){return this._scaleX!==this._scaleY&&cc.log(cc._LogInfos.Node_getScale),this._scaleX},setScale:function(a,b){this._scaleX=a;this._scaleY=b||0===b?b:a;this.setNodeDirty()},getScaleX:function(){return this._scaleX},setScaleX:function(a){this._scaleX=a;this.setNodeDirty()},getScaleY:function(){return this._scaleY},setScaleY:function(a){this._scaleY=a;this.setNodeDirty()},setPosition:function(a,b){var c=this._position;void 0===b?(c.x=a.x,c.y=a.y):
(c.x=a,c.y=b);this.setNodeDirty()},getPosition:function(){return cc.p(this._position)},getPositionX:function(){return this._position.x},setPositionX:function(a){this._position.x=a;this.setNodeDirty()},getPositionY:function(){return this._position.y},setPositionY:function(a){this._position.y=a;this.setNodeDirty()},getChildrenCount:function(){return this._children.length},getChildren:function(){return this._children},isVisible:function(){return this._visible},setVisible:function(a){this._visible!=a&&
(this._visible=a,a&&this.setNodeDirty())},getAnchorPoint:function(){return cc.p(this._anchorPoint)},setAnchorPoint:function(a,b){var c=this._anchorPoint;if(void 0===b){if(a.x===c.x&&a.y===c.y)return;c.x=a.x;c.y=a.y}else{if(a===c.x&&b===c.y)return;c.x=a;c.y=b}var d=this._anchorPointInPoints,e=this._contentSize;d.x=e.width*c.x;d.y=e.height*c.y;this.setNodeDirty()},_getAnchor:function(){return this._anchorPoint},_setAnchor:function(a){var b=a.x;a=a.y;this._anchorPoint.x!==b&&(this._anchorPoint.x=b,this._anchorPointInPoints.x=
this._contentSize.width*b);this._anchorPoint.y!==a&&(this._anchorPoint.y=a,this._anchorPointInPoints.y=this._contentSize.height*a);this.setNodeDirty()},_getAnchorX:function(){return this._anchorPoint.x},_setAnchorX:function(a){this._anchorPoint.x!==a&&(this._anchorPoint.x=a,this._anchorPointInPoints.x=this._contentSize.width*a,this.setNodeDirty())},_getAnchorY:function(){return this._anchorPoint.y},_setAnchorY:function(a){this._anchorPoint.y!==a&&(this._anchorPoint.y=a,this._anchorPointInPoints.y=
this._contentSize.height*a,this.setNodeDirty())},getAnchorPointInPoints:function(){return cc.p(this._anchorPointInPoints)},_getWidth:function(){return this._contentSize.width},_setWidth:function(a){this._contentSize.width=a;this._anchorPointInPoints.x=a*this._anchorPoint.x;this.setNodeDirty()},_getHeight:function(){return this._contentSize.height},_setHeight:function(a){this._contentSize.height=a;this._anchorPointInPoints.y=a*this._anchorPoint.y;this.setNodeDirty()},getContentSize:function(){return cc.size(this._contentSize)},
setContentSize:function(a,b){var c=this._contentSize;if(void 0===b){if(a.width===c.width&&a.height===c.height)return;c.width=a.width;c.height=a.height}else{if(a===c.width&&b===c.height)return;c.width=a;c.height=b}var d=this._anchorPointInPoints,e=this._anchorPoint;d.x=c.width*e.x;d.y=c.height*e.y;this.setNodeDirty()},isRunning:function(){return this._running},getParent:function(){return this._parent},setParent:function(a){this._parent=a},isIgnoreAnchorPointForPosition:function(){return this._ignoreAnchorPointForPosition},
ignoreAnchorPointForPosition:function(a){a!=this._ignoreAnchorPointForPosition&&(this._ignoreAnchorPointForPosition=a,this.setNodeDirty())},getTag:function(){return this.tag},setTag:function(a){this.tag=a},setName:function(a){this._name=a},getName:function(){return this._name},getUserData:function(){return this.userData},setUserData:function(a){this.userData=a},getUserObject:function(){return this.userObject},setUserObject:function(a){this.userObject!=a&&(this.userObject=a)},getOrderOfArrival:function(){return this.arrivalOrder},
setOrderOfArrival:function(a){0/0==this.arrivalOrder;this.arrivalOrder=a},getActionManager:function(){return this._actionManager||(this._actionManager=cc.director.getActionManager()),this._actionManager},setActionManager:function(a){this._actionManager!=a&&(this.stopAllActions(),this._actionManager=a)},getScheduler:function(){return this._scheduler||(this._scheduler=cc.director.getScheduler()),this._scheduler},setScheduler:function(a){this._scheduler!=a&&(this.unscheduleAllCallbacks(),this._scheduler=
a)},boundingBox:function(){return cc.log(cc._LogInfos.Node_boundingBox),this.getBoundingBox()},getBoundingBox:function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc._rectApplyAffineTransformIn(a,this.getNodeToParentTransform())},cleanup:function(){this.stopAllActions();this.unscheduleAllCallbacks();cc.eventManager.removeListeners(this);this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.cleanup)},getChildByTag:function(a){var b=this._children;
if(null!=b)for(var c=0;c<b.length;c++){var d=b[c];if(d&&d.tag==a)return d}return null},getChildByName:function(a){if(!a)return cc.log("Invalid name"),null;for(var b=this._children,c=0,d=b.length;d>c;c++)if(b[c]._name==a)return b[c];return null},addChild:function(a,b,c){var d;b=void 0===b?a._localZOrder:b;var e=!1;switch(typeof c){case "undefined":c=void 0;d=a._name;break;case "string":d=c;c=void 0;break;case "number":e=!0,d=""}cc.assert(a,cc._LogInfos.Node_addChild_3);cc.assert(null===a._parent,"child already added. It can't be added again");
this._addChildHelper(a,b,c,d,e)},_addChildHelper:function(a,b,c,d,e){this._children||(this._children=[]);this._insertChild(a,b);e?a.setTag(c):a.setName(d);a.setParent(this);a.setOrderOfArrival(cc.s_globalOrderOfArrival++);this._running&&(a.onEnter(),this._isTransitionFinished&&a.onEnterTransitionDidFinish());this._cascadeColorEnabled&&this._enableCascadeColor();this._cascadeOpacityEnabled&&this._enableCascadeOpacity()},removeFromParent:function(a){this._parent&&(null==a&&(a=!0),this._parent.removeChild(this,
a))},removeFromParentAndCleanup:function(a){cc.log(cc._LogInfos.Node_removeFromParentAndCleanup);this.removeFromParent(a)},removeChild:function(a,b){0!==this._children.length&&(null==b&&(b=!0),-1<this._children.indexOf(a)&&this._detachChild(a,b),this.setNodeDirty())},removeChildByTag:function(a,b){a===cc.NODE_TAG_INVALID&&cc.log(cc._LogInfos.Node_removeChildByTag);var c=this.getChildByTag(a);null==c?cc.log(cc._LogInfos.Node_removeChildByTag_2,a):this.removeChild(c,b)},removeAllChildrenWithCleanup:function(a){cc.log(cc._LogInfos.Node_removeAllChildrenWithCleanup);
this.removeAllChildren(a)},removeAllChildren:function(a){var b=this._children;if(null!=b){null==a&&(a=!0);for(var c=0;c<b.length;c++){var d=b[c];d&&(this._running&&(d.onExitTransitionDidStart(),d.onExit()),a&&d.cleanup(),d.parent=null)}this._children.length=0}},_detachChild:function(a,b){this._running&&(a.onExitTransitionDidStart(),a.onExit());b&&a.cleanup();a.parent=null;cc.arrayRemoveObject(this._children,a)},_insertChild:function(a,b){this._reorderChildDirty=!0;this._children.push(a);a._setLocalZOrder(b)},
reorderChild:function(a,b){cc.assert(a,cc._LogInfos.Node_reorderChild);this._reorderChildDirty=!0;a.arrivalOrder=cc.s_globalOrderOfArrival;cc.s_globalOrderOfArrival++;a._setLocalZOrder(b);this.setNodeDirty()},sortAllChildren:function(){if(this._reorderChildDirty){var a,b,c,d=this._children,e=d.length;for(a=1;e>a;a++){c=d[a];for(b=a-1;0<=b&&(c._localZOrder<d[b]._localZOrder||c._localZOrder===d[b]._localZOrder&&c.arrivalOrder<d[b].arrivalOrder);)d[b+1]=d[b],b--;d[b+1]=c}this._reorderChildDirty=!1}},
draw:function(){},transformAncestors:function(){null!=this._parent&&(this._parent.transformAncestors(),this._parent.transform())},onEnter:function(){this._isTransitionFinished=!1;this._running=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.onEnter);this.resume()},onEnterTransitionDidFinish:function(){this._isTransitionFinished=!0;this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.onEnterTransitionDidFinish)},onExitTransitionDidStart:function(){this._arrayMakeObjectsPerformSelector(this._children,
cc.Node._StateCallbackType.onExitTransitionDidStart)},onExit:function(){this._running=!1;this.pause();this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.onExit)},runAction:function(a){return cc.assert(a,cc._LogInfos.Node_runAction),this.actionManager.addAction(a,this,!this._running),a},stopAllActions:function(){this.actionManager&&this.actionManager.removeAllActionsFromTarget(this)},stopAction:function(a){this.actionManager.removeAction(a)},stopActionByTag:function(a){return a===
cc.ACTION_TAG_INVALID?void cc.log(cc._LogInfos.Node_stopActionByTag):void this.actionManager.removeActionByTag(a,this)},getActionByTag:function(a){return a===cc.ACTION_TAG_INVALID?(cc.log(cc._LogInfos.Node_getActionByTag),null):this.actionManager.getActionByTag(a,this)},getNumberOfRunningActions:function(){return this.actionManager.numberOfRunningActionsInTarget(this)},scheduleUpdate:function(){this.scheduleUpdateWithPriority(0)},scheduleUpdateWithPriority:function(a){this.scheduler.scheduleUpdateForTarget(this,
a,!this._running)},unscheduleUpdate:function(){this.scheduler.unscheduleUpdateForTarget(this)},schedule:function(a,b,c,d){b=b||0;cc.assert(a,cc._LogInfos.Node_schedule);cc.assert(0<=b,cc._LogInfos.Node_schedule_2);c=null==c?cc.REPEAT_FOREVER:c;this.scheduler.scheduleCallbackForTarget(this,a,b,c,d||0,!this._running)},scheduleOnce:function(a,b){this.schedule(a,0,0,b)},unschedule:function(a){a&&this.scheduler.unscheduleCallbackForTarget(this,a)},unscheduleAllCallbacks:function(){this.scheduler.unscheduleAllCallbacksForTarget(this)},
resumeSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_resumeSchedulerAndActions);this.resume()},resume:function(){this.scheduler.resumeTarget(this);this.actionManager&&this.actionManager.resumeTarget(this);cc.eventManager.resumeTarget(this)},pauseSchedulerAndActions:function(){cc.log(cc._LogInfos.Node_pauseSchedulerAndActions);this.pause()},pause:function(){this.scheduler.pauseTarget(this);this.actionManager&&this.actionManager.pauseTarget(this);cc.eventManager.pauseTarget(this)},setAdditionalTransform:function(a){this._additionalTransform=
a;this._additionalTransformDirty=this._transformDirty=!0},getParentToNodeTransform:function(){return this._inverseDirty&&(this._inverse=cc.affineTransformInvert(this.getNodeToParentTransform()),this._inverseDirty=!1),this._inverse},parentToNodeTransform:function(){return this.getParentToNodeTransform()},getNodeToWorldTransform:function(){for(var a=this.getNodeToParentTransform(),b=this._parent;null!=b;b=b.parent)a=cc.affineTransformConcat(a,b.getNodeToParentTransform());return a},nodeToWorldTransform:function(){return this.getNodeToWorldTransform()},
getWorldToNodeTransform:function(){return cc.affineTransformInvert(this.getNodeToWorldTransform())},worldToNodeTransform:function(){return this.getWorldToNodeTransform()},convertToNodeSpace:function(a){return cc.pointApplyAffineTransform(a,this.getWorldToNodeTransform())},convertToWorldSpace:function(a){return a=a||cc.p(0,0),cc.pointApplyAffineTransform(a,this.getNodeToWorldTransform())},convertToNodeSpaceAR:function(a){return cc.pSub(this.convertToNodeSpace(a),this._anchorPointInPoints)},convertToWorldSpaceAR:function(a){a=
a||cc.p(0,0);a=cc.pAdd(a,this._anchorPointInPoints);return this.convertToWorldSpace(a)},_convertToWindowSpace:function(a){a=this.convertToWorldSpace(a);return cc.director.convertToUI(a)},convertTouchToNodeSpace:function(a){a=a.getLocation();return this.convertToNodeSpace(a)},convertTouchToNodeSpaceAR:function(a){a=a.getLocation();return a=cc.director.convertToGL(a),this.convertToNodeSpaceAR(a)},update:function(a){this._componentContainer&&!this._componentContainer.isEmpty()&&this._componentContainer.visit(a)},
updateTransform:function(){this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.updateTransform)},retain:function(){},release:function(){},getComponent:function(a){return this._componentContainer.getComponent(a)},addComponent:function(a){this._componentContainer.add(a)},removeComponent:function(a){return this._componentContainer.remove(a)},removeAllComponents:function(){this._componentContainer.removeAll()},grid:null,ctor:null,visit:null,transform:null,nodeToParentTransform:function(){return this.getNodeToParentTransform()},
getNodeToParentTransform:null,_setNodeDirtyForCache:function(){if(!1===this._cacheDirty){this._cacheDirty=!0;var a=this._cachedParent;a&&a!=this&&a._setNodeDirtyForCache()}},_setCachedParent:function(a){if(this._cachedParent!=a){this._cachedParent=a;for(var b=this._children,c=0,d=b.length;d>c;c++)b[c]._setCachedParent(a)}},getCamera:function(){return this._camera||(this._camera=new cc.Camera),this._camera},getGrid:function(){return this.grid},setGrid:function(a){this.grid=a},getShaderProgram:function(){return this._shaderProgram},
setShaderProgram:function(a){this._shaderProgram=a},getGLServerState:function(){return this._glServerState},setGLServerState:function(a){this._glServerState=a},getBoundingBoxToWorld:function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height),b=this.getNodeToWorldTransform();if(a=cc.rectApplyAffineTransform(a,this.getNodeToWorldTransform()),!this._children)return a;for(var c=this._children,d=0;d<c.length;d++){var e=c[d];e&&e._visible&&(e=e._getBoundingBoxToCurrentNode(b))&&(a=cc.rectUnion(a,
e))}return a},_getBoundingBoxToCurrentNode:function(a){var b=cc.rect(0,0,this._contentSize.width,this._contentSize.height);a=null==a?this.getNodeToParentTransform():cc.affineTransformConcat(this.getNodeToParentTransform(),a);if(b=cc.rectApplyAffineTransform(b,a),!this._children)return b;for(var c=this._children,d=0;d<c.length;d++){var e=c[d];e&&e._visible&&(e=e._getBoundingBoxToCurrentNode(a))&&(b=cc.rectUnion(b,e))}return b},_getNodeToParentTransformForWebGL:function(){if(this._transformDirty){var a=
this._position.x,b=this._position.y,c=this._anchorPointInPoints.x,d=-c,e=this._anchorPointInPoints.y,f=-e,g=this._scaleX,h=this._scaleY;this._ignoreAnchorPointForPosition&&(a+=c,b+=e);var k=1,m=0,n=1,q=0;(0!==this._rotationX||0!==this._rotationY)&&(k=Math.cos(-this._rotationRadiansX),m=Math.sin(-this._rotationRadiansX),n=Math.cos(-this._rotationRadiansY),q=Math.sin(-this._rotationRadiansY));var r=this._skewX||this._skewY;r||0===c&&0===e||(a+=n*d*g+-m*f*h,b+=q*d*g+k*f*h);var s=this._transform;s.a=
n*g;s.b=q*g;s.c=-m*h;s.d=k*h;s.tx=a;s.ty=b;r&&(s=cc.affineTransformConcat({a:1,b:Math.tan(cc.degreesToRadians(this._skewY)),c:Math.tan(cc.degreesToRadians(this._skewX)),d:1,tx:0,ty:0},s),(0!==c||0!==e)&&(s=cc.affineTransformTranslate(s,d,f)));this._additionalTransformDirty&&(s=cc.affineTransformConcat(s,this._additionalTransform),this._additionalTransformDirty=!1);this._transform=s;this._transformDirty=!1}return this._transform},_updateColor:function(){},getOpacity:function(){return this._realOpacity},
getDisplayedOpacity:function(){return this._displayedOpacity},setOpacity:function(a){this._displayedOpacity=this._realOpacity=a;var b=255,c=this._parent;c&&c.cascadeOpacity&&(b=c.getDisplayedOpacity());this.updateDisplayedOpacity(b);this._displayedColor.a=this._realColor.a=a},updateDisplayedOpacity:function(a){if(this._displayedOpacity=this._realOpacity*a/255,this._cascadeOpacityEnabled){a=this._children;for(var b=0;b<a.length;b++){var c=a[b];c&&c.updateDisplayedOpacity(this._displayedOpacity)}}},
isCascadeOpacityEnabled:function(){return this._cascadeOpacityEnabled},setCascadeOpacityEnabled:function(a){this._cascadeOpacityEnabled!==a&&(this._cascadeOpacityEnabled=a,a?this._enableCascadeOpacity():this._disableCascadeOpacity())},_enableCascadeOpacity:function(){var a=255,b=this._parent;b&&b.cascadeOpacity&&(a=b.getDisplayedOpacity());this.updateDisplayedOpacity(a)},_disableCascadeOpacity:function(){this._displayedOpacity=this._realOpacity;for(var a=this._children,b=0;b<a.length;b++){var c=a[b];
c&&c.updateDisplayedOpacity(255)}},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a)},getDisplayedColor:function(){var a=this._displayedColor;return cc.color(a.r,a.g,a.b,a.a)},setColor:function(a){var b=this._displayedColor,c=this._realColor;b.r=c.r=a.r;b.g=c.g=a.g;b.b=c.b=a.b;a=(a=this._parent)&&a.cascadeColor?a.getDisplayedColor():cc.color.WHITE;this.updateDisplayedColor(a)},updateDisplayedColor:function(a){var b=this._displayedColor,c=this._realColor;if(b.r=0|c.r*a.r/255,
b.g=0|c.g*a.g/255,b.b=0|c.b*a.b/255,this._cascadeColorEnabled)for(a=this._children,c=0;c<a.length;c++){var d=a[c];d&&d.updateDisplayedColor(b)}},isCascadeColorEnabled:function(){return this._cascadeColorEnabled},setCascadeColorEnabled:function(a){this._cascadeColorEnabled!==a&&(this._cascadeColorEnabled=a,this._cascadeColorEnabled?this._enableCascadeColor():this._disableCascadeColor())},_enableCascadeColor:function(){var a;a=(a=this._parent)&&a.cascadeColor?a.getDisplayedColor():cc.color.WHITE;this.updateDisplayedColor(a)},
_disableCascadeColor:function(){var a=this._displayedColor,b=this._realColor;a.r=b.r;a.g=b.g;a.b=b.b;for(var a=this._children,b=cc.color.WHITE,c=0;c<a.length;c++){var d=a[c];d&&d.updateDisplayedColor(b)}},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1}}),cc.Node.create=function(){return new cc.Node},cc.Node._StateCallbackType={onEnter:1,onExit:2,cleanup:3,onEnterTransitionDidFinish:4,updateTransform:5,onExitTransitionDidStart:6,sortAllChildren:7},cc._renderType===cc._RENDER_TYPE_CANVAS){var _p=
cc.Node.prototype;_p.ctor=function(){this._initNode()};_p.setNodeDirty=function(){this._setNodeDirtyForCache();!1===this._transformDirty&&(this._transformDirty=this._inverseDirty=!0)};_p.visit=function(a){if(this._visible){var b,c=a||cc._renderContext,d=this._children;c.save();this.transform(c);var e=d.length;if(0<e){this.sortAllChildren();for(a=0;e>a&&(b=d[a],0>b._localZOrder);a++)b.visit(c);for(this.draw(c);e>a;a++)d[a].visit(c)}else this.draw(c);this._cacheDirty=!1;this.arrivalOrder=0;c.restore()}};
_p.transform=function(a){a=a||cc._renderContext;var b=cc.view,c=this.getNodeToParentTransform();a.transform(c.a,c.c,c.b,c.d,c.tx*b.getScaleX(),-c.ty*b.getScaleY())};_p.getNodeToParentTransform=function(){if(this._transformDirty){var a=this._transform;a.tx=this._position.x;a.ty=this._position.y;var b=1,c=0;this._rotationX&&(b=Math.cos(this._rotationRadiansX),c=Math.sin(this._rotationRadiansX));a.a=a.d=b;a.b=-c;a.c=c;var d=this._scaleX,e=this._scaleY,f=this._anchorPointInPoints.x,g=this._anchorPointInPoints.y,
h=1E-6>d&&-1E-6<d?1E-6:d,k=1E-6>e&&-1E-6<e?1E-6:e;if(this._skewX||this._skewY){var m=Math.tan(-this._skewX*Math.PI/180),n=Math.tan(-this._skewY*Math.PI/180);1/0===m&&(m=99999999);1/0===n&&(n=99999999);var q=g*m*h,r=f*n*k;a.a=b+-c*n;a.b=b*m+-c;a.c=c+b*n;a.d=c*m+b;a.tx+=b*q+-c*r;a.ty+=c*q+b*r}(1!==d||1!==e)&&(a.a*=h,a.c*=h,a.b*=k,a.d*=k);a.tx+=b*-f*h+-c*g*k;a.ty-=c*-f*h+b*g*k;this._ignoreAnchorPointForPosition&&(a.tx+=f,a.ty+=g);this._additionalTransformDirty&&(this._transform=cc.affineTransformConcat(a,
this._additionalTransform),this._additionalTransformDirty=!1);this._transformDirty=!1}return this._transform};_p=null}else cc.assert("function"==typeof cc._tmp.WebGLCCNode,cc._LogInfos.MissingFile,"BaseNodesWebGL.js"),cc._tmp.WebGLCCNode(),delete cc._tmp.WebGLCCNode;
(cc.assert("function"==typeof cc._tmp.PrototypeCCNode,cc._LogInfos.MissingFile,"BaseNodesPropertyDefine.js"),cc._tmp.PrototypeCCNode(),delete cc._tmp.PrototypeCCNode,cc._tmp.PrototypeTexture2D=function(){var a=cc.Texture2D;a.PVRImagesHavePremultipliedAlpha=function(a){cc.PVRHaveAlphaPremultiplied_=a};a.PIXEL_FORMAT_RGBA8888=2;a.PIXEL_FORMAT_RGB888=3;a.PIXEL_FORMAT_RGB565=4;a.PIXEL_FORMAT_A8=5;a.PIXEL_FORMAT_I8=6;a.PIXEL_FORMAT_AI88=7;a.PIXEL_FORMAT_RGBA4444=8;a.PIXEL_FORMAT_RGB5A1=7;a.PIXEL_FORMAT_PVRTC4=
9;a.PIXEL_FORMAT_PVRTC2=10;a.PIXEL_FORMAT_DEFAULT=a.PIXEL_FORMAT_RGBA8888;var b=cc.Texture2D._M={};b[a.PIXEL_FORMAT_RGBA8888]="RGBA8888";b[a.PIXEL_FORMAT_RGB888]="RGB888";b[a.PIXEL_FORMAT_RGB565]="RGB565";b[a.PIXEL_FORMAT_A8]="A8";b[a.PIXEL_FORMAT_I8]="I8";b[a.PIXEL_FORMAT_AI88]="AI88";b[a.PIXEL_FORMAT_RGBA4444]="RGBA4444";b[a.PIXEL_FORMAT_RGB5A1]="RGB5A1";b[a.PIXEL_FORMAT_PVRTC4]="PVRTC4";b[a.PIXEL_FORMAT_PVRTC2]="PVRTC2";b=cc.Texture2D._B={};b[a.PIXEL_FORMAT_RGBA8888]=32;b[a.PIXEL_FORMAT_RGB888]=
24;b[a.PIXEL_FORMAT_RGB565]=16;b[a.PIXEL_FORMAT_A8]=8;b[a.PIXEL_FORMAT_I8]=8;b[a.PIXEL_FORMAT_AI88]=16;b[a.PIXEL_FORMAT_RGBA4444]=16;b[a.PIXEL_FORMAT_RGB5A1]=16;b[a.PIXEL_FORMAT_PVRTC4]=4;b[a.PIXEL_FORMAT_PVRTC2]=3;b=cc.Texture2D.prototype;b.name;cc.defineGetterSetter(b,"name",b.getName);b.pixelFormat;cc.defineGetterSetter(b,"pixelFormat",b.getPixelFormat);b.pixelsWidth;cc.defineGetterSetter(b,"pixelsWidth",b.getPixelsWide);b.pixelsHeight;cc.defineGetterSetter(b,"pixelsHeight",b.getPixelsHigh);b.width;
cc.defineGetterSetter(b,"width",b._getWidth);b.height;cc.defineGetterSetter(b,"height",b._getHeight);a.defaultPixelFormat=a.PIXEL_FORMAT_DEFAULT},cc._tmp.PrototypeTextureAtlas=function(){var a=cc.TextureAtlas.prototype;a.totalQuads;cc.defineGetterSetter(a,"totalQuads",a.getTotalQuads);a.capacity;cc.defineGetterSetter(a,"capacity",a.getCapacity);a.quads;cc.defineGetterSetter(a,"quads",a.getQuads,a.setQuads)},cc.ALIGN_CENTER=51,cc.ALIGN_TOP=19,cc.ALIGN_TOP_RIGHT=18,cc.ALIGN_RIGHT=50,cc.ALIGN_BOTTOM_RIGHT=
34,cc.ALIGN_BOTTOM=35,cc.ALIGN_BOTTOM_LEFT=33,cc.ALIGN_LEFT=49,cc.ALIGN_TOP_LEFT=17,cc.PVRHaveAlphaPremultiplied_=!1,cc._renderType===cc._RENDER_TYPE_CANVAS?cc.Texture2D=cc.Class.extend({_contentSize:null,_isLoaded:!1,_htmlElementObj:null,_loadedEventListeners:null,url:null,ctor:function(){this._contentSize=cc.size(0,0);this._isLoaded=!1;this._htmlElementObj=null},getPixelsWide:function(){return this._contentSize.width},getPixelsHigh:function(){return this._contentSize.height},getContentSize:function(){var a=
cc.contentScaleFactor();return cc.size(this._contentSize.width/a,this._contentSize.height/a)},_getWidth:function(){return this._contentSize.width/cc.contentScaleFactor()},_getHeight:function(){return this._contentSize.height/cc.contentScaleFactor()},getContentSizeInPixels:function(){return this._contentSize},initWithElement:function(a){a&&(this._htmlElementObj=a)},getHtmlElementObj:function(){return this._htmlElementObj},isLoaded:function(){return this._isLoaded},handleLoadedTexture:function(){if(!this._isLoaded){if(!this._htmlElementObj){var a=
cc.loader.getRes(this.url);if(!a)return;this.initWithElement(a)}this._isLoaded=!0;a=this._htmlElementObj;this._contentSize.width=a.width;this._contentSize.height=a.height;this._callLoadedEventCallbacks()}},description:function(){return"<cc.Texture2D | width = "+this._contentSize.width+" height "+this._contentSize.height+">"},initWithData:function(){return!1},initWithImage:function(){return!1},initWithString:function(){return!1},releaseTexture:function(){},getName:function(){return null},getMaxS:function(){return 1},
setMaxS:function(){},getMaxT:function(){return 1},setMaxT:function(){},getPixelFormat:function(){return null},getShaderProgram:function(){return null},setShaderProgram:function(){},hasPremultipliedAlpha:function(){return!1},hasMipmaps:function(){return!1},releaseData:function(a){},keepData:function(a){return a},drawAtPoint:function(){},drawInRect:function(){},initWithETCFile:function(){return cc.log(cc._LogInfos.Texture2D_initWithETCFile),!1},initWithPVRFile:function(){return cc.log(cc._LogInfos.Texture2D_initWithPVRFile),
!1},initWithPVRTCData:function(){return cc.log(cc._LogInfos.Texture2D_initWithPVRTCData),!1},setTexParameters:function(){},setAntiAliasTexParameters:function(){},setAliasTexParameters:function(){},generateMipmap:function(){},stringForFormat:function(){return""},bitsPerPixelForFormat:function(){return-1},addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},removeLoadedEventListener:function(a){if(this._loadedEventListeners)for(var b=
this._loadedEventListeners,c=0;c<b.length;c++)b[c].eventTarget==a&&b.splice(c,1)},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}}}):(cc.assert("function"==typeof cc._tmp.WebGLTexture2D,cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTexture2D(),delete cc._tmp.WebGLTexture2D),cc.assert("function"==typeof cc._tmp.PrototypeTexture2D,cc._LogInfos.MissingFile,
"TexturesPropertyDefine.js"),cc._tmp.PrototypeTexture2D(),delete cc._tmp.PrototypeTexture2D,cc.textureCache={_textures:{},_textureColorsCache:{},_textureKeySeq:0|1E3*Math.random(),_loadedTexturesBefore:{},_initializingRenderer:function(){var a,b=this._loadedTexturesBefore,c=this._textures;for(a in b){var d=b[a];d.handleLoadedTexture();c[a]=d}this._loadedTexturesBefore={}},addPVRTCImage:function(){cc.log(cc._LogInfos.textureCache_addPVRTCImage)},addETCImage:function(){cc.log(cc._LogInfos.textureCache_addETCImage)},
description:function(){return"<TextureCache | Number of textures = "+this._textures.length+">"},textureForKey:function(a){return cc.log(cc._LogInfos.textureCache_textureForKey),this.getTextureForKey(a)},getTextureForKey:function(a){return this._textures[a]||this._textures[cc.loader._aliases[a]]},getKeyByTexture:function(a){for(var b in this._textures)if(this._textures[b]==a)return b;return null},_generalTextureKey:function(){return this._textureKeySeq++,"_textureKey_"+this._textureKeySeq},getTextureColors:function(a){var b=
this.getKeyByTexture(a);return b||(b=a instanceof HTMLImageElement?a.src:this._generalTextureKey()),this._textureColorsCache[b]||(this._textureColorsCache[b]=cc.generateTextureCacheForColor(a)),this._textureColorsCache[b]},addPVRImage:function(){cc.log(cc._LogInfos.textureCache_addPVRImage)},removeAllTextures:function(){var a=this._textures,b;for(b in a)a[b]&&a[b].releaseTexture();this._textures={}},removeTexture:function(a){if(a){var b=this._textures,c;for(c in b)b[c]==a&&(b[c].releaseTexture(),
delete b[c])}},removeTextureForKey:function(a){null!=a&&this._textures[a]&&delete this._textures[a]},cacheImage:function(a,b){if(b instanceof cc.Texture2D)return void(this._textures[a]=b);var c=new cc.Texture2D;c.initWithElement(b);c.handleLoadedTexture();this._textures[a]=c},addUIImage:function(a,b){if(cc.assert(a,cc._LogInfos.textureCache_addUIImage_2),b&&this._textures[b])return this._textures[b];var c=new cc.Texture2D;return c.initWithImage(a),null!=b&&null!=c?this._textures[b]=c:cc.log(cc._LogInfos.textureCache_addUIImage),
c},dumpCachedTextureInfo:function(){var a=0,b=0,c=this._textures,d;for(d in c){var e=c[d];a++;e.getHtmlElementObj()instanceof HTMLImageElement?cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo,d,e.getHtmlElementObj().src,e.pixelsWidth,e.pixelsHeight):cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,d,e.pixelsWidth,e.pixelsHeight);b+=e.pixelsWidth*e.pixelsHeight*4}c=this._textureColorsCache;for(d in c){var e=c[d],f;for(f in e){var g=e[f];a++;cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_2,
d,g.width,g.height);b+=g.width*g.height*4}}cc.log(cc._LogInfos.textureCache_dumpCachedTextureInfo_3,a,b/1024,(b/1048576).toFixed(2))},_clear:function(){this._textures={};this._textureColorsCache={};this._textureKeySeq=0|1E3*Math.random();this._loadedTexturesBefore={}}},cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.textureCache,_p.handleLoadedTexture=function(a){var b=this._textures,c=b[a];c||(c=b[a]=new cc.Texture2D,c.url=a);c.handleLoadedTexture()},_p.addImage=function(a,b,c){cc.assert(a,cc._LogInfos.Texture2D_addImage);
var d=this._textures,e=d[a]||d[cc.loader._aliases[a]];return e?(b&&b.call(c),e):(e=d[a]=new cc.Texture2D,e.url=a,cc.loader.getRes(a)?e.handleLoadedTexture():cc.loader._checkIsImageURL(a)?cc.loader.load(a,function(){b&&b.call(c)}):cc.loader.cache[a]=cc.loader.loadImg(a,function(d,e){return d?b?b(d):d:(cc.textureCache.handleLoadedTexture(a),void(b&&b(c,e)))}),e)},_p=null):(cc.assert("function"==typeof cc._tmp.WebGLTextureCache,cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureCache(),
delete cc._tmp.WebGLTextureCache);
if(cc.Scene=cc.Node.extend({_className:"Scene",ctor:function(){cc.Node.prototype.ctor.call(this);this._ignoreAnchorPointForPosition=!0;this.setAnchorPoint(.5,.5);this.setContentSize(cc.director.getWinSize())}}),cc.Scene.create=function(){return new cc.Scene},cc.LoaderScene=cc.Scene.extend({_interval:null,_label:null,_className:"LoaderScene",init:function(){var a=this,b=200,c=a._bgLayer=new cc.LayerColor(cc.color(32,32,32,255));c.setPosition(cc.visibleRect.bottomLeft);a.addChild(c,0);var d=24,e=-b/
2+100;cc._loaderImage&&(cc.loader.loadImg(cc._loaderImage,{isCrossOrigin:!1},function(c,d){b=d.height;a._initStage(d,cc.visibleRect.center)}),d=14,e=-b/2-10);d=a._label=cc.LabelTTF.create("Loading... 0%","Arial",d);return d.setPosition(cc.pAdd(cc.visibleRect.center,cc.p(0,e))),d.setColor(cc.color(180,180,180)),c.addChild(this._label,10),!0},_initStage:function(a,b){var c=this._texture2d=new cc.Texture2D;c.initWithElement(a);c.handleLoadedTexture();c=this._logo=cc.Sprite.create(c);c.setScale(cc.contentScaleFactor());
c.x=b.x;c.y=b.y;this._bgLayer.addChild(c,10)},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.schedule(this._startLoading,.3)},onExit:function(){cc.Node.prototype.onExit.call(this);this._label.setString("Loading... 0%")},initWithResources:function(a,b){"string"==typeof a&&(a=[a]);this.resources=a||[];this.cb=b},_startLoading:function(){var a=this;a.unschedule(a._startLoading);cc.loader.load(a.resources,function(b,c,d){b=Math.min(d/c*100|0,100);a._label.setString("Loading... "+b+"%")},
function(){a.cb&&a.cb()})}}),cc.LoaderScene.preload=function(a,b){var c=cc;return c.loaderScene||(c.loaderScene=new cc.LoaderScene,c.loaderScene.init()),c.loaderScene.initWithResources(a,b),cc.director.runScene(c.loaderScene),c.loaderScene},cc._tmp.PrototypeLayerColor=function(){var a=cc.LayerColor.prototype;cc.defineGetterSetter(a,"width",a._getWidth,a._setWidth);cc.defineGetterSetter(a,"height",a._getHeight,a._setHeight)},cc._tmp.PrototypeLayerGradient=function(){var a=cc.LayerGradient.prototype;
a.startColor;cc.defineGetterSetter(a,"startColor",a.getStartColor,a.setStartColor);a.endColor;cc.defineGetterSetter(a,"endColor",a.getEndColor,a.setEndColor);a.startOpacity;cc.defineGetterSetter(a,"startOpacity",a.getStartOpacity,a.setStartOpacity);a.endOpacity;cc.defineGetterSetter(a,"endOpacity",a.getEndOpacity,a.setEndOpacity);a.vector;cc.defineGetterSetter(a,"vector",a.getVector,a.setVector)},cc.Layer=cc.Node.extend({_isBaked:!1,_bakeSprite:null,_className:"Layer",ctor:function(){var a=cc.Node.prototype;
a.ctor.call(this);this._ignoreAnchorPointForPosition=!0;a.setAnchorPoint.call(this,.5,.5);a.setContentSize.call(this,cc.winSize)},init:function(){return this._ignoreAnchorPointForPosition=!0,this.setAnchorPoint(.5,.5),this.setContentSize(cc.winSize),this.cascadeOpacity=!1,this.cascadeColor=!1,!0},bake:null,unbake:null,isBaked:function(){return this._isBaked},visit:null}),cc.Layer.create=function(){return new cc.Layer},cc._renderType===cc._RENDER_TYPE_CANVAS){var p=cc.Layer.prototype;p.bake=function(){if(!this._isBaked){this._isBaked=
this._cacheDirty=!0;this._cachedParent=this;for(var a=this._children,b=0,c=a.length;c>b;b++)a[b]._setCachedParent(this);this._bakeSprite||(this._bakeSprite=new cc.BakeSprite)}};p.unbake=function(){if(this._isBaked){this._isBaked=!1;this._cacheDirty=!0;this._cachedParent=null;for(var a=this._children,b=0,c=a.length;c>b;b++)a[b]._setCachedParent(null)}};p.visit=function(a){if(!this._isBaked)return void cc.Node.prototype.visit.call(this,a);var b;a=a||cc._renderContext;var c=this._children,d=c.length;
if(this._visible&&0!==d){var e=this._bakeSprite;if(a.save(),this.transform(a),this._cacheDirty){b=this._getBoundingBoxForBake();b.width|=0;b.height|=0;var f=e.getCacheContext();e.resetCanvasSize(b.width,b.height);f.translate(0-b.x,b.height+b.y);var g=e.getAnchorPointInPoints();e.setPosition(g.x+b.x,g.y+b.y);this.sortAllChildren();cc.view._setScaleXYForRenderTexture();for(b=0;d>b;b++)c[b].visit(f);cc.view._resetScale();this._cacheDirty=!1}e.visit(a);this.arrivalOrder=0;a.restore()}};p._getBoundingBoxForBake=
function(){var a=null;if(!this._children||0===this._children.length)return cc.rect(0,0,10,10);for(var b=this._children,c=0;c<b.length;c++){var d=b[c];d&&d._visible&&(a?(d=d._getBoundingBoxToCurrentNode())&&(a=cc.rectUnion(a,d)):a=d._getBoundingBoxToCurrentNode())}return a};p=null}else cc.assert("function"==typeof cc._tmp.LayerDefineForWebGL,cc._LogInfos.MissingFile,"CCLayerWebGL.js"),cc._tmp.LayerDefineForWebGL(),delete cc._tmp.LayerDefineForWebGL;
(cc.LayerColor=cc.Layer.extend({_blendFunc:null,_className:"LayerColor",getBlendFunc:function(){return this._blendFunc},changeWidthAndHeight:function(a,b){this.width=a;this.height=b},changeWidth:function(a){this.width=a},changeHeight:function(a){this.height=a},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1},setColor:function(a){cc.Layer.prototype.setColor.call(this,a);this._updateColor()},setOpacity:function(a){cc.Layer.prototype.setOpacity.call(this,a);this._updateColor()},
_blendFuncStr:"source",ctor:null,init:function(a,b,c){cc._renderType!==cc._RENDER_TYPE_CANVAS&&(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_COLOR));var d=cc.director.getWinSize();a=a||cc.color(0,0,0,255);b=void 0===b?d.width:b;c=void 0===c?d.height:c;d=this._displayedColor;d.r=a.r;d.g=a.g;d.b=a.b;d=this._realColor;d.r=a.r;d.g=a.g;d.b=a.b;this._realOpacity=this._displayedOpacity=a.a;a=cc.LayerColor.prototype;return a.setContentSize.call(this,b,c),a._updateColor.call(this),!0},
setBlendFunc:function(a,b){var c=this._blendFunc;void 0===b?(c.src=a.src,c.dst=a.dst):(c.src=a,c.dst=b);cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._blendFuncStr=cc._getCompositeOperationByBlendFunc(c))},_setWidth:null,_setHeight:null,_updateColor:null,updateDisplayedColor:function(a){cc.Layer.prototype.updateDisplayedColor.call(this,a);this._updateColor()},updateDisplayedOpacity:function(a){cc.Layer.prototype.updateDisplayedOpacity.call(this,a);this._updateColor()},draw:null}),cc.LayerColor.create=
function(a,b,c){return new cc.LayerColor(a,b,c)},cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.LayerColor.prototype,_p.ctor=function(a,b,c){cc.Layer.prototype.ctor.call(this);this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);cc.LayerColor.prototype.init.call(this,a,b,c)},_p._setWidth=cc.Layer.prototype._setWidth,_p._setHeight=cc.Layer.prototype._setHeight,_p._updateColor=function(){},_p.draw=function(a){a=a||cc._renderContext;var b=cc.view,c=this._displayedColor;a.fillStyle="rgba("+(0|
c.r)+","+(0|c.g)+","+(0|c.b)+","+this._displayedOpacity/255+")";a.fillRect(0,0,this.width*b.getScaleX(),-this.height*b.getScaleY());cc.g_NumberOfDraws++},_p.visit=function(a){if(!this._isBaked)return void cc.Node.prototype.visit.call(this,a);var b;a=a||cc._renderContext;var c=this._children,d=c.length;if(this._visible){var e=this._bakeSprite;if(a.save(),this.transform(a),this._cacheDirty){b=this._getBoundingBoxForBake();b.width|=0;b.height|=0;var f=e.getCacheContext();e.resetCanvasSize(b.width,b.height);
var g=e.getAnchorPointInPoints(),h=this._position;if(this._ignoreAnchorPointForPosition)f.translate(0-b.x+h.x,b.height+b.y-h.y),e.setPosition(g.x+b.x-h.x,g.y+b.y-h.y);else{var k=this.getAnchorPointInPoints(),m=h.x-k.x,h=h.y-k.y;f.translate(0-b.x+m,b.height+b.y-h);e.setPosition(g.x+b.x-m,g.y+b.y-h)}var n;if(cc.view._setScaleXYForRenderTexture(),0<d){this.sortAllChildren();for(b=0;d>b&&(n=c[b],0>n._localZOrder);b++)n.visit(f);for(this.draw(f);d>b;b++)c[b].visit(f)}else this.draw(f);cc.view._resetScale();
this._cacheDirty=!1}e.visit(a);this.arrivalOrder=0;a.restore()}},_p._getBoundingBoxForBake=function(){var a=cc.rect(0,0,this._contentSize.width,this._contentSize.height),b=this.nodeToWorldTransform();if(a=cc.rectApplyAffineTransform(a,this.nodeToWorldTransform()),!this._children||0===this._children.length)return a;for(var c=this._children,d=0;d<c.length;d++){var e=c[d];e&&e._visible&&(e=e._getBoundingBoxToCurrentNode(b),a=cc.rectUnion(a,e))}return a},_p=null):(cc.assert("function"==typeof cc._tmp.WebGLLayerColor,
cc._LogInfos.MissingFile,"CCLayerWebGL.js"),cc._tmp.WebGLLayerColor(),delete cc._tmp.WebGLLayerColor);
(cc.assert("function"==typeof cc._tmp.PrototypeLayerColor,cc._LogInfos.MissingFile,"CCLayerPropertyDefine.js"),cc._tmp.PrototypeLayerColor(),delete cc._tmp.PrototypeLayerColor,cc.LayerGradient=cc.LayerColor.extend({_startColor:null,_endColor:null,_startOpacity:255,_endOpacity:255,_alongVector:null,_compressedInterpolation:!1,_gradientStartPoint:null,_gradientEndPoint:null,_className:"LayerGradient",ctor:function(a,b,c){cc.LayerColor.prototype.ctor.call(this);this._startColor=cc.color(0,0,0,255);this._endColor=
cc.color(0,0,0,255);this._alongVector=cc.p(0,-1);this._endOpacity=this._startOpacity=255;this._gradientStartPoint=cc.p(0,0);this._gradientEndPoint=cc.p(0,0);cc.LayerGradient.prototype.init.call(this,a,b,c)},init:function(a,b,c){a=a||cc.color(0,0,0,255);b=b||cc.color(0,0,0,255);c=c||cc.p(0,-1);var d=this._startColor,e=this._endColor;return d.r=a.r,d.g=a.g,d.b=a.b,this._startOpacity=a.a,e.r=b.r,e.g=b.g,e.b=b.b,this._endOpacity=b.a,this._alongVector=c,this._compressedInterpolation=!0,this._gradientStartPoint=
cc.p(0,0),this._gradientEndPoint=cc.p(0,0),cc.LayerColor.prototype.init.call(this,cc.color(a.r,a.g,a.b,255)),cc.LayerGradient.prototype._updateColor.call(this),!0},setContentSize:function(a,b){cc.LayerColor.prototype.setContentSize.call(this,a,b);this._updateColor()},_setWidth:function(a){cc.LayerColor.prototype._setWidth.call(this,a);this._updateColor()},_setHeight:function(a){cc.LayerColor.prototype._setHeight.call(this,a);this._updateColor()},getStartColor:function(){return this._realColor},setStartColor:function(a){this.color=
a},setEndColor:function(a){this._endColor=a;this._updateColor()},getEndColor:function(){return this._endColor},setStartOpacity:function(a){this._startOpacity=a;this._updateColor()},getStartOpacity:function(){return this._startOpacity},setEndOpacity:function(a){this._endOpacity=a;this._updateColor()},getEndOpacity:function(){return this._endOpacity},setVector:function(a){this._alongVector.x=a.x;this._alongVector.y=a.y;this._updateColor()},getVector:function(){return cc.p(this._alongVector.x,this._alongVector.y)},
isCompressedInterpolation:function(){return this._compressedInterpolation},setCompressedInterpolation:function(a){this._compressedInterpolation=a;this._updateColor()},_draw:null,_updateColor:null}),cc.LayerGradient.create=function(a,b,c){return new cc.LayerGradient(a,b,c)},cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.LayerGradient.prototype,_p.draw=function(a){a=a||cc._renderContext;"source"!=this._blendFuncStr&&(a.globalCompositeOperation=this._blendFuncStr);a.save();var b=this._displayedOpacity/
255,c=cc.view.getScaleX(),d=cc.view.getScaleY(),e=this.width*c,f=this.height*d,c=a.createLinearGradient(this._gradientStartPoint.x*c,this._gradientStartPoint.y*d,this._gradientEndPoint.x*c,this._gradientEndPoint.y*d),d=this._displayedColor,g=this._endColor;c.addColorStop(0,"rgba("+Math.round(d.r)+","+Math.round(d.g)+","+Math.round(d.b)+","+(this._startOpacity/255*b).toFixed(4)+")");c.addColorStop(1,"rgba("+Math.round(g.r)+","+Math.round(g.g)+","+Math.round(g.b)+","+(this._endOpacity/255*b).toFixed(4)+
")");a.fillStyle=c;a.fillRect(0,0,e,-f);0!=this._rotation&&a.rotate(this._rotationRadians);a.restore();cc.g_NumberOfDraws++},_p._updateColor=function(){var a=this._alongVector,b=.5*this.width,c=.5*this.height;this._gradientStartPoint.x=b*-a.x+b;this._gradientStartPoint.y=c*a.y-c;this._gradientEndPoint.x=b*a.x+b;this._gradientEndPoint.y=c*-a.y-c},_p=null):(cc.assert("function"==typeof cc._tmp.WebGLLayerGradient,cc._LogInfos.MissingFile,"CCLayerWebGL.js"),cc._tmp.WebGLLayerGradient(),delete cc._tmp.WebGLLayerGradient);
(cc.assert("function"==typeof cc._tmp.PrototypeLayerGradient,cc._LogInfos.MissingFile,"CCLayerPropertyDefine.js"),cc._tmp.PrototypeLayerGradient(),delete cc._tmp.PrototypeLayerGradient,cc.LayerMultiplex=cc.Layer.extend({_enabledLayer:0,_layers:null,_className:"LayerMultiplex",ctor:function(a){cc.Layer.prototype.ctor.call(this);a instanceof Array?cc.LayerMultiplex.prototype.initWithLayers.call(this,a):cc.LayerMultiplex.prototype.initWithLayers.call(this,Array.prototype.slice.call(arguments))},initWithLayers:function(a){return 0<
a.length&&null==a[a.length-1]&&cc.log(cc._LogInfos.LayerMultiplex_initWithLayers),this._layers=a,this._enabledLayer=0,this.addChild(this._layers[this._enabledLayer]),!0},switchTo:function(a){return a>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchTo):(this.removeChild(this._layers[this._enabledLayer],!0),this._enabledLayer=a,void this.addChild(this._layers[a]))},switchToAndReleaseMe:function(a){return a>=this._layers.length?void cc.log(cc._LogInfos.LayerMultiplex_switchToAndReleaseMe):
(this.removeChild(this._layers[this._enabledLayer],!0),this._layers[this._enabledLayer]=null,this._enabledLayer=a,void this.addChild(this._layers[a]))},addLayer:function(a){return a?void this._layers.push(a):void cc.log(cc._LogInfos.LayerMultiplex_addLayer)}}),cc.LayerMultiplex.create=function(){return new cc.LayerMultiplex(Array.prototype.slice.call(arguments))},cc._tmp.PrototypeSprite=function(){var a=cc.Sprite.prototype;cc.defineGetterSetter(a,"opacityModifyRGB",a.isOpacityModifyRGB,a.setOpacityModifyRGB);
cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);cc.defineGetterSetter(a,"color",a.getColor,a.setColor);a.dirty;a.flippedX;cc.defineGetterSetter(a,"flippedX",a.isFlippedX,a.setFlippedX);a.flippedY;cc.defineGetterSetter(a,"flippedY",a.isFlippedY,a.setFlippedY);a.offsetX;cc.defineGetterSetter(a,"offsetX",a._getOffsetX);a.offsetY;cc.defineGetterSetter(a,"offsetY",a._getOffsetY);a.atlasIndex;a.texture;cc.defineGetterSetter(a,"texture",a.getTexture,a.setTexture);a.textureRectRotated;cc.defineGetterSetter(a,
"textureRectRotated",a.isTextureRectRotated);a.textureAtlas;a.batchNode;cc.defineGetterSetter(a,"batchNode",a.getBatchNode,a.setBatchNode);a.quad;cc.defineGetterSetter(a,"quad",a.getQuad)},cc.generateTintImageWithMultiply=function(a,b,c,d){d=d||cc.newElement("canvas");c=c||cc.rect(0,0,a.width,a.height);var e=d.getContext("2d");return d.width!=c.width||d.height!=c.height?(d.width=c.width,d.height=c.height):e.globalCompositeOperation="source-over",e.fillStyle="rgb("+(0|b.r)+","+(0|b.g)+","+(0|b.b)+
")",e.fillRect(0,0,c.width,c.height),e.globalCompositeOperation="multiply",e.drawImage(a,c.x,c.y,c.width,c.height,0,0,c.width,c.height),e.globalCompositeOperation="destination-atop",e.drawImage(a,c.x,c.y,c.width,c.height,0,0,c.width,c.height),d},cc.generateTintImage=function(a,b,c,d,e){d||(d=cc.rect(0,0,a.width,a.height));var f;a=c.r/255;var g=c.g/255;c=c.b/255;var h=Math.min(d.width,b[0].width),k=Math.min(d.height,b[0].height);e?(f=e.getContext("2d"),f.clearRect(0,0,h,k)):(e=cc.newElement("canvas"),
e.width=h,e.height=k,f=e.getContext("2d"));f.save();f.globalCompositeOperation="lighter";var m=f.globalAlpha;return 0<a&&(f.globalAlpha=a*m,f.drawImage(b[0],d.x,d.y,h,k,0,0,h,k)),0<g&&(f.globalAlpha=g*m,f.drawImage(b[1],d.x,d.y,h,k,0,0,h,k)),0<c&&(f.globalAlpha=c*m,f.drawImage(b[2],d.x,d.y,h,k,0,0,h,k)),1>a+g+c&&(f.globalAlpha=m,f.drawImage(b[3],d.x,d.y,h,k,0,0,h,k)),f.restore(),e},cc.generateTextureCacheForColor=function(a){function b(){var b=cc.generateTextureCacheForColor,d=a.width,g=a.height;
c[0].width=d;c[0].height=g;c[1].width=d;c[1].height=g;c[2].width=d;c[2].height=g;c[3].width=d;c[3].height=g;b.canvas.width=d;b.canvas.height=g;var h=b.canvas.getContext("2d");h.drawImage(a,0,0);b.tempCanvas.width=d;b.tempCanvas.height=g;for(var h=h.getImageData(0,0,d,g).data,k=0;4>k;k++){var m=c[k].getContext("2d");m.getImageData(0,0,d,g).data;b.tempCtx.drawImage(a,0,0);for(var n=b.tempCtx.getImageData(0,0,d,g),q=n.data,r=0;r<h.length;r+=4)q[r]=0===k?h[r]:0,q[r+1]=1===k?h[r+1]:0,q[r+2]=2===k?h[r+
2]:0,q[r+3]=h[r+3];m.putImageData(n,0,0)}a.onload=null}if(a.channelCache)return a.channelCache;var c=[cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas"),cc.newElement("canvas")];try{b()}catch(d){a.onload=b}return a.channelCache=c,c},cc.generateTextureCacheForColor.canvas=cc.newElement("canvas"),cc.generateTextureCacheForColor.tempCanvas=cc.newElement("canvas"),cc.generateTextureCacheForColor.tempCtx=cc.generateTextureCacheForColor.tempCanvas.getContext("2d"),cc.cutRotateImageToCanvas=
function(a,b){if(!a)return null;if(!b)return a;var c=cc.newElement("canvas");c.width=b.width;c.height=b.height;var d=c.getContext("2d");return d.translate(c.width/2,c.height/2),d.rotate(-1.5707963267948966),d.drawImage(a,b.x,b.y,b.height,b.width,-b.height/2,-b.width/2,b.height,b.width),c},cc._getCompositeOperationByBlendFunc=function(a){return a?a.src==cc.SRC_ALPHA&&a.dst==cc.ONE||a.src==cc.ONE&&a.dst==cc.ONE?"lighter":a.src==cc.ZERO&&a.dst==cc.SRC_ALPHA?"destination-in":a.src==cc.ZERO&&a.dst==cc.ONE_MINUS_SRC_ALPHA?
"destination-out":"source":"source"},cc.Sprite=cc.Node.extend({dirty:!1,atlasIndex:0,textureAtlas:null,_batchNode:null,_recursiveDirty:null,_hasChildren:null,_shouldBeHidden:!1,_transformToBatch:null,_blendFunc:null,_texture:null,_rect:null,_rectRotated:!1,_offsetPosition:null,_unflippedOffsetPositionFromCenter:null,_opacityModifyRGB:!1,_flippedX:!1,_flippedY:!1,_textureLoaded:!1,_loadedEventListeners:null,_newTextureWhenChangeColor:null,_className:"Sprite",_oldDisplayColor:cc.color.WHITE,textureLoaded:function(){return this._textureLoaded},
addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}},isDirty:function(){return this.dirty},setDirty:function(a){this.dirty=a},isTextureRectRotated:function(){return this._rectRotated},getAtlasIndex:function(){return this.atlasIndex},
setAtlasIndex:function(a){this.atlasIndex=a},getTextureRect:function(){return cc.rect(this._rect.x,this._rect.y,this._rect.width,this._rect.height)},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(a){this.textureAtlas=a},getOffsetPosition:function(){return cc.p(this._offsetPosition)},_getOffsetX:function(){return this._offsetPosition.x},_getOffsetY:function(){return this._offsetPosition.y},getBlendFunc:function(){return this._blendFunc},initWithSpriteFrame:function(a){cc.assert(a,
cc._LogInfos.Sprite_initWithSpriteFrame);a.textureLoaded()||(this._textureLoaded=!1,a.addLoadedEventListener(this._spriteFrameLoadedCallback,this));var b=cc._renderType===cc._RENDER_TYPE_CANVAS?!1:a._rotated,b=this.initWithTexture(a.getTexture(),a.getRect(),b);return this.setSpriteFrame(a),b},_spriteFrameLoadedCallback:null,initWithSpriteFrameName:function(a){cc.assert(a,cc._LogInfos.Sprite_initWithSpriteFrameName);var b=cc.spriteFrameCache.getSpriteFrame(a);return cc.assert(b,a+cc._LogInfos.Sprite_initWithSpriteFrameName1),
this.initWithSpriteFrame(b)},useBatchNode:function(a){this.textureAtlas=a.textureAtlas;this._batchNode=a},setVertexRect:function(a){this._rect.x=a.x;this._rect.y=a.y;this._rect.width=a.width;this._rect.height=a.height},sortAllChildren:function(){if(this._reorderChildDirty){var a,b,c,d=this._children,e=d.length;for(a=1;e>a;a++){c=d[a];for(b=a-1;0<=b&&(c._localZOrder<d[b]._localZOrder||c._localZOrder===d[b]._localZOrder&&c.arrivalOrder<d[b].arrivalOrder);)d[b+1]=d[b],b--;d[b+1]=c}this._batchNode&&this._arrayMakeObjectsPerformSelector(d,
cc.Node._StateCallbackType.sortAllChildren);this._reorderChildDirty=!1}},reorderChild:function(a,b){return cc.assert(a,cc._LogInfos.Sprite_reorderChild_2),-1===this._children.indexOf(a)?void cc.log(cc._LogInfos.Sprite_reorderChild):void(b!==a.zIndex&&(this._batchNode&&!this._reorderChildDirty&&(this._setReorderChildDirtyRecursively(),this._batchNode.reorderBatch(!0)),cc.Node.prototype.reorderChild.call(this,a,b)))},removeChild:function(a,b){this._batchNode&&this._batchNode.removeSpriteFromAtlas(a);
cc.Node.prototype.removeChild.call(this,a,b)},setVisible:function(a){cc.Node.prototype.setVisible.call(this,a);this.setDirtyRecursively(!0)},removeAllChildren:function(a){var b=this._children,c=this._batchNode;if(c&&null!=b)for(var d=0,e=b.length;e>d;d++)c.removeSpriteFromAtlas(b[d]);cc.Node.prototype.removeAllChildren.call(this,a);this._hasChildren=!1},setDirtyRecursively:function(a){this.dirty=this._recursiveDirty=a;for(var b=this._children,c=b?b.length:0,d=0;c>d;d++)a=b[d],a instanceof cc.Sprite&&
a.setDirtyRecursively(!0)},setNodeDirty:function(a){cc.Node.prototype.setNodeDirty.call(this);a||!this._batchNode||this._recursiveDirty||(this._hasChildren?this.setDirtyRecursively(!0):(this._recursiveDirty=!0,this.dirty=!0))},ignoreAnchorPointForPosition:function(a){return this._batchNode?void cc.log(cc._LogInfos.Sprite_ignoreAnchorPointForPosition):void cc.Node.prototype.ignoreAnchorPointForPosition.call(this,a)},setFlippedX:function(a){this._flippedX!=a&&(this._flippedX=a,this.setTextureRect(this._rect,
this._rectRotated,this._contentSize),this.setNodeDirty(!0))},setFlippedY:function(a){this._flippedY!=a&&(this._flippedY=a,this.setTextureRect(this._rect,this._rectRotated,this._contentSize),this.setNodeDirty(!0))},isFlippedX:function(){return this._flippedX},isFlippedY:function(){return this._flippedY},setOpacityModifyRGB:null,isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateDisplayedOpacity:null,setDisplayFrameWithAnimationName:function(a,b){cc.assert(a,cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_3);
var c=cc.animationCache.getAnimation(a);return c?(c=c.getFrames()[b])?void this.setSpriteFrame(c.getSpriteFrame()):void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName_2):void cc.log(cc._LogInfos.Sprite_setDisplayFrameWithAnimationName)},getBatchNode:function(){return this._batchNode},_setReorderChildDirtyRecursively:function(){if(!this._reorderChildDirty){this._reorderChildDirty=!0;for(var a=this._parent;a&&a!=this._batchNode;)a._setReorderChildDirtyRecursively(),a=a.parent}},getTexture:function(){return this._texture},
_quad:null,_quadWebBuffer:null,_quadDirty:!1,_colorized:!1,_blendFuncStr:"source",_originalTexture:null,_textureRect_Canvas:null,_drawSize_Canvas:null,ctor:null,_softInit:function(a,b,c){if(void 0===a)cc.Sprite.prototype.init.call(this);else if("string"==typeof a)"#"===a[0]?(a=a.substr(1,a.length-1),a=cc.spriteFrameCache.getSpriteFrame(a),this.initWithSpriteFrame(a)):cc.Sprite.prototype.init.call(this,a,b);else if("object"==typeof a)if(a instanceof cc.Texture2D)this.initWithTexture(a,b,c);else if(a instanceof
cc.SpriteFrame)this.initWithSpriteFrame(a);else if(a instanceof HTMLImageElement||a instanceof HTMLCanvasElement)b=new cc.Texture2D,b.initWithElement(a),b.handleLoadedTexture(),this.initWithTexture(b)},getQuad:function(){return this._quad},setBlendFunc:null,init:null,initWithFile:function(a,b){cc.assert(a,cc._LogInfos.Sprite_initWithFile);var c=cc.textureCache.getTextureForKey(a);if(c){if(!b){var d=c.getContentSize();b=cc.rect(0,0,d.width,d.height)}return this.initWithTexture(c,b)}return c=cc.textureCache.addImage(a),
this.initWithTexture(c,b||cc.rect(0,0,c._contentSize.width,c._contentSize.height))},initWithTexture:null,_textureLoadedCallback:null,setTextureRect:null,updateTransform:null,addChild:null,updateColor:function(){var a=this._displayedColor,b=this._displayedOpacity,a={r:a.r,g:a.g,b:a.b,a:b};this._opacityModifyRGB&&(a.r*=b/255,a.g*=b/255,a.b*=b/255);b=this._quad;b.bl.colors=a;b.br.colors=a;b.tl.colors=a;b.tr.colors=a;this._batchNode&&(this.atlasIndex!=cc.Sprite.INDEX_NOT_INITIALIZED?this.textureAtlas.updateQuad(b,
this.atlasIndex):this.dirty=!0);this._quadDirty=!0},setOpacity:null,setColor:null,updateDisplayedColor:null,setSpriteFrame:null,setDisplayFrame:function(a){cc.log(cc._LogInfos.Sprite_setDisplayFrame);this.setSpriteFrame(a)},isFrameDisplayed:null,displayFrame:function(){return cc.SpriteFrame.create(this._texture,cc.rectPointsToPixels(this._rect),this._rectRotated,cc.pointPointsToPixels(this._unflippedOffsetPositionFromCenter),cc.sizePointsToPixels(this._contentSize))},setBatchNode:null,setTexture:null,
_updateBlendFunc:function(){return this._batchNode?void cc.log(cc._LogInfos.Sprite__updateBlendFunc):void(this._texture&&this._texture.hasPremultipliedAlpha()?(this._blendFunc.src=cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.opacityModifyRGB=!0):(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA,this.opacityModifyRGB=!1))},_changeTextureColor:function(){var a,b=this._texture,c=this._textureRect_Canvas;b&&c.validRect&&this._originalTexture&&(a=b.getHtmlElementObj(),
a)&&(this._colorized=!0,a instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor&&this._originalTexture._htmlElementObj!=a?cc.generateTintImageWithMultiply(this._originalTexture._htmlElementObj,this._displayedColor,c,a):(a=cc.generateTintImageWithMultiply(this._originalTexture._htmlElementObj,this._displayedColor,c),b=new cc.Texture2D,b.initWithElement(a),b.handleLoadedTexture(),this.texture=b))},_setTextureCoords:function(a){a=cc.rectPointsToPixels(a);var b=this._batchNode?
this.textureAtlas.texture:this._texture;if(b){var c,d,e,f,g,h=b.pixelsWidth,b=b.pixelsHeight,k=this._quad;this._rectRotated?(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(c=(2*a.x+1)/(2*h),d=c+(2*a.height-2)/(2*h),e=(2*a.y+1)/(2*b),f=e+(2*a.width-2)/(2*b)):(c=a.x/h,d=(a.x+a.height)/h,e=a.y/b,f=(a.y+a.width)/b),this._flippedX&&(g=e,e=f,f=g),this._flippedY&&(g=c,c=d,d=g),k.bl.texCoords.u=c,k.bl.texCoords.v=e,k.br.texCoords.u=c,k.br.texCoords.v=f,k.tl.texCoords.u=d,k.tl.texCoords.v=e,k.tr.texCoords.u=d,k.tr.texCoords.v=
f):(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(c=(2*a.x+1)/(2*h),d=c+(2*a.width-2)/(2*h),e=(2*a.y+1)/(2*b),f=e+(2*a.height-2)/(2*b)):(c=a.x/h,d=(a.x+a.width)/h,e=a.y/b,f=(a.y+a.height)/b),this._flippedX&&(g=c,c=d,d=g),this._flippedY&&(g=e,e=f,f=g),k.bl.texCoords.u=c,k.bl.texCoords.v=f,k.br.texCoords.u=d,k.br.texCoords.v=f,k.tl.texCoords.u=c,k.tl.texCoords.v=e,k.tr.texCoords.u=d,k.tr.texCoords.v=e);this._quadDirty=!0}},draw:null}),cc.Sprite.create=function(a,b,c){return new cc.Sprite(a,b,c)},cc.Sprite.createWithTexture=
cc.Sprite.create,cc.Sprite.createWithSpriteFrameName=cc.Sprite.create,cc.Sprite.createWithSpriteFrame=cc.Sprite.create,cc.Sprite.INDEX_NOT_INITIALIZED=-1,cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.Sprite.prototype,_p._spriteFrameLoadedCallback=function(a){this.setNodeDirty(!0);this.setTextureRect(a.getRect(),a.isRotated(),a.getOriginalSize());a=this.color;255===a.r&&255===a.g&&255===a.b||this._changeTextureColor();this._callLoadedEventCallbacks()},_p.setOpacityModifyRGB=function(a){this._opacityModifyRGB!==
a&&(this._opacityModifyRGB=a,this.setNodeDirty(!0))},_p.updateDisplayedOpacity=function(a){cc.Node.prototype.updateDisplayedOpacity.call(this,a);this._setNodeDirtyForCache()},_p.ctor=function(a,b,c){cc.Node.prototype.ctor.call(this);this._shouldBeHidden=!1;this._offsetPosition=cc.p(0,0);this._unflippedOffsetPositionFromCenter=cc.p(0,0);this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._rect=cc.rect(0,0,0,0);this._newTextureWhenChangeColor=!1;this._textureLoaded=!0;this._textureRect_Canvas=
{x:0,y:0,width:0,height:0,validRect:!1};this._drawSize_Canvas=cc.size(0,0);this._softInit(a,b,c)},_p.setBlendFunc=function(a,b){var c=this._blendFunc;void 0===b?(c.src=a.src,c.dst=a.dst):(c.src=a,c.dst=b);cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._blendFuncStr=cc._getCompositeOperationByBlendFunc(c))},_p.init=function(){return 0<arguments.length?this.initWithFile(arguments[0],arguments[1]):(cc.Node.prototype.init.call(this),this.dirty=this._recursiveDirty=!1,this._opacityModifyRGB=!0,this._blendFunc.src=
cc.BLEND_SRC,this._blendFunc.dst=cc.BLEND_DST,this.texture=null,this._textureLoaded=!0,this._flippedX=this._flippedY=!1,this.anchorX=.5,this.anchorY=.5,this._offsetPosition.x=0,this._offsetPosition.y=0,this._hasChildren=!1,this.setTextureRect(cc.rect(0,0,0,0),!1,cc.size(0,0)),!0)},_p.initWithTexture=function(a,b,c){if(cc.assert(0!=arguments.length,cc._LogInfos.CCSpriteBatchNode_initWithTexture),c=c||!1,c&&a.isLoaded()){var d=a.getHtmlElementObj(),d=cc.cutRotateImageToCanvas(d,b),e=new cc.Texture2D;
e.initWithElement(d);e.handleLoadedTexture();a=e;this._rect=cc.rect(0,0,b.width,b.height)}if(!cc.Node.prototype.init.call(this))return!1;this._batchNode=null;this.dirty=this._recursiveDirty=!1;this._opacityModifyRGB=!0;this._blendFunc.src=cc.BLEND_SRC;this._blendFunc.dst=cc.BLEND_DST;this._flippedX=this._flippedY=!1;this.anchorY=this.anchorX=.5;this._offsetPosition.x=0;this._offsetPosition.y=0;this._hasChildren=!1;d=a.isLoaded();if(this._textureLoaded=d,!d)return this._rectRotated=c,b&&(this._rect.x=
b.x,this._rect.y=b.y,this._rect.width=b.width,this._rect.height=b.height),this.texture&&this.texture.removeLoadedEventListener(this),a.addLoadedEventListener(this._textureLoadedCallback,this),this.texture=a,!0;if(b||(b=cc.rect(0,0,a.width,a.height)),a&&a.url)d=b.y+b.height,b.x+b.width>a.width&&cc.error(cc._LogInfos.RectWidth,a.url),d>a.height&&cc.error(cc._LogInfos.RectHeight,a.url);return this._originalTexture=a,this.texture=a,this.setTextureRect(b,c),this.batchNode=null,!0},_p._textureLoadedCallback=
function(a){if(!this._textureLoaded){this._textureLoaded=!0;var b=this._rect;b?cc._rectEqualToZero(b)&&(b.width=a.width,b.height=a.height):b=cc.rect(0,0,a.width,a.height);this.texture=this._originalTexture=a;this.setTextureRect(b,this._rectRotated);a=this._displayedColor;255==a.r&&255==a.g&&255==a.b||this._changeTextureColor();this.batchNode=this._batchNode;this._callLoadedEventCallbacks()}},_p.setTextureRect=function(a,b,c){this._rectRotated=b||!1;this.setContentSize(c||a);this.setVertexRect(a);
b=this._textureRect_Canvas;c=cc.contentScaleFactor();b.x=0|a.x*c;b.y=0|a.y*c;b.width=0|a.width*c;b.height=0|a.height*c;b.validRect=!(0===b.width||0===b.height||0>b.x||0>b.y);a=this._unflippedOffsetPositionFromCenter;this._flippedX&&(a.x=-a.x);this._flippedY&&(a.y=-a.y);this._offsetPosition.x=a.x+(this._contentSize.width-this._rect.width)/2;this._offsetPosition.y=a.y+(this._contentSize.height-this._rect.height)/2;this._batchNode&&(this.dirty=!0)},_p.updateTransform=function(){if(this.dirty){var a=
this._parent;!this._visible||a&&a!=this._batchNode&&a._shouldBeHidden?this._shouldBeHidden=!0:(this._shouldBeHidden=!1,this._transformToBatch=a&&a!=this._batchNode?cc.affineTransformConcat(this.nodeToParentTransform(),a._transformToBatch):this.nodeToParentTransform());this.dirty=this._recursiveDirty=!1}this._hasChildren&&this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.updateTransform)},_p.addChild=function(a,b,c){cc.assert(a,cc._LogInfos.CCSpriteBatchNode_addChild_2);
null==b&&(b=a._localZOrder);null==c&&(c=a.tag);cc.Node.prototype.addChild.call(this,a,b,c);this._hasChildren=!0},_p.setOpacity=function(a){cc.Node.prototype.setOpacity.call(this,a);this._setNodeDirtyForCache()},_p.setColor=function(a){var b=this.color;this._oldDisplayColor=b;b.r===a.r&&b.g===a.g&&b.b===a.b||cc.Node.prototype.setColor.call(this,a)},_p.updateDisplayedColor=function(a){cc.Node.prototype.updateDisplayedColor.call(this,a);a=this._oldDisplayColor;var b=this._displayedColor;a.r===b.r&&a.g===
b.g&&a.b===b.b||(this._changeTextureColor(),this._setNodeDirtyForCache())},_p.setSpriteFrame=function(a){var b=this;"string"==typeof a&&(a=cc.spriteFrameCache.getSpriteFrame(a),cc.assert(a,cc._LogInfos.CCSpriteBatchNode_setSpriteFrame));b.setNodeDirty(!0);var c=a.getOffset();b._unflippedOffsetPositionFromCenter.x=c.x;b._unflippedOffsetPositionFromCenter.y=c.y;b._rectRotated=a.isRotated();var c=a.getTexture(),d=a.textureLoaded();if(d||(b._textureLoaded=!1,a.addLoadedEventListener(function(a){b._textureLoaded=
!0;var c=a.getTexture();c!=b._texture&&(b.texture=c);b.setTextureRect(a.getRect(),a.isRotated(),a.getOriginalSize());b._callLoadedEventCallbacks()},b)),c!=b._texture&&(b.texture=c),b._rectRotated&&(b._originalTexture=c),b.setTextureRect(a.getRect(),b._rectRotated,a.getOriginalSize()),b._colorized=!1,d)a=b.color,255===a.r&&255===a.g&&255===a.b||b._changeTextureColor()},_p.isFrameDisplayed=function(a){return a.getTexture()!=this._texture?!1:cc.rectEqualToRect(a.getRect(),this._rect)},_p.setBatchNode=
function(a){(this._batchNode=a)?(this._transformToBatch=cc.affineTransformIdentity(),this.textureAtlas=this._batchNode.textureAtlas):(this.atlasIndex=cc.Sprite.INDEX_NOT_INITIALIZED,this.textureAtlas=null,this._recursiveDirty=!1,this.dirty=!1)},_p.setTexture=function(a){if(a&&"string"==typeof a)return a=cc.textureCache.addImage(a),this.setTexture(a),a=a.getContentSize(),void this.setTextureRect(cc.rect(0,0,a.width,a.height));cc.assert(!a||a instanceof cc.Texture2D,cc._LogInfos.CCSpriteBatchNode_setTexture);
this._texture!=a&&(a&&a.getHtmlElementObj()instanceof HTMLImageElement&&(this._originalTexture=a),this._texture=a)},_p.draw=function(a){if(this._textureLoaded){a=a||cc._renderContext;"source"!=this._blendFuncStr&&(a.globalCompositeOperation=this._blendFuncStr);var b=cc.view.getScaleX(),c=cc.view.getScaleY();a.globalAlpha=this._displayedOpacity/255;var d=this._rect,e=this._contentSize,f=this._offsetPosition,g=this._drawSize_Canvas,h=0|f.x,k=-f.y-d.height,m=this._textureRect_Canvas;(g.width=d.width*
b,g.height=d.height*c,(this._flippedX||this._flippedY)&&(a.save(),this._flippedX&&(h=-f.x-d.width,a.scale(-1,1)),this._flippedY&&(k=f.y,a.scale(1,-1))),h*=b,k*=c,this._texture&&m.validRect)?(e=this._texture.getHtmlElementObj(),this._colorized?a.drawImage(e,0,0,m.width,m.height,h,k,g.width,g.height):a.drawImage(e,m.x,m.y,m.width,m.height,h,k,g.width,g.height)):!this._texture&&m.validRect&&(g=this.color,a.fillStyle="rgba("+g.r+","+g.g+","+g.b+",1)",a.fillRect(h,k,e.width*b,e.height*c));1===cc.SPRITE_DEBUG_DRAW||
this._showNode?(a.strokeStyle="rgba(0,255,0,1)",h/=b,k=-(k/c),h=[cc.p(h,k),cc.p(h+d.width,k),cc.p(h+d.width,k-d.height),cc.p(h,k-d.height)],cc._drawingUtil.drawPoly(h,4,!0)):2===cc.SPRITE_DEBUG_DRAW&&(a.strokeStyle="rgba(0,255,0,1)",b=this._rect,k=-k,h=[cc.p(h,k),cc.p(h+b.width,k),cc.p(h+b.width,k-b.height),cc.p(h,k-b.height)],cc._drawingUtil.drawPoly(h,4,!0));(this._flippedX||this._flippedY)&&a.restore();cc.g_NumberOfDraws++}},cc.sys._supportCanvasNewBlendModes||(_p._changeTextureColor=function(){var a,
b=this._texture,c=this._textureRect_Canvas;if(b&&c.validRect&&this._originalTexture&&(a=b.getHtmlElementObj(),a)){var d=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());d&&(this._colorized=!0,a instanceof HTMLCanvasElement&&!this._rectRotated&&!this._newTextureWhenChangeColor?cc.generateTintImage(a,d,this._displayedColor,c,a):(a=cc.generateTintImage(a,d,this._displayedColor,c),b=new cc.Texture2D,b.initWithElement(a),b.handleLoadedTexture(),this.texture=b))}}),delete _p):
(cc.assert("function"==typeof cc._tmp.WebGLSprite,cc._LogInfos.MissingFile,"SpritesWebGL.js"),cc._tmp.WebGLSprite(),delete cc._tmp.WebGLSprite);
(cc.assert("function"==typeof cc._tmp.PrototypeSprite,cc._LogInfos.MissingFile,"SpritesPropertyDefine.js"),cc._tmp.PrototypeSprite(),delete cc._tmp.PrototypeSprite,cc.BakeSprite=cc.Sprite.extend({_cacheCanvas:null,_cacheContext:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);var a=document.createElement("canvas");a.width=a.height=10;this._cacheCanvas=a;this._cacheContext=a.getContext("2d");var b=new cc.Texture2D;b.initWithElement(a);b.handleLoadedTexture();this.setTexture(b)},getCacheContext:function(){return this._cacheContext},
getCacheCanvas:function(){return this._cacheCanvas},resetCanvasSize:function(a,b){void 0===b&&(b=a.height,a=a.width);var c=this._cacheCanvas;c.width=a;c.height=b;this.getTexture().handleLoadedTexture();this.setTextureRect(cc.rect(0,0,a,b),!1)}}),cc.AnimationFrame=cc.Class.extend({_spriteFrame:null,_delayPerUnit:0,_userInfo:null,ctor:function(a,b,c){this._spriteFrame=a||null;this._delayPerUnit=b||0;this._userInfo=c||null},clone:function(){var a=new cc.AnimationFrame;return a.initWithSpriteFrame(this._spriteFrame.clone(),
this._delayPerUnit,this._userInfo),a},copyWithZone:function(){return cc.clone(this)},copy:function(){var a=new cc.AnimationFrame;return a.initWithSpriteFrame(this._spriteFrame.clone(),this._delayPerUnit,this._userInfo),a},initWithSpriteFrame:function(a,b,c){return this._spriteFrame=a,this._delayPerUnit=b,this._userInfo=c,!0},getSpriteFrame:function(){return this._spriteFrame},setSpriteFrame:function(a){this._spriteFrame=a},getDelayUnits:function(){return this._delayPerUnit},setDelayUnits:function(a){this._delayPerUnit=
a},getUserInfo:function(){return this._userInfo},setUserInfo:function(a){this._userInfo=a}}),cc.AnimationFrame.create=function(a,b,c){return new cc.AnimationFrame(a,b,c)},cc.Animation=cc.Class.extend({_frames:null,_loops:0,_restoreOriginalFrame:!1,_duration:0,_delayPerUnit:0,_totalDelayUnits:0,ctor:function(a,b,c){if(this._frames=[],void 0===a)this.initWithSpriteFrames(null,0);else{var d=a[0];d&&(d instanceof cc.SpriteFrame?this.initWithSpriteFrames(a,b,c):d instanceof cc.AnimationFrame&&this.initWithAnimationFrames(a,
b,c))}},getFrames:function(){return this._frames},setFrames:function(a){this._frames=a},addSpriteFrame:function(a){var b=new cc.AnimationFrame;b.initWithSpriteFrame(a,1,null);this._frames.push(b);this._totalDelayUnits++},addSpriteFrameWithFile:function(a){a=cc.textureCache.addImage(a);var b=cc.rect(0,0,0,0);b.width=a.width;b.height=a.height;a=cc.SpriteFrame.create(a,b);this.addSpriteFrame(a)},addSpriteFrameWithTexture:function(a,b){var c=cc.SpriteFrame.create(a,b);this.addSpriteFrame(c)},initWithAnimationFrames:function(a,
b,c){cc.arrayVerifyType(a,cc.AnimationFrame);this._delayPerUnit=b;this._loops=void 0===c?1:c;this._totalDelayUnits=0;b=this._frames;for(c=b.length=0;c<a.length;c++){var d=a[c];b.push(d);this._totalDelayUnits+=d.getDelayUnits()}return!0},clone:function(){var a=new cc.Animation;return a.initWithAnimationFrames(this._copyFrames(),this._delayPerUnit,this._loops),a.setRestoreOriginalFrame(this._restoreOriginalFrame),a},copyWithZone:function(){var a=new cc.Animation;return a.initWithAnimationFrames(this._copyFrames(),
this._delayPerUnit,this._loops),a.setRestoreOriginalFrame(this._restoreOriginalFrame),a},_copyFrames:function(){for(var a=[],b=0;b<this._frames.length;b++)a.push(this._frames[b].clone());return a},copy:function(){return this.copyWithZone(null)},getLoops:function(){return this._loops},setLoops:function(a){this._loops=a},setRestoreOriginalFrame:function(a){this._restoreOriginalFrame=a},getRestoreOriginalFrame:function(){return this._restoreOriginalFrame},getDuration:function(){return this._totalDelayUnits*
this._delayPerUnit},getDelayPerUnit:function(){return this._delayPerUnit},setDelayPerUnit:function(a){this._delayPerUnit=a},getTotalDelayUnits:function(){return this._totalDelayUnits},initWithSpriteFrames:function(a,b,c){cc.arrayVerifyType(a,cc.SpriteFrame);this._loops=void 0===c?1:c;this._delayPerUnit=b||0;this._totalDelayUnits=0;b=this._frames;if(b.length=0,a){for(c=0;c<a.length;c++){var d=a[c],e=new cc.AnimationFrame;e.initWithSpriteFrame(d,1,null);b.push(e)}this._totalDelayUnits+=a.length}return!0},
retain:function(){},release:function(){}}),cc.Animation.create=function(a,b,c){return new cc.Animation(a,b,c)},cc.Animation.createWithAnimationFrames=cc.Animation.create,cc.animationCache={_animations:{},addAnimation:function(a,b){this._animations[b]=a},removeAnimation:function(a){a&&this._animations[a]&&delete this._animations[a]},getAnimation:function(a){return this._animations[a]?this._animations[a]:null},_addAnimationsWithDictionary:function(a,b){var c=a.animations;if(!c)return void cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary);
var d=1,e=a.properties;if(e)for(var d=null!=e.format?parseInt(e.format):d,e=e.spritesheets,f=cc.spriteFrameCache,g=cc.path,h=0;h<e.length;h++)f.addSpriteFrames(g.changeBasename(b,e[h]));switch(d){case 1:this._parseVersion1(c);break;case 2:this._parseVersion2(c);break;default:cc.log(cc._LogInfos.animationCache__addAnimationsWithDictionary_2)}},addAnimations:function(a){cc.assert(a,cc._LogInfos.animationCache_addAnimations_2);var b=cc.loader.getRes(a);return b?void this._addAnimationsWithDictionary(b,
a):void cc.log(cc._LogInfos.animationCache_addAnimations)},_parseVersion1:function(a){var b=cc.spriteFrameCache,c;for(c in a){var d=a[c],e=d.frames,d=parseFloat(d.delay)||0,f=null;if(e){for(var g=[],h=0;h<e.length;h++){var k=b.getSpriteFrame(e[h]);if(k){var m=new cc.AnimationFrame;m.initWithSpriteFrame(k,1,null);g.push(m)}else cc.log(cc._LogInfos.animationCache__parseVersion1_2,c,e[h])}0!==g.length?(g.length!=e.length&&cc.log(cc._LogInfos.animationCache__parseVersion1_4,c),f=cc.Animation.create(g,
d,1),cc.animationCache.addAnimation(f,c)):cc.log(cc._LogInfos.animationCache__parseVersion1_3,c)}else cc.log(cc._LogInfos.animationCache__parseVersion1,c)}},_parseVersion2:function(a){var b=cc.spriteFrameCache,c;for(c in a){var d=a[c],e=d.loop,f=parseInt(d.loops),e=e?cc.REPEAT_FOREVER:isNaN(f)?1:f,f=d.restoreOriginalFrame&&1==d.restoreOriginalFrame?!0:!1,g=d.frames;if(g){for(var h=[],k=0;k<g.length;k++){var m=g[k],n=m.spriteframe,q=b.getSpriteFrame(n);if(q){var n=parseFloat(m.delayUnits)||0,m=m.notification,
r=new cc.AnimationFrame;r.initWithSpriteFrame(q,n,m);h.push(r)}else cc.log(cc._LogInfos.animationCache__parseVersion2_2,c,n)}d=parseFloat(d.delayPerUnit)||0;g=new cc.Animation;g.initWithAnimationFrames(h,d,e);g.setRestoreOriginalFrame(f);cc.animationCache.addAnimation(g,c)}else cc.log(cc._LogInfos.animationCache__parseVersion2,c)}},_clear:function(){this._animations={}}},cc.SpriteFrame=cc.Class.extend({_offset:null,_originalSize:null,_rectInPixels:null,_rotated:!1,_rect:null,_offsetInPixels:null,
_originalSizeInPixels:null,_texture:null,_textureFilename:"",_textureLoaded:!1,_eventListeners:null,ctor:function(a,b,c,d,e){this._offset=cc.p(0,0);this._offsetInPixels=cc.p(0,0);this._originalSize=cc.size(0,0);this._rotated=!1;this._originalSizeInPixels=cc.size(0,0);this._textureFilename="";this._texture=null;this._textureLoaded=!1;void 0!==a&&void 0!==b&&(void 0===c||void 0===d||void 0===e?this.initWithTexture(a,b):this.initWithTexture(a,b,c,d,e))},textureLoaded:function(){return this._textureLoaded},
addLoadedEventListener:function(a,b){null==this._eventListeners&&(this._eventListeners=[]);this._eventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){var a=this._eventListeners;if(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}},getRectInPixels:function(){var a=this._rectInPixels;return cc.rect(a.x,a.y,a.width,a.height)},setRectInPixels:function(a){this._rectInPixels||(this._rectInPixels=cc.rect(0,0,0,0));this._rectInPixels.x=
a.x;this._rectInPixels.y=a.y;this._rectInPixels.width=a.width;this._rectInPixels.height=a.height;this._rect=cc.rectPixelsToPoints(a)},isRotated:function(){return this._rotated},setRotated:function(a){this._rotated=a},getRect:function(){var a=this._rect;return cc.rect(a.x,a.y,a.width,a.height)},setRect:function(a){this._rect||(this._rect=cc.rect(0,0,0,0));this._rect.x=a.x;this._rect.y=a.y;this._rect.width=a.width;this._rect.height=a.height;this._rectInPixels=cc.rectPointsToPixels(this._rect)},getOffsetInPixels:function(){return cc.p(this._offsetInPixels)},
setOffsetInPixels:function(a){this._offsetInPixels.x=a.x;this._offsetInPixels.y=a.y;cc._pointPixelsToPointsOut(this._offsetInPixels,this._offset)},getOriginalSizeInPixels:function(){return cc.size(this._originalSizeInPixels)},setOriginalSizeInPixels:function(a){this._originalSizeInPixels.width=a.width;this._originalSizeInPixels.height=a.height},getOriginalSize:function(){return cc.size(this._originalSize)},setOriginalSize:function(a){this._originalSize.width=a.width;this._originalSize.height=a.height},
getTexture:function(){if(this._texture)return this._texture;if(""!==this._textureFilename){var a=cc.textureCache.addImage(this._textureFilename);return a&&(this._textureLoaded=a.isLoaded()),a}return null},setTexture:function(a){if(this._texture!=a){var b=a.isLoaded();this._textureLoaded=b;this._texture=a;b||a.addLoadedEventListener(function(a){if(this._textureLoaded=!0,this._rotated&&cc._renderType===cc._RENDER_TYPE_CANVAS){var b=a.getHtmlElementObj(),b=cc.cutRotateImageToCanvas(b,this.getRect()),
e=new cc.Texture2D;e.initWithElement(b);e.handleLoadedTexture();this.setTexture(e);b=this.getRect();this.setRect(cc.rect(0,0,b.width,b.height))}b=this._rect;0===b.width&&0===b.height&&(b=a.width,a=a.height,this._rect.width=b,this._rect.height=a,this._rectInPixels=cc.rectPointsToPixels(this._rect),this._originalSizeInPixels.width=this._rectInPixels.width,this._originalSizeInPixels.height=this._rectInPixels.height,this._originalSize.width=b,this._originalSize.height=a);this._callLoadedEventCallbacks()},
this)}},getOffset:function(){return cc.p(this._offset)},setOffset:function(a){this._offset.x=a.x;this._offset.y=a.y},clone:function(){var a=new cc.SpriteFrame;return a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),a.setTexture(this._texture),a},copyWithZone:function(){var a=new cc.SpriteFrame;return a.initWithTexture(this._textureFilename,this._rectInPixels,this._rotated,this._offsetInPixels,this._originalSizeInPixels),a.setTexture(this._texture),
a},copy:function(){return this.copyWithZone()},initWithTexture:function(a,b,c,d,e){if(2===arguments.length&&(b=cc.rectPointsToPixels(b)),d=d||cc.p(0,0),e=e||b,c=c||!1,"string"==typeof a?(this._texture=null,this._textureFilename=a):a instanceof cc.Texture2D&&this.setTexture(a),a=this.getTexture(),this._rectInPixels=b,b=this._rect=cc.rectPixelsToPoints(b),a&&a.url&&a.isLoaded()){var f,g;c?(f=b.x+b.height,g=b.y+b.width):(f=b.x+b.width,g=b.y+b.height);f>a.getPixelsWide()&&cc.error(cc._LogInfos.RectWidth,
a.url);g>a.getPixelsHigh()&&cc.error(cc._LogInfos.RectHeight,a.url)}return this._offsetInPixels.x=d.x,this._offsetInPixels.y=d.y,cc._pointPixelsToPointsOut(d,this._offset),this._originalSizeInPixels.width=e.width,this._originalSizeInPixels.height=e.height,cc._sizePixelsToPointsOut(e,this._originalSize),this._rotated=c,!0}}),cc.SpriteFrame.create=function(a,b,c,d,e){return new cc.SpriteFrame(a,b,c,d,e)},cc.SpriteFrame.createWithTexture=cc.SpriteFrame.create,cc.SpriteFrame._frameWithTextureForCanvas=
function(a,b,c,d,e){var f=new cc.SpriteFrame;return f._texture=a,f._rectInPixels=b,f._rect=cc.rectPixelsToPoints(b),f._offsetInPixels.x=d.x,f._offsetInPixels.y=d.y,cc._pointPixelsToPointsOut(f._offsetInPixels,f._offset),f._originalSizeInPixels.width=e.width,f._originalSizeInPixels.height=e.height,cc._sizePixelsToPointsOut(f._originalSizeInPixels,f._originalSize),f._rotated=c,f},cc.spriteFrameCache={_CCNS_REG1:/^\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*$/,_CCNS_REG2:/^\s*\{\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*,\s*\{\s*([\-]?\d+[.]?\d*)\s*,\s*([\-]?\d+[.]?\d*)\s*\}\s*\}\s*$/,
_spriteFrames:{},_spriteFramesAliases:{},_frameConfigCache:{},_rectFromString:function(a){return(a=this._CCNS_REG2.exec(a))?cc.rect(parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]),parseFloat(a[4])):cc.rect(0,0,0,0)},_pointFromString:function(a){return(a=this._CCNS_REG1.exec(a))?cc.p(parseFloat(a[1]),parseFloat(a[2])):cc.p(0,0)},_sizeFromString:function(a){return(a=this._CCNS_REG1.exec(a))?cc.size(parseFloat(a[1]),parseFloat(a[2])):cc.size(0,0)},_getFrameConfig:function(a){var b=cc.loader.getRes(a);
if(cc.assert(b,cc._LogInfos.spriteFrameCache__getFrameConfig_2,a),cc.loader.release(a),b._inited)return this._frameConfigCache[a]=b,b;var c=b.frames,d=b.metadata||b.meta,b={},e={},f=0;d&&(f=d.format,f=1>=f.length?parseInt(f):f,e.image=d.textureFileName||d.textureFileName||d.image);for(var g in c){var h=c[g];if(h){d={};if(0==f){d.rect=cc.rect(h.x,h.y,h.width,h.height);d.rotated=!1;d.offset=cc.p(h.offsetX,h.offsetY);var k=h.originalWidth,h=h.originalHeight;k&&h||cc.log(cc._LogInfos.spriteFrameCache__getFrameConfig);
k=Math.abs(k);h=Math.abs(h);d.size=cc.size(k,h)}else if(1==f||2==f)d.rect=this._rectFromString(h.frame),d.rotated=h.rotated||!1,d.offset=this._pointFromString(h.offset),d.size=this._sizeFromString(h.sourceSize);else if(3==f){var k=this._sizeFromString(h.spriteSize),m=this._rectFromString(h.textureRect);k&&(m=cc.rect(m.x,m.y,k.width,k.height));d.rect=m;d.rotated=h.textureRotated||!1;d.offset=this._pointFromString(h.spriteOffset);d.size=this._sizeFromString(h.spriteSourceSize);d.aliases=h.aliases}else k=
h.frame,m=h.sourceSize,g=h.filename||g,d.rect=cc.rect(k.x,k.y,k.w,k.h),d.rotated=h.rotated||!1,d.offset=cc.p(0,0),d.size=cc.size(m.w,m.h);b[g]=d}}return this._frameConfigCache[a]={_inited:!0,frames:b,meta:e}},addSpriteFrames:function(a,b){cc.assert(a,cc._LogInfos.spriteFrameCache_addSpriteFrames_2);var c=this._frameConfigCache[a]||cc.loader.getRes(a);if(c&&c.frames){var d=this._frameConfigCache[a]||this._getFrameConfig(a),c=d.frames,d=d.meta;b?b instanceof cc.Texture2D||("string"==typeof b?b=cc.textureCache.addImage(b):
cc.assert(0,cc._LogInfos.spriteFrameCache_addSpriteFrames_3)):(d=cc.path.changeBasename(a,d.image||".png"),b=cc.textureCache.addImage(d));var d=this._spriteFramesAliases,e=this._spriteFrames,f;for(f in c){var g=c[f],h=e[f];if(!h){h=cc.SpriteFrame.create(b,g.rect,g.rotated,g.offset,g.size);if(g=g.aliases)for(var k=0,m=g.length;m>k;k++){var n=g[k];d[n]&&cc.log(cc._LogInfos.spriteFrameCache_addSpriteFrames,n);d[n]=f}cc._renderType===cc._RENDER_TYPE_CANVAS&&h.isRotated()&&h.getTexture().isLoaded()&&(g=
h.getTexture().getHtmlElementObj(),g=cc.cutRotateImageToCanvas(g,h.getRectInPixels()),k=new cc.Texture2D,k.initWithElement(g),k.handleLoadedTexture(),h.setTexture(k),g=h._rect,h.setRect(cc.rect(0,0,g.width,g.height)));e[f]=h}}}},_checkConflict:function(a){a=a.frames;for(var b in a)this._spriteFrames[b]&&cc.log(cc._LogInfos.spriteFrameCache__checkConflict,b)},addSpriteFrame:function(a,b){this._spriteFrames[b]=a},removeSpriteFrames:function(){this._spriteFrames={};this._spriteFramesAliases={}},removeSpriteFrameByName:function(a){a&&
(this._spriteFramesAliases[a]&&delete this._spriteFramesAliases[a],this._spriteFrames[a]&&delete this._spriteFrames[a])},removeSpriteFramesFromFile:function(a){var b=this._spriteFrames,c=this._spriteFramesAliases;if(a=this._frameConfigCache[a]){a=a.frames;for(var d in a)if(b[d]){delete b[d];for(var e in c)c[e]==d&&delete c[e]}}},removeSpriteFramesFromTexture:function(a){var b=this._spriteFrames,c=this._spriteFramesAliases,d;for(d in b){var e=b[d];if(e&&e.getTexture()==a){delete b[d];for(var f in c)c[f]==
d&&delete c[f]}}},getSpriteFrame:function(a){var b=this._spriteFrames[a];if(!b){var c=this._spriteFramesAliases[a];c&&(b=this._spriteFrames[c.toString()],b||delete this._spriteFramesAliases[a])}return b||cc.log(cc._LogInfos.spriteFrameCache_getSpriteFrame,a),b},_clear:function(){this._spriteFrames={};this._spriteFramesAliases={};this._frameConfigCache={}}},cc.g_NumberOfDraws=0,cc.GLToClipTransform=function(a){var b=new cc.kmMat4;cc.kmGLGetMatrix(cc.KM_GL_PROJECTION,b);var c=new cc.kmMat4;cc.kmGLGetMatrix(cc.KM_GL_MODELVIEW,
c);cc.kmMat4Multiply(a,b,c)},cc.Director=cc.Class.extend({_landscape:!1,_nextDeltaTimeZero:!1,_paused:!1,_purgeDirectorInNextLoop:!1,_sendCleanupToScene:!1,_animationInterval:0,_oldAnimationInterval:0,_projection:0,_accumDt:0,_contentScaleFactor:1,_displayStats:!1,_deltaTime:0,_frameRate:0,_FPSLabel:null,_SPFLabel:null,_drawsLabel:null,_winSizeInPoints:null,_lastUpdate:null,_nextScene:null,_notificationNode:null,_openGLView:null,_scenesStack:null,_projectionDelegate:null,_runningScene:null,_frames:0,
_totalFrames:0,_secondsPerFrame:0,_dirtyRegion:null,_scheduler:null,_actionManager:null,_eventProjectionChanged:null,_eventAfterDraw:null,_eventAfterVisit:null,_eventAfterUpdate:null,ctor:function(){var a=this;a._lastUpdate=Date.now();cc.eventManager.addCustomListener(cc.game.EVENT_SHOW,function(){a._lastUpdate=Date.now()})},init:function(){return this._oldAnimationInterval=this._animationInterval=1/cc.defaultFPS,this._scenesStack=[],this._projection=cc.Director.PROJECTION_DEFAULT,this._projectionDelegate=
null,this._accumDt=0,this._frameRate=0,this._displayStats=!1,this._totalFrames=this._frames=0,this._lastUpdate=Date.now(),this._paused=!1,this._purgeDirectorInNextLoop=!1,this._winSizeInPoints=cc.size(0,0),this._openGLView=null,this._contentScaleFactor=1,this._scheduler=new cc.Scheduler,this._actionManager=cc.ActionManager?new cc.ActionManager:null,this._scheduler.scheduleUpdateForTarget(this._actionManager,cc.Scheduler.PRIORITY_SYSTEM,!1),this._eventAfterDraw=new cc.EventCustom(cc.Director.EVENT_AFTER_DRAW),
this._eventAfterDraw.setUserData(this),this._eventAfterVisit=new cc.EventCustom(cc.Director.EVENT_AFTER_VISIT),this._eventAfterVisit.setUserData(this),this._eventAfterUpdate=new cc.EventCustom(cc.Director.EVENT_AFTER_UPDATE),this._eventAfterUpdate.setUserData(this),this._eventProjectionChanged=new cc.EventCustom(cc.Director.EVENT_PROJECTION_CHANGED),this._eventProjectionChanged.setUserData(this),!0},calculateDeltaTime:function(){var a=Date.now();this._nextDeltaTimeZero?(this._deltaTime=0,this._nextDeltaTimeZero=
!1):this._deltaTime=(a-this._lastUpdate)/1E3;0<cc.game.config[cc.game.CONFIG_KEY.debugMode]&&.2<this._deltaTime&&(this._deltaTime=1/60);this._lastUpdate=a},convertToGL:null,convertToUI:null,drawScene:function(){this.calculateDeltaTime();this._paused||(this._scheduler.update(this._deltaTime),cc.eventManager.dispatchEvent(this._eventAfterUpdate));this._clear();this._nextScene&&this.setNextScene();this._beforeVisitScene&&this._beforeVisitScene();this._runningScene&&(this._runningScene.visit(),cc.eventManager.dispatchEvent(this._eventAfterVisit));
this._notificationNode&&this._notificationNode.visit();this._displayStats&&this._showStats();this._afterVisitScene&&this._afterVisitScene();cc.eventManager.dispatchEvent(this._eventAfterDraw);this._totalFrames++;this._displayStats&&this._calculateMPF()},_beforeVisitScene:null,_afterVisitScene:null,end:function(){this._purgeDirectorInNextLoop=!0},getContentScaleFactor:function(){return this._contentScaleFactor},getNotificationNode:function(){return this._notificationNode},getWinSize:function(){return cc.size(this._winSizeInPoints)},
getWinSizeInPixels:function(){return cc.size(this._winSizeInPoints.width*this._contentScaleFactor,this._winSizeInPoints.height*this._contentScaleFactor)},getVisibleSize:null,getVisibleOrigin:null,getZEye:null,pause:function(){this._paused||(this._oldAnimationInterval=this._animationInterval,this.setAnimationInterval(.25),this._paused=!0)},popScene:function(){cc.assert(this._runningScene,cc._LogInfos.Director_popScene);this._scenesStack.pop();var a=this._scenesStack.length;0==a?this.end():(this._sendCleanupToScene=
!0,this._nextScene=this._scenesStack[a-1])},purgeCachedData:function(){cc.animationCache._clear();cc.spriteFrameCache._clear();cc.textureCache._clear()},purgeDirector:function(){this.getScheduler().unscheduleAllCallbacks();cc.eventManager&&cc.eventManager.setEnabled(!1);this._runningScene&&(this._runningScene.onExitTransitionDidStart(),this._runningScene.onExit(),this._runningScene.cleanup());this._nextScene=this._runningScene=null;this._scenesStack.length=0;this.stopAnimation();this.purgeCachedData();
cc.checkGLErrorDebug()},pushScene:function(a){cc.assert(a,cc._LogInfos.Director_pushScene);this._sendCleanupToScene=!1;this._scenesStack.push(a);this._nextScene=a},runScene:function(a){if(cc.assert(a,cc._LogInfos.Director_pushScene),this._runningScene){var b=this._scenesStack.length;0===b?(this._sendCleanupToScene=!0,this._scenesStack[b]=a,this._nextScene=a):(this._sendCleanupToScene=!0,this._scenesStack[b-1]=a,this._nextScene=a)}else this.pushScene(a),this.startAnimation()},resume:function(){this._paused&&
(this.setAnimationInterval(this._oldAnimationInterval),this._lastUpdate=Date.now(),this._lastUpdate||cc.log(cc._LogInfos.Director_resume),this._paused=!1,this._deltaTime=0)},setContentScaleFactor:function(a){a!=this._contentScaleFactor&&(this._contentScaleFactor=a,this._createStatsLabel())},setDepthTest:null,setDefaultValues:function(){},setNextDeltaTimeZero:function(a){this._nextDeltaTimeZero=a},setNextScene:function(){var a=!1,b=!1;(cc.TransitionScene&&(a=this._runningScene?this._runningScene instanceof
cc.TransitionScene:!1,b=this._nextScene?this._nextScene instanceof cc.TransitionScene:!1),b)||((b=this._runningScene)&&(b.onExitTransitionDidStart(),b.onExit()),this._sendCleanupToScene&&b&&b.cleanup());this._runningScene=this._nextScene;this._nextScene=null;a||null==this._runningScene||(this._runningScene.onEnter(),this._runningScene.onEnterTransitionDidFinish())},setNotificationNode:function(a){this._notificationNode=a},getDelegate:function(){return this._projectionDelegate},setDelegate:function(a){this._projectionDelegate=
a},setOpenGLView:null,setProjection:null,setViewport:null,getOpenGLView:null,getProjection:null,setAlphaBlending:null,_showStats:function(){this._frames++;this._accumDt+=this._deltaTime;this._FPSLabel&&this._SPFLabel&&this._drawsLabel?(this._accumDt>cc.DIRECTOR_FPS_INTERVAL&&(this._SPFLabel.string=this._secondsPerFrame.toFixed(3),this._frameRate=this._frames/this._accumDt,this._frames=0,this._accumDt=0,this._FPSLabel.string=this._frameRate.toFixed(1),this._drawsLabel.string=(0|cc.g_NumberOfDraws).toString()),
this._FPSLabel.visit(),this._SPFLabel.visit(),this._drawsLabel.visit()):this._createStatsLabel();cc.g_NumberOfDraws=0},isSendCleanupToScene:function(){return this._sendCleanupToScene},getRunningScene:function(){return this._runningScene},getAnimationInterval:function(){return this._animationInterval},isDisplayStats:function(){return this._displayStats},setDisplayStats:function(a){this._displayStats=a},getSecondsPerFrame:function(){return this._secondsPerFrame},isNextDeltaTimeZero:function(){return this._nextDeltaTimeZero},
isPaused:function(){return this._paused},getTotalFrames:function(){return this._totalFrames},popToRootScene:function(){this.popToSceneStackLevel(1)},popToSceneStackLevel:function(a){cc.assert(this._runningScene,cc._LogInfos.Director_popToSceneStackLevel_2);var b=this._scenesStack,c=b.length;if(0==c)return void this.end();if(!(a>c)){for(;c>a;){var d=b.pop();d.running&&(d.onExitTransitionDidStart(),d.onExit());d.cleanup();c--}this._nextScene=b[b.length-1];this._sendCleanupToScene=!1}},getScheduler:function(){return this._scheduler},
setScheduler:function(a){this._scheduler!=a&&(this._scheduler=a)},getActionManager:function(){return this._actionManager},setActionManager:function(a){this._actionManager!=a&&(this._actionManager=a)},getDeltaTime:function(){return this._deltaTime},_createStatsLabel:null,_calculateMPF:function(){this._secondsPerFrame=(Date.now()-this._lastUpdate)/1E3}}),cc.Director.EVENT_PROJECTION_CHANGED="director_projection_changed",cc.Director.EVENT_AFTER_DRAW="director_after_draw",cc.Director.EVENT_AFTER_VISIT=
"director_after_visit",cc.Director.EVENT_AFTER_UPDATE="director_after_update",cc.DisplayLinkDirector=cc.Director.extend({invalid:!1,startAnimation:function(){this._nextDeltaTimeZero=!0;this.invalid=!1},mainLoop:function(){this._purgeDirectorInNextLoop?(this._purgeDirectorInNextLoop=!1,this.purgeDirector()):this.invalid||this.drawScene()},stopAnimation:function(){this.invalid=!0},setAnimationInterval:function(a){this._animationInterval=a;this.invalid||(this.stopAnimation(),this.startAnimation())}}),
cc.Director.sharedDirector=null,cc.Director.firstUseDirector=!0,cc.Director._getInstance=function(){return cc.Director.firstUseDirector&&(cc.Director.firstUseDirector=!1,cc.Director.sharedDirector=new cc.DisplayLinkDirector,cc.Director.sharedDirector.init()),cc.Director.sharedDirector},cc.defaultFPS=60,cc.Director.PROJECTION_2D=0,cc.Director.PROJECTION_3D=1,cc.Director.PROJECTION_CUSTOM=3,cc.Director.PROJECTION_DEFAULT=cc.Director.PROJECTION_3D,cc._renderType===cc._RENDER_TYPE_CANVAS)?(_p=cc.Director.prototype,
_p.setProjection=function(a){this._projection=a;cc.eventManager.dispatchEvent(this._eventProjectionChanged)},_p.setDepthTest=function(){},_p.setOpenGLView=function(a){this._winSizeInPoints.width=cc._canvas.width;this._winSizeInPoints.height=cc._canvas.height;this._openGLView=a||cc.view;cc.eventManager&&cc.eventManager.setEnabled(!0)},_p._clear=function(){var a=this._openGLView.getViewPortRect();cc._renderContext.clearRect(-a.x,a.y,a.width,-a.height)},_p._createStatsLabel=function(){var a=0,a=this._winSizeInPoints.width>
this._winSizeInPoints.height?0|this._winSizeInPoints.height/320*24:0|this._winSizeInPoints.width/320*24;this._FPSLabel=cc.LabelTTF.create("000.0","Arial",a);this._SPFLabel=cc.LabelTTF.create("0.000","Arial",a);this._drawsLabel=cc.LabelTTF.create("0000","Arial",a);a=cc.DIRECTOR_STATS_POSITION;this._drawsLabel.setPosition(this._drawsLabel.width/2+a.x,5*this._drawsLabel.height/2+a.y);this._SPFLabel.setPosition(this._SPFLabel.width/2+a.x,3*this._SPFLabel.height/2+a.y);this._FPSLabel.setPosition(this._FPSLabel.width/
2+a.x,this._FPSLabel.height/2+a.y)},_p.getVisibleSize=function(){return this.getWinSize()},_p.getVisibleOrigin=function(){return cc.p(0,0)}):(cc.Director._fpsImage=new Image,cc._addEventListener(cc.Director._fpsImage,"load",function(){cc.Director._fpsImageLoaded=!0}),cc._fpsImage&&(cc.Director._fpsImage.src=cc._fpsImage),cc.assert("function"==typeof cc._tmp.DirectorWebGL,cc._LogInfos.MissingFile,"CCDirectorWebGL.js"),cc._tmp.DirectorWebGL(),delete cc._tmp.DirectorWebGL);
(cc.PRIORITY_NON_SYSTEM=cc.PRIORITY_SYSTEM+1,cc.ListEntry=function(a,b,c,d,e,f){this.prev=a;this.next=b;this.target=c;this.priority=d;this.paused=e;this.markedForDeletion=f},cc.HashUpdateEntry=function(a,b,c,d){this.list=a;this.entry=b;this.target=c;this.hh=d},cc.HashTimerEntry=function(a,b,c,d,e,f,g){this.timers=a;this.target=b;this.timerIndex=c;this.currentTimer=d;this.currentTimerSalvaged=e;this.paused=f;this.hh=g},cc.Timer=cc.Class.extend({_interval:0,_callback:null,_target:null,_elapsed:0,_runForever:!1,
_useDelay:!1,_timesExecuted:0,_repeat:0,_delay:0,getInterval:function(){return this._interval},setInterval:function(a){this._interval=a},getCallback:function(){return this._callback},ctor:function(a,b,c,d,e){this._target=a;this._callback=b;this._elapsed=-1;this._interval=c||0;this._delay=e||0;this._useDelay=0<this._delay;this._repeat=null==d?cc.REPEAT_FOREVER:d;this._runForever=this._repeat==cc.REPEAT_FOREVER},_doCallback:function(){"string"==typeof this._callback?this._target[this._callback](this._elapsed):
this._callback.call(this._target,this._elapsed)},update:function(a){if(-1==this._elapsed)this._timesExecuted=this._elapsed=0;else{var b=this._target,c=this._callback;this._elapsed+=a;this._runForever&&!this._useDelay?this._elapsed>=this._interval&&(b&&c&&this._doCallback(),this._elapsed=0):(this._useDelay?this._elapsed>=this._delay&&(b&&c&&this._doCallback(),this._elapsed-=this._delay,this._timesExecuted+=1,this._useDelay=!1):this._elapsed>=this._interval&&(b&&c&&this._doCallback(),this._elapsed=
0,this._timesExecuted+=1),this._timesExecuted>this._repeat&&cc.director.getScheduler().unscheduleCallbackForTarget(b,c))}}}),cc.Scheduler=cc.Class.extend({_timeScale:1,_updates:null,_hashForUpdates:null,_arrayForUpdates:null,_hashForTimers:null,_arrayForTimes:null,_currentTarget:null,_currentTargetSalvaged:!1,_updateHashLocked:!1,ctor:function(){this._timeScale=1;this._updates=[[],[],[]];this._hashForUpdates={};this._arrayForUpdates=[];this._hashForTimers={};this._arrayForTimers=[];this._currentTarget=
null;this._updateHashLocked=this._currentTargetSalvaged=!1},_removeHashElement:function(a){delete this._hashForTimers[a.target.__instanceId];cc.arrayRemoveObject(this._arrayForTimers,a);a.Timer=null;a.target=null},_removeUpdateFromHash:function(a){(a=this._hashForUpdates[a.target.__instanceId])&&(cc.arrayRemoveObject(a.list,a.entry),delete this._hashForUpdates[a.target.__instanceId],cc.arrayRemoveObject(this._arrayForUpdates,a),a.entry=null,a.target=null)},_priorityIn:function(a,b,c,d){d=new cc.ListEntry(null,
null,b,c,d,!1);if(a){for(var e=a.length-1,f=0;e>=f&&!(c<a[f].priority);f++);a.splice(f,0,d)}else a=[],a.push(d);c=new cc.HashUpdateEntry(a,d,b,null);return this._arrayForUpdates.push(c),this._hashForUpdates[b.__instanceId]=c,a},_appendIn:function(a,b,c){c=new cc.ListEntry(null,null,b,0,c,!1);a.push(c);a=new cc.HashUpdateEntry(a,c,b,null);this._arrayForUpdates.push(a);this._hashForUpdates[b.__instanceId]=a},setTimeScale:function(a){this._timeScale=a},getTimeScale:function(){return this._timeScale},
update:function(a){var b,c,d,e,f=this._updates,g=this._arrayForTimers;this._updateHashLocked=!0;1!=this._timeScale&&(a*=this._timeScale);d=0;for(e=f.length;e>d&&0<=d;d++)for(var h=this._updates[d],k=0,m=h.length;m>k;k++)b=h[k],b.paused||b.markedForDeletion||b.target.update(a);d=0;for(e=g.length;e>d&&(c=g[d],c);d++){if(this._currentTarget=c,this._currentTargetSalvaged=!1,!c.paused)for(c.timerIndex=0;c.timerIndex<c.timers.length;c.timerIndex++)c.currentTimer=c.timers[c.timerIndex],c.currentTimerSalvaged=
!1,c.currentTimer.update(a),c.currentTimer=null;this._currentTargetSalvaged&&0==c.timers.length&&(this._removeHashElement(c),d--)}d=0;for(e=f.length;e>d;d++)for(h=this._updates[d],k=0,m=h.length;m>k&&(b=h[k],b);)b.markedForDeletion?this._removeUpdateFromHash(b):k++;this._updateHashLocked=!1;this._currentTarget=null},scheduleCallbackForTarget:function(a,b,c,d,e,f){cc.assert(b,cc._LogInfos.Scheduler_scheduleCallbackForTarget_2);cc.assert(a,cc._LogInfos.Scheduler_scheduleCallbackForTarget_3);c=c||0;
d=null==d?cc.REPEAT_FOREVER:d;e=e||0;var g,h=this._hashForTimers[a.__instanceId];if(h||(h=new cc.HashTimerEntry(null,a,0,null,null,f||!1,null),this._arrayForTimers.push(h),this._hashForTimers[a.__instanceId]=h),null==h.timers)h.timers=[];else for(f=0;f<h.timers.length;f++)if(g=h.timers[f],b==g._callback)return cc.log(cc._LogInfos.Scheduler_scheduleCallbackForTarget,g.getInterval().toFixed(4),c.toFixed(4)),void(g._interval=c);g=new cc.Timer(a,b,c,d,e);h.timers.push(g)},scheduleUpdateForTarget:function(a,
b,c){if(null!==a){var d=this._updates,e=this._hashForUpdates[a.__instanceId];return e?void(e.entry.markedForDeletion=!1):void(0==b?this._appendIn(d[1],a,c):0>b?d[0]=this._priorityIn(d[0],a,b,c):d[2]=this._priorityIn(d[2],a,b,c))}},unscheduleCallbackForTarget:function(a,b){if(null!=a&&null!=b){var c=this._hashForTimers[a.__instanceId];if(c)for(var d=c.timers,e=0,f=d.length;f>e;e++){var g=d[e];if(b==g._callback)return g!=c.currentTimer||c.currentTimerSalvaged||(c.currentTimerSalvaged=!0),d.splice(e,
1),c.timerIndex>=e&&c.timerIndex--,void(0==d.length&&(this._currentTarget==c?this._currentTargetSalvaged=!0:this._removeHashElement(c)))}}},unscheduleUpdateForTarget:function(a){null!=a&&(a=this._hashForUpdates[a.__instanceId],null!=a&&(this._updateHashLocked?a.entry.markedForDeletion=!0:this._removeUpdateFromHash(a.entry)))},unscheduleAllCallbacksForTarget:function(a){if(null!=a){var b=this._hashForTimers[a.__instanceId];if(b){var c=b.timers;!b.currentTimerSalvaged&&0<=c.indexOf(b.currentTimer)&&
(b.currentTimerSalvaged=!0);c.length=0;this._currentTarget==b?this._currentTargetSalvaged=!0:this._removeHashElement(b)}this.unscheduleUpdateForTarget(a)}},unscheduleAllCallbacks:function(){this.unscheduleAllCallbacksWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},unscheduleAllCallbacksWithMinPriority:function(a){for(var b=this._arrayForTimers,c=this._updates,d=0,e=b.length;e>d;d++)this.unscheduleAllCallbacksForTarget(b[d].target);for(d=2;0<=d;d--)if(!(1==d&&0<a||0==d&&0<=a))for(var b=c[d],e=0,f=b.length;f>
e;e++)this.unscheduleUpdateForTarget(b[e].target)},pauseAllTargets:function(){return this.pauseAllTargetsWithMinPriority(cc.Scheduler.PRIORITY_SYSTEM)},pauseAllTargetsWithMinPriority:function(){for(var a,b=[],c=this._arrayForTimers,d=this._updates,e=0,f=c.length;f>e;e++)(a=c[e])&&(a.paused=!0,b.push(a.target));e=0;for(f=d.length;f>e;e++)for(var c=d[e],g=0,h=c.length;h>g;g++)(a=c[g])&&(a.paused=!0,b.push(a.target));return b},resumeTargets:function(a){if(a)for(var b=0;b<a.length;b++)this.resumeTarget(a[b])},
pauseTarget:function(a){cc.assert(a,cc._LogInfos.Scheduler_pauseTarget);var b=this._hashForTimers[a.__instanceId];b&&(b.paused=!0);(a=this._hashForUpdates[a.__instanceId])&&(a.entry.paused=!0)},resumeTarget:function(a){cc.assert(a,cc._LogInfos.Scheduler_resumeTarget);var b=this._hashForTimers[a.__instanceId];b&&(b.paused=!1);(a=this._hashForUpdates[a.__instanceId])&&(a.entry.paused=!1)},isTargetPaused:function(a){cc.assert(a,cc._LogInfos.Scheduler_isTargetPaused);return(a=this._hashForTimers[a.__instanceId])?
a.paused:!1}}),cc.Scheduler.PRIORITY_SYSTEM=-2147483648,cc._tmp.PrototypeLabelTTF=function(){var a=cc.LabelTTF.prototype;cc.defineGetterSetter(a,"color",a.getColor,a.setColor);cc.defineGetterSetter(a,"opacity",a.getOpacity,a.setOpacity);a.string;cc.defineGetterSetter(a,"string",a.getString,a.setString);a.textAlign;cc.defineGetterSetter(a,"textAlign",a.getHorizontalAlignment,a.setHorizontalAlignment);a.verticalAlign;cc.defineGetterSetter(a,"verticalAlign",a.getVerticalAlignment,a.setVerticalAlignment);
a.fontSize;cc.defineGetterSetter(a,"fontSize",a.getFontSize,a.setFontSize);a.fontName;cc.defineGetterSetter(a,"fontName",a.getFontName,a.setFontName);a.font;cc.defineGetterSetter(a,"font",a._getFont,a._setFont);a.boundingSize;a.boundingWidth;cc.defineGetterSetter(a,"boundingWidth",a._getBoundingWidth,a._setBoundingWidth);a.boundingHeight;cc.defineGetterSetter(a,"boundingHeight",a._getBoundingHeight,a._setBoundingHeight);a.fillStyle;cc.defineGetterSetter(a,"fillStyle",a._getFillStyle,a.setFontFillColor);
a.strokeStyle;cc.defineGetterSetter(a,"strokeStyle",a._getStrokeStyle,a._setStrokeStyle);a.lineWidth;cc.defineGetterSetter(a,"lineWidth",a._getLineWidth,a._setLineWidth);a.shadowOffset;a.shadowOffsetX;cc.defineGetterSetter(a,"shadowOffsetX",a._getShadowOffsetX,a._setShadowOffsetX);a.shadowOffsetY;cc.defineGetterSetter(a,"shadowOffsetY",a._getShadowOffsetY,a._setShadowOffsetY);a.shadowOpacity;cc.defineGetterSetter(a,"shadowOpacity",a._getShadowOpacity,a._setShadowOpacity);a.shadowBlur;cc.defineGetterSetter(a,
"shadowBlur",a._getShadowBlur,a._setShadowBlur)},cc.LabelTTF=cc.Sprite.extend({_dimensions:null,_hAlignment:cc.TEXT_ALIGNMENT_CENTER,_vAlignment:cc.VERTICAL_TEXT_ALIGNMENT_TOP,_fontName:null,_fontSize:0,_string:"",_originalText:null,_isMultiLine:!1,_fontStyleStr:null,_shadowEnabled:!1,_shadowOffset:null,_shadowOpacity:0,_shadowBlur:0,_shadowColorStr:null,_strokeEnabled:!1,_strokeColor:null,_strokeSize:0,_strokeColorStr:null,_textFillColor:null,_fillColorStr:null,_strokeShadowOffsetX:0,_strokeShadowOffsetY:0,
_needUpdateTexture:!1,_labelCanvas:null,_labelContext:null,_lineWidths:null,_className:"LabelTTF",initWithString:function(a,b,c,d,e,f){var g;return g=a?a+"":"",c=c||16,d=d||cc.size(0,0),e=e||cc.TEXT_ALIGNMENT_LEFT,f=f||cc.VERTICAL_TEXT_ALIGNMENT_TOP,this._opacityModifyRGB=!1,this._dimensions=cc.size(d.width,d.height),this._fontName=b||"Arial",this._hAlignment=e,this._vAlignment=f,this._fontSize=c,this._fontStyleStr=this._fontSize+"px '"+b+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(b,
this._fontSize),this.string=g,this._setColorsString(),this._updateTexture(),this._needUpdateTexture=!1,!0},ctor:function(a,b,c,d,e,f){cc.Sprite.prototype.ctor.call(this);this._dimensions=cc.size(0,0);this._hAlignment=cc.TEXT_ALIGNMENT_LEFT;this._vAlignment=cc.VERTICAL_TEXT_ALIGNMENT_TOP;this._opacityModifyRGB=!1;this._fontStyleStr="";this._fontName="Arial";this._shadowEnabled=this._isMultiLine=!1;this._shadowOffset=cc.p(0,0);this._shadowBlur=this._shadowOpacity=0;this._shadowColorStr="rgba(128, 128, 128, 0.5)";
this._strokeEnabled=!1;this._strokeColor=cc.color(255,255,255,255);this._strokeSize=0;this._strokeColorStr="";this._textFillColor=cc.color(255,255,255,255);this._fillColorStr="rgba(255,255,255,1)";this._strokeShadowOffsetY=this._strokeShadowOffsetX=0;this._needUpdateTexture=!1;this._lineWidths=[];this._setColorsString();b&&b instanceof cc.FontDefinition?this.initWithStringAndTextDefinition(a,b):cc.LabelTTF.prototype.initWithString.call(this,a,b,c,d,e,f)},init:function(){return this.initWithString(" ",
this._fontName,this._fontSize)},_measureConfig:function(){this._getLabelContext().font=this._fontStyleStr},_measure:function(a){return this._getLabelContext().measureText(a).width},description:function(){return"<cc.LabelTTF | FontName ="+this._fontName+" FontSize = "+this._fontSize.toFixed(1)+">"},setColor:null,_setColorsString:null,updateDisplayedColor:null,setOpacity:null,updateDisplayedOpacity:null,updateDisplayedOpacityForCanvas:function(a){cc.Node.prototype.updateDisplayedOpacity.call(this,a);
this._setColorsString()},getString:function(){return this._string},getHorizontalAlignment:function(){return this._hAlignment},getVerticalAlignment:function(){return this._vAlignment},getDimensions:function(){return cc.size(this._dimensions)},getFontSize:function(){return this._fontSize},getFontName:function(){return this._fontName},initWithStringAndTextDefinition:null,setTextDefinition:function(a){a&&this._updateWithTextDefinition(a,!0)},getTextDefinition:function(){return this._prepareTextDefinition(!1)},
enableShadow:function(a,b,c,d){c=c||.5;!1===this._shadowEnabled&&(this._shadowEnabled=!0);var e=this._shadowOffset;(e&&e.x!=a||e._y!=b)&&(e.x=a,e.y=b);this._shadowOpacity!=c&&(this._shadowOpacity=c);this._setColorsString();this._shadowBlur!=d&&(this._shadowBlur=d);this._needUpdateTexture=!0},_getShadowOffsetX:function(){return this._shadowOffset.x},_setShadowOffsetX:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset.x!=a&&(this._shadowOffset.x=a,this._needUpdateTexture=
!0)},_getShadowOffsetY:function(){return this._shadowOffset._y},_setShadowOffsetY:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOffset._y!=a&&(this._shadowOffset._y=a,this._needUpdateTexture=!0)},_getShadowOffset:function(){return cc.p(this._shadowOffset.x,this._shadowOffset.y)},_setShadowOffset:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);(this._shadowOffset.x!=a.x||this._shadowOffset.y!=a.y)&&(this._shadowOffset.x=a.x,this._shadowOffset.y=a.y,this._needUpdateTexture=
!0)},_getShadowOpacity:function(){return this._shadowOpacity},_setShadowOpacity:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowOpacity!=a&&(this._shadowOpacity=a,this._setColorsString(),this._needUpdateTexture=!0)},_getShadowBlur:function(){return this._shadowBlur},_setShadowBlur:function(a){!1===this._shadowEnabled&&(this._shadowEnabled=!0);this._shadowBlur!=a&&(this._shadowBlur=a,this._needUpdateTexture=!0)},disableShadow:function(){this._shadowEnabled&&(this._shadowEnabled=
!1,this._needUpdateTexture=!0)},enableStroke:function(a,b){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var c=this._strokeColor;c.r===a.r&&c.g===a.g&&c.b===a.b||(c.r=a.r,c.g=a.g,c.b=a.b,this._setColorsString());this._strokeSize!==b&&(this._strokeSize=b||0);this._needUpdateTexture=!0},_getStrokeStyle:function(){return this._strokeColor},_setStrokeStyle:function(a){!1===this._strokeEnabled&&(this._strokeEnabled=!0);var b=this._strokeColor;(b.r!==a.r||b.g!==a.g||b.b!==a.b)&&(b.r=a.r,b.g=a.g,b.b=
a.b,this._setColorsString(),this._needUpdateTexture=!0)},_getLineWidth:function(){return this._strokeSize},_setLineWidth:function(a){!1===this._strokeEnabled&&(this._strokeEnabled=!0);this._strokeSize!==a&&(this._strokeSize=a||0,this._needUpdateTexture=!0)},disableStroke:function(){this._strokeEnabled&&(this._strokeEnabled=!1,this._needUpdateTexture=!0)},setFontFillColor:null,_getFillStyle:function(){return this._textFillColor},_updateWithTextDefinition:function(a,b){a.fontDimensions?(this._dimensions.width=
a.boundingWidth,this._dimensions.height=a.boundingHeight):(this._dimensions.width=0,this._dimensions.height=0);this._hAlignment=a.textAlign;this._vAlignment=a.verticalAlign;this._fontName=a.fontName;this._fontSize=a.fontSize||12;this._fontStyleStr=this._fontSize+"px '"+this._fontName+"'";this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(this._fontName,this._fontSize);a.shadowEnabled&&this.enableShadow(a.shadowOffsetX,a.shadowOffsetY,a.shadowOpacity,a.shadowBlur);a.strokeEnabled&&this.enableStroke(a.strokeStyle,
a.lineWidth);this.setFontFillColor(a.fillStyle);b&&this._updateTexture()},_prepareTextDefinition:function(a){var b=new cc.FontDefinition;if(a?(b.fontSize=this._fontSize,b.boundingWidth=cc.contentScaleFactor()*this._dimensions.width,b.boundingHeight=cc.contentScaleFactor()*this._dimensions.height):(b.fontSize=this._fontSize,b.boundingWidth=this._dimensions.width,b.boundingHeight=this._dimensions.height),b.fontName=this._fontName,b.textAlign=this._hAlignment,b.verticalAlign=this._vAlignment,this._strokeEnabled){b.strokeEnabled=
!0;var c=this._strokeColor;b.strokeStyle=cc.color(c.r,c.g,c.b);b.lineWidth=this._strokeSize}else b.strokeEnabled=!1;this._shadowEnabled?(b.shadowEnabled=!0,b.shadowBlur=this._shadowBlur,b.shadowOpacity=this._shadowOpacity,b.shadowOffsetX=(a?cc.contentScaleFactor():1)*this._shadowOffset.x,b.shadowOffsetY=(a?cc.contentScaleFactor():1)*this._shadowOffset.y):b._shadowEnabled=!1;a=this._textFillColor;return b.fillStyle=cc.color(a.r,a.g,a.b),b},_fontClientHeight:18,setString:function(a){a=String(a);this._originalText!=
a&&(this._originalText=a+"",this._updateString(),this._needUpdateTexture=!0)},_updateString:function(){this._string=this._originalText},setHorizontalAlignment:function(a){a!==this._hAlignment&&(this._hAlignment=a,this._needUpdateTexture=!0)},setVerticalAlignment:function(a){a!=this._vAlignment&&(this._vAlignment=a,this._needUpdateTexture=!0)},setDimensions:function(a,b){var c;void 0===b?(c=a.width,b=a.height):c=a;(c!=this._dimensions.width||b!=this._dimensions.height)&&(this._dimensions.width=c,this._dimensions.height=
b,this._updateString(),this._needUpdateTexture=!0)},_getBoundingWidth:function(){return this._dimensions.width},_setBoundingWidth:function(a){a!=this._dimensions.width&&(this._dimensions.width=a,this._updateString(),this._needUpdateTexture=!0)},_getBoundingHeight:function(){return this._dimensions.height},_setBoundingHeight:function(a){a!=this._dimensions.height&&(this._dimensions.height=a,this._updateString(),this._needUpdateTexture=!0)},setFontSize:function(a){this._fontSize!==a&&(this._fontSize=
a,this._fontStyleStr=a+"px '"+this._fontName+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(this._fontName,a),this._needUpdateTexture=!0)},setFontName:function(a){this._fontName&&this._fontName!=a&&(this._fontName=a,this._fontStyleStr=this._fontSize+"px '"+a+"'",this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(a,this._fontSize),this._needUpdateTexture=!0)},_getFont:function(){return this._fontStyleStr},_setFont:function(a){var b=cc.LabelTTF._fontStyleRE.exec(a);b&&(this._fontSize=
parseInt(b[1]),this._fontName=b[2],this._fontStyleStr=a,this._fontClientHeight=cc.LabelTTF.__getFontHeightByDiv(this._fontName,this._fontSize),this._needUpdateTexture=!0)},_drawTTFInCanvas:function(a){if(a){var b=this._strokeShadowOffsetX,c=this._strokeShadowOffsetY,d=this._contentSize.height-c,e=this._vAlignment,f=this._hAlignment,g=this._fontClientHeight,h=this._strokeSize;a.setTransform(1,0,0,1,0+.5*b,d+.5*c);a.font!=this._fontStyleStr&&(a.font=this._fontStyleStr);a.fillStyle=this._fillColorStr;
var k=c=0,m=this._strokeEnabled;if(m&&(a.lineWidth=2*h,a.strokeStyle=this._strokeColorStr),this._shadowEnabled)h=this._shadowOffset,a.shadowColor=this._shadowColorStr,a.shadowOffsetX=h.x,a.shadowOffsetY=-h.y,a.shadowBlur=this._shadowBlur;a.textBaseline=cc.LabelTTF._textBaseline[e];a.textAlign=cc.LabelTTF._textAlign[f];b=this._contentSize.width-b;if(c+=f===cc.TEXT_ALIGNMENT_RIGHT?b:f===cc.TEXT_ALIGNMENT_CENTER?b/2:0,this._isMultiLine)for(f=this._strings.length,e===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?
k=g+d-g*f:e===cc.VERTICAL_TEXT_ALIGNMENT_CENTER&&(k=g/2+(d-g*f)/2),e=0;f>e;e++)b=this._strings[e],h=-d+g*e+k,m&&a.strokeText(b,c,h),a.fillText(b,c,h);else e===cc.VERTICAL_TEXT_ALIGNMENT_BOTTOM?(m&&a.strokeText(this._string,c,k),a.fillText(this._string,c,k)):e===cc.VERTICAL_TEXT_ALIGNMENT_TOP?(k-=d,m&&a.strokeText(this._string,c,k),a.fillText(this._string,c,k)):(k-=.5*d,m&&a.strokeText(this._string,c,k),a.fillText(this._string,c,k))}},_getLabelContext:function(){if(this._labelContext)return this._labelContext;
if(!this._labelCanvas){var a=cc.newElement("canvas"),b=new cc.Texture2D;b.initWithElement(a);this.texture=b;this._labelCanvas=a}return this._labelContext=this._labelCanvas.getContext("2d"),this._labelContext},_checkWarp:function(a,b,c){var d=a[b],e=this._measure(d);if(e>c&&1<d.length){for(var f,g=c/e*d.length|0,h=d.substr(g),k=e-this._measure(h),m=0,n=0;k>c&&100>n++;)g*=c/k,g|=0,h=d.substr(g),k=e-this._measure(h);for(n=0;c>k&&100>n++;)h&&(m=(f=cc.LabelTTF._wordRex.exec(h))?f[0].length:1,f=h),g+=m,
h=d.substr(g),k=e-this._measure(h);g-=m;c=d.substr(0,g);cc.LabelTTF.wrapInspection&&cc.LabelTTF._symbolRex.test(f||h)&&(e=cc.LabelTTF._lastWordRex.exec(c),g-=e?e[0].length:0,f=d.substr(g),c=d.substr(0,g));cc.LabelTTF._firsrEnglish.test(f)&&(e=cc.LabelTTF._lastEnglish.exec(c))&&c!==e[0]&&(g-=e[0].length,f=d.substr(g),c=d.substr(0,g));a[b]=f||h;a.splice(b,0,c)}},_updateTTF:function(){var a,b,c=this._dimensions.width,d=this._lineWidths;if(d.length=0,this._isMultiLine=!1,this._measureConfig(),0!==c)for(this._strings=
this._string.split("\n"),a=0;a<this._strings.length;a++)this._checkWarp(this._strings,a,c);else for(this._strings=this._string.split("\n"),a=0,b=this._strings.length;b>a;a++)d.push(this._measure(this._strings[a]));0<this._strings.length&&(this._isMultiLine=!0);b=a=0;if(this._strokeEnabled&&(a=b=2*this._strokeSize),this._shadowEnabled){var e=this._shadowOffset;a+=2*Math.abs(e.x);b+=2*Math.abs(e.y)}c=0===c?this._isMultiLine?cc.size(0|Math.max.apply(Math,d)+a,0|this._fontClientHeight*this._strings.length+
b):cc.size(0|this._measure(this._string)+a,0|this._fontClientHeight+b):0===this._dimensions.height?this._isMultiLine?cc.size(0|c+a,0|this._fontClientHeight*this._strings.length+b):cc.size(0|c+a,0|this._fontClientHeight+b):cc.size(0|c+a,0|this._dimensions.height+b);this.setContentSize(c);this._strokeShadowOffsetX=a;this._strokeShadowOffsetY=b;d=this._anchorPoint;this._anchorPointInPoints.x=.5*a+(c.width-a)*d.x;this._anchorPointInPoints.y=.5*b+(c.height-b)*d.y},getContentSize:function(){return this._needUpdateTexture&&
this._updateTTF(),cc.Sprite.prototype.getContentSize.call(this)},_getWidth:function(){return this._needUpdateTexture&&this._updateTTF(),cc.Sprite.prototype._getWidth.call(this)},_getHeight:function(){return this._needUpdateTexture&&this._updateTTF(),cc.Sprite.prototype._getHeight.call(this)},_updateTexture:function(){var a=this._getLabelContext(),b=this._labelCanvas,c=this._contentSize;if(0===this._string.length)return b.width=1,b.height=c.height||1,this._texture&&this._texture.handleLoadedTexture(),
this.setTextureRect(cc.rect(0,0,1,c.height)),!0;a.font=this._fontStyleStr;this._updateTTF();var d=c.width,c=c.height,e=b.width==d&&b.height==c;return b.width=d,b.height=c,e&&a.clearRect(0,0,d,c),this._drawTTFInCanvas(a),this._texture&&this._texture.handleLoadedTexture(),this.setTextureRect(cc.rect(0,0,d,c)),!0},visit:function(a){this._string&&""!=this._string&&(this._needUpdateTexture&&(this._needUpdateTexture=!1,this._updateTexture()),cc.Sprite.prototype.visit.call(this,a||cc._renderContext))},draw:null,
_setTextureCoords:function(a){var b=this._batchNode?this.textureAtlas.texture:this._texture;if(b){var c,d,e,f,g,h=b.pixelsWidth,b=b.pixelsHeight,k=this._quad;this._rectRotated?(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(c=(2*a.x+1)/(2*h),d=c+(2*a.height-2)/(2*h),e=(2*a.y+1)/(2*b),f=e+(2*a.width-2)/(2*b)):(c=a.x/h,d=(a.x+a.height)/h,e=a.y/b,f=(a.y+a.width)/b),this._flippedX&&(g=e,e=f,f=g),this._flippedY&&(g=c,c=d,d=g),k.bl.texCoords.u=c,k.bl.texCoords.v=e,k.br.texCoords.u=c,k.br.texCoords.v=f,k.tl.texCoords.u=
d,k.tl.texCoords.v=e,k.tr.texCoords.u=d,k.tr.texCoords.v=f):(cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(c=(2*a.x+1)/(2*h),d=c+(2*a.width-2)/(2*h),e=(2*a.y+1)/(2*b),f=e+(2*a.height-2)/(2*b)):(c=a.x/h,d=(a.x+a.width)/h,e=a.y/b,f=(a.y+a.height)/b),this._flippedX&&(g=c,c=d,d=g),this._flippedY&&(g=e,e=f,f=g),k.bl.texCoords.u=c,k.bl.texCoords.v=f,k.br.texCoords.u=d,k.br.texCoords.v=f,k.tl.texCoords.u=c,k.tl.texCoords.v=e,k.tr.texCoords.u=d,k.tr.texCoords.v=e);this._quadDirty=!0}}}),cc._renderType===cc._RENDER_TYPE_CANVAS)?
(_p=cc.LabelTTF.prototype,_p.setColor=function(a){cc.Node.prototype.setColor.call(this,a);this._setColorsString()},_p._setColorsString=function(){this._needUpdateTexture=!0;var a=this._displayedColor,b=this._displayedOpacity,c=this._strokeColor,d=this._textFillColor;this._shadowColorStr="rgba("+(0|.5*a.r)+","+(0|.5*a.g)+","+(0|.5*a.b)+","+this._shadowOpacity+")";this._fillColorStr="rgba("+(0|a.r/255*d.r)+","+(0|a.g/255*d.g)+","+(0|a.b/255*d.b)+", "+b/255+")";this._strokeColorStr="rgba("+(0|a.r/255*
c.r)+","+(0|a.g/255*c.g)+","+(0|a.b/255*c.b)+", "+b/255+")"},_p.updateDisplayedColor=function(a){cc.Node.prototype.updateDisplayedColor.call(this,a);this._setColorsString()},_p.setOpacity=function(a){this._opacity!==a&&(cc.Sprite.prototype.setOpacity.call(this,a),this._setColorsString(),this._needUpdateTexture=!0)},_p.updateDisplayedOpacity=cc.Sprite.prototype.updateDisplayedOpacity,_p.initWithStringAndTextDefinition=function(a,b){return this._updateWithTextDefinition(b,!1),this.string=a,!0},_p.setFontFillColor=
function(a){var b=this._textFillColor;(b.r!=a.r||b.g!=a.g||b.b!=a.b)&&(b.r=a.r,b.g=a.g,b.b=a.b,this._setColorsString(),this._needUpdateTexture=!0)},_p.draw=cc.Sprite.prototype.draw,_p.setTextureRect=function(a,b,c){this._rectRotated=b||!1;this.setContentSize(c||a);this.setVertexRect(a);b=this._textureRect_Canvas;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;b.validRect=!(0===b.width||0===b.height||0>b.x||0>b.y);a=this._unflippedOffsetPositionFromCenter;this._flippedX&&(a.x=-a.x);this._flippedY&&
(a.y=-a.y);this._offsetPosition.x=a.x+(this._contentSize.width-this._rect.width)/2;this._offsetPosition.y=a.y+(this._contentSize.height-this._rect.height)/2;this._batchNode&&(this.dirty=!0)},_p=null):(cc.assert("function"==typeof cc._tmp.WebGLLabelTTF,cc._LogInfos.MissingFile,"LabelTTFWebGL.js"),cc._tmp.WebGLLabelTTF(),delete cc._tmp.WebGLLabelTTF);cc.assert("function"==typeof cc._tmp.PrototypeLabelTTF,cc._LogInfos.MissingFile,"LabelTTFPropertyDefine.js");cc._tmp.PrototypeLabelTTF();delete cc._tmp.PrototypeLabelTTF;
cc.LabelTTF._textAlign=["left","center","right"];cc.LabelTTF._textBaseline=["top","middle","bottom"];cc.LabelTTF.wrapInspection=!0;cc.LabelTTF._wordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)/;cc.LabelTTF._symbolRex=/^[!,.:;}\]%\?>\u3001\u2018\u201c\u300b\uff1f\u3002\uff0c\uff01]/;cc.LabelTTF._lastWordRex=/([a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+|\S)$/;
cc.LabelTTF._lastEnglish=/[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]+$/;cc.LabelTTF._firsrEnglish=/^[a-zA-Z0-9\u00c4\u00d6\u00dc\u00e4\u00f6\u00fc\u00df\u00e9\u00e8\u00e7\u00e0\u00f9\u00ea\u00e2\u00ee\u00f4\u00fb]/;cc.LabelTTF._fontStyleRE=/^(\d+)px\s+['"]?([\w\s\d]+)['"]?$/;cc.LabelTTF.create=function(a,b,c,d,e,f){return new cc.LabelTTF(a,b,c,d,e,f)};cc.LabelTTF.createWithFontDefinition=cc.LabelTTF.create;
cc.LabelTTF._SHADER_PROGRAM=cc.USE_LA88_LABELS?cc.SHADER_POSITION_TEXTURECOLOR:cc.SHADER_POSITION_TEXTUREA8COLOR;cc.LabelTTF.__labelHeightDiv=cc.newElement("div");cc.LabelTTF.__labelHeightDiv.style.fontFamily="Arial";cc.LabelTTF.__labelHeightDiv.style.position="absolute";cc.LabelTTF.__labelHeightDiv.style.left="-100px";cc.LabelTTF.__labelHeightDiv.style.top="-100px";cc.LabelTTF.__labelHeightDiv.style.lineHeight="normal";
document.body?document.body.appendChild(cc.LabelTTF.__labelHeightDiv):cc._addEventListener(window,"load",function(){this.removeEventListener("load",arguments.callee,!1);document.body.appendChild(cc.LabelTTF.__labelHeightDiv)},!1);
cc.LabelTTF.__getFontHeightByDiv=function(a,b){var c=cc.LabelTTF.__fontHeightCache[a+"."+b];if(0<c)return c;var d=cc.LabelTTF.__labelHeightDiv;return d.innerHTML="ajghl~!",d.style.fontFamily=a,d.style.fontSize=b+"px",c=d.clientHeight,cc.LabelTTF.__fontHeightCache[a+"."+b]=c,d.innerHTML="",c};cc.LabelTTF.__fontHeightCache={};cc=cc||{};cc._tmp=cc._tmp||{};cc.associateWithNative=function(){};
cc.KEY={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,escape:27,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,"+":107,"-":109,numdel:110,"/":111,f1:112,f2:113,
f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,scrolllock:145,semicolon:186,",":186,equal:187,"=":187,";":188,comma:188,dash:189,".":190,period:190,forwardslash:191,grave:192,"[":219,openbracket:219,"]":221,closebracket:221,backslash:220,quote:222,space:32};cc.FMT_JPG=0;cc.FMT_PNG=1;cc.FMT_TIFF=2;cc.FMT_RAWDATA=3;cc.FMT_WEBP=4;cc.FMT_UNKNOWN=5;
cc.getImageFormatByData=function(a){return 8<a.length&&137==a[0]&&80==a[1]&&78==a[2]&&71==a[3]&&13==a[4]&&10==a[5]&&26==a[6]&&10==a[7]?cc.FMT_PNG:2<a.length&&(73==a[0]&&73==a[1]||77==a[0]&&77==a[1]||255==a[0]&&216==a[1])?cc.FMT_TIFF:cc.FMT_UNKNOWN};cc.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
cc.base=function(a,b){var c=arguments.callee.caller;if(c.superClass_)return ret=c.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var d=Array.prototype.slice.call(arguments,2),e=!1,f=a.constructor;f;f=f.superClass_&&f.superClass_.constructor)if(f.prototype[b]===c)e=!0;else if(e)return f.prototype[b].apply(a,d);if(a[b]===c)return a.constructor.prototype[b].apply(a,d);throw Error("cc.base called from a method of one name to a method of a different name");};_p=cc.inputManager;
_p.setAccelerometerEnabled=function(a){this._accelEnabled!==a&&(this._accelEnabled=a,a=cc.director.getScheduler(),this._accelEnabled?(this._accelCurTime=0,a.scheduleUpdateForTarget(this)):(this._accelCurTime=0,a.unscheduleUpdateForTarget(this)))};_p.setAccelerometerInterval=function(a){this._accelInterval!==a&&(this._accelInterval=a)};
_p._registerKeyboardEvent=function(){cc._addEventListener(cc._canvas,"keydown",function(a){cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode,!0));a.stopPropagation();a.preventDefault()},!1);cc._addEventListener(cc._canvas,"keyup",function(a){cc.eventManager.dispatchEvent(new cc.EventKeyboard(a.keyCode,!1));a.stopPropagation();a.preventDefault()},!1)};
_p._registerAccelerometerEvent=function(){var a=window;this._acceleration=new cc.Acceleration;this._accelDeviceEvent=a.DeviceMotionEvent||a.DeviceOrientationEvent;cc.sys.browserType==cc.sys.BROWSER_TYPE_MOBILE_QQ&&(this._accelDeviceEvent=window.DeviceOrientationEvent);var b=this._accelDeviceEvent==a.DeviceMotionEvent?"devicemotion":"deviceorientation",c=navigator.userAgent;(/Android/.test(c)||/Adr/.test(c)&&cc.sys.browserType==cc.BROWSER_TYPE_UC)&&(this._minus=-1);cc._addEventListener(a,b,this.didAccelerate.bind(this),
!1)};
_p.didAccelerate=function(a){var b=window;if(this._accelEnabled){var c,d,e,f=this._acceleration;this._accelDeviceEvent==window.DeviceMotionEvent?(e=a.accelerationIncludingGravity,c=this._accelMinus*e.x*.1,d=this._accelMinus*e.y*.1,e=.1*e.z):(c=a.gamma/90*.981,d=.981*-(a.beta/90),e=a.alpha/90*.981);cc.sys.os===cc.sys.OS_ANDROID?(f.x=-c,f.y=-d):(f.x=c,f.y=d);f.z=e;f.timestamp=a.timeStamp||Date.now();a=f.x;b.orientation===cc.UIInterfaceOrientationLandscapeRight?(f.x=-f.y,f.y=a):b.orientation===cc.UIInterfaceOrientationLandscapeLeft?
(f.x=f.y,f.y=-a):b.orientation===cc.UIInterfaceOrientationPortraitUpsideDown&&(f.x=-f.x,f.y=-f.y)}};delete _p;
cc.vertexLineToPolygon=function(a,b,c,d,e){if(e+=d,!(1>=e)){b*=.5;for(var f,g=e-1,h=d;e>h;h++){f=2*h;var k,m=cc.p(a[2*h],a[2*h+1]);if(0===h)k=cc.pPerp(cc.pNormalize(cc.pSub(m,cc.p(a[2*(h+1)],a[2*(h+1)+1]))));else if(h===g)k=cc.pPerp(cc.pNormalize(cc.pSub(cc.p(a[2*(h-1)],a[2*(h-1)+1]),m)));else{k=cc.p(a[2*(h-1)],a[2*(h-1)+1]);var n=cc.p(a[2*(h+1)],a[2*(h+1)+1]),q=cc.pNormalize(cc.pSub(n,m)),r=cc.pNormalize(cc.pSub(k,m)),s=Math.acos(cc.pDot(q,r));k=s<cc.degreesToRadians(70)?cc.pPerp(cc.pNormalize(cc.pMidpoint(q,
r))):s<cc.degreesToRadians(170)?cc.pNormalize(cc.pMidpoint(q,r)):cc.pPerp(cc.pNormalize(cc.pSub(n,k)))}k=cc.pMult(k,b);c[2*f]=m.x+k.x;c[2*f+1]=m.y+k.y;c[2*(f+1)]=m.x-k.x;c[2*(f+1)+1]=m.y-k.y}for(h=0==d?0:d-1;g>h;h++)f=2*h,a=f+2,b=cc.vertex2(c[2*f],c[2*f+1]),e=cc.vertex2(c[2*(f+1)],c[2*(f+1)+1]),f=cc.vertex2(c[2*a],c[2*a]),d=cc.vertex2(c[2*(a+1)],c[2*(a+1)+1]),b=!cc.vertexLineIntersect(b.x,b.y,d.x,d.y,e.x,e.y,f.x,f.y),b.isSuccess||(0>b.value||1<b.value)&&(b.isSuccess=!0),b.isSuccess&&(c[2*a]=d.x,c[2*
a+1]=d.y,c[2*(a+1)]=f.x,c[2*(a+1)+1]=f.y)}};cc.vertexLineIntersect=function(a,b,c,d,e,f,g,h){var k,m,n,q;return a==c&&b==d||e==g&&f==h||(c-=a,d-=b,e-=a,f-=b,g-=a,h-=b,k=Math.sqrt(c*c+d*d),m=c/k,n=d/k,q=e*m+f*n,f=f*m-e*n,e=q,q=g*m+h*n,h=h*m-g*n,g=q,f==h)?{isSuccess:!1,value:0}:{isSuccess:!0,value:(g+(e-g)*h/(h-f))/k}};cc.vertexListIsClockwise=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[(b+1)%c],e=a[(b+2)%c];if(0<cc.pCross(cc.pSub(d,a[b]),cc.pSub(e,d)))return!1}return!0};
cc.CGAffineToGL=function(a,b){b[2]=b[3]=b[6]=b[7]=b[8]=b[9]=b[11]=b[14]=0;b[10]=b[15]=1;b[0]=a.a;b[4]=a.c;b[12]=a.tx;b[1]=a.b;b[5]=a.d;b[13]=a.ty};cc.GLToCGAffine=function(a,b){b.a=a[0];b.c=a[4];b.tx=a[12];b.b=a[1];b.d=a[5];b.ty=a[13]};cc.EventAcceleration=cc.Event.extend({_acc:null,ctor:function(a){cc.Event.prototype.ctor.call(this,cc.Event.ACCELERATION);this._acc=a}});
cc.EventKeyboard=cc.Event.extend({_keyCode:0,_isPressed:!1,ctor:function(a,b){cc.Event.prototype.ctor.call(this,cc.Event.KEYBOARD);this._keyCode=a;this._isPressed=b}});
cc._EventListenerAcceleration=cc.EventListener.extend({_onAccelerationEvent:null,ctor:function(a){this._onAccelerationEvent=a;var b=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.ACCELERATION,cc._EventListenerAcceleration.LISTENER_ID,function(a){b._onAccelerationEvent(a._acc,a)})},checkAvailable:function(){return cc.assert(this._onAccelerationEvent,cc._LogInfos._EventListenerAcceleration_checkAvailable),!0},clone:function(){return new cc._EventListenerAcceleration(this._onAccelerationEvent)}});
cc._EventListenerAcceleration.LISTENER_ID="__cc_acceleration";cc._EventListenerAcceleration.create=function(a){return new cc._EventListenerAcceleration(a)};
cc._EventListenerKeyboard=cc.EventListener.extend({onKeyPressed:null,onKeyReleased:null,ctor:function(){var a=this;cc.EventListener.prototype.ctor.call(this,cc.EventListener.KEYBOARD,cc._EventListenerKeyboard.LISTENER_ID,function(b){b._isPressed?a.onKeyPressed&&a.onKeyPressed(b._keyCode,b):a.onKeyReleased&&a.onKeyReleased(b._keyCode,b)})},clone:function(){var a=new cc._EventListenerKeyboard;return a.onKeyPressed=this.onKeyPressed,a.onKeyReleased=this.onKeyReleased,a},checkAvailable:function(){return null==
this.onKeyPressed&&null==this.onKeyReleased?(cc.log(cc._LogInfos._EventListenerKeyboard_checkAvailable),!1):!0}});cc._EventListenerKeyboard.LISTENER_ID="__cc_keyboard";cc._EventListenerKeyboard.create=function(){return new cc._EventListenerKeyboard};
cc.AtlasNode=cc.Node.extend({textureAtlas:null,quadsToDraw:0,_itemsPerRow:0,_itemsPerColumn:0,_itemWidth:0,_itemHeight:0,_colorUnmodified:null,_opacityModifyRGB:!1,_blendFunc:null,_ignoreContentScaleFactor:!1,_className:"AtlasNode",ctor:function(a,b,c,d){cc.Node.prototype.ctor.call(this);this._colorUnmodified=cc.color.WHITE;this._blendFunc={src:cc.BLEND_SRC,dst:cc.BLEND_DST};this._ignoreContentScaleFactor=!1;void 0!==d&&this.initWithTileFile(a,b,c,d)},updateAtlasValues:function(){cc.log(cc._LogInfos.AtlasNode_updateAtlasValues)},
getColor:function(){return this._opacityModifyRGB?this._colorUnmodified:cc.Node.prototype.getColor.call(this)},setOpacityModifyRGB:function(a){var b=this.color;this._opacityModifyRGB=a;this.color=b},isOpacityModifyRGB:function(){return this._opacityModifyRGB},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(a,b){this._blendFunc=void 0===b?a:{src:a,dst:b}},setTextureAtlas:function(a){this.textureAtlas=a},getTextureAtlas:function(){return this.textureAtlas},getQuadsToDraw:function(){return this.quadsToDraw},
setQuadsToDraw:function(a){this.quadsToDraw=a},_textureForCanvas:null,_originalTexture:null,_uniformColor:null,_colorF32Array:null,initWithTileFile:function(a,b,c,d){if(!a)throw"cc.AtlasNode.initWithTileFile(): title should not be null";a=cc.textureCache.addImage(a);return this.initWithTexture(a,b,c,d)},initWithTexture:null,_initWithTextureForCanvas:function(a,b,c,d){return this._itemWidth=b,this._itemHeight=c,this._opacityModifyRGB=!0,this._originalTexture=a,this._originalTexture?(this._textureForCanvas=
this._originalTexture,this._calculateMaxItems(),this.quadsToDraw=d,!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},_initWithTextureForWebGL:function(a,b,c,d){this._itemWidth=b;this._itemHeight=c;this._colorUnmodified=cc.color.WHITE;this._opacityModifyRGB=!0;this._blendFunc.src=cc.BLEND_SRC;this._blendFunc.dst=cc.BLEND_DST;b=this._realColor;return this._colorF32Array=new Float32Array([b.r/255,b.g/255,b.b/255,this._realOpacity/255]),this.textureAtlas=new cc.TextureAtlas,this.textureAtlas.initWithTexture(a,
d),this.textureAtlas?(this._updateBlendFunc(),this._updateOpacityModifyRGB(),this._calculateMaxItems(),this.quadsToDraw=d,this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURE_UCOLOR),this._uniformColor=cc._renderContext.getUniformLocation(this.shaderProgram.getProgram(),"u_color"),!0):(cc.log(cc._LogInfos.AtlasNode__initWithTexture),!1)},draw:null,_drawForWebGL:function(a){a=a||cc._renderContext;cc.nodeDrawSetup(this);cc.glBlendFunc(this._blendFunc.src,this._blendFunc.dst);this._uniformColor&&
this._colorF32Array&&(a.uniform4fv(this._uniformColor,this._colorF32Array),this.textureAtlas.drawNumberOfQuads(this.quadsToDraw,0))},setColor:null,_setColorForCanvas:function(a){var b=this._realColor;if(b.r!=a.r||b.g!=a.g||b.b!=a.b){b=cc.color(a.r,a.g,a.b);if(this._colorUnmodified=a,this._opacityModifyRGB){var c=this._displayedOpacity;b.r=b.r*c/255;b.g=b.g*c/255;b.b=b.b*c/255}cc.Node.prototype.setColor.call(this,a);this._changeTextureColor()}},_changeTextureColor:function(){var a=this.getTexture();
if(a&&this._originalTexture){var b=this._originalTexture.getHtmlElementObj();if(b){var c=a.getHtmlElementObj(),d=cc.rect(0,0,b.width,b.height);c instanceof HTMLCanvasElement?cc.generateTintImageWithMultiply(b,this._displayedColor,d,c):(c=cc.generateTintImageWithMultiply(b,this._displayedColor,d),a=new cc.Texture2D,a.initWithElement(c),a.handleLoadedTexture(),this.setTexture(a))}}},_setColorForWebGL:function(a){var b=cc.color(a.r,a.g,a.b);this._colorUnmodified=a;var c=this._displayedOpacity;this._opacityModifyRGB&&
(b.r=b.r*c/255,b.g=b.g*c/255,b.b=b.b*c/255);cc.Node.prototype.setColor.call(this,a);a=this._displayedColor;this._colorF32Array=new Float32Array([a.r/255,a.g/255,a.b/255,c/255])},setOpacity:function(){},_setOpacityForCanvas:function(a){cc.Node.prototype.setOpacity.call(this,a);this._opacityModifyRGB&&(this.color=this._colorUnmodified)},_setOpacityForWebGL:function(a){(cc.Node.prototype.setOpacity.call(this,a),this._opacityModifyRGB)?this.color=this._colorUnmodified:(a=this._displayedColor,this._colorF32Array=
new Float32Array([a.r/255,a.g/255,a.b/255,this._displayedOpacity/255]))},getTexture:null,_getTextureForCanvas:function(){return this._textureForCanvas},_getTextureForWebGL:function(){return this.textureAtlas.texture},setTexture:null,_setTextureForCanvas:function(a){this._textureForCanvas=a},_setTextureForWebGL:function(a){this.textureAtlas.texture=a;this._updateBlendFunc();this._updateOpacityModifyRGB()},_calculateMaxItems:null,_calculateMaxItemsForCanvas:function(){var a=this.texture.getContentSize();
this._itemsPerColumn=0|a.height/this._itemHeight;this._itemsPerRow=0|a.width/this._itemWidth},_calculateMaxItemsForWebGL:function(){var a=this.texture,b=a.getContentSize();this._ignoreContentScaleFactor&&(b=a.getContentSizeInPixels());this._itemsPerColumn=0|b.height/this._itemHeight;this._itemsPerRow=0|b.width/this._itemWidth},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},_updateOpacityModifyRGB:function(){this._opacityModifyRGB=
this.textureAtlas.texture.hasPremultipliedAlpha()},_setIgnoreContentScaleFactor:function(a){this._ignoreContentScaleFactor=a}});_p=cc.AtlasNode.prototype;
cc._renderType===cc._RENDER_TYPE_WEBGL?(_p.initWithTexture=_p._initWithTextureForWebGL,_p.draw=_p._drawForWebGL,_p.setColor=_p._setColorForWebGL,_p.setOpacity=_p._setOpacityForWebGL,_p.getTexture=_p._getTextureForWebGL,_p.setTexture=_p._setTextureForWebGL,_p._calculateMaxItems=_p._calculateMaxItemsForWebGL):(_p.initWithTexture=_p._initWithTextureForCanvas,_p.draw=cc.Node.prototype.draw,_p.setColor=_p._setColorForCanvas,_p.setOpacity=_p._setOpacityForCanvas,_p.getTexture=_p._getTextureForCanvas,_p.setTexture=
_p._setTextureForCanvas,_p._calculateMaxItems=_p._calculateMaxItemsForCanvas,cc.sys._supportCanvasNewBlendModes||(_p._changeTextureColor=function(){var a,b=this.getTexture();if(b&&this._originalTexture&&(a=b.getHtmlElementObj(),a)){var c=this._originalTexture.getHtmlElementObj(),d=cc.textureCache.getTextureColors(c);d&&(c=cc.rect(0,0,c.width,c.height),a instanceof HTMLCanvasElement?cc.generateTintImage(a,d,this._displayedColor,c,a):(a=cc.generateTintImage(a,d,this._displayedColor,c),b=new cc.Texture2D,
b.initWithElement(a),b.handleLoadedTexture(),this.setTexture(b)))}}));cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);cc.defineGetterSetter(_p,"color",_p.getColor,_p.setColor);_p.texture;cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);_p.textureAtlas;_p.quadsToDraw;cc.AtlasNode.create=function(a,b,c,d){return new cc.AtlasNode(a,b,c,d)};
cc.TextureAtlas=cc.Class.extend({dirty:!1,texture:null,_indices:null,_buffersVBO:null,_capacity:0,_quads:null,_quadsArrayBuffer:null,_quadsWebBuffer:null,_quadsReader:null,ctor:function(a,b){this._buffersVBO=[];"string"==typeof a?this.initWithFile(a,b):a instanceof cc.Texture2D&&this.initWithTexture(a,b)},getTotalQuads:function(){return this._totalQuads},getCapacity:function(){return this._capacity},getTexture:function(){return this.texture},setTexture:function(a){this.texture=a},setDirty:function(a){this.dirty=
a},isDirty:function(){return this.dirty},getQuads:function(){return this._quads},setQuads:function(a){this._quads=a},_copyQuadsToTextureAtlas:function(a,b){if(a)for(var c=0;c<a.length;c++)this._setQuadToArray(a[c],b+c)},_setQuadToArray:function(a,b){var c=this._quads;return c[b]?(c[b].bl=a.bl,c[b].br=a.br,c[b].tl=a.tl,void(c[b].tr=a.tr)):void(c[b]=new cc.V3F_C4B_T2F_Quad(a.tl,a.bl,a.tr,a.br,this._quadsArrayBuffer,b*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT))},description:function(){return"<cc.TextureAtlas | totalQuads ="+
this._totalQuads+">"},_setupIndices:function(){if(0!==this._capacity)for(var a=this._indices,b=this._capacity,c=0;b>c;c++)cc.TEXTURE_ATLAS_USE_TRIANGLE_STRIP?(a[6*c+0]=4*c+0,a[6*c+1]=4*c+0,a[6*c+2]=4*c+2,a[6*c+3]=4*c+1,a[6*c+4]=4*c+3,a[6*c+5]=4*c+3):(a[6*c+0]=4*c+0,a[6*c+1]=4*c+1,a[6*c+2]=4*c+2,a[6*c+3]=4*c+3,a[6*c+4]=4*c+2,a[6*c+5]=4*c+1)},_setupVBO:function(){var a=cc._renderContext;this._buffersVBO[0]=a.createBuffer();this._buffersVBO[1]=a.createBuffer();this._quadsWebBuffer=a.createBuffer();this._mapBuffers()},
_mapBuffers:function(){var a=cc._renderContext;a.bindBuffer(a.ARRAY_BUFFER,this._quadsWebBuffer);a.bufferData(a.ARRAY_BUFFER,this._quadsArrayBuffer,a.DYNAMIC_DRAW);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this._buffersVBO[1]);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this._indices,a.STATIC_DRAW)},initWithFile:function(a,b){var c=cc.textureCache.addImage(a);return c?this.initWithTexture(c,b):(cc.log(cc._LogInfos.TextureAtlas_initWithFile,a),!1)},initWithTexture:function(a,b){cc.assert(a,cc._LogInfos.TextureAtlas_initWithTexture);
this._capacity=b|=0;this._totalQuads=0;this.texture=a;this._quads=[];this._indices=new Uint16Array(6*b);var c=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._quadsArrayBuffer=new ArrayBuffer(c*b),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),(!this._quads||!this._indices)&&0<b)return!1;for(var d=this._quads,e=0;b>e;e++)d[e]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,e*c);return this._setupIndices(),this._setupVBO(),this.dirty=!0,!0},updateQuad:function(a,b){cc.assert(a,
cc._LogInfos.TextureAtlas_updateQuad);cc.assert(0<=b&&b<this._capacity,cc._LogInfos.TextureAtlas_updateQuad_2);this._totalQuads=Math.max(b+1,this._totalQuads);this._setQuadToArray(a,b);this.dirty=!0},insertQuad:function(a,b){if(cc.assert(b<this._capacity,cc._LogInfos.TextureAtlas_insertQuad_2),this._totalQuads++,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var c=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=b*c,e=(this._totalQuads-1-b)*c;this._quads[this._totalQuads-
1]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*c);this._quadsReader.set(this._quadsReader.subarray(d,d+e),d+c);this._setQuadToArray(a,b);this.dirty=!0},insertQuads:function(a,b,c){c=c||a.length;cc.assert(b+c<=this._capacity,cc._LogInfos.TextureAtlas_insertQuads);var d=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads+=c,this._totalQuads>this._capacity)return void cc.log(cc._LogInfos.TextureAtlas_insertQuad);var e,f=b*d,g=(this._totalQuads-1-b-c)*
d,h=this._totalQuads-1-c;for(e=0;c>e;e++)this._quads[h+e]=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,(this._totalQuads-1)*d);this._quadsReader.set(this._quadsReader.subarray(f,f+g),f+d*c);for(e=0;c>e;e++)this._setQuadToArray(a[e],b+e);this.dirty=!0},insertQuadFromIndex:function(a,b){if(a!==b){cc.assert(0<=b||b<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex);cc.assert(0<=a||a<this._totalQuads,cc._LogInfos.TextureAtlas_insertQuadFromIndex_2);var c,d,e=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
f=this._quadsReader,g=f.subarray(a*e,e);a>b?(c=b*e,d=(a-b)*e,f.set(f.subarray(c,c+d),c+e),f.set(g,c)):(c=(a+1)*e,d=(b-a)*e,f.set(f.subarray(c,c+d),c-e),f.set(g,b*e));this.dirty=!0}},removeQuadAtIndex:function(a){cc.assert(a<this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadAtIndex);var b=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT;if(this._totalQuads--,this._quads.length=this._totalQuads,a!==this._totalQuads){var c=(a+1)*b;this._quadsReader.set(this._quadsReader.subarray(c,c+(this._totalQuads-a)*b),
c-b)}this.dirty=!0},removeQuadsAtIndex:function(a,b){if(cc.assert(a+b<=this._totalQuads,cc._LogInfos.TextureAtlas_removeQuadsAtIndex),this._totalQuads-=b,a!==this._totalQuads){var c=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=(a+b)*c,e=a*c;this._quadsReader.set(this._quadsReader.subarray(d,d+(this._totalQuads-a)*c),e)}this.dirty=!0},removeAllQuads:function(){this._totalQuads=this._quads.length=0},_setDirty:function(a){this.dirty=a},resizeCapacity:function(a){if(a==this._capacity)return!0;var b=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,
c=this._capacity;this._totalQuads=Math.min(this._totalQuads,a);var d=this._capacity=0|a,e=this._totalQuads;if(null==this._quads)for(this._quads=[],this._quadsArrayBuffer=new ArrayBuffer(b*d),this._quadsReader=new Uint8Array(this._quadsArrayBuffer),a=0;d>a;a++)this._quads=new cc.V3F_C4B_T2F_Quad(null,null,null,null,this._quadsArrayBuffer,a*b);else{var f,g,h=this._quads;if(d>c){f=[];g=new ArrayBuffer(b*d);for(a=0;e>a;a++)f[a]=new cc.V3F_C4B_T2F_Quad(h[a].tl,h[a].bl,h[a].tr,h[a].br,g,a*b);for(;d>a;a++)f[a]=
new cc.V3F_C4B_T2F_Quad(null,null,null,null,g,a*b)}else for(e=Math.max(e,d),f=[],g=new ArrayBuffer(b*d),a=0;e>a;a++)f[a]=new cc.V3F_C4B_T2F_Quad(h[a].tl,h[a].bl,h[a].tr,h[a].br,g,a*b);this._quadsReader=new Uint8Array(g);this._quads=f;this._quadsArrayBuffer=g}null==this._indices?this._indices=new Uint16Array(6*d):d>c?(b=new Uint16Array(6*d),b.set(this._indices,0),this._indices=b):this._indices=this._indices.subarray(0,6*d);return this._setupIndices(),this._mapBuffers(),this.dirty=!0,!0},increaseTotalQuadsWith:function(a){this._totalQuads+=
a},moveQuadsFromIndex:function(a,b,c){if(void 0===c){if(c=b,b=this._totalQuads-a,cc.assert(c+(this._totalQuads-a)<=this._capacity,cc._LogInfos.TextureAtlas_moveQuadsFromIndex),0===b)return}else if(cc.assert(c+b<=this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_2),cc.assert(a<this._totalQuads,cc._LogInfos.TextureAtlas_moveQuadsFromIndex_3),a==c)return;var d,e,f=cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,g=a*f,h=b*f,k=this._quadsReader,m=k.subarray(g,g+h),n=c*f;a>c?(d=(a-c)*f,e=c*f,k.set(k.subarray(e,
e+d),e+h)):(d=(c-a)*f,e=(a+b)*f,k.set(k.subarray(e,e+d),g));k.set(m,n);this.dirty=!0},fillWithEmptyQuadsFromIndex:function(a,b){for(var c=b*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,d=new Uint8Array(this._quadsArrayBuffer,a*cc.V3F_C4B_T2F_Quad.BYTES_PER_ELEMENT,c),e=0;c>e;e++)d[e]=0},drawQuads:function(){this.drawNumberOfQuads(this._totalQuads,0)},_releaseBuffer:function(){var a=cc._renderContext;this._buffersVBO&&(this._buffersVBO[0]&&a.deleteBuffer(this._buffersVBO[0]),this._buffersVBO[1]&&a.deleteBuffer(this._buffersVBO[1]));
this._quadsWebBuffer&&a.deleteBuffer(this._quadsWebBuffer)}});_p=cc.TextureAtlas.prototype;_p.totalQuads;cc.defineGetterSetter(_p,"totalQuads",_p.getTotalQuads);_p.capacity;cc.defineGetterSetter(_p,"capacity",_p.getCapacity);_p.quads;cc.defineGetterSetter(_p,"quads",_p.getQuads,_p.setQuads);cc.TextureAtlas.create=function(a,b){return new cc.TextureAtlas(a,b)};cc.TextureAtlas.createWithTexture=cc.TextureAtlas.create;
cc._renderType===cc._RENDER_TYPE_WEBGL&&(cc.assert("function"==typeof cc._tmp.WebGLTextureAtlas,cc._LogInfos.MissingFile,"TexturesWebGL.js"),cc._tmp.WebGLTextureAtlas(),delete cc._tmp.WebGLTextureAtlas);cc.assert("function"==typeof cc._tmp.PrototypeTextureAtlas,cc._LogInfos.MissingFile,"TexturesPropertyDefine.js");cc._tmp.PrototypeTextureAtlas();delete cc._tmp.PrototypeTextureAtlas;cc.DEFAULT_SPRITE_BATCH_CAPACITY=29;
cc.SpriteBatchNode=cc.Node.extend({textureAtlas:null,_blendFunc:null,_descendants:null,_className:"SpriteBatchNode",addSpriteWithoutQuad:function(a,b,c){if(cc.assert(a,cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad_2),!(a instanceof cc.Sprite))return cc.log(cc._LogInfos.SpriteBatchNode_addSpriteWithoutQuad),null;a.atlasIndex=b;var d=0,e=this._descendants;if(e&&0<e.length)for(var f=0;f<e.length;f++){var g=e[f];g&&g.atlasIndex>=b&&++d}return e.splice(d,0,a),cc.Node.prototype.addChild.call(this,a,
b,c),this.reorderBatch(!1),this},getTextureAtlas:function(){return this.textureAtlas},setTextureAtlas:function(a){a!=this.textureAtlas&&(this.textureAtlas=a)},getDescendants:function(){return this._descendants},initWithFile:function(a,b){var c=cc.textureCache.getTextureForKey(a);return c||(c=cc.textureCache.addImage(a)),this.initWithTexture(c,b)},_setNodeDirtyForCache:function(){this._cacheDirty=!0},init:function(a,b){var c=cc.textureCache.getTextureForKey(a);return c||(c=cc.textureCache.addImage(a)),
this.initWithTexture(c,b)},increaseAtlasCapacity:function(){var a=this.textureAtlas.capacity,b=Math.floor(4*(a+1)/3);cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity,a,b);this.textureAtlas.resizeCapacity(b)||cc.log(cc._LogInfos.SpriteBatchNode_increaseAtlasCapacity_2)},removeChildAtIndex:function(a,b){this.removeChild(this._children[a],b)},rebuildIndexInOrder:function(a,b){var c=a.children;if(c&&0<c.length)for(var d=0;d<c.length;d++){var e=c[d];e&&0>e.zIndex&&(b=this.rebuildIndexInOrder(e,
b))}if(!a==this&&(a.atlasIndex=b,b++),c&&0<c.length)for(d=0;d<c.length;d++)(e=c[d])&&0<=e.zIndex&&(b=this.rebuildIndexInOrder(e,b));return b},highestAtlasIndexInChild:function(a){var b=a.children;return b&&0!=b.length?this.highestAtlasIndexInChild(b[b.length-1]):a.atlasIndex},lowestAtlasIndexInChild:function(a){var b=a.children;return b&&0!=b.length?this.lowestAtlasIndexInChild(b[b.length-1]):a.atlasIndex},atlasIndexForChild:function(a,b){var c=a.parent,d=c.children,e=d.indexOf(a),f=null;return 0<
e&&e<cc.UINT_MAX&&(f=d[e-1]),c==this?0==e?0:this.highestAtlasIndexInChild(f)+1:0==e?0>b?c.atlasIndex:c.atlasIndex+1:0>f.zIndex&&0>b||0<=f.zIndex&&0<=b?this.highestAtlasIndexInChild(f)+1:c.atlasIndex+1},reorderBatch:function(a){this._reorderChildDirty=a},setBlendFunc:function(a,b){this._blendFunc=void 0===b?a:{src:a,dst:b}},getBlendFunc:function(){return this._blendFunc},reorderChild:function(a,b){return cc.assert(a,cc._LogInfos.SpriteBatchNode_reorderChild_2),-1===this._children.indexOf(a)?void cc.log(cc._LogInfos.SpriteBatchNode_reorderChild):
void(b!==a.zIndex&&(cc.Node.prototype.reorderChild.call(this,a,b),this.setNodeDirty()))},removeChild:function(a,b){if(null!=a){if(-1===this._children.indexOf(a))return void cc.log(cc._LogInfos.SpriteBatchNode_removeChild);this.removeSpriteFromAtlas(a);cc.Node.prototype.removeChild.call(this,a,b)}},_mvpMatrix:null,_textureForCanvas:null,_useCache:!1,_originalTexture:null,ctor:null,_ctorForCanvas:function(a,b){cc.Node.prototype.ctor.call(this);var c;b=b||cc.DEFAULT_SPRITE_BATCH_CAPACITY;"string"==typeof a?
(c=cc.textureCache.getTextureForKey(a),c||(c=cc.textureCache.addImage(a))):a instanceof cc.Texture2D&&(c=a);c&&this.initWithTexture(c,b)},_ctorForWebGL:function(a,b){cc.Node.prototype.ctor.call(this);this._mvpMatrix=new cc.kmMat4;var c;b=b||cc.DEFAULT_SPRITE_BATCH_CAPACITY;"string"==typeof a?(c=cc.textureCache.getTextureForKey(a),c||(c=cc.textureCache.addImage(a))):a instanceof cc.Texture2D&&(c=a);c&&this.initWithTexture(c,b)},updateQuadFromSprite:null,_updateQuadFromSpriteForCanvas:function(a,b){return cc.assert(a,
cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite_2),a instanceof cc.Sprite?(a.batchNode=this,a.atlasIndex=b,a.dirty=!0,void a.updateTransform()):void cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite)},_updateQuadFromSpriteForWebGL:function(a,b){if(cc.assert(a,cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite),!(a instanceof cc.Sprite))return void cc.log(cc._LogInfos.CCSpriteBatchNode_updateQuadFromSprite);for(var c=this.textureAtlas.capacity;b>=c||c==this.textureAtlas.totalQuads;)this.increaseAtlasCapacity();
a.batchNode=this;a.atlasIndex=b;a.dirty=!0;a.updateTransform()},_swap:function(a,b){var c=this._descendants,d=this.textureAtlas,e=d.quads,f=c[a],g=cc.V3F_C4B_T2F_QuadCopy(e[a]);c[b].atlasIndex=a;c[a]=c[b];d.updateQuad(e[b],a);c[b]=f;d.updateQuad(g,b)},insertQuadFromSprite:null,_insertQuadFromSpriteForCanvas:function(a,b){return cc.assert(a,cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite_2),a instanceof cc.Sprite?(a.batchNode=this,a.atlasIndex=b,a.dirty=!0,a.updateTransform(),a._setCachedParent(this),
void this._children.splice(b,0,a)):void cc.log(cc._LogInfos.CCSpriteBatchNode_insertQuadFromSprite)},_insertQuadFromSpriteForWebGL:function(a,b){if(cc.assert(a,cc._LogInfos.Sprite_insertQuadFromSprite_2),!(a instanceof cc.Sprite))return void cc.log(cc._LogInfos.Sprite_insertQuadFromSprite);for(var c=this.textureAtlas;b>=c.capacity||c.capacity===c.totalQuads;)this.increaseAtlasCapacity();a.batchNode=this;a.atlasIndex=b;c.insertQuad(a.quad,b);a.dirty=!0;a.updateTransform()},_updateAtlasIndex:function(a,
b){var c=0,d=a.children;d&&(c=d.length);var e=0;if(0===c)e=a.atlasIndex,a.atlasIndex=b,a.arrivalOrder=0,e!=b&&this._swap(e,b),b++;else{c=!0;0<=d[0].zIndex&&(e=a.atlasIndex,a.atlasIndex=b,a.arrivalOrder=0,e!=b&&this._swap(e,b),b++,c=!1);for(var f=0;f<d.length;f++){var g=d[f];c&&0<=g.zIndex&&(e=a.atlasIndex,a.atlasIndex=b,a.arrivalOrder=0,e!=b&&this._swap(e,b),b++,c=!1);b=this._updateAtlasIndex(g,b)}c&&(e=a.atlasIndex,a.atlasIndex=b,a.arrivalOrder=0,e!=b&&this._swap(e,b),b++)}return b},_updateBlendFunc:function(){this.textureAtlas.texture.hasPremultipliedAlpha()||
(this._blendFunc.src=cc.SRC_ALPHA,this._blendFunc.dst=cc.ONE_MINUS_SRC_ALPHA)},initWithTexture:null,_initWithTextureForCanvas:function(a){return this._children=[],this._descendants=[],this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),this._originalTexture=a,this._textureForCanvas=a,!0},_initWithTextureForWebGL:function(a,b){return this._children=[],this._descendants=[],this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST),b=b||cc.DEFAULT_SPRITE_BATCH_CAPACITY,this.textureAtlas=new cc.TextureAtlas,
this.textureAtlas.initWithTexture(a,b),this._updateBlendFunc(),this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR),!0},insertChild:function(a,b){a.batchNode=this;a.atlasIndex=b;a.dirty=!0;var c=this.textureAtlas;c.totalQuads>=c.capacity&&this.increaseAtlasCapacity();c.insertQuad(a.quad,b);this._descendants.splice(b,0,a);var c=b+1,d=this._descendants;if(d&&0<d.length)for(;c<d.length;c++)d[c].atlasIndex++;var e=a.children;if(e)for(c=0,l=e.length||0;l>c;c++)if(d=e[c]){var f=
this.atlasIndexForChild(d,d.zIndex);this.insertChild(d,f)}},appendChild:null,_appendChildForCanvas:function(a){this._reorderChildDirty=!0;a.batchNode=this;a.dirty=!0;this._descendants.push(a);a.atlasIndex=this._descendants.length-1;a=a.children;for(var b=0,c=a.length||0;c>b;b++)this.appendChild(a[b])},_appendChildForWebGL:function(a){this._reorderChildDirty=!0;a.batchNode=this;a.dirty=!0;this._descendants.push(a);var b=this._descendants.length-1;a.atlasIndex=b;var c=this.textureAtlas;c.totalQuads==
c.capacity&&this.increaseAtlasCapacity();c.insertQuad(a.quad,b);a=a.children;b=0;for(c=a.length||0;c>b;b++)this.appendChild(a[b])},removeSpriteFromAtlas:null,_removeSpriteFromAtlasForCanvas:function(a){a.batchNode=null;var b=this._descendants,c=b.indexOf(a);if(-1!=c){b.splice(c,1);for(var d=b.length;d>c;++c)b[c].atlasIndex--}if(a=a.children)for(b=0,c=a.length||0;c>b;b++)a[b]&&this.removeSpriteFromAtlas(a[b])},_removeSpriteFromAtlasForWebGL:function(a){this.textureAtlas.removeQuadAtIndex(a.atlasIndex);
a.batchNode=null;var b=this._descendants,c=b.indexOf(a);if(-1!=c){b.splice(c,1);for(var d=b.length;d>c;++c)b[c].atlasIndex--}if(a=a.children)for(b=0,c=a.length||0;c>b;b++)a[b]&&this.removeSpriteFromAtlas(a[b])},getTexture:null,_getTextureForCanvas:function(){return this._textureForCanvas},_getTextureForWebGL:function(){return this.textureAtlas.texture},setTexture:null,_setTextureForCanvas:function(a){this._textureForCanvas=a;for(var b=this._children,c=0;c<b.length;c++)b[c].texture=a},_setTextureForWebGL:function(a){this.textureAtlas.texture=
a;this._updateBlendFunc()},visit:null,_visitForCanvas:function(a){var b=a||cc._renderContext;if(this._visible){b.save();this.transform(a);var c=this._children;if(c)for(this.sortAllChildren(),a=0;a<c.length;a++)c[a]&&c[a].visit(b);b.restore()}},_visitForWebGL:function(a){a=a||cc._renderContext;if(this._visible){cc.kmGLPushMatrix();var b=this.grid;b&&b.isActive()&&(b.beforeDraw(),this.transformAncestors());this.sortAllChildren();this.transform(a);this.draw(a);b&&b.isActive()&&b.afterDraw(this);cc.kmGLPopMatrix();
this.arrivalOrder=0}},addChild:null,_addChildForCanvas:function(a,b,c){return cc.assert(null!=a,cc._LogInfos.CCSpriteBatchNode_addChild_3),a instanceof cc.Sprite?(b=null==b?a.zIndex:b,c=null==c?a.tag:c,cc.Node.prototype.addChild.call(this,a,b,c),this.appendChild(a),void this.setNodeDirty()):void cc.log(cc._LogInfos.CCSpriteBatchNode_addChild)},_addChildForWebGL:function(a,b,c){return cc.assert(null!=a,cc._LogInfos.Sprite_addChild_6),a instanceof cc.Sprite?a.texture!=this.textureAtlas.texture?void cc.log(cc._LogInfos.Sprite_addChild_5):
(b=null==b?a.zIndex:b,c=null==c?a.tag:c,cc.Node.prototype.addChild.call(this,a,b,c),this.appendChild(a),void this.setNodeDirty()):void cc.log(cc._LogInfos.Sprite_addChild_4)},removeAllChildren:null,_removeAllChildrenForCanvas:function(a){var b=this._descendants;if(b&&0<b.length)for(var c=0,d=b.length;d>c;c++)b[c]&&(b[c].batchNode=null);cc.Node.prototype.removeAllChildren.call(this,a);this._descendants.length=0},_removeAllChildrenForWebGL:function(a){var b=this._descendants;if(b&&0<b.length)for(var c=
0,d=b.length;d>c;c++)b[c]&&(b[c].batchNode=null);cc.Node.prototype.removeAllChildren.call(this,a);this._descendants.length=0;this.textureAtlas.removeAllQuads()},sortAllChildren:null,_sortAllChildrenForCanvas:function(){if(this._reorderChildDirty){var a,b,c=0,d=this._children,e=d.length;for(a=1;e>a;a++){var f=d[a],c=a-1;for(b=d[c];0<=c&&(f._localZOrder<b._localZOrder||f._localZOrder==b._localZOrder&&f.arrivalOrder<b.arrivalOrder);)d[c+1]=b,c-=1,b=d[c];d[c+1]=f}0<d.length&&this._arrayMakeObjectsPerformSelector(d,
cc.Node._StateCallbackType.sortAllChildren);this._reorderChildDirty=!1}},_sortAllChildrenForWebGL:function(){if(this._reorderChildDirty){var a,b,c=this._children,d=0,e=c.length;for(a=1;e>a;a++){var f=c[a],d=a-1;for(b=c[d];0<=d&&(f._localZOrder<b._localZOrder||f._localZOrder==b._localZOrder&&f.arrivalOrder<b.arrivalOrder);)c[d+1]=b,d-=1,b=c[d];c[d+1]=f}if(0<c.length)for(this._arrayMakeObjectsPerformSelector(c,cc.Node._StateCallbackType.sortAllChildren),a=b=0;a<c.length;a++)b=this._updateAtlasIndex(c[a],
b);this._reorderChildDirty=!1}},draw:null,_drawForWebGL:function(){0!==this.textureAtlas.totalQuads&&(this._shaderProgram.use(),this._shaderProgram.setUniformForModelViewAndProjectionMatrixWithMat4(),this._arrayMakeObjectsPerformSelector(this._children,cc.Node._StateCallbackType.updateTransform),cc.glBlendFunc(this._blendFunc.src,this._blendFunc.dst),this.textureAtlas.drawQuads())}});_p=cc.SpriteBatchNode.prototype;
cc._renderType===cc._RENDER_TYPE_WEBGL?(_p.ctor=_p._ctorForWebGL,_p.updateQuadFromSprite=_p._updateQuadFromSpriteForWebGL,_p.insertQuadFromSprite=_p._insertQuadFromSpriteForWebGL,_p.initWithTexture=_p._initWithTextureForWebGL,_p.appendChild=_p._appendChildForWebGL,_p.removeSpriteFromAtlas=_p._removeSpriteFromAtlasForWebGL,_p.getTexture=_p._getTextureForWebGL,_p.setTexture=_p._setTextureForWebGL,_p.visit=_p._visitForWebGL,_p.addChild=_p._addChildForWebGL,_p.removeAllChildren=_p._removeAllChildrenForWebGL,
_p.sortAllChildren=_p._sortAllChildrenForWebGL,_p.draw=_p._drawForWebGL):(_p.ctor=_p._ctorForCanvas,_p.updateQuadFromSprite=_p._updateQuadFromSpriteForCanvas,_p.insertQuadFromSprite=_p._insertQuadFromSpriteForCanvas,_p.initWithTexture=_p._initWithTextureForCanvas,_p.appendChild=_p._appendChildForCanvas,_p.removeSpriteFromAtlas=_p._removeSpriteFromAtlasForCanvas,_p.getTexture=_p._getTextureForCanvas,_p.setTexture=_p._setTextureForCanvas,_p.visit=_p._visitForCanvas,_p.removeAllChildren=_p._removeAllChildrenForCanvas,
_p.addChild=_p._addChildForCanvas,_p.sortAllChildren=_p._sortAllChildrenForCanvas,_p.draw=cc.Node.prototype.draw);cc.defineGetterSetter(_p,"texture",_p.getTexture,_p.setTexture);_p.descendants;cc.defineGetterSetter(_p,"descendants",_p.getDescendants);cc.SpriteBatchNode.create=function(a,b){return new cc.SpriteBatchNode(a,b)};cc.SpriteBatchNode.createWithTexture=cc.SpriteBatchNode.create;
cc.configuration={ERROR:0,STRING:1,INT:2,DOUBLE:3,BOOLEAN:4,_maxTextureSize:0,_maxModelviewStackDepth:0,_supportsPVRTC:!1,_supportsNPOT:!1,_supportsBGRA8888:!1,_supportsDiscardFramebuffer:!1,_supportsShareableVAO:!1,_maxSamplesAllowed:0,_maxTextureUnits:0,_GlExtensions:"",_valueDict:{},_inited:!1,_init:function(){var a=this._valueDict;a["cocos2d.x.version"]=cc.ENGINE_VERSION;a["cocos2d.x.compiled_with_profiler"]=!1;a["cocos2d.x.compiled_with_gl_state_cache"]=cc.ENABLE_GL_STATE_CACHE;this._inited=
!0},getMaxTextureSize:function(){return this._maxTextureSize},getMaxModelviewStackDepth:function(){return this._maxModelviewStackDepth},getMaxTextureUnits:function(){return this._maxTextureUnits},supportsNPOT:function(){return this._supportsNPOT},supportsPVRTC:function(){return this._supportsPVRTC},supportsETC:function(){return!1},supportsS3TC:function(){return!1},supportsATITC:function(){return!1},supportsBGRA8888:function(){return this._supportsBGRA8888},supportsDiscardFramebuffer:function(){return this._supportsDiscardFramebuffer},
supportsShareableVAO:function(){return this._supportsShareableVAO},checkForGLExtension:function(a){return-1<this._GlExtensions.indexOf(a)},getValue:function(a,b){this._inited||this._init();var c=this._valueDict;return c[a]?c[a]:b},setValue:function(a,b){this._valueDict[a]=b},dumpInfo:function(){0===cc.ENABLE_GL_STATE_CACHE&&(cc.log(""),cc.log(cc._LogInfos.configuration_dumpInfo),cc.log(""))},gatherGPUInfo:function(){if(cc._renderType!==cc._RENDER_TYPE_CANVAS){this._inited||this._init();var a=cc._renderContext,
b=this._valueDict;b["gl.vendor"]=a.getParameter(a.VENDOR);b["gl.renderer"]=a.getParameter(a.RENDERER);b["gl.version"]=a.getParameter(a.VERSION);this._GlExtensions="";for(var c=a.getSupportedExtensions(),d=0;d<c.length;d++)this._GlExtensions+=c[d]+" ";this._maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE);b["gl.max_texture_size"]=this._maxTextureSize;this._maxTextureUnits=a.getParameter(a.MAX_COMBINED_TEXTURE_IMAGE_UNITS);b["gl.max_texture_units"]=this._maxTextureUnits;this._supportsPVRTC=this.checkForGLExtension("GL_IMG_texture_compression_pvrtc");
b["gl.supports_PVRTC"]=this._supportsPVRTC;this._supportsNPOT=!1;b["gl.supports_NPOT"]=this._supportsNPOT;this._supportsBGRA8888=this.checkForGLExtension("GL_IMG_texture_format_BGRA888");b["gl.supports_BGRA8888"]=this._supportsBGRA8888;this._supportsDiscardFramebuffer=this.checkForGLExtension("GL_EXT_discard_framebuffer");b["gl.supports_discard_framebuffer"]=this._supportsDiscardFramebuffer;this._supportsShareableVAO=this.checkForGLExtension("vertex_array_object");b["gl.supports_vertex_array_object"]=
this._supportsShareableVAO;cc.checkGLErrorDebug()}},loadConfigFile:function(a){this._inited||this._init();var b=cc.loader.getRes(a);if(!b)throw"Please load the resource first : "+a;cc.assert(b,cc._LogInfos.configuration_loadConfigFile_2,a);b=b.data;if(!b)return void cc.log(cc._LogInfos.configuration_loadConfigFile,a);for(var c in b)this._valueDict[c]=b[c]}};
cc.Camera=cc.Class.extend({_eyeX:null,_eyeY:null,_eyeZ:null,_centerX:null,_centerY:null,_centerZ:null,_upX:null,_upY:null,_upZ:null,_dirty:null,_lookupMatrix:null,ctor:function(){this._lookupMatrix=new cc.kmMat4;this.restore()},description:function(){return"<CCCamera | center =("+this._centerX+","+this._centerY+","+this._centerZ+")>"},setDirty:function(a){this._dirty=a},isDirty:function(){return this._dirty},restore:function(){this._eyeX=this._eyeY=0;this._eyeZ=cc.Camera.getZEye();this._upX=this._centerX=
this._centerY=this._centerZ=0;this._upY=1;this._upZ=0;cc.kmMat4Identity(this._lookupMatrix);this._dirty=!1},locate:function(){if(this._dirty){var a=new cc.kmVec3,b=new cc.kmVec3,c=new cc.kmVec3;cc.kmVec3Fill(a,this._eyeX,this._eyeY,this._eyeZ);cc.kmVec3Fill(b,this._centerX,this._centerY,this._centerZ);cc.kmVec3Fill(c,this._upX,this._upY,this._upZ);cc.kmMat4LookAt(this._lookupMatrix,a,b,c);this._dirty=!1}cc.kmGLMultMatrix(this._lookupMatrix)},setEyeXYZ:function(a,b,c){this.setEye(a,b,c)},setEye:function(a,
b,c){this._eyeX=a;this._eyeY=b;this._eyeZ=c;this._dirty=!0},setCenterXYZ:function(a,b,c){this.setCenter(a,b,c)},setCenter:function(a,b,c){this._centerX=a;this._centerY=b;this._centerZ=c;this._dirty=!0},setUpXYZ:function(a,b,c){this.setUp(a,b,c)},setUp:function(a,b,c){this._upX=a;this._upY=b;this._upZ=c;this._dirty=!0},getEyeXYZ:function(){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getEye:function(){return{x:this._eyeX,y:this._eyeY,z:this._eyeZ}},getCenterXYZ:function(){return{x:this._centerX,
y:this._centerY,z:this._centerZ}},getCenter:function(){return{x:this._centerX,y:this._centerY,z:this._centerZ}},getUpXYZ:function(){return{x:this._upX,y:this._upY,z:this._upZ}},getUp:function(){return{x:this._upX,y:this._upY,z:this._upZ}},_DISALLOW_COPY_AND_ASSIGN:function(){}});cc.Camera.getZEye=function(){return cc.FLT_EPSILON};cc.PI2=2*Math.PI;
cc.DrawingPrimitiveCanvas=cc.Class.extend({_cacheArray:[],_renderContext:null,ctor:function(a){this._renderContext=a},drawPoint:function(a,b){b||(b=1);var c=cc.view.getScaleX(),d=cc.view.getScaleY(),d=cc.p(a.x*c,a.y*d);this._renderContext.beginPath();this._renderContext.arc(d.x,-d.y,b*c,0,2*Math.PI,!1);this._renderContext.closePath();this._renderContext.fill()},drawPoints:function(a,b,c){if(null!=a){c||(c=1);b=this._renderContext;var d=cc.view.getScaleX(),e=cc.view.getScaleY();b.beginPath();for(var f=
0,g=a.length;g>f;f++)b.arc(a[f].x*d,-a[f].y*e,c*d,0,2*Math.PI,!1);b.closePath();b.fill()}},drawLine:function(a,b){var c=this._renderContext,d=cc.view.getScaleX(),e=cc.view.getScaleY();c.beginPath();c.moveTo(a.x*d,-a.y*e);c.lineTo(b.x*d,-b.y*e);c.closePath();c.stroke()},drawRect:function(a,b){this.drawLine(cc.p(a.x,a.y),cc.p(b.x,a.y));this.drawLine(cc.p(b.x,a.y),cc.p(b.x,b.y));this.drawLine(cc.p(b.x,b.y),cc.p(a.x,b.y));this.drawLine(cc.p(a.x,b.y),cc.p(a.x,a.y))},drawSolidRect:function(a,b,c){a=[a,
cc.p(b.x,a.y),b,cc.p(a.x,b.y)];this.drawSolidPoly(a,4,c)},drawPoly:function(a,b,c,d){if(d=d||!1,null!=a){if(3>a.length)throw Error("Polygon's point must greater than 2");var e=a[0];b=this._renderContext;var f=cc.view.getScaleX(),g=cc.view.getScaleY();b.beginPath();b.moveTo(e.x*f,-e.y*g);for(var e=1,h=a.length;h>e;e++)b.lineTo(a[e].x*f,-a[e].y*g);c&&b.closePath();d?b.fill():b.stroke()}},drawSolidPoly:function(a,b,c){this.setDrawColor(c.r,c.g,c.b,c.a);this.drawPoly(a,b,!0,!0)},drawCircle:function(a,
b,c,d,e){e=e||!1;d=this._renderContext;var f=cc.view.getScaleX(),g=cc.view.getScaleY();d.beginPath();d.arc(0|a.x*f,0|-(a.y*g),b*f,-c,-(c-2*Math.PI),!1);e&&d.lineTo(0|a.x*f,0|-(a.y*g));d.stroke()},drawQuadBezier:function(a,b,c,d){for(var e=this._cacheArray,f=e.length=0,g=0;d>g;g++){var h=Math.pow(1-f,2)*a.x+2*(1-f)*f*b.x+f*f*c.x,k=Math.pow(1-f,2)*a.y+2*(1-f)*f*b.y+f*f*c.y;e.push(cc.p(h,k));f+=1/d}e.push(cc.p(c.x,c.y));this.drawPoly(e,d+1,!1,!1)},drawCubicBezier:function(a,b,c,d,e){for(var f=this._cacheArray,
g=f.length=0,h=0;e>h;h++){var k=Math.pow(1-g,3)*a.x+3*Math.pow(1-g,2)*g*b.x+3*(1-g)*g*g*c.x+g*g*g*d.x,m=Math.pow(1-g,3)*a.y+3*Math.pow(1-g,2)*g*b.y+3*(1-g)*g*g*c.y+g*g*g*d.y;f.push(cc.p(k,m));g+=1/e}f.push(cc.p(d.x,d.y));this.drawPoly(f,e+1,!1,!1)},drawCatmullRom:function(a,b){this.drawCardinalSpline(a,.5,b)},drawCardinalSpline:function(a,b,c){cc._renderContext.strokeStyle="rgba(255,255,255,1)";var d=this._cacheArray;d.length=0;for(var e,f,g=1/a.length,h=0;c+1>h;h++){var k=h/c;1==k?(e=a.length-1,
f=1):(e=0|k/g,f=(k-g*e)/g);k=cc.CardinalSplineAt(cc.getControlPointAt(a,e-1),cc.getControlPointAt(a,e-0),cc.getControlPointAt(a,e+1),cc.getControlPointAt(a,e+2),b,f);d.push(k)}this.drawPoly(d,c+1,!1,!1)},drawImage:function(a,b,c,d,e){switch(arguments.length){case 2:this._renderContext.drawImage(a,b.x,-(b.y+a.height));break;case 3:this._renderContext.drawImage(a,b.x,-(b.y+c.height),c.width,c.height);break;case 5:this._renderContext.drawImage(a,b.x,b.y,c.width,c.height,d.x,-(d.y+e.height),e.width,e.height);
break;default:throw Error("Argument must be non-nil");}},drawStar:function(a,b,c){a=a||this._renderContext;b*=cc.view.getScaleX();c="rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b);a.fillStyle=c+",1)";var d=b/10;a.beginPath();a.moveTo(-b,b);a.lineTo(0,d);a.lineTo(b,b);a.lineTo(d,0);a.lineTo(b,-b);a.lineTo(0,-d);a.lineTo(-b,-b);a.lineTo(-d,0);a.lineTo(-b,b);a.closePath();a.fill();var e=a.createRadialGradient(0,0,d,0,0,b);e.addColorStop(0,c+", 1)");e.addColorStop(.3,c+", 0.8)");e.addColorStop(1,c+", 0.0)");
a.fillStyle=e;a.beginPath();a.arc(0,0,b-d,0,cc.PI2,!1);a.closePath();a.fill()},drawColorBall:function(a,b,c){a=a||this._renderContext;b*=cc.view.getScaleX();c="rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b);var d=a.createRadialGradient(0,0,b/10,0,0,b);d.addColorStop(0,c+", 1)");d.addColorStop(.3,c+", 0.8)");d.addColorStop(.6,c+", 0.4)");d.addColorStop(1,c+", 0.0)");a.fillStyle=d;a.beginPath();a.arc(0,0,b,0,cc.PI2,!1);a.closePath();a.fill()},fillText:function(a,b,c){this._renderContext.fillText(a,b,-c)},setDrawColor:function(a,
b,c,d){this._renderContext.fillStyle="rgba("+a+","+b+","+c+","+d/255+")";this._renderContext.strokeStyle="rgba("+a+","+b+","+c+","+d/255+")"},setPointSize:function(){},setLineWidth:function(a){this._renderContext.lineWidth=a*cc.view.getScaleX()}});
cc.DrawingPrimitiveWebGL=cc.Class.extend({_renderContext:null,_initialized:!1,_shader:null,_colorLocation:-1,_colorArray:null,_pointSizeLocation:-1,_pointSize:-1,ctor:function(a){if(null==a&&(a=cc._renderContext),!a instanceof WebGLRenderingContext)throw"Can't initialise DrawingPrimitiveWebGL. context need is WebGLRenderingContext";this._renderContext=a;this._colorArray=new Float32Array([1,1,1,1])},lazy_init:function(){this._initialized||(this._shader=cc.shaderCache.programForKey(cc.SHADER_POSITION_UCOLOR),
this._colorLocation=this._renderContext.getUniformLocation(this._shader.getProgram(),"u_color"),this._pointSizeLocation=this._renderContext.getUniformLocation(this._shader.getProgram(),"u_pointSize"),this._initialized=!0)},drawInit:function(){this._initialized=!1},drawPoint:function(a){this.lazy_init();var b=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);b.uniform4fv(this._colorLocation,
this._colorArray);this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,new Float32Array([a.x,a.y]),b.STATIC_DRAW);b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,0);b.drawArrays(b.POINTS,0,1);b.deleteBuffer(c);cc.incrementGLDraws(1)},drawPoints:function(a){if(a&&0!=a.length){this.lazy_init();var b=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);b.uniform4fv(this._colorLocation,this._colorArray);this._shader.setUniformLocationWith1f(this._pointSizeLocation,this._pointSize);var c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,this._pointsToTypeArray(a),b.STATIC_DRAW);b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,0);b.drawArrays(b.POINTS,0,a.length);b.deleteBuffer(c);cc.incrementGLDraws(1)}},_pointsToTypeArray:function(a){for(var b=new Float32Array(2*
a.length),c=0;c<a.length;c++)b[2*c]=a[c].x,b[2*c+1]=a[c].y;return b},drawLine:function(a,b){this.lazy_init();var c=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);c.uniform4fv(this._colorLocation,this._colorArray);var d=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,d);c.bufferData(c.ARRAY_BUFFER,this._pointsToTypeArray([a,b]),c.STATIC_DRAW);c.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,
2,c.FLOAT,!1,0,0);c.drawArrays(c.LINES,0,2);c.deleteBuffer(d);cc.incrementGLDraws(1)},drawRect:function(a,b){this.drawLine(cc.p(a.x,a.y),cc.p(b.x,a.y));this.drawLine(cc.p(b.x,a.y),cc.p(b.x,b.y));this.drawLine(cc.p(b.x,b.y),cc.p(a.x,b.y));this.drawLine(cc.p(a.x,b.y),cc.p(a.x,a.y))},drawSolidRect:function(a,b,c){a=[a,cc.p(b.x,a.y),b,cc.p(a.x,b.y)];this.drawSolidPoly(a,4,c)},drawPoly:function(a,b,c){this.lazy_init();b=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);b.uniform4fv(this._colorLocation,this._colorArray);var d=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,d);b.bufferData(b.ARRAY_BUFFER,this._pointsToTypeArray(a),b.STATIC_DRAW);b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,0);c?b.drawArrays(b.LINE_LOOP,0,a.length):b.drawArrays(b.LINE_STRIP,0,a.length);b.deleteBuffer(d);cc.incrementGLDraws(1)},drawSolidPoly:function(a,b,c){this.lazy_init();c&&this.setDrawColor(c.r,c.g,c.b,c.a);
b=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);b.uniform4fv(this._colorLocation,this._colorArray);c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,this._pointsToTypeArray(a),b.STATIC_DRAW);b.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,b.FLOAT,!1,0,0);b.drawArrays(b.TRIANGLE_FAN,0,a.length);b.deleteBuffer(c);cc.incrementGLDraws(1)},drawCircle:function(a,
b,c,d,e){this.lazy_init();var f=1;e&&f++;var g=2*Math.PI/d;if(e=new Float32Array(2*(d+2))){for(var h=0;d>=h;h++){var k=h*g,m=b*Math.cos(k+c)+a.x,k=b*Math.sin(k+c)+a.y;e[2*h]=m;e[2*h+1]=k}e[2*(d+1)]=a.x;e[2*(d+1)+1]=a.y;a=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);a.uniform4fv(this._colorLocation,this._colorArray);b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,
e,a.STATIC_DRAW);a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0);a.drawArrays(a.LINE_STRIP,0,d+f);a.deleteBuffer(b);cc.incrementGLDraws(1)}},drawQuadBezier:function(a,b,c,d){this.lazy_init();for(var e=new Float32Array(2*(d+1)),f=0,g=0;d>g;g++)e[2*g]=Math.pow(1-f,2)*a.x+2*(1-f)*f*b.x+f*f*c.x,e[2*g+1]=Math.pow(1-f,2)*a.y+2*(1-f)*f*b.y+f*f*c.y,f+=1/d;e[2*d]=c.x;e[2*d+1]=c.y;a=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);
a.uniform4fv(this._colorLocation,this._colorArray);b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,e,a.STATIC_DRAW);a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0);a.drawArrays(a.LINE_STRIP,0,d+1);a.deleteBuffer(b);cc.incrementGLDraws(1)},drawCubicBezier:function(a,b,c,d,e){this.lazy_init();for(var f=new Float32Array(2*(e+1)),g=0,h=0;e>h;h++)f[2*h]=Math.pow(1-g,3)*a.x+3*Math.pow(1-g,2)*g*b.x+3*(1-g)*g*g*c.x+g*g*g*d.x,f[2*h+1]=Math.pow(1-g,3)*a.y+3*Math.pow(1-
g,2)*g*b.y+3*(1-g)*g*g*c.y+g*g*g*d.y,g+=1/e;f[2*e]=d.x;f[2*e+1]=d.y;a=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);a.uniform4fv(this._colorLocation,this._colorArray);b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,f,a.STATIC_DRAW);a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0);a.drawArrays(a.LINE_STRIP,0,e+1);a.deleteBuffer(b);cc.incrementGLDraws(1)},
drawCatmullRom:function(a,b){this.drawCardinalSpline(a,.5,b)},drawCardinalSpline:function(a,b,c){this.lazy_init();for(var d,e,f=new Float32Array(2*(c+1)),g=1/a.length,h=0;c+1>h;h++){var k=h/c;1==k?(d=a.length-1,e=1):(d=0|k/g,e=(k-g*d)/g);k=cc.CardinalSplineAt(cc.getControlPointAt(a,d-1),cc.getControlPointAt(a,d),cc.getControlPointAt(a,d+1),cc.getControlPointAt(a,d+2),b,e);f[2*h]=k.x;f[2*h+1]=k.y}a=this._renderContext;this._shader.use();this._shader.setUniformForModelViewAndProjectionMatrixWithMat4();
cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POSITION);a.uniform4fv(this._colorLocation,this._colorArray);b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,f,a.STATIC_DRAW);a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,0,0);a.drawArrays(a.LINE_STRIP,0,c+1);a.deleteBuffer(b);cc.incrementGLDraws(1)},setDrawColor:function(a,b,c,d){this._colorArray[0]=a/255;this._colorArray[1]=b/255;this._colorArray[2]=c/255;this._colorArray[3]=d/255},setPointSize:function(a){this._pointSize=
a*cc.contentScaleFactor()},setLineWidth:function(a){this._renderContext.lineWidth&&this._renderContext.lineWidth(a)}});cc.HashElement=cc.Class.extend({actions:null,target:null,actionIndex:0,currentAction:null,currentActionSalvaged:!1,paused:!1,hh:null,ctor:function(){this.actions=[];this.target=null;this.actionIndex=0;this.currentAction=null;this.paused=this.currentActionSalvaged=!1;this.hh=null}});
cc.ActionManager=cc.Class.extend({_hashTargets:null,_arrayTargets:null,_currentTarget:null,_currentTargetSalvaged:!1,_searchElementByTarget:function(a,b){for(var c=0;c<a.length;c++)if(b==a[c].target)return a[c];return null},ctor:function(){this._hashTargets={};this._arrayTargets=[];this._currentTarget=null;this._currentTargetSalvaged=!1},addAction:function(a,b,c){if(!a)throw"cc.ActionManager.addAction(): action must be non-null";if(!b)throw"cc.ActionManager.addAction(): action must be non-null";var d=
this._hashTargets[b.__instanceId];d||(d=new cc.HashElement,d.paused=c,d.target=b,this._hashTargets[b.__instanceId]=d,this._arrayTargets.push(d));this._actionAllocWithHashElement(d);d.actions.push(a);a.startWithTarget(b)},removeAllActions:function(){for(var a=this._arrayTargets,b=0;b<a.length;b++){var c=a[b];c&&this.removeAllActionsFromTarget(c.target,!0)}},removeAllActionsFromTarget:function(a,b){if(null!=a){var c=this._hashTargets[a.__instanceId];c&&(-1===c.actions.indexOf(c.currentAction)||c.currentActionSalvaged||
(c.currentActionSalvaged=!0),c.actions.length=0,this._currentTarget!=c||b?this._deleteHashElement(c):this._currentTargetSalvaged=!0)}},removeAction:function(a){if(null!=a){var b=a.getOriginalTarget();if(b=this._hashTargets[b.__instanceId])for(var c=0;c<b.actions.length;c++){if(b.actions[c]==a){b.actions.splice(c,1);break}}else cc.log(cc._LogInfos.ActionManager_removeAction)}},removeActionByTag:function(a,b){a==cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_addAction);cc.assert(b,cc._LogInfos.ActionManager_addAction);
var c=this._hashTargets[b.__instanceId];if(c)for(var d=c.actions.length,e=0;d>e;++e){var f=c.actions[e];if(f&&f.getTag()===a&&f.getOriginalTarget()==b){this._removeActionAtIndex(e,c);break}}},getActionByTag:function(a,b){a==cc.ACTION_TAG_INVALID&&cc.log(cc._LogInfos.ActionManager_getActionByTag);var c=this._hashTargets[b.__instanceId];if(c){if(null!=c.actions)for(var d=0;d<c.actions.length;++d){var e=c.actions[d];if(e&&e.getTag()===a)return e}cc.log(cc._LogInfos.ActionManager_getActionByTag_2,a)}return null},
numberOfRunningActionsInTarget:function(a){return(a=this._hashTargets[a.__instanceId])&&a.actions?a.actions.length:0},pauseTarget:function(a){(a=this._hashTargets[a.__instanceId])&&(a.paused=!0)},resumeTarget:function(a){(a=this._hashTargets[a.__instanceId])&&(a.paused=!1)},pauseAllRunningActions:function(){for(var a=[],b=this._arrayTargets,c=0;c<b.length;c++){var d=b[c];d&&!d.paused&&(d.paused=!0,a.push(d.target))}return a},resumeTargets:function(a){if(a)for(var b=0;b<a.length;b++)a[b]&&this.resumeTarget(a[b])},
purgeSharedManager:function(){cc.director.getScheduler().unscheduleUpdateForTarget(this)},_removeActionAtIndex:function(a,b){b.actions[a]!=b.currentAction||b.currentActionSalvaged||(b.currentActionSalvaged=!0);b.actions.splice(a,1);b.actionIndex>=a&&b.actionIndex--;0==b.actions.length&&(this._currentTarget==b?this._currentTargetSalvaged=!0:this._deleteHashElement(b))},_deleteHashElement:function(a){a&&(delete this._hashTargets[a.target.__instanceId],cc.arrayRemoveObject(this._arrayTargets,a),a.actions=
null,a.target=null)},_actionAllocWithHashElement:function(a){null==a.actions&&(a.actions=[])},update:function(a){for(var b,c=this._arrayTargets,d=0;d<c.length;d++){if(this._currentTarget=c[d],b=this._currentTarget,!b.paused)for(b.actionIndex=0;b.actionIndex<b.actions.length;b.actionIndex++)if(b.currentAction=b.actions[b.actionIndex],b.currentAction){if(b.currentActionSalvaged=!1,b.currentAction.step(a*(b.currentAction._speedMethod?b.currentAction._speed:1)),b.currentActionSalvaged)b.currentAction=
null;else if(b.currentAction.isDone()){b.currentAction.stop();var e=b.currentAction;b.currentAction=null;this.removeAction(e)}b.currentAction=null}this._currentTargetSalvaged&&0===b.actions.length&&this._deleteHashElement(b)}}});cc.ACTION_TAG_INVALID=-1;
cc.Action=cc.Class.extend({originalTarget:null,target:null,tag:cc.ACTION_TAG_INVALID,ctor:function(){this.target=this.originalTarget=null;this.tag=cc.ACTION_TAG_INVALID},copy:function(){return cc.log("copy is deprecated. Please use clone instead."),this.clone()},clone:function(){var a=new cc.Action;return a.originalTarget=null,a.target=null,a.tag=this.tag,a},isDone:function(){return!0},startWithTarget:function(a){this.target=this.originalTarget=a},stop:function(){this.target=null},step:function(){cc.log("[Action step]. override me")},
update:function(){cc.log("[Action update]. override me")},getTarget:function(){return this.target},setTarget:function(a){this.target=a},getOriginalTarget:function(){return this.originalTarget},setOriginalTarget:function(a){this.originalTarget=a},getTag:function(){return this.tag},setTag:function(a){this.tag=a},retain:function(){},release:function(){}});cc.action=function(){return new cc.Action};cc.Action.create=cc.action;
cc.FiniteTimeAction=cc.Action.extend({_duration:0,ctor:function(){cc.Action.prototype.ctor.call(this);this._duration=0},getDuration:function(){return this._duration*(this._times||1)},setDuration:function(a){this._duration=a},reverse:function(){return cc.log("cocos2d: FiniteTimeAction#reverse: Implement me"),null},clone:function(){return new cc.FiniteTimeAction}});
cc.Speed=cc.Action.extend({_speed:0,_innerAction:null,ctor:function(a,b){cc.Action.prototype.ctor.call(this);this._speed=0;this._innerAction=null;a&&this.initWithAction(a,b)},getSpeed:function(){return this._speed},setSpeed:function(a){this._speed=a},initWithAction:function(a,b){if(!a)throw"cc.Speed.initWithAction(): action must be non nil";return this._innerAction=a,this._speed=b,!0},clone:function(){var a=new cc.Speed;return a.initWithAction(this._innerAction.clone(),this._speed),a},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,
a);this._innerAction.startWithTarget(a)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},step:function(a){this._innerAction.step(a*this._speed)},isDone:function(){return this._innerAction.isDone()},reverse:function(){return new cc.Speed(this._innerAction.reverse(),this._speed)},setInnerAction:function(a){this._innerAction!=a&&(this._innerAction=a)},getInnerAction:function(){return this._innerAction}});cc.speed=function(a,b){return new cc.Speed(a,b)};cc.Speed.create=cc.speed;
cc.Follow=cc.Action.extend({_followedNode:null,_boundarySet:!1,_boundaryFullyCovered:!1,_halfScreenSize:null,_fullScreenSize:null,_worldRect:null,leftBoundary:0,rightBoundary:0,topBoundary:0,bottomBoundary:0,ctor:function(a,b){cc.Action.prototype.ctor.call(this);this._followedNode=null;this._boundaryFullyCovered=this._boundarySet=!1;this._fullScreenSize=this._halfScreenSize=null;this.bottomBoundary=this.topBoundary=this.rightBoundary=this.leftBoundary=0;this._worldRect=cc.rect(0,0,0,0);a&&(b?this.initWithTarget(a,
b):this.initWithTarget(a))},clone:function(){var a=new cc.Follow,b=this._worldRect,b=new cc.Rect(b.x,b.y,b.width,b.height);return a.initWithTarget(this._followedNode,b),a},isBoundarySet:function(){return this._boundarySet},setBoudarySet:function(a){this._boundarySet=a},initWithTarget:function(a,b){if(!a)throw"cc.Follow.initWithAction(): followedNode must be non nil";b=b||cc.rect(0,0,0,0);this._followedNode=a;this._worldRect=b;this._boundarySet=!cc._rectEqualToZero(b);this._boundaryFullyCovered=!1;
var c=cc.director.getWinSize();return this._fullScreenSize=cc.p(c.width,c.height),this._halfScreenSize=cc.pMult(this._fullScreenSize,.5),this._boundarySet&&(this.leftBoundary=-(b.x+b.width-this._fullScreenSize.x),this.rightBoundary=-b.x,this.topBoundary=-b.y,this.bottomBoundary=-(b.y+b.height-this._fullScreenSize.y),this.rightBoundary<this.leftBoundary&&(this.rightBoundary=this.leftBoundary=(this.leftBoundary+this.rightBoundary)/2),this.topBoundary<this.bottomBoundary&&(this.topBoundary=this.bottomBoundary=
(this.topBoundary+this.bottomBoundary)/2),this.topBoundary==this.bottomBoundary&&this.leftBoundary==this.rightBoundary&&(this._boundaryFullyCovered=!0)),!0},step:function(){var a=this._followedNode.x,b=this._followedNode.y;(a=this._halfScreenSize.x-a,b=this._halfScreenSize.y-b,this._boundarySet)?this._boundaryFullyCovered||this.target.setPosition(cc.clampf(a,this.leftBoundary,this.rightBoundary),cc.clampf(b,this.bottomBoundary,this.topBoundary)):this.target.setPosition(a,b)},isDone:function(){return!this._followedNode.running},
stop:function(){this.target=null;cc.Action.prototype.stop.call(this)}});cc.follow=function(a,b){return new cc.Follow(a,b)};cc.Follow.create=cc.follow;
cc.ActionInterval=cc.FiniteTimeAction.extend({_elapsed:0,_firstTick:!1,_easeList:null,_times:1,_repeatForever:!1,_repeatMethod:!1,_speed:1,_speedMethod:!1,ctor:function(a){this._times=this._speed=1;this._repeatForever=!1;this.MAX_VALUE=2;this._speedMethod=this._repeatMethod=!1;cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==a&&this.initWithDuration(a)},getElapsed:function(){return this._elapsed},initWithDuration:function(a){return this._duration=0===a?cc.FLT_EPSILON:a,this._elapsed=0,this._firstTick=
!0,!0},isDone:function(){return this._elapsed>=this._duration},_cloneDecoration:function(a){a._repeatForever=this._repeatForever;a._speed=this._speed;a._times=this._times;a._easeList=this._easeList;a._speedMethod=this._speedMethod;a._repeatMethod=this._repeatMethod},_reverseEaseList:function(a){if(this._easeList){a._easeList=[];for(var b=0;b<this._easeList.length;b++)a._easeList.push(this._easeList[b].reverse())}},clone:function(){var a=new cc.ActionInterval(this._duration);return this._cloneDecoration(a),
a},easing:function(){this._easeList?this._easeList.length=0:this._easeList=[];for(var a=0;a<arguments.length;a++)this._easeList.push(arguments[a]);return this},_computeEaseTime:function(a){var b=this._easeList;if(!b||0===b.length)return a;for(var c=0,d=b.length;d>c;c++)a=b[c].easing(a);return a},step:function(a){this._firstTick?(this._firstTick=!1,this._elapsed=0):this._elapsed+=a;a=this._elapsed/(1.192092896E-7<this._duration?this._duration:1.192092896E-7);a=1>a?a:1;this.update(0<a?a:0);this._repeatMethod&&
1<this._times&&this.isDone()&&(this._repeatForever||this._times--,this.startWithTarget(this.target),this.step(this._elapsed-this._duration))},startWithTarget:function(a){cc.Action.prototype.startWithTarget.call(this,a);this._elapsed=0;this._firstTick=!0},reverse:function(){return cc.log("cc.IntervalAction: reverse not implemented."),null},setAmplitudeRate:function(){cc.log("cc.ActionInterval.setAmplitudeRate(): it should be overridden in subclass.")},getAmplitudeRate:function(){return cc.log("cc.ActionInterval.getAmplitudeRate(): it should be overridden in subclass."),
0},speed:function(a){return 0>=a?(cc.log("The speed parameter error"),this):(this._speedMethod=!0,this._speed*=a,this)},getSpeed:function(){return this._speed},setSpeed:function(a){return this._speed=a,this},repeat:function(a){return a=Math.round(a),isNaN(a)||1>a?(cc.log("The repeat parameter error"),this):(this._repeatMethod=!0,this._times*=a,this)},repeatForever:function(){return this._repeatMethod=!0,this._times=this.MAX_VALUE,this._repeatForever=!0,this}});cc.actionInterval=function(a){return new cc.ActionInterval(a)};
cc.ActionInterval.create=cc.actionInterval;
cc.Sequence=cc.ActionInterval.extend({_actions:null,_split:null,_last:0,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._actions=[];var b=a instanceof Array?a:arguments,c=b.length-1;if(0<=c&&null==b[c]&&cc.log("parameters should not be ending with null in Javascript"),0<=c){for(var d,e=b[0],f=1;c>f;f++)b[f]&&(d=e,e=cc.Sequence._actionOneTwo(d,b[f]));this.initWithTwoActions(e,b[c])}},initWithTwoActions:function(a,b){if(!a||!b)throw"cc.Sequence.initWithTwoActions(): arguments must all be non nil";return this.initWithDuration(a._duration+
b._duration),this._actions[0]=a,this._actions[1]=b,!0},clone:function(){var a=new cc.Sequence;return this._cloneDecoration(a),a.initWithTwoActions(this._actions[0].clone(),this._actions[1].clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._split=this._actions[0]._duration/this._duration;this._last=-1},stop:function(){-1!==this._last&&this._actions[this._last].stop();cc.Action.prototype.stop.call(this)},update:function(a){a=this._computeEaseTime(a);
var b,c=0,d=this._split,e=this._actions,f=this._last;d>a?(b=0!==d?a/d:1,0===c&&1===f&&(e[1].update(0),e[1].stop())):(c=1,b=1===d?1:(a-d)/(1-d),-1===f&&(e[0].startWithTarget(this.target),e[0].update(1),e[0].stop()),f||(e[0].update(1),e[0].stop()));f===c&&e[c].isDone()||(f!==c&&e[c].startWithTarget(this.target),e[c].update(b),this._last=c)},reverse:function(){var a=cc.Sequence._actionOneTwo(this._actions[1].reverse(),this._actions[0].reverse());return this._cloneDecoration(a),this._reverseEaseList(a),
a}});cc.sequence=function(a){var b=a instanceof Array?a:arguments;0<b.length&&null==b[b.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var c=b[0],d=1;d<b.length;d++)b[d]&&(c=cc.Sequence._actionOneTwo(c,b[d]));return c};cc.Sequence.create=cc.sequence;cc.Sequence._actionOneTwo=function(a,b){var c=new cc.Sequence;return c.initWithTwoActions(a,b),c};
cc.Repeat=cc.ActionInterval.extend({_times:0,_total:0,_nextDt:0,_actionInstant:!1,_innerAction:null,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithAction(a,b)},initWithAction:function(a,b){return this.initWithDuration(a._duration*b)?(this._times=b,this._innerAction=a,a instanceof cc.ActionInstant&&(this._actionInstant=!0,this._times-=1),this._total=0,!0):!1},clone:function(){var a=new cc.Repeat;return this._cloneDecoration(a),a.initWithAction(this._innerAction.clone(),
this._times),a},startWithTarget:function(a){this._total=0;this._nextDt=this._innerAction._duration/this._duration;cc.ActionInterval.prototype.startWithTarget.call(this,a);this._innerAction.startWithTarget(a)},stop:function(){this._innerAction.stop();cc.Action.prototype.stop.call(this)},update:function(a){a=this._computeEaseTime(a);var b=this._innerAction,c=this._duration,d=this._times,e=this._nextDt;if(a>=e){for(;a>e&&this._total<d;)b.update(1),this._total++,b.stop(),b.startWithTarget(this.target),
this._nextDt=e+=b._duration/c;1<=a&&this._total<d&&this._total++;this._actionInstant||(this._total===d?(b.update(1),b.stop()):b.update(a-(e-b._duration/c)))}else b.update(a*d%1)},isDone:function(){return this._total==this._times},reverse:function(){var a=new cc.Repeat(this._innerAction.reverse(),this._times);return this._cloneDecoration(a),this._reverseEaseList(a),a},setInnerAction:function(a){this._innerAction!=a&&(this._innerAction=a)},getInnerAction:function(){return this._innerAction}});
cc.repeat=function(a,b){return new cc.Repeat(a,b)};cc.Repeat.create=cc.repeat;
cc.RepeatForever=cc.ActionInterval.extend({_innerAction:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._innerAction=null;a&&this.initWithAction(a)},initWithAction:function(a){if(!a)throw"cc.RepeatForever.initWithAction(): action must be non null";return this._innerAction=a,!0},clone:function(){var a=new cc.RepeatForever;return this._cloneDecoration(a),a.initWithAction(this._innerAction.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);this._innerAction.startWithTarget(a)},step:function(a){var b=this._innerAction;b.step(a);b.isDone()&&(b.startWithTarget(this.target),b.step(b.getElapsed()-b._duration))},isDone:function(){return!1},reverse:function(){var a=new cc.RepeatForever(this._innerAction.reverse());return this._cloneDecoration(a),this._reverseEaseList(a),a},setInnerAction:function(a){this._innerAction!=a&&(this._innerAction=a)},getInnerAction:function(){return this._innerAction}});cc.repeatForever=function(a){return new cc.RepeatForever(a)};
cc.RepeatForever.create=cc.repeatForever;
cc.Spawn=cc.ActionInterval.extend({_one:null,_two:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._two=this._one=null;var b=a instanceof Array?a:arguments,c=b.length-1;if(0<=c&&null==b[c]&&cc.log("parameters should not be ending with null in Javascript"),0<=c){for(var d,e=b[0],f=1;c>f;f++)b[f]&&(d=e,e=cc.Spawn._actionOneTwo(d,b[f]));this.initWithTwoActions(e,b[c])}},initWithTwoActions:function(a,b){if(!a||!b)throw"cc.Spawn.initWithTwoActions(): arguments must all be non null";var c=
!1,d=a._duration,e=b._duration;return this.initWithDuration(Math.max(d,e))&&(this._one=a,this._two=b,d>e?this._two=cc.Sequence._actionOneTwo(b,cc.delayTime(d-e)):e>d&&(this._one=cc.Sequence._actionOneTwo(a,cc.delayTime(e-d))),c=!0),c},clone:function(){var a=new cc.Spawn;return this._cloneDecoration(a),a.initWithTwoActions(this._one.clone(),this._two.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._one.startWithTarget(a);this._two.startWithTarget(a)},
stop:function(){this._one.stop();this._two.stop();cc.Action.prototype.stop.call(this)},update:function(a){a=this._computeEaseTime(a);this._one&&this._one.update(a);this._two&&this._two.update(a)},reverse:function(){var a=cc.Spawn._actionOneTwo(this._one.reverse(),this._two.reverse());return this._cloneDecoration(a),this._reverseEaseList(a),a}});
cc.spawn=function(a){var b=a instanceof Array?a:arguments;0<b.length&&null==b[b.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var c=b[0],d=1;d<b.length;d++)null!=b[d]&&(c=cc.Spawn._actionOneTwo(c,b[d]));return c};cc.Spawn.create=cc.spawn;cc.Spawn._actionOneTwo=function(a,b){var c=new cc.Spawn;return c.initWithTwoActions(a,b),c};
cc.RotateTo=cc.ActionInterval.extend({_dstAngleX:0,_startAngleX:0,_diffAngleX:0,_dstAngleY:0,_startAngleY:0,_diffAngleY:0,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._dstAngleX=b||0,this._dstAngleY=c||this._dstAngleX,!0):!1},clone:function(){var a=new cc.RotateTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._dstAngleX,
this._dstAngleY),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);var b=a.rotationX%360,c=this._dstAngleX-b;180<c&&(c-=360);-180>c&&(c+=360);this._startAngleX=b;this._diffAngleX=c;this._startAngleY=a.rotationY%360;a=this._dstAngleY-this._startAngleY;180<a&&(a-=360);-180>a&&(a+=360);this._diffAngleY=a},reverse:function(){cc.log("cc.RotateTo.reverse(): it should be overridden in subclass.")},update:function(a){a=this._computeEaseTime(a);this.target&&(this.target.rotationX=
this._startAngleX+this._diffAngleX*a,this.target.rotationY=this._startAngleY+this._diffAngleY*a)}});cc.rotateTo=function(a,b,c){return new cc.RotateTo(a,b,c)};cc.RotateTo.create=cc.rotateTo;
cc.RotateBy=cc.ActionInterval.extend({_angleX:0,_startAngleX:0,_angleY:0,_startAngleY:0,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._angleX=b||0,this._angleY=c||this._angleX,!0):!1},clone:function(){var a=new cc.RotateBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._angleX,this._angleY),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);this._startAngleX=a.rotationX;this._startAngleY=a.rotationY},update:function(a){a=this._computeEaseTime(a);this.target&&(this.target.rotationX=this._startAngleX+this._angleX*a,this.target.rotationY=this._startAngleY+this._angleY*a)},reverse:function(){var a=new cc.RotateBy(this._duration,-this._angleX,-this._angleY);return this._cloneDecoration(a),this._reverseEaseList(a),a}});cc.rotateBy=function(a,b,c){return new cc.RotateBy(a,b,c)};cc.RotateBy.create=cc.rotateBy;
cc.MoveBy=cc.ActionInterval.extend({_positionDelta:null,_startPosition:null,_previousPosition:null,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);this._positionDelta=cc.p(0,0);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);void 0!==b&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(void 0!==b.x&&(c=b.y,b=b.x),this._positionDelta.x=b,this._positionDelta.y=c,!0):!1},clone:function(){var a=
new cc.MoveBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._positionDelta),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);var b=a.getPositionX();a=a.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a},update:function(a){if(a=this._computeEaseTime(a),this.target){var b=this._positionDelta.x*a;a*=this._positionDelta.y;var c=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var d=
this.target.getPositionX(),e=this.target.getPositionY(),f=this._previousPosition;c.x=c.x+d-f.x;c.y=c.y+e-f.y;b+=c.x;a+=c.y;f.x=b;f.y=a;this.target.setPosition(b,a)}else this.target.setPosition(c.x+b,c.y+a)}},reverse:function(){var a=new cc.MoveBy(this._duration,cc.p(-this._positionDelta.x,-this._positionDelta.y));return this._cloneDecoration(a),this._reverseEaseList(a),a}});cc.moveBy=function(a,b,c){return new cc.MoveBy(a,b,c)};cc.MoveBy.create=cc.moveBy;
cc.MoveTo=cc.MoveBy.extend({_endPosition:null,ctor:function(a,b,c){cc.MoveBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);void 0!==b&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.MoveBy.prototype.initWithDuration.call(this,a,b,c)?(void 0!==b.x&&(c=b.y,b=b.x),this._endPosition.x=b,this._endPosition.y=c,!0):!1},clone:function(){var a=new cc.MoveTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._endPosition),a},startWithTarget:function(a){cc.MoveBy.prototype.startWithTarget.call(this,
a);this._positionDelta.x=this._endPosition.x-a.getPositionX();this._positionDelta.y=this._endPosition.y-a.getPositionY()}});cc.moveTo=function(a,b,c){return new cc.MoveTo(a,b,c)};cc.MoveTo.create=cc.moveTo;
cc.SkewTo=cc.ActionInterval.extend({_skewX:0,_skewY:0,_startSkewX:0,_startSkewY:0,_endSkewX:0,_endSkewY:0,_deltaX:0,_deltaY:0,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==c&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){var d=!1;return cc.ActionInterval.prototype.initWithDuration.call(this,a)&&(this._endSkewX=b,this._endSkewY=c,d=!0),d},clone:function(){var a=new cc.SkewTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._endSkewX,
this._endSkewY),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._startSkewX=a.skewX%180;this._deltaX=this._endSkewX-this._startSkewX;180<this._deltaX&&(this._deltaX-=360);-180>this._deltaX&&(this._deltaX+=360);this._startSkewY=a.skewY%360;this._deltaY=this._endSkewY-this._startSkewY;180<this._deltaY&&(this._deltaY-=360);-180>this._deltaY&&(this._deltaY+=360)},update:function(a){a=this._computeEaseTime(a);this.target.skewX=this._startSkewX+this._deltaX*
a;this.target.skewY=this._startSkewY+this._deltaY*a}});cc.skewTo=function(a,b,c){return new cc.SkewTo(a,b,c)};cc.SkewTo.create=cc.skewTo;
cc.SkewBy=cc.SkewTo.extend({ctor:function(a,b,c){cc.SkewTo.prototype.ctor.call(this);void 0!==c&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){var d=!1;return cc.SkewTo.prototype.initWithDuration.call(this,a,b,c)&&(this._skewX=b,this._skewY=c,d=!0),d},clone:function(){var a=new cc.SkewBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._skewX,this._skewY),a},startWithTarget:function(a){cc.SkewTo.prototype.startWithTarget.call(this,a);this._deltaX=this._skewX;
this._deltaY=this._skewY;this._endSkewX=this._startSkewX+this._deltaX;this._endSkewY=this._startSkewY+this._deltaY},reverse:function(){var a=new cc.SkewBy(this._duration,-this._skewX,-this._skewY);return this._cloneDecoration(a),this._reverseEaseList(a),a}});cc.skewBy=function(a,b,c){return new cc.SkewBy(a,b,c)};cc.SkewBy.create=cc.skewBy;
cc.JumpBy=cc.ActionInterval.extend({_startPosition:null,_delta:null,_height:0,_jumps:0,_previousPosition:null,ctor:function(a,b,c,d,e){cc.ActionInterval.prototype.ctor.call(this);this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);this._delta=cc.p(0,0);void 0!==d&&this.initWithDuration(a,b,c,d,e)},initWithDuration:function(a,b,c,d,e){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(void 0===e&&(e=d,d=c,c=b.y,b=b.x),this._delta.x=b,this._delta.y=c,this._height=d,this._jumps=
e,!0):!1},clone:function(){var a=new cc.JumpBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._delta,this._height,this._jumps),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);var b=a.getPositionX();a=a.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a},update:function(a){if(a=this._computeEaseTime(a),this.target){var b=a*this._jumps%1,b=4*this._height*b*(1-b),b=b+this._delta.y*
a;a*=this._delta.x;var c=this._startPosition;if(cc.ENABLE_STACKABLE_ACTIONS){var d=this.target.getPositionX(),e=this.target.getPositionY(),f=this._previousPosition;c.x=c.x+d-f.x;c.y=c.y+e-f.y;a+=c.x;b+=c.y;f.x=a;f.y=b;this.target.setPosition(a,b)}else this.target.setPosition(c.x+a,c.y+b)}},reverse:function(){var a=new cc.JumpBy(this._duration,cc.p(-this._delta.x,-this._delta.y),this._height,this._jumps);return this._cloneDecoration(a),this._reverseEaseList(a),a}});
cc.jumpBy=function(a,b,c,d,e){return new cc.JumpBy(a,b,c,d,e)};cc.JumpBy.create=cc.jumpBy;
cc.JumpTo=cc.JumpBy.extend({_endPosition:null,ctor:function(a,b,c,d,e){cc.JumpBy.prototype.ctor.call(this);this._endPosition=cc.p(0,0);void 0!==d&&this.initWithDuration(a,b,c,d,e)},initWithDuration:function(a,b,c,d,e){return cc.JumpBy.prototype.initWithDuration.call(this,a,b,c,d,e)?(void 0===e&&(c=b.y,b=b.x),this._endPosition.x=b,this._endPosition.y=c,!0):!1},startWithTarget:function(a){cc.JumpBy.prototype.startWithTarget.call(this,a);this._delta.x=this._endPosition.x-this._startPosition.x;this._delta.y=
this._endPosition.y-this._startPosition.y},clone:function(){var a=new cc.JumpTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._endPosition,this._height,this._jumps),a}});cc.jumpTo=function(a,b,c,d,e){return new cc.JumpTo(a,b,c,d,e)};cc.JumpTo.create=cc.jumpTo;cc.bezierAt=function(a,b,c,d,e){return Math.pow(1-e,3)*a+3*e*Math.pow(1-e,2)*b+3*Math.pow(e,2)*(1-e)*c+Math.pow(e,3)*d};
cc.BezierBy=cc.ActionInterval.extend({_config:null,_startPosition:null,_previousPosition:null,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);this._config=[];this._startPosition=cc.p(0,0);this._previousPosition=cc.p(0,0);b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._config=b,!0):!1},clone:function(){var a=new cc.BezierBy;this._cloneDecoration(a);for(var b=[],c=0;c<this._config.length;c++){var d=
this._config[c];b.push(cc.p(d.x,d.y))}return a.initWithDuration(this._duration,b),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);var b=a.getPositionX();a=a.getPositionY();this._previousPosition.x=b;this._previousPosition.y=a;this._startPosition.x=b;this._startPosition.y=a},update:function(a){if(a=this._computeEaseTime(a),this.target){var b=this._config,c=b[0].y,d=b[1].y,e=b[2].y,b=cc.bezierAt(0,b[0].x,b[1].x,b[2].x,a);a=cc.bezierAt(0,c,d,e,a);c=this._startPosition;
if(cc.ENABLE_STACKABLE_ACTIONS){var d=this.target.getPositionX(),e=this.target.getPositionY(),f=this._previousPosition;c.x=c.x+d-f.x;c.y=c.y+e-f.y;b+=c.x;a+=c.y;f.x=b;f.y=a;this.target.setPosition(b,a)}else this.target.setPosition(c.x+b,c.y+a)}},reverse:function(){var a=this._config,a=[cc.pAdd(a[1],cc.pNeg(a[2])),cc.pAdd(a[0],cc.pNeg(a[2])),cc.pNeg(a[2])],a=new cc.BezierBy(this._duration,a);return this._cloneDecoration(a),this._reverseEaseList(a),a}});
cc.bezierBy=function(a,b){return new cc.BezierBy(a,b)};cc.BezierBy.create=cc.bezierBy;
cc.BezierTo=cc.BezierBy.extend({_toConfig:null,ctor:function(a,b){cc.BezierBy.prototype.ctor.call(this);this._toConfig=[];b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._toConfig=b,!0):!1},clone:function(){var a=new cc.BezierTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._toConfig),a},startWithTarget:function(a){cc.BezierBy.prototype.startWithTarget.call(this,a);a=this._startPosition;var b=
this._toConfig,c=this._config;c[0]=cc.pSub(b[0],a);c[1]=cc.pSub(b[1],a);c[2]=cc.pSub(b[2],a)}});cc.bezierTo=function(a,b){return new cc.BezierTo(a,b)};cc.BezierTo.create=cc.bezierTo;
cc.ScaleTo=cc.ActionInterval.extend({_scaleX:1,_scaleY:1,_startScaleX:1,_startScaleY:1,_endScaleX:0,_endScaleY:0,_deltaX:0,_deltaY:0,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._endScaleX=b,this._endScaleY=null!=c?c:b,!0):!1},clone:function(){var a=new cc.ScaleTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._endScaleX,
this._endScaleY),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._startScaleX=a.scaleX;this._startScaleY=a.scaleY;this._deltaX=this._endScaleX-this._startScaleX;this._deltaY=this._endScaleY-this._startScaleY},update:function(a){a=this._computeEaseTime(a);this.target&&(this.target.scaleX=this._startScaleX+this._deltaX*a,this.target.scaleY=this._startScaleY+this._deltaY*a)}});cc.scaleTo=function(a,b,c){return new cc.ScaleTo(a,b,c)};cc.ScaleTo.create=cc.scaleTo;
cc.ScaleBy=cc.ScaleTo.extend({startWithTarget:function(a){cc.ScaleTo.prototype.startWithTarget.call(this,a);this._deltaX=this._startScaleX*this._endScaleX-this._startScaleX;this._deltaY=this._startScaleY*this._endScaleY-this._startScaleY},reverse:function(){var a=new cc.ScaleBy(this._duration,1/this._endScaleX,1/this._endScaleY);return this._cloneDecoration(a),this._reverseEaseList(a),a},clone:function(){var a=new cc.ScaleBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._endScaleX,
this._endScaleY),a}});cc.scaleBy=function(a,b,c){return new cc.ScaleBy(a,b,c)};cc.ScaleBy.create=cc.scaleBy;
cc.Blink=cc.ActionInterval.extend({_times:0,_originalState:!1,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._times=b,!0):!1},clone:function(){var a=new cc.Blink;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._times),a},update:function(a){if(a=this._computeEaseTime(a),this.target&&!this.isDone()){var b=1/this._times;this.target.visible=
a%b>b/2}},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._originalState=a.visible},stop:function(){this.target.visible=this._originalState;cc.ActionInterval.prototype.stop.call(this)},reverse:function(){var a=new cc.Blink(this._duration,this._times);return this._cloneDecoration(a),this._reverseEaseList(a),a}});cc.blink=function(a,b){return new cc.Blink(a,b)};cc.Blink.create=cc.blink;
cc.FadeTo=cc.ActionInterval.extend({_toOpacity:0,_fromOpacity:0,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);void 0!==b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._toOpacity=b,!0):!1},clone:function(){var a=new cc.FadeTo;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._toOpacity),a},update:function(a){a=this._computeEaseTime(a);var b=void 0!==this._fromOpacity?this._fromOpacity:
255;this.target.opacity=b+(this._toOpacity-b)*a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._fromOpacity=a.opacity}});cc.fadeTo=function(a,b){return new cc.FadeTo(a,b)};cc.FadeTo.create=cc.fadeTo;
cc.FadeIn=cc.FadeTo.extend({_reverseAction:null,ctor:function(a){cc.FadeTo.prototype.ctor.call(this);a&&this.initWithDuration(a,255)},reverse:function(){var a=new cc.FadeOut;return a.initWithDuration(this._duration,0),this._cloneDecoration(a),this._reverseEaseList(a),a},clone:function(){var a=new cc.FadeIn;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._toOpacity),a},startWithTarget:function(a){this._reverseAction&&(this._toOpacity=this._reverseAction._fromOpacity);cc.FadeTo.prototype.startWithTarget.call(this,
a)}});cc.fadeIn=function(a){return new cc.FadeIn(a)};cc.FadeIn.create=cc.fadeIn;cc.FadeOut=cc.FadeTo.extend({ctor:function(a){cc.FadeTo.prototype.ctor.call(this);a&&this.initWithDuration(a,0)},reverse:function(){var a=new cc.FadeIn;return a._reverseAction=this,a.initWithDuration(this._duration,255),this._cloneDecoration(a),this._reverseEaseList(a),a},clone:function(){var a=new cc.FadeOut;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._toOpacity),a}});cc.fadeOut=function(a){return new cc.FadeOut(a)};
cc.FadeOut.create=cc.fadeOut;
cc.TintTo=cc.ActionInterval.extend({_to:null,_from:null,ctor:function(a,b,c,d){cc.ActionInterval.prototype.ctor.call(this);this._to=cc.color(0,0,0);this._from=cc.color(0,0,0);void 0!==d&&this.initWithDuration(a,b,c,d)},initWithDuration:function(a,b,c,d){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._to=cc.color(b,c,d),!0):!1},clone:function(){var a=new cc.TintTo;this._cloneDecoration(a);var b=this._to;return a.initWithDuration(this._duration,b.r,b.g,b.b),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);this._from=this.target.color},update:function(a){a=this._computeEaseTime(a);var b=this._from,c=this._to;b&&(this.target.color=cc.color(b.r+(c.r-b.r)*a,b.g+(c.g-b.g)*a,b.b+(c.b-b.b)*a))}});cc.tintTo=function(a,b,c,d){return new cc.TintTo(a,b,c,d)};cc.TintTo.create=cc.tintTo;
cc.TintBy=cc.ActionInterval.extend({_deltaR:0,_deltaG:0,_deltaB:0,_fromR:0,_fromG:0,_fromB:0,ctor:function(a,b,c,d){cc.ActionInterval.prototype.ctor.call(this);void 0!==d&&this.initWithDuration(a,b,c,d)},initWithDuration:function(a,b,c,d){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._deltaR=b,this._deltaG=c,this._deltaB=d,!0):!1},clone:function(){var a=new cc.TintBy;return this._cloneDecoration(a),a.initWithDuration(this._duration,this._deltaR,this._deltaG,this._deltaB),
a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);a=a.color;this._fromR=a.r;this._fromG=a.g;this._fromB=a.b},update:function(a){a=this._computeEaseTime(a);this.target.color=cc.color(this._fromR+this._deltaR*a,this._fromG+this._deltaG*a,this._fromB+this._deltaB*a)},reverse:function(){var a=new cc.TintBy(this._duration,-this._deltaR,-this._deltaG,-this._deltaB);return this._cloneDecoration(a),this._reverseEaseList(a),a}});
cc.tintBy=function(a,b,c,d){return new cc.TintBy(a,b,c,d)};cc.TintBy.create=cc.tintBy;cc.DelayTime=cc.ActionInterval.extend({update:function(){},reverse:function(){var a=new cc.DelayTime(this._duration);return this._cloneDecoration(a),this._reverseEaseList(a),a},clone:function(){var a=new cc.DelayTime;return this._cloneDecoration(a),a.initWithDuration(this._duration),a}});cc.delayTime=function(a){return new cc.DelayTime(a)};cc.DelayTime.create=cc.delayTime;
cc.ReverseTime=cc.ActionInterval.extend({_other:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._other=null;a&&this.initWithAction(a)},initWithAction:function(a){if(!a)throw"cc.ReverseTime.initWithAction(): action must be non null";if(a==this._other)throw"cc.ReverseTime.initWithAction(): the action was already passed in.";return cc.ActionInterval.prototype.initWithDuration.call(this,a._duration)?(this._other=a,!0):!1},clone:function(){var a=new cc.ReverseTime;return this._cloneDecoration(a),
a.initWithAction(this._other.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._other.startWithTarget(a)},update:function(a){a=this._computeEaseTime(a);this._other&&this._other.update(1-a)},reverse:function(){return this._other.clone()},stop:function(){this._other.stop();cc.Action.prototype.stop.call(this)}});cc.reverseTime=function(a){return new cc.ReverseTime(a)};cc.ReverseTime.create=cc.reverseTime;
cc.Animate=cc.ActionInterval.extend({_animation:null,_nextFrame:0,_origFrame:null,_executedLoops:0,_splitTimes:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);this._splitTimes=[];a&&this.initWithAnimation(a)},getAnimation:function(){return this._animation},setAnimation:function(a){this._animation=a},initWithAnimation:function(a){if(!a)throw"cc.Animate.initWithAnimation(): animation must be non-NULL";var b=a.getDuration();if(this.initWithDuration(b*a.getLoops())){this._nextFrame=
0;this.setAnimation(a);this._origFrame=null;this._executedLoops=0;var c=this._splitTimes,d=c.length=0,e=b/a.getTotalDelayUnits();a=a.getFrames();cc.arrayVerifyType(a,cc.AnimationFrame);for(var f=0;f<a.length;f++){var g=d*e/b,d=d+a[f].getDelayUnits();c.push(g)}return!0}return!1},clone:function(){var a=new cc.Animate;return this._cloneDecoration(a),a.initWithAnimation(this._animation.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._animation.getRestoreOriginalFrame()&&
(this._origFrame=a.displayFrame());this._executedLoops=this._nextFrame=0},update:function(a){if(a=this._computeEaseTime(a),1>a)a*=this._animation.getLoops(),(0|a)>this._executedLoops&&(this._nextFrame=0,this._executedLoops++),a%=1;for(var b=this._animation.getFrames(),c=b.length,d=this._splitTimes,e=this._nextFrame;c>e&&d[e]<=a;e++)this.target.setSpriteFrame(b[e].getSpriteFrame()),this._nextFrame=e+1},reverse:function(){var a=this._animation,b=a.getFrames(),c=[];if(cc.arrayVerifyType(b,cc.AnimationFrame),
0<b.length)for(var d=b.length-1;0<=d;d--){var e=b[d];if(!e)break;c.push(e.clone())}b=new cc.Animation(c,a.getDelayPerUnit(),a.getLoops());b.setRestoreOriginalFrame(a.getRestoreOriginalFrame());a=new cc.Animate(b);return this._cloneDecoration(a),this._reverseEaseList(a),a},stop:function(){this._animation.getRestoreOriginalFrame()&&this.target&&this.target.setSpriteFrame(this._origFrame);cc.Action.prototype.stop.call(this)}});cc.animate=function(a){return new cc.Animate(a)};cc.Animate.create=cc.animate;
cc.TargetedAction=cc.ActionInterval.extend({_action:null,_forcedTarget:null,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);b&&this.initWithTarget(a,b)},initWithTarget:function(a,b){return this.initWithDuration(b._duration)?(this._forcedTarget=a,this._action=b,!0):!1},clone:function(){var a=new cc.TargetedAction;return this._cloneDecoration(a),a.initWithTarget(this._forcedTarget,this._action.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);this._action.startWithTarget(this._forcedTarget)},stop:function(){this._action.stop()},update:function(a){a=this._computeEaseTime(a);this._action.update(a)},getForcedTarget:function(){return this._forcedTarget},setForcedTarget:function(a){this._forcedTarget!=a&&(this._forcedTarget=a)}});cc.targetedAction=function(a,b){return new cc.TargetedAction(a,b)};cc.TargetedAction.create=cc.targetedAction;
cc.ActionInstant=cc.FiniteTimeAction.extend({isDone:function(){return!0},step:function(){this.update(1)},update:function(){},reverse:function(){return this.clone()},clone:function(){return new cc.ActionInstant}});cc.Show=cc.ActionInstant.extend({update:function(){this.target.visible=!0},reverse:function(){return new cc.Hide},clone:function(){return new cc.Show}});cc.show=function(){return new cc.Show};cc.Show.create=cc.show;
cc.Hide=cc.ActionInstant.extend({update:function(){this.target.visible=!1},reverse:function(){return new cc.Show},clone:function(){return new cc.Hide}});cc.hide=function(){return new cc.Hide};cc.Hide.create=cc.hide;cc.ToggleVisibility=cc.ActionInstant.extend({update:function(){this.target.visible=!this.target.visible},reverse:function(){return new cc.ToggleVisibility},clone:function(){return new cc.ToggleVisibility}});cc.toggleVisibility=function(){return new cc.ToggleVisibility};
cc.ToggleVisibility.create=cc.toggleVisibility;cc.RemoveSelf=cc.ActionInstant.extend({_isNeedCleanUp:!0,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==a&&this.init(a)},update:function(){this.target.removeFromParent(this._isNeedCleanUp)},init:function(a){return this._isNeedCleanUp=a,!0},reverse:function(){return new cc.RemoveSelf(this._isNeedCleanUp)},clone:function(){return new cc.RemoveSelf(this._isNeedCleanUp)}});cc.removeSelf=function(a){return new cc.RemoveSelf(a)};
cc.RemoveSelf.create=cc.removeSelf;cc.FlipX=cc.ActionInstant.extend({_flippedX:!1,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedX=!1;void 0!==a&&this.initWithFlipX(a)},initWithFlipX:function(a){return this._flippedX=a,!0},update:function(){this.target.flippedX=this._flippedX},reverse:function(){return new cc.FlipX(!this._flippedX)},clone:function(){var a=new cc.FlipX;return a.initWithFlipX(this._flippedX),a}});cc.flipX=function(a){return new cc.FlipX(a)};
cc.FlipX.create=cc.flipX;cc.FlipY=cc.ActionInstant.extend({_flippedY:!1,ctor:function(a){cc.FiniteTimeAction.prototype.ctor.call(this);this._flippedY=!1;void 0!==a&&this.initWithFlipY(a)},initWithFlipY:function(a){return this._flippedY=a,!0},update:function(){this.target.flippedY=this._flippedY},reverse:function(){return new cc.FlipY(!this._flippedY)},clone:function(){var a=new cc.FlipY;return a.initWithFlipY(this._flippedY),a}});cc.flipY=function(a){return new cc.FlipY(a)};cc.FlipY.create=cc.flipY;
cc.Place=cc.ActionInstant.extend({_x:0,_y:0,ctor:function(a,b){cc.FiniteTimeAction.prototype.ctor.call(this);this._y=this._x=0;void 0!==a&&(void 0!==a.x&&(b=a.y,a=a.x),this.initWithPosition(a,b))},initWithPosition:function(a,b){return this._x=a,this._y=b,!0},update:function(){this.target.setPosition(this._x,this._y)},clone:function(){var a=new cc.Place;return a.initWithPosition(this._x,this._y),a}});cc.place=function(a,b){return new cc.Place(a,b)};cc.Place.create=cc.place;
cc.CallFunc=cc.ActionInstant.extend({_selectorTarget:null,_callFunc:null,_function:null,_data:null,ctor:function(a,b,c){cc.FiniteTimeAction.prototype.ctor.call(this);void 0!==a&&(void 0===b?this.initWithFunction(a):this.initWithFunction(a,b,c))},initWithFunction:function(a,b,c){return b?(this._data=c,this._callFunc=a,this._selectorTarget=b):a&&(this._function=a),!0},execute:function(){null!=this._callFunc?this._callFunc.call(this._selectorTarget,this.target,this._data):this._function&&this._function.call(null,
this.target)},update:function(){this.execute()},getTargetCallback:function(){return this._selectorTarget},setTargetCallback:function(a){a!=this._selectorTarget&&(this._selectorTarget&&(this._selectorTarget=null),this._selectorTarget=a)},clone:function(){var a=new cc.CallFunc;return this._selectorTarget?a.initWithFunction(this._callFunc,this._selectorTarget,this._data):this._function&&a.initWithFunction(this._function),a}});cc.callFunc=function(a,b,c){return new cc.CallFunc(a,b,c)};
cc.CallFunc.create=cc.callFunc;
cc.ActionCamera=cc.ActionInterval.extend({_centerXOrig:0,_centerYOrig:0,_centerZOrig:0,_eyeXOrig:0,_eyeYOrig:0,_eyeZOrig:0,_upXOrig:0,_upYOrig:0,_upZOrig:0,ctor:function(){cc.ActionInterval.prototype.ctor.call(this);this._upZOrig=this._upYOrig=this._upXOrig=this._eyeZOrig=this._eyeYOrig=this._eyeXOrig=this._centerZOrig=this._centerYOrig=this._centerXOrig=0},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);a=a.getCamera();var b=a.getCenter();this._centerXOrig=b.x;
this._centerYOrig=b.y;this._centerZOrig=b.z;b=a.getEye();this._eyeXOrig=b.x;this._eyeYOrig=b.y;this._eyeZOrig=b.z;a=a.getUp();this._upXOrig=a.x;this._upYOrig=a.y;this._upZOrig=a.z},clone:function(){return new cc.ActionCamera},reverse:function(){return new cc.ReverseTime(this)}});
cc.OrbitCamera=cc.ActionCamera.extend({_radius:0,_deltaRadius:0,_angleZ:0,_deltaAngleZ:0,_angleX:0,_deltaAngleX:0,_radZ:0,_radDeltaZ:0,_radX:0,_radDeltaX:0,ctor:function(a,b,c,d,e,f,g){cc.ActionCamera.prototype.ctor.call(this);void 0!==g&&this.initWithDuration(a,b,c,d,e,f,g)},initWithDuration:function(a,b,c,d,e,f,g){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._radius=b,this._deltaRadius=c,this._angleZ=d,this._deltaAngleZ=e,this._angleX=f,this._deltaAngleX=g,this._radDeltaZ=
cc.degreesToRadians(e),this._radDeltaX=cc.degreesToRadians(g),!0):!1},sphericalRadius:function(){var a,b,c,d=this.target.getCamera(),e=d.getEye(),f=d.getCenter(),d=e.x-f.x,g=e.y-f.y,e=e.z-f.z,f=Math.sqrt(Math.pow(d,2)+Math.pow(g,2)+Math.pow(e,2)),h=Math.sqrt(Math.pow(d,2)+Math.pow(g,2));return 0===h&&(h=cc.FLT_EPSILON),0===f&&(f=cc.FLT_EPSILON),b=Math.acos(e/f),c=0>d?Math.PI-Math.asin(g/h):Math.asin(g/h),a=f/cc.Camera.getZEye(),{newRadius:a,zenith:b,azimuth:c}},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);a=this.sphericalRadius();isNaN(this._radius)&&(this._radius=a.newRadius);isNaN(this._angleZ)&&(this._angleZ=cc.radiansToDegrees(a.zenith));isNaN(this._angleX)&&(this._angleX=cc.radiansToDegrees(a.azimuth));this._radZ=cc.degreesToRadians(this._angleZ);this._radX=cc.degreesToRadians(this._angleX)},clone:function(){var a=new cc.OrbitCamera;return a.initWithDuration(this._duration,this._radius,this._deltaRadius,this._angleZ,this._deltaAngleZ,this._angleX,this._deltaAngleX),a},update:function(a){a=
this._computeEaseTime(a);var b=(this._radius+this._deltaRadius*a)*cc.Camera.getZEye(),c=this._radZ+this._radDeltaZ*a,d=this._radX+this._radDeltaX*a;a=Math.sin(c)*Math.cos(d)*b+this._centerXOrig;d=Math.sin(c)*Math.sin(d)*b+this._centerYOrig;b=Math.cos(c)*b+this._centerZOrig;this.target.getCamera().setEye(a,d,b)}});cc.orbitCamera=function(a,b,c,d,e,f,g){return new cc.OrbitCamera(a,b,c,d,e,f,g)};cc.OrbitCamera.create=cc.orbitCamera;
cc.ActionEase=cc.ActionInterval.extend({_inner:null,ctor:function(a){cc.ActionInterval.prototype.ctor.call(this);a&&this.initWithAction(a)},initWithAction:function(a){if(!a)throw"cc.ActionEase.initWithAction(): action must be non nil";return this.initWithDuration(a.getDuration())?(this._inner=a,!0):!1},clone:function(){var a=new cc.ActionEase;return a.initWithAction(this._inner.clone()),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._inner.startWithTarget(this.target)},
stop:function(){this._inner.stop();cc.ActionInterval.prototype.stop.call(this)},update:function(a){this._inner.update(a)},reverse:function(){return new cc.ActionEase(this._inner.reverse())},getInnerAction:function(){return this._inner}});cc.actionEase=function(a){return new cc.ActionEase(a)};cc.ActionEase.create=cc.actionEase;
cc.EaseRateAction=cc.ActionEase.extend({_rate:0,ctor:function(a,b){cc.ActionEase.prototype.ctor.call(this);void 0!==b&&this.initWithAction(a,b)},setRate:function(a){this._rate=a},getRate:function(){return this._rate},initWithAction:function(a,b){return cc.ActionEase.prototype.initWithAction.call(this,a)?(this._rate=b,!0):!1},clone:function(){var a=new cc.EaseRateAction;return a.initWithAction(this._inner.clone(),this._rate),a},reverse:function(){return new cc.EaseRateAction(this._inner.reverse(),
1/this._rate)}});cc.easeRateAction=function(a,b){return new cc.EaseRateAction(a,b)};cc.EaseRateAction.create=cc.easeRateAction;cc.EaseIn=cc.EaseRateAction.extend({update:function(a){this._inner.update(Math.pow(a,this._rate))},reverse:function(){return new cc.EaseIn(this._inner.reverse(),1/this._rate)},clone:function(){var a=new cc.EaseIn;return a.initWithAction(this._inner.clone(),this._rate),a}});cc.EaseIn.create=function(a,b){return new cc.EaseIn(a,b)};
cc.easeIn=function(a){return{_rate:a,easing:function(a){return Math.pow(a,this._rate)},reverse:function(){return cc.easeIn(1/this._rate)}}};cc.EaseOut=cc.EaseRateAction.extend({update:function(a){this._inner.update(Math.pow(a,1/this._rate))},reverse:function(){return new cc.EaseOut(this._inner.reverse(),1/this._rate)},clone:function(){var a=new cc.EaseOut;return a.initWithAction(this._inner.clone(),this._rate),a}});cc.EaseOut.create=function(a,b){return new cc.EaseOut(a,b)};
cc.easeOut=function(a){return{_rate:a,easing:function(a){return Math.pow(a,1/this._rate)},reverse:function(){return cc.easeOut(1/this._rate)}}};cc.EaseInOut=cc.EaseRateAction.extend({update:function(a){a*=2;this._inner.update(1>a?.5*Math.pow(a,this._rate):1-.5*Math.pow(2-a,this._rate))},clone:function(){var a=new cc.EaseInOut;return a.initWithAction(this._inner.clone(),this._rate),a},reverse:function(){return new cc.EaseInOut(this._inner.reverse(),this._rate)}});
cc.EaseInOut.create=function(a,b){return new cc.EaseInOut(a,b)};cc.easeInOut=function(a){return{_rate:a,easing:function(a){return a*=2,1>a?.5*Math.pow(a,this._rate):1-.5*Math.pow(2-a,this._rate)},reverse:function(){return cc.easeInOut(this._rate)}}};
cc.EaseExponentialIn=cc.ActionEase.extend({update:function(a){this._inner.update(0===a?0:Math.pow(2,10*(a-1)))},reverse:function(){return new cc.EaseExponentialOut(this._inner.reverse())},clone:function(){var a=new cc.EaseExponentialIn;return a.initWithAction(this._inner.clone()),a}});cc.EaseExponentialIn.create=function(a){return new cc.EaseExponentialIn(a)};cc._easeExponentialInObj={easing:function(a){return 0===a?0:Math.pow(2,10*(a-1))},reverse:function(){return cc._easeExponentialOutObj}};
cc.easeExponentialIn=function(){return cc._easeExponentialInObj};cc.EaseExponentialOut=cc.ActionEase.extend({update:function(a){this._inner.update(1==a?1:-Math.pow(2,-10*a)+1)},reverse:function(){return new cc.EaseExponentialIn(this._inner.reverse())},clone:function(){var a=new cc.EaseExponentialOut;return a.initWithAction(this._inner.clone()),a}});cc.EaseExponentialOut.create=function(a){return new cc.EaseExponentialOut(a)};
cc._easeExponentialOutObj={easing:function(a){return 1==a?1:-Math.pow(2,-10*a)+1},reverse:function(){return cc._easeExponentialInObj}};cc.easeExponentialOut=function(){return cc._easeExponentialOutObj};
cc.EaseExponentialInOut=cc.ActionEase.extend({update:function(a){1!=a&&0!==a&&(a*=2,a=1>a?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*(a-1))+2));this._inner.update(a)},reverse:function(){return new cc.EaseExponentialInOut(this._inner.reverse())},clone:function(){var a=new cc.EaseExponentialInOut;return a.initWithAction(this._inner.clone()),a}});cc.EaseExponentialInOut.create=function(a){return new cc.EaseExponentialInOut(a)};
cc._easeExponentialInOutObj={easing:function(a){return 1!==a&&0!==a?(a*=2,1>a?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*(a-1))+2)):a},reverse:function(){return cc._easeExponentialInOutObj}};cc.easeExponentialInOut=function(){return cc._easeExponentialInOutObj};
cc.EaseSineIn=cc.ActionEase.extend({update:function(a){a=0===a||1===a?a:-1*Math.cos(a*Math.PI/2)+1;this._inner.update(a)},reverse:function(){return new cc.EaseSineOut(this._inner.reverse())},clone:function(){var a=new cc.EaseSineIn;return a.initWithAction(this._inner.clone()),a}});cc.EaseSineIn.create=function(a){return new cc.EaseSineIn(a)};cc._easeSineInObj={easing:function(a){return 0===a||1===a?a:-1*Math.cos(a*Math.PI/2)+1},reverse:function(){return cc._easeSineOutObj}};cc.easeSineIn=function(){return cc._easeSineInObj};
cc.EaseSineOut=cc.ActionEase.extend({update:function(a){a=0===a||1===a?a:Math.sin(a*Math.PI/2);this._inner.update(a)},reverse:function(){return new cc.EaseSineIn(this._inner.reverse())},clone:function(){var a=new cc.EaseSineOut;return a.initWithAction(this._inner.clone()),a}});cc.EaseSineOut.create=function(a){return new cc.EaseSineOut(a)};cc._easeSineOutObj={easing:function(a){return 0===a||1==a?a:Math.sin(a*Math.PI/2)},reverse:function(){return cc._easeSineInObj}};cc.easeSineOut=function(){return cc._easeSineOutObj};
cc.EaseSineInOut=cc.ActionEase.extend({update:function(a){a=0===a||1===a?a:-.5*(Math.cos(Math.PI*a)-1);this._inner.update(a)},clone:function(){var a=new cc.EaseSineInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseSineInOut(this._inner.reverse())}});cc.EaseSineInOut.create=function(a){return new cc.EaseSineInOut(a)};cc._easeSineInOutObj={easing:function(a){return 0===a||1===a?a:-.5*(Math.cos(Math.PI*a)-1)},reverse:function(){return cc._easeSineInOutObj}};
cc.easeSineInOut=function(){return cc._easeSineInOutObj};
cc.EaseElastic=cc.ActionEase.extend({_period:.3,ctor:function(a,b){cc.ActionEase.prototype.ctor.call(this);a&&this.initWithAction(a,b)},getPeriod:function(){return this._period},setPeriod:function(a){this._period=a},initWithAction:function(a,b){return cc.ActionEase.prototype.initWithAction.call(this,a),this._period=null==b?.3:b,!0},reverse:function(){return cc.log("cc.EaseElastic.reverse(): it should be overridden in subclass."),null},clone:function(){var a=new cc.EaseElastic;return a.initWithAction(this._inner.clone(),
this._period),a}});cc.EaseElastic.create=function(a,b){return new cc.EaseElastic(a,b)};cc.EaseElasticIn=cc.EaseElastic.extend({update:function(a){var b=0;0===a||1===a?b=a:(b=this._period/4,a-=1,b=-Math.pow(2,10*a)*Math.sin((a-b)*Math.PI*2/this._period));this._inner.update(b)},reverse:function(){return new cc.EaseElasticOut(this._inner.reverse(),this._period)},clone:function(){var a=new cc.EaseElasticIn;return a.initWithAction(this._inner.clone(),this._period),a}});
cc.EaseElasticIn.create=function(a,b){return new cc.EaseElasticIn(a,b)};cc._easeElasticInObj={easing:function(a){return 0===a||1===a?a:(a-=1,-Math.pow(2,10*a)*Math.sin((a-.075)*Math.PI*2/.3))},reverse:function(){return cc._easeElasticOutObj}};cc.easeElasticIn=function(a){return a&&.3!==a?{_period:a,easing:function(a){return 0===a||1===a?a:(a-=1,-Math.pow(2,10*a)*Math.sin((a-this._period/4)*Math.PI*2/this._period))},reverse:function(){return cc.easeElasticOut(this._period)}}:cc._easeElasticInObj};
cc.EaseElasticOut=cc.EaseElastic.extend({update:function(a){var b=0;0===a||1==a?b=a:(b=this._period/4,b=Math.pow(2,-10*a)*Math.sin((a-b)*Math.PI*2/this._period)+1);this._inner.update(b)},reverse:function(){return new cc.EaseElasticIn(this._inner.reverse(),this._period)},clone:function(){var a=new cc.EaseElasticOut;return a.initWithAction(this._inner.clone(),this._period),a}});cc.EaseElasticOut.create=function(a,b){return new cc.EaseElasticOut(a,b)};
cc._easeElasticOutObj={easing:function(a){return 0===a||1===a?a:Math.pow(2,-10*a)*Math.sin((a-.075)*Math.PI*2/.3)+1},reverse:function(){return cc._easeElasticInObj}};cc.easeElasticOut=function(a){return a&&.3!==a?{_period:a,easing:function(a){return 0===a||1===a?a:Math.pow(2,-10*a)*Math.sin((a-this._period/4)*Math.PI*2/this._period)+1},reverse:function(){return cc.easeElasticIn(this._period)}}:cc._easeElasticOutObj};
cc.EaseElasticInOut=cc.EaseElastic.extend({update:function(a){var b=0,b=this._period;if(0===a||1==a)b=a;else{b||(b=this._period=.3*1.5);var c=b/4;a=2*a-1;b=0>a?-.5*Math.pow(2,10*a)*Math.sin((a-c)*Math.PI*2/b):Math.pow(2,-10*a)*Math.sin((a-c)*Math.PI*2/b)*.5+1}this._inner.update(b)},reverse:function(){return new cc.EaseElasticInOut(this._inner.reverse(),this._period)},clone:function(){var a=new cc.EaseElasticInOut;return a.initWithAction(this._inner.clone(),this._period),a}});
cc.EaseElasticInOut.create=function(a,b){return new cc.EaseElasticInOut(a,b)};cc.easeElasticInOut=function(a){return a=a||.3,{_period:a,easing:function(a){var c=0,c=this._period;if(0===a||1===a)c=a;else{c||(c=this._period=.3*1.5);var d=c/4;a=2*a-1;c=0>a?-.5*Math.pow(2,10*a)*Math.sin((a-d)*Math.PI*2/c):Math.pow(2,-10*a)*Math.sin((a-d)*Math.PI*2/c)*.5+1}return c},reverse:function(){return cc.easeElasticInOut(this._period)}}};
cc.EaseBounce=cc.ActionEase.extend({bounceTime:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?(a-=1.5/2.75,7.5625*a*a+.75):2.5/2.75>a?(a-=2.25/2.75,7.5625*a*a+.9375):(a-=2.625/2.75,7.5625*a*a+.984375)},clone:function(){var a=new cc.EaseBounce;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseBounce(this._inner.reverse())}});cc.EaseBounce.create=function(a){return new cc.EaseBounce(a)};
cc.EaseBounceIn=cc.EaseBounce.extend({update:function(a){a=1-this.bounceTime(1-a);this._inner.update(a)},reverse:function(){return new cc.EaseBounceOut(this._inner.reverse())},clone:function(){var a=new cc.EaseBounceIn;return a.initWithAction(this._inner.clone()),a}});cc.EaseBounceIn.create=function(a){return new cc.EaseBounceIn(a)};cc._bounceTime=function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?(a-=1.5/2.75,7.5625*a*a+.75):2.5/2.75>a?(a-=2.25/2.75,7.5625*a*a+.9375):(a-=2.625/2.75,7.5625*a*a+.984375)};
cc._easeBounceInObj={easing:function(a){return 1-cc._bounceTime(1-a)},reverse:function(){return cc._easeBounceOutObj}};cc.easeBounceIn=function(){return cc._easeBounceInObj};cc.EaseBounceOut=cc.EaseBounce.extend({update:function(a){a=this.bounceTime(a);this._inner.update(a)},reverse:function(){return new cc.EaseBounceIn(this._inner.reverse())},clone:function(){var a=new cc.EaseBounceOut;return a.initWithAction(this._inner.clone()),a}});cc.EaseBounceOut.create=function(a){return new cc.EaseBounceOut(a)};
cc._easeBounceOutObj={easing:function(a){return cc._bounceTime(a)},reverse:function(){return cc._easeBounceInObj}};cc.easeBounceOut=function(){return cc._easeBounceOutObj};cc.EaseBounceInOut=cc.EaseBounce.extend({update:function(a){var b=0;.5>a?(a*=2,b=.5*(1-this.bounceTime(1-a))):b=.5*this.bounceTime(2*a-1)+.5;this._inner.update(b)},clone:function(){var a=new cc.EaseBounceInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseBounceInOut(this._inner.reverse())}});
cc.EaseBounceInOut.create=function(a){return new cc.EaseBounceInOut(a)};cc._easeBounceInOutObj={easing:function(a){var b;return.5>a?(a*=2,b=.5*(1-cc._bounceTime(1-a))):b=.5*cc._bounceTime(2*a-1)+.5,b},reverse:function(){return cc._easeBounceInOutObj}};cc.easeBounceInOut=function(){return cc._easeBounceInOutObj};
cc.EaseBackIn=cc.ActionEase.extend({update:function(a){this._inner.update(0===a||1==a?a:a*a*(2.70158*a-1.70158))},reverse:function(){return new cc.EaseBackOut(this._inner.reverse())},clone:function(){var a=new cc.EaseBackIn;return a.initWithAction(this._inner.clone()),a}});cc.EaseBackIn.create=function(a){return new cc.EaseBackIn(a)};cc._easeBackInObj={easing:function(a){return 0===a||1===a?a:a*a*(2.70158*a-1.70158)},reverse:function(){return cc._easeBackOutObj}};cc.easeBackIn=function(){return cc._easeBackInObj};
cc.EaseBackOut=cc.ActionEase.extend({update:function(a){a-=1;this._inner.update(a*a*(2.70158*a+1.70158)+1)},reverse:function(){return new cc.EaseBackIn(this._inner.reverse())},clone:function(){var a=new cc.EaseBackOut;return a.initWithAction(this._inner.clone()),a}});cc.EaseBackOut.create=function(a){return new cc.EaseBackOut(a)};cc._easeBackOutObj={easing:function(a){return a-=1,a*a*(2.70158*a+1.70158)+1},reverse:function(){return cc._easeBackInObj}};cc.easeBackOut=function(){return cc._easeBackOutObj};
cc.EaseBackInOut=cc.ActionEase.extend({update:function(a){a*=2;1>a?this._inner.update(a*a*(3.5949095*a-2.5949095)/2):(a-=2,this._inner.update(a*a*(3.5949095*a+2.5949095)/2+1))},clone:function(){var a=new cc.EaseBackInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseBackInOut(this._inner.reverse())}});cc.EaseBackInOut.create=function(a){return new cc.EaseBackInOut(a)};
cc._easeBackInOutObj={easing:function(a){return a*=2,1>a?a*a*(3.5949095*a-2.5949095)/2:(a-=2,a*a*(3.5949095*a+2.5949095)/2+1)},reverse:function(){return cc._easeBackInOutObj}};cc.easeBackInOut=function(){return cc._easeBackInOutObj};
cc.EaseBezierAction=cc.ActionEase.extend({_p0:null,_p1:null,_p2:null,_p3:null,ctor:function(a){cc.ActionEase.prototype.ctor.call(this,a)},_updateTime:function(a,b,c,d,e){return Math.pow(1-e,3)*a+3*e*Math.pow(1-e,2)*b+3*Math.pow(e,2)*(1-e)*c+Math.pow(e,3)*d},update:function(a){a=this._updateTime(this._p0,this._p1,this._p2,this._p3,a);this._inner.update(a)},clone:function(){var a=new cc.EaseBezierAction;return a.initWithAction(this._inner.clone()),a.setBezierParamer(this._p0,this._p1,this._p2,this._p3),
a},reverse:function(){var a=new cc.EaseBezierAction(this._inner.reverse());return a.setBezierParamer(this._p3,this._p2,this._p1,this._p0),a},setBezierParamer:function(a,b,c,d){this._p0=a||0;this._p1=b||0;this._p2=c||0;this._p3=d||0}});cc.EaseBezierAction.create=function(a){return new cc.EaseBezierAction(a)};cc.easeBezierAction=function(a,b,c,d){return{easing:function(e){return cc.EaseBezierAction.prototype._updateTime(a,b,c,d,e)},reverse:function(){return cc.easeBezierAction(d,c,b,a)}}};
cc.EaseQuadraticActionIn=cc.ActionEase.extend({_updateTime:function(a){return Math.pow(a,2)},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuadraticActionIn;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuadraticActionIn(this._inner.reverse())}});cc.EaseQuadraticActionIn.create=function(a){return new cc.EaseQuadraticActionIn(a)};cc._easeQuadraticActionIn={easing:cc.EaseQuadraticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionIn}};
cc.easeQuadraticActionIn=function(){return cc._easeQuadraticActionIn};cc.EaseQuadraticActionOut=cc.ActionEase.extend({_updateTime:function(a){return-a*(a-2)},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuadraticActionOut;return a.initWithAction(),a},reverse:function(){return new cc.EaseQuadraticActionOut(this._inner.reverse())}});cc.EaseQuadraticActionOut.create=function(a){return new cc.EaseQuadraticActionOut(a)};
cc._easeQuadraticActionOut={easing:cc.EaseQuadraticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionOut}};cc.easeQuadraticActionOut=function(){return cc._easeQuadraticActionOut};
cc.EaseQuadraticActionInOut=cc.ActionEase.extend({_updateTime:function(a){var b=a;return a*=2,1>a?b=a*a*.5:(--a,b=-.5*(a*(a-2)-1)),b},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuadraticActionInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuadraticActionInOut(this._inner.reverse())}});cc.EaseQuadraticActionInOut.create=function(a){return new cc.EaseQuadraticActionInOut(a)};
cc._easeQuadraticActionInOut={easing:cc.EaseQuadraticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuadraticActionInOut}};cc.easeQuadraticActionInOut=function(){return cc._easeQuadraticActionInOut};cc.EaseQuarticActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a*a},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuarticActionIn;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuarticActionIn(this._inner.reverse())}});
cc.EaseQuarticActionIn.create=function(a){return new cc.EaseQuarticActionIn(a)};cc._easeQuarticActionIn={easing:cc.EaseQuarticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuarticActionIn}};cc.easeQuarticActionIn=function(){return cc._easeQuarticActionIn};
cc.EaseQuarticActionOut=cc.ActionEase.extend({_updateTime:function(a){return a-=1,-(a*a*a*a-1)},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuarticActionOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuarticActionOut(this._inner.reverse())}});cc.EaseQuarticActionOut.create=function(a){return new cc.EaseQuarticActionOut(a)};cc._easeQuarticActionOut={easing:cc.EaseQuarticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionOut}};
cc.easeQuarticActionOut=function(){return cc._easeQuarticActionOut};cc.EaseQuarticActionInOut=cc.ActionEase.extend({_updateTime:function(a){return a*=2,1>a?.5*a*a*a*a:(a-=2,-.5*(a*a*a*a-2))},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuarticActionInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuarticActionInOut(this._inner.reverse())}});cc.EaseQuarticActionInOut.create=function(a){return new cc.EaseQuarticActionInOut(a)};
cc._easeQuarticActionInOut={easing:cc.EaseQuarticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuarticActionInOut}};cc.easeQuarticActionInOut=function(){return cc._easeQuarticActionInOut};cc.EaseQuinticActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a*a*a},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuinticActionIn;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuinticActionIn(this._inner.reverse())}});
cc.EaseQuinticActionIn.create=function(a){return new cc.EaseQuinticActionIn(a)};cc._easeQuinticActionIn={easing:cc.EaseQuinticActionIn.prototype._updateTime,reverse:function(){return cc._easeQuinticActionIn}};cc.easeQuinticActionIn=function(){return cc._easeQuinticActionIn};
cc.EaseQuinticActionOut=cc.ActionEase.extend({_updateTime:function(a){return a-=1,a*a*a*a*a+1},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuinticActionOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuinticActionOut(this._inner.reverse())}});cc.EaseQuinticActionOut.create=function(a){return new cc.EaseQuinticActionOut(a)};cc._easeQuinticActionOut={easing:cc.EaseQuinticActionOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionOut}};
cc.easeQuinticActionOut=function(){return cc._easeQuinticActionOut};cc.EaseQuinticActionInOut=cc.ActionEase.extend({_updateTime:function(a){return a*=2,1>a?.5*a*a*a*a*a:(a-=2,.5*(a*a*a*a*a+2))},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseQuinticActionInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseQuinticActionInOut(this._inner.reverse())}});cc.EaseQuinticActionInOut.create=function(a){return new cc.EaseQuinticActionInOut(a)};
cc._easeQuinticActionInOut={easing:cc.EaseQuinticActionInOut.prototype._updateTime,reverse:function(){return cc._easeQuinticActionInOut}};cc.easeQuinticActionInOut=function(){return cc._easeQuinticActionInOut};cc.EaseCircleActionIn=cc.ActionEase.extend({_updateTime:function(a){return-1*(Math.sqrt(1-a*a)-1)},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCircleActionIn;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCircleActionIn(this._inner.reverse())}});
cc.EaseCircleActionIn.create=function(a){return new cc.EaseCircleActionIn(a)};cc._easeCircleActionIn={easing:cc.EaseCircleActionIn.prototype._updateTime,reverse:function(){return cc._easeCircleActionIn}};cc.easeCircleActionIn=function(){return cc._easeCircleActionIn};
cc.EaseCircleActionOut=cc.ActionEase.extend({_updateTime:function(a){return a-=1,Math.sqrt(1-a*a)},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCircleActionOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCircleActionOut(this._inner.reverse())}});cc.EaseCircleActionOut.create=function(a){return new cc.EaseCircleActionOut(a)};cc._easeCircleActionOut={easing:cc.EaseCircleActionOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionOut}};
cc.easeCircleActionOut=function(){return cc._easeCircleActionOut};cc.EaseCircleActionInOut=cc.ActionEase.extend({_updateTime:function(a){return a*=2,1>a?-.5*(Math.sqrt(1-a*a)-1):(a-=2,.5*(Math.sqrt(1-a*a)+1))},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCircleActionInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCircleActionInOut(this._inner.reverse())}});cc.EaseCircleActionInOut.create=function(a){return new cc.EaseCircleActionInOut(a)};
cc._easeCircleActionInOut={easing:cc.EaseCircleActionInOut.prototype._updateTime,reverse:function(){return cc._easeCircleActionInOut}};cc.easeCircleActionInOut=function(){return cc._easeCircleActionInOut};cc.EaseCubicActionIn=cc.ActionEase.extend({_updateTime:function(a){return a*a*a},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCubicActionIn;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCubicActionIn(this._inner.reverse())}});
cc.EaseCubicActionIn.create=function(a){return new cc.EaseCubicActionIn(a)};cc._easeCubicActionIn={easing:cc.EaseCubicActionIn.prototype._updateTime,reverse:function(){return cc._easeCubicActionIn}};cc.easeCubicActionIn=function(){return cc._easeCubicActionIn};
cc.EaseCubicActionOut=cc.ActionEase.extend({_updateTime:function(a){return a-=1,a*a*a+1},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCubicActionOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCubicActionOut(this._inner.reverse())}});cc.EaseCubicActionOut.create=function(a){return new cc.EaseCubicActionOut(a)};cc._easeCubicActionOut={easing:cc.EaseCubicActionOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionOut}};
cc.easeCubicActionOut=function(){return cc._easeCubicActionOut};cc.EaseCubicActionInOut=cc.ActionEase.extend({_updateTime:function(a){return a*=2,1>a?.5*a*a*a:(a-=2,.5*(a*a*a+2))},update:function(a){this._inner.update(this._updateTime(a))},clone:function(){var a=new cc.EaseCubicActionInOut;return a.initWithAction(this._inner.clone()),a},reverse:function(){return new cc.EaseCubicActionInOut(this._inner.reverse())}});cc.EaseCubicActionInOut.create=function(a){return new cc.EaseCubicActionInOut(a)};
cc._easeCubicActionInOut={easing:cc.EaseCubicActionInOut.prototype._updateTime,reverse:function(){return cc._easeCubicActionInOut}};cc.easeCubicActionInOut=function(){return cc._easeCubicActionInOut};cc.cardinalSplineAt=function(a,b,c,d,e,f){var g=f*f,h=g*f,k=(1-e)/2;e=k*(-h+2*g-f);var m=k*(-h+g)+(2*h-3*g+1);f=k*(h-2*g+f)+(-2*h+3*g);g=k*(h-g);return cc.p(a.x*e+b.x*m+c.x*f+d.x*g,a.y*e+b.y*m+c.y*f+d.y*g)};
cc.reverseControlPoints=function(a){for(var b=[],c=a.length-1;0<=c;c--)b.push(cc.p(a[c].x,a[c].y));return b};cc.cloneControlPoints=function(a){for(var b=[],c=0;c<a.length;c++)b.push(cc.p(a[c].x,a[c].y));return b};cc.copyControlPoints=cc.cloneControlPoints;cc.getControlPointAt=function(a,b){var c=Math.min(a.length-1,Math.max(b,0));return a[c]};cc.reverseControlPointsInline=function(a){for(var b=a.length,c=0|b/2,d=0;c>d;++d){var e=a[d];a[d]=a[b-d-1];a[b-d-1]=e}};
cc.CardinalSplineTo=cc.ActionInterval.extend({_points:null,_deltaT:0,_tension:0,_previousPosition:null,_accumulatedDiff:null,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);this._points=[];void 0!==c&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){if(!b||0==b.length)throw"Invalid configuration. It must at least have one control point";return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this.setPoints(b),this._tension=c,!0):!1},clone:function(){var a=
new cc.CardinalSplineTo;return a.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),a},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a);this._deltaT=1/(this._points.length-1);this._previousPosition=cc.p(this.target.getPositionX(),this.target.getPositionY());this._accumulatedDiff=cc.p(0,0)},update:function(a){a=this._computeEaseTime(a);var b,c=this._points;if(1==a)b=c.length-1,a=1;else{var d=this._deltaT;b=0|a/d;a=(a-d*b)/d}b=cc.cardinalSplineAt(cc.getControlPointAt(c,
b-1),cc.getControlPointAt(c,b-0),cc.getControlPointAt(c,b+1),cc.getControlPointAt(c,b+2),this._tension,a);if(cc.ENABLE_STACKABLE_ACTIONS){var e,f;if(e=this.target.getPositionX()-this._previousPosition.x,f=this.target.getPositionY()-this._previousPosition.y,0!=e||0!=f)c=this._accumulatedDiff,e=c.x+e,f=c.y+f,c.x=e,c.y=f,b.x+=e,b.y+=f}this.updatePosition(b)},reverse:function(){var a=cc.reverseControlPoints(this._points);return cc.cardinalSplineTo(this._duration,a,this._tension)},updatePosition:function(a){this.target.setPosition(a);
this._previousPosition=a},getPoints:function(){return this._points},setPoints:function(a){this._points=a}});cc.cardinalSplineTo=function(a,b,c){return new cc.CardinalSplineTo(a,b,c)};cc.CardinalSplineTo.create=cc.cardinalSplineTo;
cc.CardinalSplineBy=cc.CardinalSplineTo.extend({_startPosition:null,ctor:function(a,b,c){cc.CardinalSplineTo.prototype.ctor.call(this);this._startPosition=cc.p(0,0);void 0!==c&&this.initWithDuration(a,b,c)},startWithTarget:function(a){cc.CardinalSplineTo.prototype.startWithTarget.call(this,a);this._startPosition.x=a.getPositionX();this._startPosition.y=a.getPositionY()},reverse:function(){for(var a,b=this._points.slice(),c=b[0],d=1;d<b.length;++d)a=b[d],b[d]=cc.pSub(a,c),c=a;b=cc.reverseControlPoints(b);
c=b[b.length-1];b.pop();c.x=-c.x;c.y=-c.y;b.unshift(c);for(d=1;d<b.length;++d)a=b[d],a.x=-a.x,a.y=-a.y,a.x+=c.x,a.y+=c.y,c=b[d]=a;return cc.cardinalSplineBy(this._duration,b,this._tension)},updatePosition:function(a){var b=this._startPosition,c=a.x+b.x;a=a.y+b.y;this._previousPosition.x=c;this._previousPosition.y=a;this.target.setPosition(c,a)},clone:function(){var a=new cc.CardinalSplineBy;return a.initWithDuration(this._duration,cc.copyControlPoints(this._points),this._tension),a}});
cc.cardinalSplineBy=function(a,b,c){return new cc.CardinalSplineBy(a,b,c)};cc.CardinalSplineBy.create=cc.cardinalSplineBy;cc.CatmullRomTo=cc.CardinalSplineTo.extend({ctor:function(a,b){b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,a,b,.5)},clone:function(){var a=new cc.CatmullRomTo;return a.initWithDuration(this._duration,cc.copyControlPoints(this._points)),a}});
cc.catmullRomTo=function(a,b){return new cc.CatmullRomTo(a,b)};cc.CatmullRomTo.create=cc.catmullRomTo;cc.CatmullRomBy=cc.CardinalSplineBy.extend({ctor:function(a,b){cc.CardinalSplineBy.prototype.ctor.call(this);b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.CardinalSplineTo.prototype.initWithDuration.call(this,a,b,.5)},clone:function(){var a=new cc.CatmullRomBy;return a.initWithDuration(this._duration,cc.copyControlPoints(this._points)),a}});
cc.catmullRomBy=function(a,b){return new cc.CatmullRomBy(a,b)};cc.CatmullRomBy.create=cc.catmullRomBy;cc.ActionTweenDelegate=cc.Class.extend({updateTweenAction:function(){}});
cc.ActionTween=cc.ActionInterval.extend({key:"",from:0,to:0,delta:0,ctor:function(a,b,c,d){cc.ActionInterval.prototype.ctor.call(this);this.key="";void 0!==d&&this.initWithDuration(a,b,c,d)},initWithDuration:function(a,b,c,d){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this.key=b,this.to=d,this.from=c,!0):!1},startWithTarget:function(a){if(!a||!a.updateTweenAction)throw"cc.ActionTween.startWithTarget(): target must be non-null, and target must implement updateTweenAction function";
cc.ActionInterval.prototype.startWithTarget.call(this,a);this.delta=this.to-this.from},update:function(a){this.target.updateTweenAction(this.to-this.delta*(1-a),this.key)},reverse:function(){return new cc.ActionTween(this.duration,this.key,this.to,this.from)},clone:function(){var a=new cc.ActionTween;return a.initWithDuration(this._duration,this.key,this.from,this.to),a}});cc.actionTween=function(a,b,c,d){return new cc.ActionTween(a,b,c,d)};cc.ActionTween.create=cc.actionTween;
cc._globalFontSize=cc.ITEM_SIZE;cc._globalFontName="Arial";cc._globalFontNameRelease=!1;
cc.MenuItem=cc.Node.extend({_enabled:!1,_target:null,_callback:null,_isSelected:!1,_className:"MenuItem",ctor:function(a,b){var c=cc.Node.prototype;c.ctor.call(this);this._callback=this._target=null;this._enabled=this._isSelected=!1;c.setAnchorPoint.call(this,.5,.5);this._target=b||null;(this._callback=a||null)&&(this._enabled=!0)},isSelected:function(){return this._isSelected},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1},setTarget:function(a,b){this._target=b;this._callback=
a},isEnabled:function(){return this._enabled},setEnabled:function(a){this._enabled=a},initWithCallback:function(a,b){return this.anchorX=.5,this.anchorY=.5,this._target=b,this._callback=a,this._enabled=!0,this._isSelected=!1,!0},rect:function(){var a=this._position,b=this._contentSize,c=this._anchorPoint;return cc.rect(a.x-b.width*c.x,a.y-b.height*c.y,b.width,b.height)},selected:function(){this._isSelected=!0},unselected:function(){this._isSelected=!1},setCallback:function(a,b){this._target=b;this._callback=
a},activate:function(){if(this._enabled){var a=this._target,b=this._callback;b&&(a&&"string"==typeof b?a[b](this):a&&"function"==typeof b?b.call(a,this):b(this))}}});_p=cc.MenuItem.prototype;_p.enabled;cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled);cc.MenuItem.create=function(a,b){return new cc.MenuItem(a,b)};
cc.MenuItemLabel=cc.MenuItem.extend({_disabledColor:null,_label:null,_orginalScale:0,_colorBackup:null,ctor:function(a,b,c){cc.MenuItem.prototype.ctor.call(this,b,c);this._label=this._disabledColor=null;this._orginalScale=0;this._colorBackup=null;a&&(this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(a),this.cascadeColor=!0,this.cascadeOpacity=!0)},getDisabledColor:function(){return this._disabledColor},setDisabledColor:function(a){this._disabledColor=
a},getLabel:function(){return this._label},setLabel:function(a){a&&(this.addChild(a),a.anchorX=0,a.anchorY=0,this.width=a.width,this.height=a.height);this._label&&this.removeChild(this._label,!0);this._label=a},setEnabled:function(a){if(this._enabled!=a){var b=this._label;a?b.color=this._colorBackup:(this._colorBackup=b.color,b.color=this._disabledColor)}cc.MenuItem.prototype.setEnabled.call(this,a)},setOpacity:function(a){this._label.opacity=a},getOpacity:function(){return this._label.opacity},setColor:function(a){this._label.color=
a},getColor:function(){return this._label.color},initWithLabel:function(a,b,c){return this.initWithCallback(b,c),this._originalScale=1,this._colorBackup=cc.color.WHITE,this._disabledColor=cc.color(126,126,126),this.setLabel(a),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},setString:function(a){this._label.string=a;this.width=this._label.width;this.height=this._label.height},getString:function(){return this._label.string},activate:function(){this._enabled&&(this.stopAllActions(),this.scale=this._originalScale,
cc.MenuItem.prototype.activate.call(this))},selected:function(){if(this._enabled){cc.MenuItem.prototype.selected.call(this);var a=this.getActionByTag(cc.ZOOM_ACTION_TAG);a?this.stopAction(a):this._originalScale=this.scale;a=cc.ScaleTo.create(.1,1.2*this._originalScale);a.setTag(cc.ZOOM_ACTION_TAG);this.runAction(a)}},unselected:function(){if(this._enabled){cc.MenuItem.prototype.unselected.call(this);this.stopActionByTag(cc.ZOOM_ACTION_TAG);var a=cc.ScaleTo.create(.1,this._originalScale);a.setTag(cc.ZOOM_ACTION_TAG);
this.runAction(a)}}});_p=cc.MenuItemLabel.prototype;_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);_p.disabledColor;cc.defineGetterSetter(_p,"disabledColor",_p.getDisabledColor,_p.setDisabledColor);_p.label;cc.defineGetterSetter(_p,"label",_p.getLabel,_p.setLabel);cc.MenuItemLabel.create=function(a,b,c){return new cc.MenuItemLabel(a,b,c)};
cc.MenuItemAtlasFont=cc.MenuItemLabel.extend({ctor:function(a,b,c,d,e,f,g){var h;a&&0<a.length&&(h=cc.LabelAtlas.create(a,b,c,d,e));cc.MenuItemLabel.prototype.ctor.call(this,h,f,g)},initWithString:function(a,b,c,d,e,f,g){if(!a||0==a.length)throw"cc.MenuItemAtlasFont.initWithString(): value should be non-null and its length should be greater than 0";var h=new cc.LabelAtlas;return h.initWithString(a,b,c,d,e),this.initWithLabel(h,f,g),!0}});
cc.MenuItemAtlasFont.create=function(a,b,c,d,e,f,g){return new cc.MenuItemAtlasFont(a,b,c,d,e,f,g)};
cc.MenuItemFont=cc.MenuItemLabel.extend({_fontSize:null,_fontName:null,ctor:function(a,b,c){var d;a&&0<a.length?(this._fontName=cc._globalFontName,this._fontSize=cc._globalFontSize,d=cc.LabelTTF.create(a,this._fontName,this._fontSize)):(this._fontSize=0,this._fontName="");cc.MenuItemLabel.prototype.ctor.call(this,d,b,c)},initWithString:function(a,b,c){if(!a||0==a.length)throw"Value should be non-null and its length should be greater than 0";this._fontName=cc._globalFontName;this._fontSize=cc._globalFontSize;
a=cc.LabelTTF.create(a,this._fontName,this._fontSize);return this.initWithLabel(a,b,c),!0},setFontSize:function(a){this._fontSize=a;this._recreateLabel()},getFontSize:function(){return this._fontSize},setFontName:function(a){this._fontName=a;this._recreateLabel()},getFontName:function(){return this._fontName},_recreateLabel:function(){var a=cc.LabelTTF.create(this._label.string,this._fontName,this._fontSize);this.setLabel(a)}});cc.MenuItemFont.setFontSize=function(a){cc._globalFontSize=a};
cc.MenuItemFont.fontSize=function(){return cc._globalFontSize};cc.MenuItemFont.setFontName=function(a){cc._globalFontNameRelease&&(cc._globalFontName="");cc._globalFontName=a;cc._globalFontNameRelease=!0};_p=cc.MenuItemFont.prototype;_p.fontSize;cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize);_p.fontName;cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName);cc.MenuItemFont.fontName=function(){return cc._globalFontName};
cc.MenuItemFont.create=function(a,b,c){return new cc.MenuItemFont(a,b,c)};
cc.MenuItemSprite=cc.MenuItem.extend({_normalImage:null,_selectedImage:null,_disabledImage:null,ctor:function(a,b,c,d,e){if(cc.MenuItem.prototype.ctor.call(this),this._normalImage=null,this._selectedImage=null,this._disabledImage=null,void 0!==b){var f,g,h;void 0!==e?(f=c,h=d,g=e):void 0!==d&&"function"==typeof d?(f=c,h=d):void 0!==d&&"function"==typeof c?(g=d,h=c,f=cc.Sprite.create(b)):void 0===c&&(f=cc.Sprite.create(b));this.initWithNormalSprite(a,b,f,h,g)}},getNormalImage:function(){return this._normalImage},
setNormalImage:function(a){this._normalImage!=a&&(a&&(this.addChild(a,0,cc.NORMAL_TAG),a.anchorX=0,a.anchorY=0),this._normalImage&&this.removeChild(this._normalImage,!0),this._normalImage=a,this.width=this._normalImage.width,this.height=this._normalImage.height,this._updateImagesVisibility(),a.textureLoaded&&!a.textureLoaded()&&a.addLoadedEventListener(function(a){this.width=a.width;this.height=a.height},this))},getSelectedImage:function(){return this._selectedImage},setSelectedImage:function(a){this._selectedImage!=
a&&(a&&(this.addChild(a,0,cc.SELECTED_TAG),a.anchorX=0,a.anchorY=0),this._selectedImage&&this.removeChild(this._selectedImage,!0),this._selectedImage=a,this._updateImagesVisibility())},getDisabledImage:function(){return this._disabledImage},setDisabledImage:function(a){this._disabledImage!=a&&(a&&(this.addChild(a,0,cc.DISABLE_TAG),a.anchorX=0,a.anchorY=0),this._disabledImage&&this.removeChild(this._disabledImage,!0),this._disabledImage=a,this._updateImagesVisibility())},initWithNormalSprite:function(a,
b,c,d,e){this.initWithCallback(d,e);this.setNormalImage(a);this.setSelectedImage(b);this.setDisabledImage(c);a=this._normalImage;return a&&(this.width=a.width,this.height=a.height,a.textureLoaded&&!a.textureLoaded()&&a.addLoadedEventListener(function(a){this.width=a.width;this.height=a.height;this.cascadeOpacity=this.cascadeColor=!0},this)),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},setColor:function(a){this._normalImage.color=a;this._selectedImage&&(this._selectedImage.color=a);this._disabledImage&&
(this._disabledImage.color=a)},getColor:function(){return this._normalImage.color},setOpacity:function(a){this._normalImage.opacity=a;this._selectedImage&&(this._selectedImage.opacity=a);this._disabledImage&&(this._disabledImage.opacity=a)},getOpacity:function(){return this._normalImage.opacity},selected:function(){cc.MenuItem.prototype.selected.call(this);this._normalImage&&(this._disabledImage&&(this._disabledImage.visible=!1),this._selectedImage?(this._normalImage.visible=!1,this._selectedImage.visible=
!0):this._normalImage.visible=!0)},unselected:function(){cc.MenuItem.prototype.unselected.call(this);this._normalImage&&(this._normalImage.visible=!0,this._selectedImage&&(this._selectedImage.visible=!1),this._disabledImage&&(this._disabledImage.visible=!1))},setEnabled:function(a){this._enabled!=a&&(cc.MenuItem.prototype.setEnabled.call(this,a),this._updateImagesVisibility())},_updateImagesVisibility:function(){var a=this._normalImage,b=this._selectedImage,c=this._disabledImage;this._enabled?(a&&
(a.visible=!0),b&&(b.visible=!1),c&&(c.visible=!1)):c?(a&&(a.visible=!1),b&&(b.visible=!1),c&&(c.visible=!0)):(a&&(a.visible=!0),b&&(b.visible=!1))}});_p=cc.MenuItemSprite.prototype;_p.normalImage;cc.defineGetterSetter(_p,"normalImage",_p.getNormalImage,_p.setNormalImage);_p.selectedImage;cc.defineGetterSetter(_p,"selectedImage",_p.getSelectedImage,_p.setSelectedImage);_p.disabledImage;cc.defineGetterSetter(_p,"disabledImage",_p.getDisabledImage,_p.setDisabledImage);
cc.MenuItemSprite.create=function(a,b,c,d,e){return new cc.MenuItemSprite(a,b,c,d,e||void 0)};
cc.MenuItemImage=cc.MenuItemSprite.extend({ctor:function(a,b,c,d,e){var f=null,g=null,h=null,k=null,m=null;void 0===a?cc.MenuItemSprite.prototype.ctor.call(this):(f=cc.Sprite.create(a),b&&(g=cc.Sprite.create(b)),void 0===d?k=c:void 0===e?(k=c,m=d):e&&(h=cc.Sprite.create(c),k=d,m=e),cc.MenuItemSprite.prototype.ctor.call(this,f,g,h,k,m))},setNormalSpriteFrame:function(a){this.setNormalImage(cc.Sprite.create(a))},setSelectedSpriteFrame:function(a){this.setSelectedImage(cc.Sprite.create(a))},setDisabledSpriteFrame:function(a){this.setDisabledImage(cc.Sprite.create(a))},
initWithNormalImage:function(a,b,c,d,e){var f=null,g=null,h=null;return a&&(f=cc.Sprite.create(a)),b&&(g=cc.Sprite.create(b)),c&&(h=cc.Sprite.create(c)),this.initWithNormalSprite(f,g,h,d,e)}});cc.MenuItemImage.create=function(a,b,c,d,e){return new cc.MenuItemImage(a,b,c,d,e)};
cc.MenuItemToggle=cc.MenuItem.extend({subItems:null,_selectedIndex:0,_opacity:null,_color:null,ctor:function(){cc.MenuItem.prototype.ctor.call(this);this._selectedIndex=0;this.subItems=[];this._opacity=0;this._color=cc.color.WHITE;0<arguments.length&&this.initWithItems(Array.prototype.slice.apply(arguments))},getOpacity:function(){return this._opacity},setOpacity:function(a){if(this._opacity=a,this.subItems&&0<this.subItems.length)for(var b=0;b<this.subItems.length;b++)this.subItems[b].opacity=a;
this._color.a=a},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},setColor:function(a){var b=this._color;if(b.r=a.r,b.g=a.g,b.b=a.b,this.subItems&&0<this.subItems.length)for(b=0;b<this.subItems.length;b++)this.subItems[b].setColor(a);void 0===a.a||a.a_undefined||this.setOpacity(a.a)},getSelectedIndex:function(){return this._selectedIndex},setSelectedIndex:function(a){if(a!=this._selectedIndex){this._selectedIndex=a;(a=this.getChildByTag(cc.CURRENT_ITEM))&&a.removeFromParent(!1);
a=this.subItems[this._selectedIndex];this.addChild(a,0,cc.CURRENT_ITEM);var b=a.width,c=a.height;this.width=b;this.height=c;a.setPosition(b/2,c/2)}},getSubItems:function(){return this.subItems},setSubItems:function(a){this.subItems=a},initWithItems:function(a){var b=a.length;"function"==typeof a[a.length-2]?(this.initWithCallback(a[a.length-2],a[a.length-1]),b-=2):"function"==typeof a[a.length-1]?(this.initWithCallback(a[a.length-1],null),b-=1):this.initWithCallback(null,null);for(var c=this.subItems,
d=c.length=0;b>d;d++)a[d]&&c.push(a[d]);return this._selectedIndex=cc.UINT_MAX,this.setSelectedIndex(0),this.cascadeColor=!0,this.cascadeOpacity=!0,!0},addSubItem:function(a){this.subItems.push(a)},activate:function(){this._enabled&&this.setSelectedIndex((this._selectedIndex+1)%this.subItems.length);cc.MenuItem.prototype.activate.call(this)},selected:function(){cc.MenuItem.prototype.selected.call(this);this.subItems[this._selectedIndex].selected()},unselected:function(){cc.MenuItem.prototype.unselected.call(this);
this.subItems[this._selectedIndex].unselected()},setEnabled:function(a){if(this._enabled!=a){cc.MenuItem.prototype.setEnabled.call(this,a);var b=this.subItems;if(b&&0<b.length)for(var c=0;c<b.length;c++)b[c].enabled=a}},selectedItem:function(){return this.subItems[this._selectedIndex]},onEnter:function(){cc.Node.prototype.onEnter.call(this);this.setSelectedIndex(this._selectedIndex)}});_p=cc.MenuItemToggle.prototype;_p.selectedIndex;cc.defineGetterSetter(_p,"selectedIndex",_p.getSelectedIndex,_p.setSelectedIndex);
cc.MenuItemToggle.create=function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var a=new cc.MenuItemToggle;return a.initWithItems(Array.prototype.slice.apply(arguments)),a};cc.MENU_STATE_WAITING=0;cc.MENU_STATE_TRACKING_TOUCH=1;cc.MENU_HANDLER_PRIORITY=-128;cc.DEFAULT_PADDING=5;
cc.Menu=cc.Layer.extend({enabled:!1,_color:null,_opacity:0,_selectedItem:null,_state:-1,_touchListener:null,_className:"Menu",ctor:function(a){cc.Layer.prototype.ctor.call(this);this._color=cc.color.WHITE;this.enabled=!1;this._opacity=255;this._selectedItem=null;this._state=-1;this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this._onTouchBegan,onTouchMoved:this._onTouchMoved,onTouchEnded:this._onTouchEnded,onTouchCancelled:this._onTouchCancelled});
0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");var b,c=arguments.length;if(0==c)b=[];else if(1==c)b=a instanceof Array?a:[a];else if(1<c){b=[];for(var d=0;c>d;d++)arguments[d]&&b.push(arguments[d])}this.initWithArray(b)},onEnter:function(){var a=this._touchListener;a._isRegistered()||cc.eventManager.addListener(a,this);cc.Node.prototype.onEnter.call(this)},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,
a.a)},setColor:function(a){var b=this._color;b.r=a.r;b.g=a.g;b.b=a.b;if((b=this._children)&&0<b.length)for(var c=0;c<b.length;c++)b[c].setColor(a);void 0===a.a||a.a_undefined||this.setOpacity(a.a)},getOpacity:function(){return this._opacity},setOpacity:function(a){this._opacity=a;var b=this._children;if(b&&0<b.length)for(var c=0;c<b.length;c++)b[c].setOpacity(a);this._color.a=a},isEnabled:function(){return this.enabled},setEnabled:function(a){this.enabled=a},initWithItems:function(a){var b=[];if(a)for(var c=
0;c<a.length;c++)a[c]&&b.push(a[c]);return this.initWithArray(b)},initWithArray:function(a){if(cc.Layer.prototype.init.call(this)){this.enabled=!0;var b=cc.winSize;if(this.setPosition(b.width/2,b.height/2),this.setContentSize(b),this.setAnchorPoint(.5,.5),this.ignoreAnchorPointForPosition(!0),a)for(b=0;b<a.length;b++)this.addChild(a[b],b);return this._selectedItem=null,this._state=cc.MENU_STATE_WAITING,this.cascadeColor=!0,this.cascadeOpacity=!0,!0}return!1},addChild:function(a,b,c){if(!(a instanceof
cc.MenuItem))throw"cc.Menu.addChild() : Menu only supports MenuItem objects as children";cc.Layer.prototype.addChild.call(this,a,b,c)},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},alignItemsVerticallyWithPadding:function(a){var b,c,d,e,f;d=-a;var g=this._children;if(g&&0<g.length){c=0;for(b=g.length;b>c;c++)d+=g[c].height*g[c].scaleY+a;var h=d/2;c=0;for(b=g.length;b>c;c++)f=g[c],e=f.height,d=f.scaleY,f.setPosition(0,h-e*d/2),h-=e*d+a}},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},
alignItemsHorizontallyWithPadding:function(a){var b,c,d,e,f;d=-a;var g=this._children;if(g&&0<g.length){b=0;for(c=g.length;c>b;b++)d+=g[b].width*g[b].scaleX+a;var h=-d/2;b=0;for(c=g.length;c>b;b++)f=g[b],d=f.scaleX,e=g[b].width,f.setPosition(h+e*d/2,0),h+=e*d+a}},alignItemsInColumns:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b]);var c,d,e,f=-5,g=0,h=0,
k=0,m=this._children;if(m&&0<m.length)for(b=0,e=m.length;e>b;b++)g>=a.length||(c=a[g],c&&(d=m[b].height,h=h>=d||isNaN(d)?h:d,++k,k>=c&&(f+=h+5,k=0,h=0,++g)));var n=cc.director.getWinSize(),q=c=h=g=0,r=0,f=f/2;if(m&&0<m.length)for(b=0,e=m.length;e>b;b++){var s=m[b];0==c&&(c=a[g],q=n.width/(1+c),r=q);d=s._getHeight();h=h>=d||isNaN(d)?h:d;s.setPosition(r-n.width/2,f-d/2);r+=q;++k;k>=c&&(f-=h+5,k=0,c=0,h=0,++g)}},alignItemsInRows:function(){0<arguments.length&&null==arguments[arguments.length-1]&&cc.log("parameters should not be ending with null in Javascript");
var a,b=[];for(a=0;a<arguments.length;a++)b.push(arguments[a]);var c,d,e,f,g=[],h=[],k=-10,m=-5,n=0,q=0,r=0,s=this._children;if(s&&0<s.length)for(a=0,e=s.length;e>a;a++)d=s[a],n>=b.length||(c=b[n],c&&(f=d.width,q=q>=f||isNaN(f)?q:f,m+=d.height+5,++r,r>=c&&(g.push(q),h.push(m),k+=q+10,r=0,q=0,m=-5,++n)));m=cc.director.getWinSize();c=q=n=0;var k=-k/2,u=0;if(s&&0<s.length)for(a=0,e=s.length;e>a;a++)d=s[a],0==c&&(c=b[n],u=h[n]),f=d._getWidth(),q=q>=f||isNaN(f)?q:f,d.setPosition(k+g[n]/2,u-m.height/2),
u-=d.height+10,++r,r>=c&&(k+=q+5,r=0,c=0,q=0,++n)},removeChild:function(a,b){if(null!=a){if(!(a instanceof cc.MenuItem))return void cc.log("cc.Menu.removeChild():Menu only supports MenuItem objects as children");this._selectedItem==a&&(this._selectedItem=null);cc.Node.prototype.removeChild.call(this,a,b)}},_onTouchBegan:function(a,b){var c=b.getCurrentTarget();if(c._state!=cc.MENU_STATE_WAITING||!c._visible||!c.enabled)return!1;for(var d=c.parent;null!=d;d=d.parent)if(!d.isVisible())return!1;return c._selectedItem=
c._itemForTouch(a),c._selectedItem?(c._state=cc.MENU_STATE_TRACKING_TOUCH,c._selectedItem.selected(),!0):!1},_onTouchEnded:function(a,b){var c=b.getCurrentTarget();return c._state!==cc.MENU_STATE_TRACKING_TOUCH?void cc.log("cc.Menu.onTouchEnded(): invalid state"):(c._selectedItem&&(c._selectedItem.unselected(),c._selectedItem.activate()),void(c._state=cc.MENU_STATE_WAITING))},_onTouchCancelled:function(a,b){var c=b.getCurrentTarget();return c._state!==cc.MENU_STATE_TRACKING_TOUCH?void cc.log("cc.Menu.onTouchCancelled(): invalid state"):
(this._selectedItem&&c._selectedItem.unselected(),void(c._state=cc.MENU_STATE_WAITING))},_onTouchMoved:function(a,b){var c=b.getCurrentTarget();if(c._state!==cc.MENU_STATE_TRACKING_TOUCH)return void cc.log("cc.Menu.onTouchMoved(): invalid state");var d=c._itemForTouch(a);d!=c._selectedItem&&(c._selectedItem&&c._selectedItem.unselected(),c._selectedItem=d,c._selectedItem&&c._selectedItem.selected())},onExit:function(){this._state==cc.MENU_STATE_TRACKING_TOUCH&&(this._selectedItem&&(this._selectedItem.unselected(),
this._selectedItem=null),this._state=cc.MENU_STATE_WAITING);cc.Node.prototype.onExit.call(this)},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1},_itemForTouch:function(a){var b;a=a.getLocation();var c=this._children;if(c&&0<c.length)for(var d=0;d<c.length;d++)if(b=c[d],b.isVisible()&&b.isEnabled()){var e=b.convertToNodeSpace(a),f=b.rect();if(f.x=0,f.y=0,cc.rectContainsPoint(f,e))return b}return null}});_p=cc.Menu.prototype;_p.enabled;
cc.Menu.create=function(a){var b=arguments.length;0<b&&null==arguments[b-1]&&cc.log("parameters should not be ending with null in Javascript");return 0==b?new cc.Menu:new cc.Menu(1==b?a:Array.prototype.slice.call(arguments,0))};cc.IMAGE_FORMAT_JPEG=0;cc.IMAGE_FORMAT_PNG=1;cc.IMAGE_FORMAT_RAWDATA=9;cc.NextPOT=function(a){return a-=1,a|=a>>1,a|=a>>2,a|=a>>4,a|=a>>8,a|=a>>16,a+1};
cc.RenderTexture=cc.Node.extend({sprite:null,clearFlags:0,clearDepthVal:0,autoDraw:!1,_cacheCanvas:null,_cacheContext:null,_fBO:0,_depthRenderBuffer:0,_oldFBO:0,_texture:null,_textureCopy:null,_uITextureImage:null,_pixelFormat:cc.Texture2D.PIXEL_FORMAT_RGBA8888,_clearColor:null,clearStencilVal:0,_clearColorStr:null,_className:"RenderTexture",ctor:null,_ctorForCanvas:function(a,b,c,d){cc.Node.prototype.ctor.call(this);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0;this._clearColor=cc.color(255,
255,255,255);this._clearColorStr="rgba(255,255,255,1)";this._cacheCanvas=cc.newElement("canvas");this._cacheContext=this._cacheCanvas.getContext("2d");this.anchorY=this.anchorX=0;void 0!==a&&void 0!==b&&(c=c||cc.Texture2D.PIXEL_FORMAT_RGBA8888,d=d||0,this.initWithWidthAndHeight(a,b,c,d))},_ctorForWebGL:function(a,b,c,d){cc.Node.prototype.ctor.call(this);this._cascadeOpacityEnabled=this._cascadeColorEnabled=!0;this._clearColor=cc.color(0,0,0,0);void 0!==a&&void 0!==b&&(c=c||cc.Texture2D.PIXEL_FORMAT_RGBA8888,
d=d||0,this.initWithWidthAndHeight(a,b,c,d))},cleanup:null,_cleanupForCanvas:function(){cc.Node.prototype.onExit.call(this);this._cacheCanvas=this._cacheContext=null},_cleanupForWebGL:function(){cc.Node.prototype.onExit.call(this);this._textureCopy=null;var a=cc._renderContext;a.deleteFramebuffer(this._fBO);this._depthRenderBuffer&&a.deleteRenderbuffer(this._depthRenderBuffer);this._uITextureImage=null},getSprite:function(){return this.sprite},setSprite:function(a){this.sprite=a},initWithWidthAndHeight:null,
_initWithWidthAndHeightForCanvas:function(a,b){var c=this._cacheCanvas,d=cc.contentScaleFactor();c.width=0|a*d;c.height=0|b*d;this._cacheContext.translate(0,c.height);d=new cc.Texture2D;d.initWithElement(c);d.handleLoadedTexture();c=this.sprite=cc.Sprite.create(d);return c.setBlendFunc(cc.ONE,cc.ONE_MINUS_SRC_ALPHA),this.autoDraw=!1,this.addChild(c),!0},_initWithWidthAndHeightForWebGL:function(a,b,c,d){c==cc.Texture2D.PIXEL_FORMAT_A8&&cc.log("cc.RenderTexture._initWithWidthAndHeightForWebGL() : only RGB and RGBA formats are valid for a render texture;");
var e=cc._renderContext,f=cc.contentScaleFactor();a=0|a*f;b=0|b*f;this._oldFBO=e.getParameter(e.FRAMEBUFFER_BINDING);var g,h;cc.configuration.supportsNPOT()?(g=a,h=b):(g=cc.NextPOT(a),h=cc.NextPOT(b));for(var f=new Uint8Array(g*h*4),k=0;g*h*4>k;k++)f[k]=0;if(this._pixelFormat=c,this._texture=new cc.Texture2D,!this._texture)return!1;k=this._texture;k.initWithData(f,this._pixelFormat,g,h,cc.size(a,b));c=e.getParameter(e.RENDERBUFFER_BINDING);if(cc.configuration.checkForGLExtension("GL_QCOM")){if(this._textureCopy=
new cc.Texture2D,!this._textureCopy)return!1;this._textureCopy.initWithData(f,this._pixelFormat,g,h,cc.size(a,b))}this._fBO=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,this._fBO);e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,k._webTextureObj,0);0!=d&&(this._depthRenderBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this._depthRenderBuffer),e.renderbufferStorage(e.RENDERBUFFER,d,g,h),d==e.DEPTH_STENCIL?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,
e.RENDERBUFFER,this._depthRenderBuffer):d==e.STENCIL_INDEX||d==e.STENCIL_INDEX8?e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,this._depthRenderBuffer):d==e.DEPTH_COMPONENT16&&e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this._depthRenderBuffer));e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&cc.log("Could not attach texture to the framebuffer");k.setAliasTexParameters();a=this.sprite=cc.Sprite.create(k);return a.scaleY=
-1,a.setBlendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.bindRenderbuffer(e.RENDERBUFFER,c),e.bindFramebuffer(e.FRAMEBUFFER,this._oldFBO),this.autoDraw=!1,this.addChild(a),!0},begin:null,_beginForCanvas:function(){cc._renderContext=this._cacheContext;cc.view._setScaleXYForRenderTexture()},_beginForWebGL:function(){cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLPushMatrix();cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLPushMatrix();var a=cc.director;a.setProjection(a.getProjection());var b=this._texture.getContentSizeInPixels(),
c=cc.director.getWinSizeInPixels(),a=c.width/b.width,c=c.height/b.height,d=cc._renderContext;d.viewport(0,0,b.width,b.height);b=new cc.kmMat4;cc.kmMat4OrthographicProjection(b,-1/a,1/a,-1/c,1/c,-1,1);cc.kmGLMultMatrix(b);this._oldFBO=d.getParameter(d.FRAMEBUFFER_BINDING);d.bindFramebuffer(d.FRAMEBUFFER,this._fBO);cc.configuration.checkForGLExtension("GL_QCOM")&&(d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this._textureCopy._webTextureObj,0),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT),
d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,this._texture._webTextureObj,0))},beginWithClear:function(a,b,c,d,e,f){var g=cc._renderContext;e=e||g.COLOR_BUFFER_BIT;f=f||g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT;this._beginWithClear(a,b,c,d,e,f,g.COLOR_BUFFER_BIT|g.DEPTH_BUFFER_BIT|g.STENCIL_BUFFER_BIT)},_beginWithClear:null,_beginWithClearForCanvas:function(a,b,c,d){this.begin();a=a||0;b=b||0;c=c||0;d=isNaN(d)?1:d;var e=this._cacheContext,f=this._cacheCanvas;e.save();e.fillStyle=
"rgba("+(0|a)+","+(0|b)+","+(0|c)+","+d/255+")";e.clearRect(0,0,f.width,-f.height);e.fillRect(0,0,f.width,-f.height);e.restore()},_beginWithClearForWebGL:function(a,b,c,d,e,f,g){a/=255;b/=255;c/=255;d/=255;this.begin();var h=cc._renderContext,k=[0,0,0,0],m=0,n=0;g&h.COLOR_BUFFER_BIT&&(k=h.getParameter(h.COLOR_CLEAR_VALUE),h.clearColor(a,b,c,d));g&h.DEPTH_BUFFER_BIT&&(m=h.getParameter(h.DEPTH_CLEAR_VALUE),h.clearDepth(e));g&h.STENCIL_BUFFER_BIT&&(n=h.getParameter(h.STENCIL_CLEAR_VALUE),h.clearStencil(f));
h.clear(g);g&h.COLOR_BUFFER_BIT&&h.clearColor(k[0],k[1],k[2],k[3]);g&h.DEPTH_BUFFER_BIT&&h.clearDepth(m);g&h.STENCIL_BUFFER_BIT&&h.clearStencil(n)},end:null,_endForCanvas:function(){cc._renderContext=cc._mainRenderContextBackup;cc.view._resetScale()},_endForWebGL:function(){var a=cc._renderContext,b=cc.director;a.bindFramebuffer(a.FRAMEBUFFER,this._oldFBO);b.setViewport();cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLPopMatrix();cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLPopMatrix()},clear:function(a,
b,c,d){this.beginWithClear(a,b,c,d);this.end()},clearRect:null,_clearRectForCanvas:function(a,b,c,d){this._cacheContext.clearRect(a,b,c,-d)},_clearRectForWebGL:function(){},clearDepth:null,_clearDepthForCanvas:function(){cc.log("clearDepth isn't supported on Cocos2d-Html5")},_clearDepthForWebGL:function(a){this.begin();var b=cc._renderContext,c=b.getParameter(b.DEPTH_CLEAR_VALUE);b.clearDepth(a);b.clear(b.DEPTH_BUFFER_BIT);b.clearDepth(c);this.end()},clearStencil:null,_clearStencilForCanvas:function(){cc.log("clearDepth isn't supported on Cocos2d-Html5")},
_clearStencilForWebGL:function(a){var b=cc._renderContext,c=b.getParameter(b.STENCIL_CLEAR_VALUE);b.clearStencil(a);b.clear(b.STENCIL_BUFFER_BIT);b.clearStencil(c)},visit:null,_visitForCanvas:function(a){this._visible&&(a=a||cc._renderContext,a.save(),this.draw(a),this.transform(a),this.sprite.visit(),a.restore(),this.arrivalOrder=0)},_visitForWebGL:function(a){if(this._visible){cc.kmGLPushMatrix();var b=this.grid;b&&b.isActive()&&(b.beforeDraw(),this.transformAncestors());this.transform(a);this.sprite.visit();
this.draw(a);b&&b.isActive()&&b.afterDraw(this);cc.kmGLPopMatrix();this.arrivalOrder=0}},draw:null,_drawForCanvas:function(a){if(a=a||cc._renderContext,this.autoDraw){if(this.begin(),this.clearFlags){var b=this._cacheCanvas;a.save();a.fillStyle=this._clearColorStr;a.clearRect(0,0,b.width,-b.height);a.fillRect(0,0,b.width,-b.height);a.restore()}this.sortAllChildren();a=this._children;for(var b=a.length,c=this.sprite,d=0;b>d;d++){var e=a[d];e!=c&&e.visit()}this.end()}},_drawForWebGL:function(){var a=
cc._renderContext;if(this.autoDraw){this.begin();var b=this.clearFlags;if(b){var c=[0,0,0,0],d=0,e=0;b&a.COLOR_BUFFER_BIT&&(c=a.getParameter(a.COLOR_CLEAR_VALUE),a.clearColor(this._clearColor.r/255,this._clearColor.g/255,this._clearColor.b/255,this._clearColor.a/255));b&a.DEPTH_BUFFER_BIT&&(d=a.getParameter(a.DEPTH_CLEAR_VALUE),a.clearDepth(this.clearDepthVal));b&a.STENCIL_BUFFER_BIT&&(e=a.getParameter(a.STENCIL_CLEAR_VALUE),a.clearStencil(this.clearStencilVal));a.clear(b);b&a.COLOR_BUFFER_BIT&&a.clearColor(c[0],
c[1],c[2],c[3]);b&a.DEPTH_BUFFER_BIT&&a.clearDepth(d);b&a.STENCIL_BUFFER_BIT&&a.clearStencil(e)}this.sortAllChildren();a=this._children;for(b=0;b<a.length;b++)c=a[b],c!=this.sprite&&c.visit();this.end()}},newCCImage:function(){return cc.log("saveToFile isn't supported on cocos2d-html5"),null},_memcpy:function(a,b,c,d,e){for(var f=0;e>f;f++)a[b+f]=c[d+f]},saveToFile:function(){cc.log("saveToFile isn't supported on Cocos2d-Html5")},listenToBackground:function(){cc.log("listenToBackground isn't supported on Cocos2d-Html5")},
listenToForeground:function(){cc.log("listenToForeground isn't supported on Cocos2d-Html5")},getClearFlags:function(){return this.clearFlags},setClearFlags:function(a){this.clearFlags=a},getClearColor:function(){return this._clearColor},setClearColor:null,_setClearColorForCanvas:function(a){var b=this._clearColor;b.r=a.r;b.g=a.g;b.b=a.b;b.a=a.a;this._clearColorStr="rgba("+(0|a.r)+","+(0|a.g)+","+(0|a.b)+","+a.a/255+")"},_setClearColorForWebGL:function(a){var b=this._clearColor;b.r=a.r;b.g=a.g;b.b=
a.b;b.a=a.a},getClearDepth:function(){return this.clearDepthVal},setClearDepth:function(a){this.clearDepthVal=a},getClearStencil:function(){return this.clearStencilVal},setClearStencil:function(a){this.clearStencilVal=a},isAutoDraw:function(){return this.autoDraw},setAutoDraw:function(a){this.autoDraw=a}});_p=cc.RenderTexture.prototype;
cc._renderType==cc._RENDER_TYPE_WEBGL?(_p.ctor=_p._ctorForWebGL,_p.cleanup=_p._cleanupForWebGL,_p.initWithWidthAndHeight=_p._initWithWidthAndHeightForWebGL,_p.begin=_p._beginForWebGL,_p._beginWithClear=_p._beginWithClearForWebGL,_p.end=_p._endForWebGL,_p.clearRect=_p._clearRectForWebGL,_p.clearDepth=_p._clearDepthForWebGL,_p.clearStencil=_p._clearStencilForWebGL,_p.visit=_p._visitForWebGL,_p.draw=_p._drawForWebGL,_p.setClearColor=_p._setClearColorForWebGL):(_p.ctor=_p._ctorForCanvas,_p.cleanup=_p._cleanupForCanvas,
_p.initWithWidthAndHeight=_p._initWithWidthAndHeightForCanvas,_p.begin=_p._beginForCanvas,_p._beginWithClear=_p._beginWithClearForCanvas,_p.end=_p._endForCanvas,_p.clearRect=_p._clearRectForCanvas,_p.clearDepth=_p._clearDepthForCanvas,_p.clearStencil=_p._clearStencilForCanvas,_p.visit=_p._visitForCanvas,_p.draw=_p._drawForCanvas,_p.setClearColor=_p._setClearColorForCanvas);_p.clearColorVal;cc.defineGetterSetter(_p,"clearColorVal",_p.getClearColor,_p.setClearColor);
cc.RenderTexture.create=function(a,b,c,d){return new cc.RenderTexture(a,b,c,d)};
cc.LabelAtlas=cc.AtlasNode.extend({_string:null,_mapStartChar:null,_textureLoaded:!1,_loadedEventListeners:null,_className:"LabelAtlas",ctor:function(a,b,c,d,e){cc.AtlasNode.prototype.ctor.call(this);b&&cc.LabelAtlas.prototype.initWithString.call(this,a,b,c,d,e)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){this._textureLoaded=
!0;for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}},initWithString:function(a,b,c,d,e){var f,g,h=a+"";if(void 0===c){c=cc.loader.getRes(b);if(1!==parseInt(c.version,10))return cc.log("cc.LabelAtlas.initWithString(): Unsupported version. Upgrade cocos2d version"),!1;b=cc.path.changeBasename(b,c.textureFilename);d=cc.contentScaleFactor();f=parseInt(c.itemWidth,10)/d;g=parseInt(c.itemHeight,10)/d;c=String.fromCharCode(parseInt(c.firstChar,
10))}else f=c||0,g=d||0,c=e||" ";var k=null,k=b instanceof cc.Texture2D?b:cc.textureCache.addImage(b);b=k.isLoaded();return this._textureLoaded=b,b||k.addLoadedEventListener(function(){this.initWithTexture(k,f,g,h.length);this.string=h;this._callLoadedEventCallbacks()},this),this.initWithTexture(k,f,g,h.length)?(this._mapStartChar=c,this.string=h,!0):!1},setColor:function(a){cc.AtlasNode.prototype.setColor.call(this,a);this.updateAtlasValues()},getString:function(){return this._string},draw:function(a){if(cc.AtlasNode.prototype.draw.call(this,
a),cc.LABELATLAS_DEBUG_DRAW)a=this.size,a=[cc.p(0,0),cc.p(a.width,0),cc.p(a.width,a.height),cc.p(0,a.height)],cc._drawingUtil.drawPoly(a,4,!0)},_addChildForCanvas:function(a,b,c){a._lateChild=!0;cc.Node.prototype.addChild.call(this,a,b,c)},updateAtlasValues:null,_updateAtlasValuesForCanvas:function(){for(var a=this._string||"",b=a.length,c=this.texture,d=this._itemWidth,e=this._itemHeight,f=0;b>f;f++){var g=a.charCodeAt(f)-this._mapStartChar.charCodeAt(0),h=parseInt(g%this._itemsPerRow,10),g=parseInt(g/
this._itemsPerRow,10),h=cc.rect(h*d,g*e,d,e),g=a.charCodeAt(f),k=this.getChildByTag(f);k?32==g?(k.init(),k.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):(k.initWithTexture(c,h),k.visible=!0,k.opacity=this._displayedOpacity):(k=new cc.Sprite,32==g?(k.init(),k.setTextureRect(cc.rect(0,0,10,10),!1,cc.size(0,0))):k.initWithTexture(c,h),cc.Node.prototype.addChild.call(this,k,0,f));k.setPosition(f*d+d/2,e/2)}},_updateAtlasValuesForWebGL:function(){var a=this._string,b=a.length,c=this.textureAtlas,
d=c.texture,e=d.pixelsWidth,d=d.pixelsHeight,f=this._itemWidth,g=this._itemHeight;this._ignoreContentScaleFactor||(f=this._itemWidth*cc.contentScaleFactor(),g=this._itemHeight*cc.contentScaleFactor());b>c.getCapacity()&&cc.log("cc.LabelAtlas._updateAtlasValues(): Invalid String length");for(var h=c.quads,k=this._displayedColor,k={r:k.r,g:k.g,b:k.b,a:this._displayedOpacity},m=this._itemWidth,n=0;b>n;n++){var q,r,s,u,t=a.charCodeAt(n)-this._mapStartChar.charCodeAt(0),v=t%this._itemsPerRow,t=0|t/this._itemsPerRow;
cc.FIX_ARTIFACTS_BY_STRECHING_TEXEL?(q=(2*v*f+1)/(2*e),r=q+(2*f-2)/(2*e),s=(2*t*g+1)/(2*d),u=s+(2*g-2)/(2*d)):(q=v*f/e,r=q+f/e,s=t*g/d,u=s+g/d);var w=h[n],v=w.tl,t=w.tr,x=w.bl,w=w.br;v.texCoords.u=q;v.texCoords.v=s;t.texCoords.u=r;t.texCoords.v=s;x.texCoords.u=q;x.texCoords.v=u;w.texCoords.u=r;w.texCoords.v=u;x.vertices.x=n*m;x.vertices.y=0;x.vertices.z=0;w.vertices.x=n*m+m;w.vertices.y=0;w.vertices.z=0;v.vertices.x=n*m;v.vertices.y=this._itemHeight;v.vertices.z=0;t.vertices.x=n*m+m;t.vertices.y=
this._itemHeight;t.vertices.z=0;v.colors=k;t.colors=k;x.colors=k;w.colors=k}0<b&&(c.dirty=!0,a=c.totalQuads,b>a&&c.increaseTotalQuadsWith(b-a))},setString:null,_setStringForCanvas:function(a){a=String(a);var b=a.length;if(this._string=a,this.width=b*this._itemWidth,this.height=this._itemHeight,this._children){a=this._children;for(var b=a.length,c=0;b>c;c++){var d=a[c];d&&!d._lateChild&&(d.visible=!1)}}this.updateAtlasValues();this.quadsToDraw=b},_setStringForWebGL:function(a){a=String(a);var b=a.length;
b>this.textureAtlas.totalQuads&&this.textureAtlas.resizeCapacity(b);this._string=a;this.width=b*this._itemWidth;this.height=this._itemHeight;this.updateAtlasValues();this.quadsToDraw=b},setOpacity:null,_setOpacityForCanvas:function(a){if(this._displayedOpacity!==a){cc.AtlasNode.prototype.setOpacity.call(this,a);for(var b=this._children,c=0,d=b.length;d>c;c++)b[c]&&(b[c].opacity=a)}},_setOpacityForWebGL:function(a){this._opacity!==a&&cc.AtlasNode.prototype.setOpacity.call(this,a)}});_p=cc.LabelAtlas.prototype;
cc._renderType===cc._RENDER_TYPE_WEBGL?(_p.updateAtlasValues=_p._updateAtlasValuesForWebGL,_p.setString=_p._setStringForWebGL,_p.setOpacity=_p._setOpacityForWebGL):(_p.updateAtlasValues=_p._updateAtlasValuesForCanvas,_p.setString=_p._setStringForCanvas,_p.setOpacity=_p._setOpacityForCanvas,_p.addChild=_p._addChildForCanvas);cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);
cc.LabelAtlas.create=function(a,b,c,d,e){return new cc.LabelAtlas(a,b,c,d,e)};cc.LABEL_AUTOMATIC_WIDTH=-1;
cc.LabelBMFont=cc.SpriteBatchNode.extend({_opacityModifyRGB:!1,_string:"",_config:null,_fntFile:"",_initialString:"",_alignment:cc.TEXT_ALIGNMENT_CENTER,_width:-1,_lineBreakWithoutSpaces:!1,_imageOffset:null,_reusedChar:null,_displayedOpacity:255,_realOpacity:255,_displayedColor:null,_realColor:null,_cascadeColorEnabled:!0,_cascadeOpacityEnabled:!0,_textureLoaded:!1,_loadedEventListeners:null,_className:"LabelBMFont",_setString:function(a,b){b?this._initialString=a:this._string=a;var c=this._children;
if(c)for(var d=0;d<c.length;d++){var e=c[d];e&&e.setVisible(!1)}this._textureLoaded&&(this.createFontChars(),b&&this.updateLabel())},ctor:function(a,b,c,d,e){cc.SpriteBatchNode.prototype.ctor.call(this);this._imageOffset=cc.p(0,0);this._displayedColor=cc.color(255,255,255,255);this._realColor=cc.color(255,255,255,255);this._reusedChar=[];this.initWithString(a,b,c,d,e)},textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners||(this._loadedEventListeners=
[]);this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){if(this._loadedEventListeners){for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0}},draw:function(a){if(cc.SpriteBatchNode.prototype.draw.call(this,a),cc.LABELBMFONT_DEBUG_DRAW){a=this.getContentSize();var b=cc.p(0|-this._anchorPointInPoints.x,0|-this._anchorPointInPoints.y);a=[cc.p(b.x,b.y),cc.p(b.x+a.width,b.y),cc.p(b.x+
a.width,b.y+a.height),cc.p(b.x,b.y+a.height)];cc._drawingUtil.setDrawColor(0,255,0,255);cc._drawingUtil.drawPoly(a,4,!0)}},setColor:function(a){var b=this._displayedColor,c=this._realColor;(c.r!=a.r||c.g!=a.g||c.b!=a.b||c.a!=a.a)&&(b.r=c.r=a.r,b.g=c.g=a.g,b.b=c.b=a.b,this._textureLoaded&&this._cascadeColorEnabled)&&(a=cc.color.WHITE,(b=this._parent)&&b.cascadeColor&&(a=b.getDisplayedColor()),this.updateDisplayedColor(a))},isOpacityModifyRGB:function(){return this._opacityModifyRGB},setOpacityModifyRGB:function(a){this._opacityModifyRGB=
a;if(a=this._children)for(var b=0;b<a.length;b++){var c=a[b];c&&(c.opacityModifyRGB=this._opacityModifyRGB)}},getOpacity:function(){return this._realOpacity},getDisplayedOpacity:function(){return this._displayedOpacity},setOpacity:function(a){if(this._displayedOpacity=this._realOpacity=a,this._cascadeOpacityEnabled){var b=255,c=this._parent;c&&c.cascadeOpacity&&(b=c.getDisplayedOpacity());this.updateDisplayedOpacity(b)}this._displayedColor.a=this._realColor.a=a},updateDisplayedOpacity:function(a){this._displayedOpacity=
this._realOpacity*a/255;a=this._children;for(var b=0;b<a.length;b++){var c=a[b];cc._renderType==cc._RENDER_TYPE_WEBGL?c.updateDisplayedOpacity(this._displayedOpacity):(cc.Node.prototype.updateDisplayedOpacity.call(c,this._displayedOpacity),c.setNodeDirty())}this._changeTextureColor()},isCascadeOpacityEnabled:function(){return!1},setCascadeOpacityEnabled:function(a){this._cascadeOpacityEnabled=a},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a)},getDisplayedColor:function(){var a=
this._displayedColor;return cc.color(a.r,a.g,a.b,a.a)},updateDisplayedColor:function(a){var b=this._displayedColor,c=this._realColor;b.r=c.r*a.r/255;b.g=c.g*a.g/255;b.b=c.b*a.b/255;a=this._children;for(b=0;b<a.length;b++)c=a[b],cc._renderType==cc._RENDER_TYPE_WEBGL?c.updateDisplayedColor(this._displayedColor):(cc.Node.prototype.updateDisplayedColor.call(c,this._displayedColor),c.setNodeDirty());this._changeTextureColor()},_changeTextureColor:function(){if(cc._renderType!=cc._RENDER_TYPE_WEBGL){var a=
this.getTexture();if(a&&0<a.getContentSize().width){var b=this._originalTexture.getHtmlElementObj();if(b){var c=a.getHtmlElementObj(),d=cc.rect(0,0,b.width,b.height);c instanceof HTMLCanvasElement&&!this._rectRotated?(cc.generateTintImageWithMultiply(b,this._displayedColor,d,c),this.setTexture(a)):(c=cc.generateTintImageWithMultiply(b,this._displayedColor,d),a=new cc.Texture2D,a.initWithElement(c),a.handleLoadedTexture(),this.setTexture(a))}}}},isCascadeColorEnabled:function(){return!1},setCascadeColorEnabled:function(a){this._cascadeColorEnabled=
a},init:function(){return this.initWithString(null,null,null,null,null)},initWithString:function(a,b,c,d,e){a=a||"";this._config&&cc.log("cc.LabelBMFont.initWithString(): re-init is no longer supported");if(b){var f=cc.loader.getRes(b);if(!f)return cc.log("cc.LabelBMFont.initWithString(): Impossible to create font. Please check file"),!1;this._config=f;this._fntFile=b;b=cc.textureCache.addImage(f.atlasName);(this._textureLoaded=f=b.isLoaded())||b.addLoadedEventListener(function(a){this._textureLoaded=
!0;this.initWithTexture(a,this._initialString.length);this.setString(this._initialString,!0);this._callLoadedEventCallbacks()},this)}else b=new cc.Texture2D,f=new Image,b.initWithElement(f),this._textureLoaded=!1;if(this.initWithTexture(b,a.length)){if(this._alignment=d||cc.TEXT_ALIGNMENT_LEFT,this._imageOffset=e||cc.p(0,0),this._width=null==c?-1:c,this._displayedOpacity=this._realOpacity=255,this._displayedColor=cc.color(255,255,255,255),this._realColor=cc.color(255,255,255,255),this._cascadeOpacityEnabled=
!0,this._cascadeColorEnabled=!0,this._contentSize.width=0,this._contentSize.height=0,this.setAnchorPoint(.5,.5),cc._renderType===cc._RENDER_TYPE_WEBGL)c=this.textureAtlas.texture,this._opacityModifyRGB=c.hasPremultipliedAlpha(),d=this._reusedChar=new cc.Sprite,d.initWithTexture(c,cc.rect(0,0,0,0),!1),d.batchNode=this;return this.setString(a,!0),!0}return!1},createFontChars:function(){var a=cc._renderType,b=a===cc._RENDER_TYPE_CANVAS?this.texture:this.textureAtlas.texture,c=0,d=cc.size(0,0),e=0,f=
1,g=this._string,h=g?g.length:0;if(0!==h){var k,m=this._config,n=m.kerningDict,q=m.commonHeight,r=m.fontDefDictionary;for(k=0;h-1>k;k++)10==g.charCodeAt(k)&&f++;var s=q*f,f=-(q-q*f),u=-1;for(k=0;h>k;k++)if(q=g.charCodeAt(k),0!=q)if(10!==q){var t=n[u<<16|65535&q]||0,v=r[q];if(v){var w=cc.rect(v.rect.x,v.rect.y,v.rect.width,v.rect.height),w=cc.rectPixelsToPoints(w);w.x+=this._imageOffset.x;w.y+=this._imageOffset.y;(u=this.getChildByTag(k))?32===q&&a===cc._RENDER_TYPE_CANVAS?u.setTextureRect(w,!1,cc.size(0,
0)):(u.setTextureRect(w,!1),u.visible=!0):(u=new cc.Sprite,32===q&&a===cc._RENDER_TYPE_CANVAS&&(w=cc.rect(0,0,0,0)),u.initWithTexture(b,w,!1),u._newTextureWhenChangeColor=!0,this.addChild(u,0,k));u.opacityModifyRGB=this._opacityModifyRGB;cc._renderType==cc._RENDER_TYPE_WEBGL?(u.updateDisplayedColor(this._displayedColor),u.updateDisplayedOpacity(this._displayedOpacity)):(cc.Node.prototype.updateDisplayedColor.call(u,this._displayedColor),cc.Node.prototype.updateDisplayedOpacity.call(u,this._displayedOpacity),
u.setNodeDirty());w=cc.p(c+v.xOffset+.5*v.rect.width+t,f+(m.commonHeight-v.yOffset)-.5*w.height*cc.contentScaleFactor());u.setPosition(cc.pointPixelsToPoints(w));c+=v.xAdvance+t;u=q;c>e&&(e=c)}else cc.log("cocos2d: LabelBMFont: character not found "+g[k])}else c=0,f-=m.commonHeight;d.width=e;d.height=s;this.setContentSize(cc.sizePixelsToPoints(d))}},updateString:function(a){var b=this._children;if(b)for(var c=0,d=b.length;d>c;c++){var e=b[c];e&&(e.visible=!1)}this._config&&this.createFontChars();
a||this.updateLabel()},getString:function(){return this._initialString},setString:function(a,b){a=String(a);null==b&&(b=!0);null!=a&&"string"==typeof a||(a+="");this._initialString=a;this._setString(a,b)},_setStringForSetter:function(a){this.setString(a,!1)},setCString:function(a){this.setString(a,!0)},updateLabel:function(){if(this.string=this._initialString,0<this._width){for(var a,b=this._string.length,c=[],d=[],e=1,f=0,g=!1,h=!1,k=-1,m=-1,n=0,q=0,r=this._children.length;r>q;q++){for(var s=0;!(a=
this.getChildByTag(q+n+s));)s++;if(n+=s,f>=b)break;var u=this._string[f];if(h||(m=this._getLetterPosXLeft(a),h=!0),g||(k=m,g=!0),10!=u.charCodeAt(0))if(this._isspace_unicode(u))d.push(u),c=c.concat(d),d.length=0,h=!1,m=-1,f++;else if(this._getLetterPosXRight(a)-k>this._width)if(this._lineBreakWithoutSpaces){if(this._utf8_trim_ws(d),d.push("\n"),c=c.concat(d),d.length=0,h=!1,g=!1,m=-1,k=-1,e++,f>=b)break;m||(m=this._getLetterPosXLeft(a),h=!0);k||(k=m,g=!0);q--}else d.push(u),-1!=c.lastIndexOf(" ")?
this._utf8_trim_ws(c):c=[],0<c.length&&c.push("\n"),e++,g=!1,k=-1,f++;else d.push(u),f++;else{if(d.push("\n"),c=c.concat(d),d.length=0,h=!1,g=!1,m=-1,k=-1,q--,n-=s,e++,f>=b)break;m||(m=this._getLetterPosXLeft(a),h=!0);k||(k=m,g=!0);f++}}c=c.concat(d);q=c.length;b="";for(f=0;q>f;++f)b+=c[f];b+=String.fromCharCode(0);this._setString(b,!1)}if(this._alignment!=cc.TEXT_ALIGNMENT_LEFT)for(c=f=0,b=this._string.length,d=[],e=0;b>e;e++)if(10!=this._string[e].charCodeAt(0)&&0!=this._string[e].charCodeAt(0))d.push(this._string[f]);
else if(q=0,g=d.length,0==g)c++;else if(k=f+g-1+c,!(0>k)&&(q=this.getChildByTag(k),null!=q)){q=q.getPositionX()+q._getWidth()/2;h=0;switch(this._alignment){case cc.TEXT_ALIGNMENT_CENTER:h=this.width/2-q/2;break;case cc.TEXT_ALIGNMENT_RIGHT:h=this.width-q}if(0!=h)for(q=0;g>q;q++)k=f+q+c,0>k||(a=this.getChildByTag(k),a&&(a.x+=h));f+=g;c++;d.length=0}},setAlignment:function(a){this._alignment=a;this.updateLabel()},_getAlignment:function(){return this._alignment},setBoundingWidth:function(a){this._width=
a;this.updateLabel()},_getBoundingWidth:function(){return this._width},setLineBreakWithoutSpace:function(a){this._lineBreakWithoutSpaces=a;this.updateLabel()},setScale:function(a,b){cc.Node.prototype.setScale.call(this,a,b);this.updateLabel()},setScaleX:function(a){cc.Node.prototype.setScaleX.call(this,a);this.updateLabel()},setScaleY:function(a){cc.Node.prototype.setScaleY.call(this,a);this.updateLabel()},setFntFile:function(a){if(null!=a&&a!=this._fntFile){var b=cc.loader.getRes(a);if(!b)return void cc.log("cc.LabelBMFont.setFntFile() : Impossible to create font. Please check file");
this._fntFile=a;this._config=b;a=cc.textureCache.addImage(b.atlasName);this._textureLoaded=b=a.isLoaded();this.texture=a;cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._originalTexture=this.texture);b?this.createFontChars():a.addLoadedEventListener(function(a){this._textureLoaded=!0;this.texture=a;this.createFontChars();this._changeTextureColor();this.updateLabel();this._callLoadedEventCallbacks()},this)}},getFntFile:function(){return this._fntFile},setAnchorPoint:function(a,b){cc.Node.prototype.setAnchorPoint.call(this,
a,b);this.updateLabel()},_setAnchor:function(a){cc.Node.prototype._setAnchor.call(this,a);this.updateLabel()},_setAnchorX:function(a){cc.Node.prototype._setAnchorX.call(this,a);this.updateLabel()},_setAnchorY:function(a){cc.Node.prototype._setAnchorY.call(this,a);this.updateLabel()},_atlasNameFromFntFile:function(){},_kerningAmountForFirst:function(a,b){var c=0;if(this._configuration.kerningDictionary){var d=this._configuration.kerningDictionary[(a<<16|65535&b).toString()];d&&(c=d.amount)}return c},
_getLetterPosXLeft:function(a){return a.getPositionX()*this._scaleX-a._getWidth()*this._scaleX*a._getAnchorX()},_getLetterPosXRight:function(a){return a.getPositionX()*this._scaleX+a._getWidth()*this._scaleX*a._getAnchorX()},_isspace_unicode:function(a){return a=a.charCodeAt(0),9<=a&&13>=a||32==a||133==a||160==a||5760==a||8192<=a&&8202>=a||8232==a||8233==a||8239==a||8287==a||12288==a},_utf8_trim_ws:function(a){var b=a.length;if(!(0>=b)&&(b-=1,this._isspace_unicode(a[b]))){for(var c=b-1;0<=c&&this._isspace_unicode(a[c]);--c)b=
c;this._utf8_trim_from(a,b)}},_utf8_trim_from:function(a,b){var c=a.length;b>=c||0>b||a.splice(b,c)}});_p=cc.LabelBMFont.prototype;
cc._renderType!==cc._RENDER_TYPE_CANVAS||cc.sys._supportCanvasNewBlendModes||(_p._changeTextureColor=function(){if(cc._renderType!=cc._RENDER_TYPE_WEBGL){var a,b=this.getTexture();if(b&&0<b.getContentSize().width&&(a=b.getHtmlElementObj(),a)){var c=cc.textureCache.getTextureColors(this._originalTexture.getHtmlElementObj());c&&(a instanceof HTMLCanvasElement&&!this._rectRotated?cc.generateTintImage(a,c,this._displayedColor,null,a):(a=cc.generateTintImage(a,c,this._displayedColor),b=new cc.Texture2D,
b.initWithElement(a),b.handleLoadedTexture(),this.setTexture(b)))}}});_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p._setStringForSetter);_p.boundingWidth;cc.defineGetterSetter(_p,"boundingWidth",_p._getBoundingWidth,_p.setBoundingWidth);_p.textAlign;cc.defineGetterSetter(_p,"textAlign",_p._getAlignment,_p.setAlignment);cc.LabelBMFont.create=function(a,b,c,d,e){return new cc.LabelBMFont(a,b,c,d,e)};
cc._fntLoader={INFO_EXP:/info [^\n]*(\n|$)/gi,COMMON_EXP:/common [^\n]*(\n|$)/gi,PAGE_EXP:/page [^\n]*(\n|$)/gi,CHAR_EXP:/char [^\n]*(\n|$)/gi,KERNING_EXP:/kerning [^\n]*(\n|$)/gi,ITEM_EXP:/\w+=[^ \r\n]+/gi,INT_EXP:/^[\-]?\d+$/,_parseStrToObj:function(a){a=a.match(this.ITEM_EXP);var b={};if(a)for(var c=0,d=a.length;d>c;c++){var e=a[c],f=e.indexOf("="),g=e.substring(0,f),e=e.substring(f+1);e.match(this.INT_EXP)?e=parseInt(e):'"'==e[0]&&(e=e.substring(1,e.length-1));b[g]=e}return b},parseFnt:function(a,
b){var c={},d=this._parseStrToObj(a.match(this.INFO_EXP)[0]).padding.split(","),d=(parseInt(d[0]),parseInt(d[1]),parseInt(d[2]),parseInt(d[3]),this._parseStrToObj(a.match(this.COMMON_EXP)[0]));if(c.commonHeight=d.lineHeight,cc._renderType===cc._RENDER_TYPE_WEBGL){var e=cc.configuration.getMaxTextureSize();(d.scaleW>e.width||d.scaleH>e.height)&&cc.log("cc.LabelBMFont._parseCommonArguments(): page can't be larger than supported")}1!==d.pages&&cc.log("cc.LabelBMFont._parseCommonArguments(): only supports 1 page");
d=this._parseStrToObj(a.match(this.PAGE_EXP)[0]);0!==d.id&&cc.log("cc.LabelBMFont._parseImageFileName() : file could not be found");c.atlasName=cc.path.changeBasename(b,d.file);for(var f=a.match(this.CHAR_EXP),g=c.fontDefDictionary={},d=0,e=f.length;e>d;d++){var h=this._parseStrToObj(f[d]);g[h.id]={rect:{x:h.x,y:h.y,width:h.width,height:h.height},xOffset:h.xoffset,yOffset:h.yoffset,xAdvance:h.xadvance}}f=c.kerningDict={};if(g=a.match(this.KERNING_EXP))for(d=0,e=g.length;e>d;d++)h=this._parseStrToObj(g[d]),
f[h.first<<16|65535&h.second]=h.amount;return c},load:function(a,b,c,d){var e=this;cc.loader.loadTxt(a,function(a,c){return a?d(a):void d(null,e.parseFnt(c,b))})}};cc.loader.register(["fnt"],cc._fntLoader);cc.v2fzero=function(){return{x:0,y:0}};cc.v2f=function(a,b){return{x:a,y:b}};cc.v2fadd=function(a,b){return cc.v2f(a.x+b.x,a.y+b.y)};cc.v2fsub=function(a,b){return cc.v2f(a.x-b.x,a.y-b.y)};cc.v2fmult=function(a,b){return cc.v2f(a.x*b,a.y*b)};cc.v2fperp=function(a){return cc.v2f(-a.y,a.x)};
cc.v2fneg=function(a){return cc.v2f(-a.x,-a.y)};cc.v2fdot=function(a,b){return a.x*b.x+a.y*b.y};cc.v2fforangle=function(a){return cc.v2f(Math.cos(a),Math.sin(a))};cc.v2fnormalize=function(a){a=cc.pNormalize(cc.p(a.x,a.y));return cc.v2f(a.x,a.y)};cc.__v2f=function(a){return cc.v2f(a.x,a.y)};cc.__t=function(a){return{u:a.x,v:a.y}};
cc.DrawNodeCanvas=cc.Node.extend({_buffer:null,_blendFunc:null,_lineWidth:1,_drawColor:null,_className:"DrawNodeCanvas",ctor:function(){cc.Node.prototype.ctor.call(this);this._buffer=[];this._drawColor=cc.color(255,255,255,255);this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,cc.BLEND_DST);this.init()},getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(a,b){void 0===b?(this._blendFunc.src=a.src,this._blendFunc.dst=a.dst):(this._blendFunc.src=a,this._blendFunc.dst=b)},setLineWidth:function(a){this._lineWidth=
a},getLineWidth:function(){return this._lineWidth},setDrawColor:function(a){var b=this._drawColor;b.r=a.r;b.g=a.g;b.b=a.b;b.a=null==a.a?255:a.a},getDrawColor:function(){return cc.color(this._drawColor.r,this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(a,b,c,d,e){d=d||this._lineWidth;e=e||this.getDrawColor();null==e.a&&(e.a=255);a=[a,cc.p(b.x,a.y),b,cc.p(a.x,b.y)];b=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);b.verts=a;b.lineWidth=d;b.lineColor=e;b.isClosePolygon=!0;b.isStroke=
!0;b.lineCap="butt";(b.fillColor=c)&&(null==c.a&&(c.a=255),b.isFill=!0);this._buffer.push(b)},drawCircle:function(a,b,c,d,e,f,g){f=f||this._lineWidth;g=g||this.getDrawColor();null==g.a&&(g.a=255);for(var h=2*Math.PI/d,k=[],m=0;d>=m;m++){var n=m*h,q=b*Math.cos(n+c)+a.x,n=b*Math.sin(n+c)+a.y;k.push(cc.p(q,n))}e&&k.push(cc.p(a.x,a.y));a=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);a.verts=k;a.lineWidth=f;a.lineColor=g;a.isClosePolygon=!0;a.isStroke=!0;this._buffer.push(a)},drawQuadBezier:function(a,
b,c,d,e,f){e=e||this._lineWidth;f=f||this.getDrawColor();null==f.a&&(f.a=255);for(var g=[],h=0,k=0;d>k;k++){var m=Math.pow(1-h,2)*a.x+2*(1-h)*h*b.x+h*h*c.x,n=Math.pow(1-h,2)*a.y+2*(1-h)*h*b.y+h*h*c.y;g.push(cc.p(m,n));h+=1/d}g.push(cc.p(c.x,c.y));a=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);a.verts=g;a.lineWidth=e;a.lineColor=f;a.isStroke=!0;a.lineCap="round";this._buffer.push(a)},drawCubicBezier:function(a,b,c,d,e,f,g){f=f||this._lineWidth;g=g||this.getDrawColor();null==g.a&&(g.a=255);for(var h=
[],k=0,m=0;e>m;m++){var n=Math.pow(1-k,3)*a.x+3*Math.pow(1-k,2)*k*b.x+3*(1-k)*k*k*c.x+k*k*k*d.x,q=Math.pow(1-k,3)*a.y+3*Math.pow(1-k,2)*k*b.y+3*(1-k)*k*k*c.y+k*k*k*d.y;h.push(cc.p(n,q));k+=1/e}h.push(cc.p(d.x,d.y));a=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);a.verts=h;a.lineWidth=f;a.lineColor=g;a.isStroke=!0;a.lineCap="round";this._buffer.push(a)},drawCatmullRom:function(a,b,c,d){this.drawCardinalSpline(a,.5,b,c,d)},drawCardinalSpline:function(a,b,c,d,e){d=d||this._lineWidth;e=e||this.getDrawColor();
null==e.a&&(e.a=255);for(var f,g,h=[],k=1/a.length,m=0;c+1>m;m++){var n=m/c;1==n?(f=a.length-1,g=1):(f=0|n/k,g=(n-k*f)/k);n=cc.cardinalSplineAt(cc.getControlPointAt(a,f-1),cc.getControlPointAt(a,f-0),cc.getControlPointAt(a,f+1),cc.getControlPointAt(a,f+2),b,g);h.push(n)}a=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);a.verts=h;a.lineWidth=d;a.lineColor=e;a.isStroke=!0;a.lineCap="round";this._buffer.push(a)},drawDot:function(a,b,c){c=c||this.getDrawColor();null==c.a&&(c.a=255);var d=new cc._DrawNodeElement(cc.DrawNode.TYPE_DOT);
d.verts=[a];d.lineWidth=b;d.fillColor=c;this._buffer.push(d)},drawDots:function(a,b,c){if(a&&0!=a.length){c=c||this.getDrawColor();null==c.a&&(c.a=255);for(var d=0,e=a.length;e>d;d++)this.drawDot(a[d],b,c)}},drawSegment:function(a,b,c,d){c=c||this._lineWidth;d=d||this.getDrawColor();null==d.a&&(d.a=255);var e=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);e.verts=[a,b];e.lineWidth=2*c;e.lineColor=d;e.isStroke=!0;e.lineCap="round";this._buffer.push(e)},drawPoly_:function(a,b,c,d){c=c||this._lineWidth;
d=d||this.getDrawColor();null==d.a&&(d.a=255);var e=new cc._DrawNodeElement(cc.DrawNode.TYPE_POLY);e.verts=a;e.fillColor=b;e.lineWidth=c;e.lineColor=d;e.isClosePolygon=!0;e.isStroke=!0;e.lineCap="round";b&&(e.isFill=!0);this._buffer.push(e)},drawPoly:function(a,b,c,d){for(var e=[],f=0;f<a.length;f++)e.push(cc.p(a[f].x,a[f].y));return this.drawPoly_(e,b,c,d)},draw:function(a){a=a||cc._renderContext;this._blendFunc&&this._blendFunc.src==cc.SRC_ALPHA&&this._blendFunc.dst==cc.ONE&&(a.globalCompositeOperation=
"lighter");for(var b=0;b<this._buffer.length;b++){var c=this._buffer[b];switch(c.type){case cc.DrawNode.TYPE_DOT:this._drawDot(a,c);break;case cc.DrawNode.TYPE_SEGMENT:this._drawSegment(a,c);break;case cc.DrawNode.TYPE_POLY:this._drawPoly(a,c)}}},_drawDot:function(a,b){var c=b.fillColor,d=b.verts[0],e=b.lineWidth,f=cc.view.getScaleX(),g=cc.view.getScaleY();a.fillStyle="rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+","+c.a/255+")";a.beginPath();a.arc(d.x*f,-d.y*g,e*f,0,2*Math.PI,!1);a.closePath();a.fill()},
_drawSegment:function(a,b){var c=b.lineColor,d=b.verts[0],e=b.verts[1],f=b.lineWidth,g=b.lineCap,h=cc.view.getScaleX(),k=cc.view.getScaleY();a.strokeStyle="rgba("+(0|c.r)+","+(0|c.g)+","+(0|c.b)+","+c.a/255+")";a.lineWidth=f*h;a.beginPath();a.lineCap=g;a.moveTo(d.x*h,-d.y*k);a.lineTo(e.x*h,-e.y*k);a.stroke()},_drawPoly:function(a,b){var c=b.verts,d=b.lineCap,e=b.fillColor,f=b.lineWidth,g=b.lineColor,h=b.isClosePolygon,k=b.isFill,m=b.isStroke;if(null!=c){var n=c[0],q=cc.view.getScaleX(),r=cc.view.getScaleY();
a.lineCap=d;e&&(a.fillStyle="rgba("+(0|e.r)+","+(0|e.g)+","+(0|e.b)+","+e.a/255+")");f&&(a.lineWidth=f*q);g&&(a.strokeStyle="rgba("+(0|g.r)+","+(0|g.g)+","+(0|g.b)+","+g.a/255+")");a.beginPath();a.moveTo(n.x*q,-n.y*r);d=1;for(e=c.length;e>d;d++)a.lineTo(c[d].x*q,-c[d].y*r);h&&a.closePath();k&&a.fill();m&&a.stroke()}},clear:function(){this._buffer.length=0}});
cc.DrawNodeWebGL=cc.Node.extend({_bufferCapacity:0,_buffer:null,_trianglesArrayBuffer:null,_trianglesWebBuffer:null,_trianglesReader:null,_lineWidth:1,_drawColor:null,_blendFunc:null,_dirty:!1,_className:"DrawNodeWebGL",getBlendFunc:function(){return this._blendFunc},setBlendFunc:function(a,b){void 0===b?(this._blendFunc.src=a.src,this._blendFunc.dst=a.dst):(this._blendFunc.src=a,this._blendFunc.dst=b)},ctor:function(){cc.Node.prototype.ctor.call(this);this._buffer=[];this._blendFunc=new cc.BlendFunc(cc.BLEND_SRC,
cc.BLEND_DST);this._drawColor=cc.color(255,255,255,255);this.init()},init:function(){return cc.Node.prototype.init.call(this)?(this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_LENGTHTEXTURECOLOR),this._ensureCapacity(64),this._trianglesWebBuffer=cc._renderContext.createBuffer(),this._dirty=!0,!0):!1},setLineWidth:function(a){this._lineWidth=a},getLineWidth:function(){return this._lineWidth},setDrawColor:function(a){var b=this._drawColor;b.r=a.r;b.g=a.g;b.b=a.b;b.a=a.a},getDrawColor:function(){return cc.color(this._drawColor.r,
this._drawColor.g,this._drawColor.b,this._drawColor.a)},drawRect:function(a,b,c,d,e){d=d||this._lineWidth;e=e||this.getDrawColor();null==e.a&&(e.a=255);a=[a,cc.p(b.x,a.y),b,cc.p(a.x,b.y)];null==c?this._drawSegments(a,d,e,!0):this.drawPoly(a,c,d,e)},drawCircle:function(a,b,c,d,e,f,g){f=f||this._lineWidth;g=g||this.getDrawColor();null==g.a&&(g.a=255);var h,k=2*Math.PI/d,m=[];for(h=0;d>=h;h++){var n=h*k,q=b*Math.cos(n+c)+a.x,n=b*Math.sin(n+c)+a.y;m.push(cc.p(q,n))}e&&m.push(cc.p(a.x,a.y));f*=.5;h=0;
for(a=m.length;a-1>h;h++)this.drawSegment(m[h],m[h+1],f,g)},drawQuadBezier:function(a,b,c,d,e,f){e=e||this._lineWidth;f=f||this.getDrawColor();null==f.a&&(f.a=255);for(var g=[],h=0,k=0;d>k;k++){var m=Math.pow(1-h,2)*a.x+2*(1-h)*h*b.x+h*h*c.x,n=Math.pow(1-h,2)*a.y+2*(1-h)*h*b.y+h*h*c.y;g.push(cc.p(m,n));h+=1/d}g.push(cc.p(c.x,c.y));this._drawSegments(g,e,f,!1)},drawCubicBezier:function(a,b,c,d,e,f,g){f=f||this._lineWidth;g=g||this.getDrawColor();null==g.a&&(g.a=255);for(var h=[],k=0,m=0;e>m;m++){var n=
Math.pow(1-k,3)*a.x+3*Math.pow(1-k,2)*k*b.x+3*(1-k)*k*k*c.x+k*k*k*d.x,q=Math.pow(1-k,3)*a.y+3*Math.pow(1-k,2)*k*b.y+3*(1-k)*k*k*c.y+k*k*k*d.y;h.push(cc.p(n,q));k+=1/e}h.push(cc.p(d.x,d.y));this._drawSegments(h,f,g,!1)},drawCatmullRom:function(a,b,c,d){this.drawCardinalSpline(a,.5,b,c,d)},drawCardinalSpline:function(a,b,c,d,e){d=d||this._lineWidth;e=e||this.getDrawColor();null==e.a&&(e.a=255);for(var f,g,h=[],k=1/a.length,m=0;c+1>m;m++){var n=m/c;1==n?(f=a.length-1,g=1):(f=0|n/k,g=(n-k*f)/k);n=cc.cardinalSplineAt(cc.getControlPointAt(a,
f-1),cc.getControlPointAt(a,f-0),cc.getControlPointAt(a,f+1),cc.getControlPointAt(a,f+2),b,g);h.push(n)}d*=.5;a=0;for(b=h.length;b-1>a;a++)this.drawSegment(h[a],h[a+1],d,e)},_render:function(){var a=cc._renderContext;cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);a.bindBuffer(a.ARRAY_BUFFER,this._trianglesWebBuffer);this._dirty&&(a.bufferData(a.ARRAY_BUFFER,this._trianglesArrayBuffer,a.STREAM_DRAW),this._dirty=!1);var b=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,
2,a.FLOAT,!1,b,0);a.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,a.UNSIGNED_BYTE,!0,b,8);a.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,a.FLOAT,!1,b,12);a.drawArrays(a.TRIANGLES,0,3*this._buffer.length);cc.incrementGLDraws(1)},_ensureCapacity:function(a){var b=this._buffer;if(b.length+a>this._bufferCapacity){var c=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;if(this._bufferCapacity+=Math.max(this._bufferCapacity,a),null==b||0===b.length)this._buffer=[],this._trianglesArrayBuffer=new ArrayBuffer(c*
this._bufferCapacity),this._trianglesReader=new Uint8Array(this._trianglesArrayBuffer);else{a=[];for(var d=new ArrayBuffer(c*this._bufferCapacity),e=0;e<b.length;e++)a[e]=new cc.V2F_C4B_T2F_Triangle(b[e].a,b[e].b,b[e].c,d,e*c);this._trianglesReader=new Uint8Array(d);this._trianglesArrayBuffer=d;this._buffer=a}}},draw:function(){cc.glBlendFunc(this._blendFunc.src,this._blendFunc.dst);this._shaderProgram.use();this._shaderProgram.setUniformsForBuiltins();this._render()},drawDot:function(a,b,c){c=c||
this.getDrawColor();null==c.a&&(c.a=255);var d={r:0|c.r,g:0|c.g,b:0|c.b,a:0|c.a};c={vertices:{x:a.x-b,y:a.y-b},colors:d,texCoords:{u:-1,v:-1}};var e={vertices:{x:a.x-b,y:a.y+b},colors:d,texCoords:{u:-1,v:1}},f={vertices:{x:a.x+b,y:a.y+b},colors:d,texCoords:{u:1,v:1}};a={vertices:{x:a.x+b,y:a.y-b},colors:d,texCoords:{u:1,v:-1}};this._ensureCapacity(6);this._buffer.push(new cc.V2F_C4B_T2F_Triangle(c,e,f,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT));this._buffer.push(new cc.V2F_C4B_T2F_Triangle(c,
f,a,this._trianglesArrayBuffer,this._buffer.length*cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT));this._dirty=!0},drawDots:function(a,b,c){if(a&&0!=a.length){c=c||this.getDrawColor();null==c.a&&(c.a=255);for(var d=0,e=a.length;e>d;d++)this.drawDot(a[d],b,c)}},drawSegment:function(a,b,c,d){d=d||this.getDrawColor();null==d.a&&(d.a=255);c=c||.5*this._lineWidth;this._ensureCapacity(18);d={r:0|d.r,g:0|d.g,b:0|d.b,a:0|d.a};var e=cc.__v2f(a),f=cc.__v2f(b);b=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(f,e)));a=cc.v2fperp(b);
var g=cc.v2fmult(b,c),h=cc.v2fmult(a,c);c=cc.v2fsub(f,cc.v2fadd(g,h));var k=cc.v2fadd(f,cc.v2fsub(g,h)),m=cc.v2fsub(f,g),f=cc.v2fadd(f,g),n=cc.v2fsub(e,g),q=cc.v2fadd(e,g),r=cc.v2fsub(e,cc.v2fsub(g,h)),e=cc.v2fadd(e,cc.v2fadd(g,h)),g=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,h=this._trianglesArrayBuffer,s=this._buffer;s.push(new cc.V2F_C4B_T2F_Triangle({vertices:c,colors:d,texCoords:cc.__t(cc.v2fneg(cc.v2fadd(b,a)))},{vertices:k,colors:d,texCoords:cc.__t(cc.v2fsub(b,a))},{vertices:m,colors:d,texCoords:cc.__t(cc.v2fneg(b))},
h,s.length*g));s.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:d,texCoords:cc.__t(b)},{vertices:k,colors:d,texCoords:cc.__t(cc.v2fsub(b,a))},{vertices:m,colors:d,texCoords:cc.__t(cc.v2fneg(b))},h,s.length*g));s.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:d,texCoords:cc.__t(b)},{vertices:n,colors:d,texCoords:cc.__t(cc.v2fneg(b))},{vertices:m,colors:d,texCoords:cc.__t(cc.v2fneg(b))},h,s.length*g));s.push(new cc.V2F_C4B_T2F_Triangle({vertices:f,colors:d,texCoords:cc.__t(b)},{vertices:n,
colors:d,texCoords:cc.__t(cc.v2fneg(b))},{vertices:q,colors:d,texCoords:cc.__t(b)},h,s.length*g));s.push(new cc.V2F_C4B_T2F_Triangle({vertices:r,colors:d,texCoords:cc.__t(cc.v2fsub(a,b))},{vertices:n,colors:d,texCoords:cc.__t(cc.v2fneg(b))},{vertices:q,colors:d,texCoords:cc.__t(b)},h,s.length*g));s.push(new cc.V2F_C4B_T2F_Triangle({vertices:r,colors:d,texCoords:cc.__t(cc.v2fsub(a,b))},{vertices:e,colors:d,texCoords:cc.__t(cc.v2fadd(b,a))},{vertices:q,colors:d,texCoords:cc.__t(b)},h,s.length*g));this._dirty=
!0},drawPoly:function(a,b,c,d){if(null==b)return void this._drawSegments(a,c,d,!0);null==b.a&&(b.a=255);null==d.a&&(d.a=255);c=c||this._lineWidth;c*=.5;var e,f,g;b={r:0|b.r,g:0|b.g,b:0|b.b,a:0|b.a};var h={r:0|d.r,g:0|d.g,b:0|d.b,a:0|d.a},k=[],m=a.length;for(d=0;m>d;d++){e=cc.__v2f(a[(d-1+m)%m]);f=cc.__v2f(a[d]);g=cc.__v2f(a[(d+1)%m]);var n=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(f,e)));f=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(g,f)));n=cc.v2fmult(cc.v2fadd(n,f),1/(cc.v2fdot(n,f)+1));k[d]={offset:n,n:f}}n=
0<c;this._ensureCapacity(3*(3*m-2));var q=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT,r=this._trianglesArrayBuffer,s=this._buffer,u=0==n?.5:0;for(d=0;m-2>d;d++)e=cc.v2fsub(cc.__v2f(a[0]),cc.v2fmult(k[0].offset,u)),f=cc.v2fsub(cc.__v2f(a[d+1]),cc.v2fmult(k[d+1].offset,u)),g=cc.v2fsub(cc.__v2f(a[d+2]),cc.v2fmult(k[d+2].offset,u)),s.push(new cc.V2F_C4B_T2F_Triangle({vertices:e,colors:b,texCoords:cc.__t(cc.v2fzero())},{vertices:f,colors:b,texCoords:cc.__t(cc.v2fzero())},{vertices:g,colors:b,texCoords:cc.__t(cc.v2fzero())},
r,s.length*q));for(d=0;m>d;d++){u=(d+1)%m;e=cc.__v2f(a[d]);f=cc.__v2f(a[u]);g=k[d].n;var t=k[d].offset,v=k[u].offset,u=n?cc.v2fsub(e,cc.v2fmult(t,c)):cc.v2fsub(e,cc.v2fmult(t,.5)),w=n?cc.v2fsub(f,cc.v2fmult(v,c)):cc.v2fsub(f,cc.v2fmult(v,.5));e=n?cc.v2fadd(e,cc.v2fmult(t,c)):cc.v2fadd(e,cc.v2fmult(t,.5));f=n?cc.v2fadd(f,cc.v2fmult(v,c)):cc.v2fadd(f,cc.v2fmult(v,.5));n?(s.push(new cc.V2F_C4B_T2F_Triangle({vertices:u,colors:h,texCoords:cc.__t(cc.v2fneg(g))},{vertices:w,colors:h,texCoords:cc.__t(cc.v2fneg(g))},
{vertices:f,colors:h,texCoords:cc.__t(g)},r,s.length*q)),s.push(new cc.V2F_C4B_T2F_Triangle({vertices:u,colors:h,texCoords:cc.__t(cc.v2fneg(g))},{vertices:e,colors:h,texCoords:cc.__t(g)},{vertices:f,colors:h,texCoords:cc.__t(g)},r,s.length*q))):(s.push(new cc.V2F_C4B_T2F_Triangle({vertices:u,colors:b,texCoords:cc.__t(cc.v2fzero())},{vertices:w,colors:b,texCoords:cc.__t(cc.v2fzero())},{vertices:f,colors:b,texCoords:cc.__t(g)},r,s.length*q)),s.push(new cc.V2F_C4B_T2F_Triangle({vertices:u,colors:b,texCoords:cc.__t(cc.v2fzero())},
{vertices:e,colors:b,texCoords:cc.__t(g)},{vertices:f,colors:b,texCoords:cc.__t(g)},r,s.length*q)))}this._dirty=!0},_drawSegments:function(a,b,c,d){if(b=b||this._lineWidth,c=c||this._drawColor,null==c.a&&(c.a=255),b*=.5,!(0>=b)){var e,f,g,h={r:0|c.r,g:0|c.g,b:0|c.b,a:0|c.a},k=[],m=a.length;for(c=0;m>c;c++){e=cc.__v2f(a[(c-1+m)%m]);f=cc.__v2f(a[c]);g=cc.__v2f(a[(c+1)%m]);var n=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(f,e)));f=cc.v2fnormalize(cc.v2fperp(cc.v2fsub(g,f)));g=cc.v2fmult(cc.v2fadd(n,f),1/(cc.v2fdot(n,
f)+1));k[c]={offset:g,n:f}}this._ensureCapacity(3*(3*m-2));g=cc.V2F_C4B_T2F_Triangle.BYTES_PER_ELEMENT;var n=this._trianglesArrayBuffer,q=this._buffer;d=d?m:m-1;for(c=0;d>c;c++){var r=(c+1)%m;e=cc.__v2f(a[c]);f=cc.__v2f(a[r]);var s=k[c].n,u=k[c].offset,t=k[r].offset,r=cc.v2fsub(e,cc.v2fmult(u,b)),v=cc.v2fsub(f,cc.v2fmult(t,b));e=cc.v2fadd(e,cc.v2fmult(u,b));f=cc.v2fadd(f,cc.v2fmult(t,b));q.push(new cc.V2F_C4B_T2F_Triangle({vertices:r,colors:h,texCoords:cc.__t(cc.v2fneg(s))},{vertices:v,colors:h,texCoords:cc.__t(cc.v2fneg(s))},
{vertices:f,colors:h,texCoords:cc.__t(s)},n,q.length*g));q.push(new cc.V2F_C4B_T2F_Triangle({vertices:r,colors:h,texCoords:cc.__t(cc.v2fneg(s))},{vertices:e,colors:h,texCoords:cc.__t(s)},{vertices:f,colors:h,texCoords:cc.__t(s)},n,q.length*g))}this._dirty=!0}},clear:function(){this._buffer.length=0;this._dirty=!0}});cc.DrawNode=cc._renderType==cc._RENDER_TYPE_WEBGL?cc.DrawNodeWebGL:cc.DrawNodeCanvas;cc.DrawNode.create=function(){return new cc.DrawNode};
cc._DrawNodeElement=function(a,b,c,d,e,f,g,h,k){this.type=a;this.verts=b||null;this.fillColor=c||null;this.lineWidth=d||0;this.lineColor=e||null;this.lineCap=f||"butt";this.isClosePolygon=g||!1;this.isFill=h||!1;this.isStroke=k||!1};cc.DrawNode.TYPE_DOT=0;cc.DrawNode.TYPE_SEGMENT=1;cc.DrawNode.TYPE_POLY=2;cc.stencilBits=-1;cc.setProgram=function(a,b){a.shaderProgram=b;var c=a.children;if(c)for(var d=0;d<c.length;d++)cc.setProgram(c[d],b)};
cc.ClippingNode=cc.Node.extend({alphaThreshold:0,inverted:!1,_stencil:null,_godhelpme:!1,ctor:function(a){cc.Node.prototype.ctor.call(this);this._stencil=null;this.alphaThreshold=0;this.inverted=!1;cc.ClippingNode.prototype.init.call(this,a||null)},init:null,_className:"ClippingNode",_initForWebGL:function(a){return this._stencil=a,this.alphaThreshold=1,this.inverted=!1,cc.ClippingNode._init_once=!0,cc.ClippingNode._init_once&&(cc.stencilBits=cc._renderContext.getParameter(cc._renderContext.STENCIL_BITS),
0>=cc.stencilBits&&cc.log("Stencil buffer is not enabled."),cc.ClippingNode._init_once=!1),!0},_initForCanvas:function(a){this._stencil=a;this.alphaThreshold=1;this.inverted=!1},onEnter:function(){cc.Node.prototype.onEnter.call(this);this._stencil.onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this);this._stencil.onEnterTransitionDidFinish()},onExitTransitionDidStart:function(){this._stencil.onExitTransitionDidStart();cc.Node.prototype.onExitTransitionDidStart.call(this)},
onExit:function(){this._stencil.onExit();cc.Node.prototype.onExit.call(this)},visit:null,_visitForWebGL:function(a){var b=a||cc._renderContext;if(1>cc.stencilBits)return void cc.Node.prototype.visit.call(this,a);if(!this._stencil||!this._stencil.visible)return void(this.inverted&&cc.Node.prototype.visit.call(this,a));if(cc.ClippingNode._layer+1==cc.stencilBits)return cc.ClippingNode._visit_once=!0,cc.ClippingNode._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its childs."),
cc.ClippingNode._visit_once=!1),void cc.Node.prototype.visit.call(this,a);cc.ClippingNode._layer++;var c=1<<cc.ClippingNode._layer,d=c|c-1,e=b.isEnabled(b.STENCIL_TEST),f=b.getParameter(b.STENCIL_WRITEMASK),g=b.getParameter(b.STENCIL_FUNC),h=b.getParameter(b.STENCIL_REF),k=b.getParameter(b.STENCIL_VALUE_MASK),m=b.getParameter(b.STENCIL_FAIL),n=b.getParameter(b.STENCIL_PASS_DEPTH_FAIL),q=b.getParameter(b.STENCIL_PASS_DEPTH_PASS);b.enable(b.STENCIL_TEST);b.stencilMask(c);var r=b.getParameter(b.DEPTH_WRITEMASK);
if(b.depthMask(!1),b.stencilFunc(b.NEVER,c,c),b.stencilOp(this.inverted?b.REPLACE:b.ZERO,b.KEEP,b.KEEP),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPushMatrix(),cc.kmGLLoadIdentity(),cc._drawingUtil.drawSolidRect(cc.p(-1,-1),cc.p(1,1),cc.color(255,255,255,255)),cc.kmGLMatrixMode(cc.KM_GL_PROJECTION),cc.kmGLPopMatrix(),cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW),cc.kmGLPopMatrix(),b.stencilFunc(b.NEVER,c,c),b.stencilOp(this.inverted?
b.ZERO:b.REPLACE,b.KEEP,b.KEEP),1>this.alphaThreshold){var c=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLORALPHATEST),s=b.getUniformLocation(c.getProgram(),cc.UNIFORM_ALPHA_TEST_VALUE_S);cc.glUseProgram(c.getProgram());c.setUniformLocationWith1f(s,this.alphaThreshold);cc.setProgram(this._stencil,c)}cc.kmGLPushMatrix();this.transform();this._stencil.visit();cc.kmGLPopMatrix();b.depthMask(r);b.stencilFunc(b.EQUAL,d,d);b.stencilOp(b.KEEP,b.KEEP,b.KEEP);cc.Node.prototype.visit.call(this,
a);b.stencilFunc(g,h,k);b.stencilOp(m,n,q);b.stencilMask(f);e||b.disable(b.STENCIL_TEST);cc.ClippingNode._layer--},_visitForCanvas:function(a){if(!this._stencil||!this._stencil.visible)return void(this.inverted&&cc.Node.prototype.visit.call(this,a));a=a||cc._renderContext;var b=a.canvas;if(this._cangodhelpme()||this._stencil instanceof cc.Sprite){var c=cc.ClippingNode._getSharedCache();c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b,0,0);a.save();cc.Node.prototype.visit.call(this,
a);a.globalCompositeOperation=this.inverted?"destination-out":"destination-in";this.transform(a);this._stencil.visit();a.restore();a.save();a.setTransform(1,0,0,1,0,0);a.globalCompositeOperation="destination-over";a.drawImage(c,0,0)}else{var d=this._children;a.save();this.transform(a);this._stencil.visit(a);this.inverted&&(a.save(),a.setTransform(1,0,0,1,0,0),a.moveTo(0,0),a.lineTo(0,b.height),a.lineTo(b.width,b.height),a.lineTo(b.width,0),a.lineTo(0,0),a.restore());a.clip();this._cangodhelpme(!0);
var e=d.length;if(0<e){this.sortAllChildren();for(b=0;e>b&&(c=d[b],0>c._localZOrder);b++)c.visit(a);for(this.draw(a);e>b;b++)d[b].visit(a)}else this.draw(a);this._cangodhelpme(!1)}a.restore()},getStencil:function(){return this._stencil},setStencil:null,_setStencilForWebGL:function(a){this._stencil=a},_setStencilForCanvas:function(a){this._stencil=a;var b=cc._renderContext;a instanceof cc.Sprite||a instanceof cc.DrawNode&&(a.draw=function(){var c=cc.view.getScaleX(),d=cc.view.getScaleY();b.beginPath();
for(var e=0;e<a._buffer.length;e++){var f=a._buffer[e].verts,g=f[0];b.moveTo(g.x*c,-g.y*d);for(var g=1,h=f.length;h>g;g++)b.lineTo(f[g].x*c,-f[g].y*d)}})},getAlphaThreshold:function(){return this.alphaThreshold},setAlphaThreshold:function(a){this.alphaThreshold=a},isInverted:function(){return this.inverted},setInverted:function(a){this.inverted=a},_cangodhelpme:function(a){return(!0===a||!1===a)&&(cc.ClippingNode.prototype._godhelpme=a),cc.ClippingNode.prototype._godhelpme}});_p=cc.ClippingNode.prototype;
cc._renderType===cc._RENDER_TYPE_WEBGL?(_p.init=_p._initForWebGL,_p.visit=_p._visitForWebGL,_p.setStencil=_p._setStencilForWebGL):(_p.init=_p._initForCanvas,_p.visit=_p._visitForCanvas,_p.setStencil=_p._setStencilForCanvas);cc.defineGetterSetter(_p,"stencil",_p.getStencil,_p.setStencil);_p.stencil;cc.ClippingNode._init_once=null;cc.ClippingNode._visit_once=null;cc.ClippingNode._layer=-1;cc.ClippingNode._sharedCache=null;
cc.ClippingNode._getSharedCache=function(){return cc.ClippingNode._sharedCache||(cc.ClippingNode._sharedCache=document.createElement("canvas"))};cc.ClippingNode.create=function(a){return new cc.ClippingNode(a)};
cc.ProgressTimer=cc.Node.extend({_type:null,_percentage:0,_sprite:null,_midPoint:null,_barChangeRate:null,_reverseDirection:!1,_className:"ProgressTimer",getMidpoint:function(){return cc.p(this._midPoint.x,this._midPoint.y)},setMidpoint:function(a){this._midPoint=cc.pClamp(a,cc.p(0,0),cc.p(1,1))},getBarChangeRate:function(){return cc.p(this._barChangeRate.x,this._barChangeRate.y)},setBarChangeRate:function(a){this._barChangeRate=cc.pClamp(a,cc.p(0,0),cc.p(1,1))},getType:function(){return this._type},
getPercentage:function(){return this._percentage},getSprite:function(){return this._sprite},setPercentage:function(a){this._percentage!=a&&(this._percentage=cc.clampf(a,0,100),this._updateProgress())},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1},isReverseDirection:function(){return this._reverseDirection},_boundaryTexCoord:function(a){if(a<cc.ProgressTimer.TEXTURE_COORDS_COUNT){var b=cc.ProgressTimer.TEXTURE_COORDS;return this._reverseDirection?cc.p(b>>7-(a<<1)&1,b>>7-
((a<<1)+1)&1):cc.p(b>>(a<<1)+1&1,b>>(a<<1)&1)}return cc.p(0,0)},_origin:null,_startAngle:270,_endAngle:270,_radius:0,_counterClockWise:!1,_barRect:null,_vertexDataCount:0,_vertexData:null,_vertexArrayBuffer:null,_vertexWebGLBuffer:null,_vertexDataDirty:!1,ctor:null,_ctorForCanvas:function(a){cc.Node.prototype.ctor.call(this);this._type=cc.ProgressTimer.TYPE_RADIAL;this._percentage=0;this._midPoint=cc.p(0,0);this._barChangeRate=cc.p(0,0);this._reverseDirection=!1;this._sprite=null;this._origin=cc.p(0,
0);this._endAngle=this._startAngle=270;this._radius=0;this._counterClockWise=!1;this._barRect=cc.rect(0,0,0,0);a&&this._initWithSpriteForCanvas(a)},_ctorForWebGL:function(a){cc.Node.prototype.ctor.call(this);this._type=cc.ProgressTimer.TYPE_RADIAL;this._percentage=0;this._midPoint=cc.p(0,0);this._barChangeRate=cc.p(0,0);this._reverseDirection=!1;this._sprite=null;this._vertexWebGLBuffer=cc._renderContext.createBuffer();this._vertexDataCount=0;this._vertexArrayBuffer=this._vertexData=null;this._vertexDataDirty=
!1;a&&this._initWithSpriteForWebGL(a)},setColor:function(a){this._sprite.color=a;this._updateColor()},setOpacity:function(a){this._sprite.opacity=a;this._updateColor()},getColor:function(){return this._sprite.color},getOpacity:function(){return this._sprite.opacity},setReverseProgress:null,_setReverseProgressForCanvas:function(a){this._reverseDirection!==a&&(this._reverseDirection=a)},_setReverseProgressForWebGL:function(a){this._reverseDirection!==a&&(this._reverseDirection=a,this._vertexData=null,
this._vertexArrayBuffer=null,this._vertexDataCount=0)},setSprite:null,_setSpriteForCanvas:function(a){this._sprite!=a&&(this._sprite=a,this.width=this._sprite.width,this.height=this._sprite.height)},_setSpriteForWebGL:function(a){a&&this._sprite!=a&&(this._sprite=a,this.width=a.width,this.height=a.height,this._vertexData&&(this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0))},setType:null,_setTypeForCanvas:function(a){a!==this._type&&(this._type=a)},_setTypeForWebGL:function(a){a!==
this._type&&(this._vertexData&&(this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0),this._type=a)},setReverseDirection:null,_setReverseDirectionForCanvas:function(a){this._reverseDirection!==a&&(this._reverseDirection=a)},_setReverseDirectionForWebGL:function(a){this._reverseDirection!==a&&(this._reverseDirection=a,this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0)},_textureCoordFromAlphaPoint:function(a){var b=this._sprite;if(!b)return{u:0,v:0};var c=
b.quad,d=cc.p(c.bl.texCoords.u,c.bl.texCoords.v),c=cc.p(c.tr.texCoords.u,c.tr.texCoords.v);b.textureRectRotated&&(b=a.x,a.x=a.y,a.y=b);return{u:d.x*(1-a.x)+c.x*a.x,v:d.y*(1-a.y)+c.y*a.y}},_vertexFromAlphaPoint:function(a){if(!this._sprite)return{x:0,y:0};var b=this._sprite.quad,c=cc.p(b.bl.vertices.x,b.bl.vertices.y),b=cc.p(b.tr.vertices.x,b.tr.vertices.y);return{x:c.x*(1-a.x)+b.x*a.x,y:c.y*(1-a.y)+b.y*a.y}},initWithSprite:null,_initWithSpriteForCanvas:function(a){return this.percentage=0,this.anchorX=
.5,this.anchorY=.5,this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),this.barChangeRate=cc.p(1,1),this.sprite=a,!0},_initWithSpriteForWebGL:function(a){return this.percentage=0,this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0,this.anchorX=.5,this.anchorY=.5,this._type=cc.ProgressTimer.TYPE_RADIAL,this._reverseDirection=!1,this.midPoint=cc.p(.5,.5),this.barChangeRate=cc.p(1,1),this.sprite=a,this.shaderProgram=cc.shaderCache.programForKey(cc.SHADER_POSITION_TEXTURECOLOR),
!0},draw:null,_drawForCanvas:function(a){a=a||cc._renderContext;var b=this._sprite;"source"!=b._blendFuncStr&&(a.globalCompositeOperation=b._blendFuncStr);var c=cc.view.getScaleX(),d=cc.view.getScaleY();a.globalAlpha=b._displayedOpacity/255;var e=b._rect,f=b._contentSize,g=b._offsetPosition,h=b._drawSize_Canvas,k=0|g.x,m=-g.y-e.height,n=b._textureRect_Canvas;(h.width=e.width*c,h.height=e.height*d,a.save(),b._flippedX&&(k=-g.x-e.width,a.scale(-1,1)),b._flippedY&&(m=g.y,a.scale(1,-1)),k*=c,m*=d,this._type==
cc.ProgressTimer.TYPE_BAR)?(e=this._barRect,a.beginPath(),a.rect(e.x*c,e.y*d,e.width*c,e.height*d),a.clip(),a.closePath()):this._type==cc.ProgressTimer.TYPE_RADIAL&&(e=this._origin.x*c,g=this._origin.y*d,a.beginPath(),a.arc(e,g,this._radius*d,Math.PI/180*this._startAngle,Math.PI/180*this._endAngle,this._counterClockWise),a.lineTo(e,g),a.clip(),a.closePath());b._texture&&n.validRect?(c=b._texture.getHtmlElementObj(),b._colorized?a.drawImage(c,0,0,n.width,n.height,k,m,h.width,h.height):a.drawImage(c,
n.x,n.y,n.width,n.height,k,m,h.width,h.height)):0!==f.width&&(b=this.color,a.fillStyle="rgba("+b.r+","+b.g+","+b.b+",1)",a.fillRect(k,m,f.width*c,f.height*d));a.restore();cc.incrementGLDraws(1)},_drawForWebGL:function(a){a=a||cc._renderContext;if(this._vertexData&&this._sprite){cc.nodeDrawSetup(this);var b=this._sprite.getBlendFunc();cc.glBlendFunc(b.src,b.dst);cc.glEnableVertexAttribs(cc.VERTEX_ATTRIB_FLAG_POS_COLOR_TEX);cc.glBindTexture2D(this._sprite.texture);a.bindBuffer(a.ARRAY_BUFFER,this._vertexWebGLBuffer);
this._vertexDataDirty&&(a.bufferData(a.ARRAY_BUFFER,this._vertexArrayBuffer,a.DYNAMIC_DRAW),this._vertexDataDirty=!1);b=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;a.vertexAttribPointer(cc.VERTEX_ATTRIB_POSITION,2,a.FLOAT,!1,b,0);a.vertexAttribPointer(cc.VERTEX_ATTRIB_COLOR,4,a.UNSIGNED_BYTE,!0,b,8);a.vertexAttribPointer(cc.VERTEX_ATTRIB_TEX_COORDS,2,a.FLOAT,!1,b,12);this._type===cc.ProgressTimer.TYPE_RADIAL?a.drawArrays(a.TRIANGLE_FAN,0,this._vertexDataCount):this._type==cc.ProgressTimer.TYPE_BAR&&(this._reverseDirection?
(a.drawArrays(a.TRIANGLE_STRIP,0,this._vertexDataCount/2),a.drawArrays(a.TRIANGLE_STRIP,4,this._vertexDataCount/2),cc.g_NumberOfDraws++):a.drawArrays(a.TRIANGLE_STRIP,0,this._vertexDataCount));cc.g_NumberOfDraws++}},_updateRadial:function(){if(this._sprite){var a,b,c=this._midPoint;a=this._percentage/100;var d=2*cc.PI*(this._reverseDirection?a:1-a),e=cc.p(c.x,1);b=cc.pRotateByAngle(e,c,d);d=0;if(0==a)b=e,d=0;else if(1==a)b=e,d=4;else{var f=cc.FLT_MAX,g=cc.ProgressTimer.TEXTURE_COORDS_COUNT;for(a=
0;g>=a;++a){var h=(a+(g-1))%g,k=this._boundaryTexCoord(a%g),h=this._boundaryTexCoord(h);0==a?h=cc.pLerp(k,h,1-c.x):4==a&&(k=cc.pLerp(k,h,1-c.x));var m=cc.p(0,0);cc.pLineIntersect(k,h,c,b,m)&&(0!=a&&4!=a||0<=m.x&&1>=m.x)&&0<=m.y&&m.y<f&&(f=m.y,d=a)}b=cc.pAdd(c,cc.pMult(cc.pSub(b,c),f))}f=!0;if(this._vertexDataCount!=d+3&&(f=!1,this._vertexData=null,this._vertexArrayBuffer=null,this._vertexDataCount=0),!this._vertexData){g=this._vertexDataCount=d+3;k=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=
new ArrayBuffer(g*k);h=[];for(a=0;g>a;a++)h[a]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,a*k);if(this._vertexData=h,!this._vertexData)return void cc.log("cc.ProgressTimer._updateRadial() : Not enough memory")}this._updateColor();g=this._vertexData;if(!f)for(g[0].texCoords=this._textureCoordFromAlphaPoint(c),g[0].vertices=this._vertexFromAlphaPoint(c),g[1].texCoords=this._textureCoordFromAlphaPoint(e),g[1].vertices=this._vertexFromAlphaPoint(e),a=0;d>a;a++)c=this._boundaryTexCoord(a),
g[a+2].texCoords=this._textureCoordFromAlphaPoint(c),g[a+2].vertices=this._vertexFromAlphaPoint(c);g[this._vertexDataCount-1].texCoords=this._textureCoordFromAlphaPoint(b);g[this._vertexDataCount-1].vertices=this._vertexFromAlphaPoint(b)}},_updateBar:function(){if(this._sprite){var a,b=this._percentage/100,c=this._barChangeRate,c=cc.pMult(cc.p(1-c.x+b*c.x,1-c.y+b*c.y),.5),b=cc.pSub(this._midPoint,c),c=cc.pAdd(this._midPoint,c);0>b.x&&(c.x+=-b.x,b.x=0);1<c.x&&(b.x-=c.x-1,c.x=1);0>b.y&&(c.y+=-b.y,b.y=
0);1<c.y&&(b.y-=c.y-1,c.y=1);if(this._reverseDirection){if(!this._vertexData){this._vertexDataCount=8;var d=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT;this._vertexArrayBuffer=new ArrayBuffer(8*d);var e=[];for(a=0;8>a;a++)e[a]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,a*d);e[0].texCoords=this._textureCoordFromAlphaPoint(cc.p(0,1));e[0].vertices=this._vertexFromAlphaPoint(cc.p(0,1));e[1].texCoords=this._textureCoordFromAlphaPoint(cc.p(0,0));e[1].vertices=this._vertexFromAlphaPoint(cc.p(0,0));
e[6].texCoords=this._textureCoordFromAlphaPoint(cc.p(1,1));e[6].vertices=this._vertexFromAlphaPoint(cc.p(1,1));e[7].texCoords=this._textureCoordFromAlphaPoint(cc.p(1,0));e[7].vertices=this._vertexFromAlphaPoint(cc.p(1,0));this._vertexData=e}a=this._vertexData;a[2].texCoords=this._textureCoordFromAlphaPoint(cc.p(b.x,c.y));a[2].vertices=this._vertexFromAlphaPoint(cc.p(b.x,c.y));a[3].texCoords=this._textureCoordFromAlphaPoint(cc.p(b.x,b.y));a[3].vertices=this._vertexFromAlphaPoint(cc.p(b.x,b.y));a[4].texCoords=
this._textureCoordFromAlphaPoint(cc.p(c.x,c.y));a[4].vertices=this._vertexFromAlphaPoint(cc.p(c.x,c.y));a[5].texCoords=this._textureCoordFromAlphaPoint(cc.p(c.x,b.y));a[5].vertices=this._vertexFromAlphaPoint(cc.p(c.x,b.y))}else{if(!this._vertexData)for(this._vertexDataCount=4,d=cc.V2F_C4B_T2F.BYTES_PER_ELEMENT,this._vertexArrayBuffer=new ArrayBuffer(4*d),this._vertexData=[],a=0;4>a;a++)this._vertexData[a]=new cc.V2F_C4B_T2F(null,null,null,this._vertexArrayBuffer,a*d);a=this._vertexData;a[0].texCoords=
this._textureCoordFromAlphaPoint(cc.p(b.x,c.y));a[0].vertices=this._vertexFromAlphaPoint(cc.p(b.x,c.y));a[1].texCoords=this._textureCoordFromAlphaPoint(cc.p(b.x,b.y));a[1].vertices=this._vertexFromAlphaPoint(cc.p(b.x,b.y));a[2].texCoords=this._textureCoordFromAlphaPoint(cc.p(c.x,c.y));a[2].vertices=this._vertexFromAlphaPoint(cc.p(c.x,c.y));a[3].texCoords=this._textureCoordFromAlphaPoint(cc.p(c.x,b.y));a[3].vertices=this._vertexFromAlphaPoint(cc.p(c.x,b.y))}this._updateColor()}},_updateColor:function(){if(this._sprite&&
this._vertexData){for(var a=this._sprite.quad.tl.colors,b=this._vertexData,c=0,d=this._vertexDataCount;d>c;++c)b[c].colors=a;this._vertexDataDirty=!0}},_updateProgress:null,_updateProgressForCanvas:function(){var a=this._sprite,b=a.width,c=a.height,d=this._midPoint;if(this._type==cc.ProgressTimer.TYPE_RADIAL){this._radius=Math.round(Math.sqrt(b*b+c*c));var e,f,g=!1,h=this._origin;h.x=b*d.x;h.y=-c*d.y;this._reverseDirection?(f=270,e=270-3.6*this._percentage):(e=-90,f=-90+3.6*this._percentage);a._flippedX&&
(h.x-=2*b*this._midPoint.x,e=-e,f=-f,e-=180,f-=180,g=!g);a._flippedY&&(h.y+=2*c*this._midPoint.y,g=!g,e=-e,f=-f);this._startAngle=e;this._endAngle=f;this._counterClockWise=g}else g=this._barChangeRate,f=this._percentage/100,e=this._barRect,g=cc.size(b*(1-g.x),c*(1-g.y)),f=cc.size((b-g.width)*f,(c-g.height)*f),f=cc.size(g.width+f.width,g.height+f.height),h=cc.p(b*d.x,c*d.y),g=h.x-f.width/2,.5<d.x&&f.width/2>=b-h.x&&(g=b-f.width),b=h.y-f.height/2,.5<d.y&&f.height/2>=c-h.y&&(b=c-f.height),e.x=0,c=1,
a._flippedX&&(e.x-=f.width,c=-1),0<g&&(e.x+=g*c),e.y=0,c=1,a._flippedY&&(e.y+=f.height,c=-1),0<b&&(e.y-=b*c),e.width=f.width,e.height=-f.height},_updateProgressForWebGL:function(){var a=this._type;a===cc.ProgressTimer.TYPE_RADIAL?this._updateRadial():a===cc.ProgressTimer.TYPE_BAR&&this._updateBar();this._vertexDataDirty=!0}});_p=cc.ProgressTimer.prototype;
cc._renderType==cc._RENDER_TYPE_WEBGL?(_p.ctor=_p._ctorForWebGL,_p.setReverseProgress=_p._setReverseProgressForWebGL,_p.setSprite=_p._setSpriteForWebGL,_p.setType=_p._setTypeForWebGL,_p.setReverseDirection=_p._setReverseDirectionForWebGL,_p.initWithSprite=_p._initWithSpriteForWebGL,_p.draw=_p._drawForWebGL,_p._updateProgress=_p._updateProgressForWebGL):(_p.ctor=_p._ctorForCanvas,_p.setReverseProgress=_p._setReverseProgressForCanvas,_p.setSprite=_p._setSpriteForCanvas,_p.setType=_p._setTypeForCanvas,
_p.setReverseDirection=_p._setReverseDirectionForCanvas,_p.initWithSprite=_p._initWithSpriteForCanvas,_p.draw=_p._drawForCanvas,_p._updateProgress=cc.ProgressTimer.prototype._updateProgressForCanvas);_p.midPoint;cc.defineGetterSetter(_p,"midPoint",_p.getMidpoint,_p.setMidpoint);_p.barChangeRate;cc.defineGetterSetter(_p,"barChangeRate",_p.getBarChangeRate,_p.setBarChangeRate);_p.type;cc.defineGetterSetter(_p,"type",_p.getType,_p.setType);_p.percentage;
cc.defineGetterSetter(_p,"percentage",_p.getPercentage,_p.setPercentage);_p.sprite;cc.defineGetterSetter(_p,"sprite",_p.getSprite,_p.setSprite);_p.reverseDir;cc.defineGetterSetter(_p,"reverseDir",_p.isReverseDirection,_p.setReverseDirection);cc.ProgressTimer.create=function(a){return new cc.ProgressTimer(a)};cc.ProgressTimer.TEXTURE_COORDS_COUNT=4;cc.ProgressTimer.TEXTURE_COORDS=75;cc.ProgressTimer.TYPE_RADIAL=0;cc.ProgressTimer.TYPE_BAR=1;
cc.ProgressTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(a,b){cc.ActionInterval.prototype.ctor.call(this);this._from=this._to=0;void 0!==b&&this.initWithDuration(a,b)},initWithDuration:function(a,b){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._to=b,!0):!1},clone:function(){var a=new cc.ProgressTo;return a.initWithDuration(this._duration,this._to),a},reverse:function(){return cc.log("cc.ProgressTo.reverse(): reverse hasn't been supported."),null},startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,
a);this._from=a.percentage;100==this._from&&(this._from=0)},update:function(a){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*a)}});cc.progressTo=function(a,b){return new cc.ProgressTo(a,b)};cc.ProgressTo.create=cc.progressTo;
cc.ProgressFromTo=cc.ActionInterval.extend({_to:0,_from:0,ctor:function(a,b,c){cc.ActionInterval.prototype.ctor.call(this);this._from=this._to=0;void 0!==c&&this.initWithDuration(a,b,c)},initWithDuration:function(a,b,c){return cc.ActionInterval.prototype.initWithDuration.call(this,a)?(this._to=c,this._from=b,!0):!1},clone:function(){var a=new cc.ProgressFromTo;return a.initWithDuration(this._duration,this._from,this._to),a},reverse:function(){return cc.progressFromTo(this._duration,this._to,this._from)},
startWithTarget:function(a){cc.ActionInterval.prototype.startWithTarget.call(this,a)},update:function(a){this.target instanceof cc.ProgressTimer&&(this.target.percentage=this._from+(this._to-this._from)*a)}});cc.progressFromTo=function(a,b,c){return new cc.ProgressFromTo(a,b,c)};cc.ProgressFromTo.create=cc.progressFromTo;cc.IMEKeyboardNotificationInfo=function(a,b,c){this.begin=a||cc.rect(0,0,0,0);this.end=b||cc.rect(0,0,0,0);this.duration=c||0};
cc.IMEDelegate=cc.Class.extend({ctor:function(){cc.imeDispatcher.addDelegate(this)},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return!1},didAttachWithIME:function(){},canDetachWithIME:function(){return!1},didDetachWithIME:function(){},insertText:function(){},deleteBackward:function(){},getContentText:function(){return""},
keyboardWillShow:function(){},keyboardDidShow:function(){},keyboardWillHide:function(){},keyboardDidHide:function(){}});
cc.IMEDispatcher=cc.Class.extend({_domInputControl:null,impl:null,_currentInputString:"",_lastClickPosition:null,ctor:function(){this.impl=new cc.IMEDispatcher.Impl;this._lastClickPosition=cc.p(0,0)},init:function(){if(!cc.sys.isMobile){(this._domInputControl=cc.$("#imeDispatcherInput"))||(this._domInputControl=cc.$new("input"),this._domInputControl.setAttribute("type","text"),this._domInputControl.setAttribute("id","imeDispatcherInput"),this._domInputControl.resize(0,0),this._domInputControl.translates(0,
0),this._domInputControl.style.opacity="0",this._domInputControl.style.fontSize="1px",this._domInputControl.setAttribute("tabindex",2),this._domInputControl.style.position="absolute",this._domInputControl.style.top=0,this._domInputControl.style.left=0,document.body.appendChild(this._domInputControl));var a=this;cc._addEventListener(this._domInputControl,"input",function(){a._processDomInputString(a._domInputControl.value)},!1);cc._addEventListener(this._domInputControl,"keydown",function(b){b.keyCode===
cc.KEY.tab?(b.stopPropagation(),b.preventDefault()):b.keyCode==cc.KEY.enter&&(a.dispatchInsertText("\n",1),b.stopPropagation(),b.preventDefault())},!1);/msie/i.test(navigator.userAgent)&&cc._addEventListener(this._domInputControl,"keyup",function(b){b.keyCode==cc.KEY.backspace&&a._processDomInputString(a._domInputControl.value)},!1);cc._addEventListener(window,"mousedown",function(b){var c=b.pageY||0;a._lastClickPosition.x=b.pageX||0;a._lastClickPosition.y=c},!1)}},_processDomInputString:function(a){var b,
c;b=this._currentInputString.length<a.length?this._currentInputString.length:a.length;for(c=0;b>c&&a[c]===this._currentInputString[c];c++);var d=this._currentInputString.length-c,e=a.length-c;for(b=0;d>b;b++)this.dispatchDeleteBackward();for(b=0;e>b;b++)this.dispatchInsertText(a[c+b],1);this._currentInputString=a},dispatchInsertText:function(a,b){!this.impl||!a||0>=b||this.impl._delegateWithIme&&this.impl._delegateWithIme.insertText(a,b)},dispatchDeleteBackward:function(){this.impl&&this.impl._delegateWithIme&&
this.impl._delegateWithIme.deleteBackward()},getContentText:function(){if(this.impl&&this.impl._delegateWithIme){var a=this.impl._delegateWithIme.getContentText();return a?a:""}return""},dispatchKeyboardWillShow:function(a){if(this.impl)for(var b=0;b<this.impl._delegateList.length;b++){var c=this.impl._delegateList[b];c&&c.keyboardWillShow(a)}},dispatchKeyboardDidShow:function(a){if(this.impl)for(var b=0;b<this.impl._delegateList.length;b++){var c=this.impl._delegateList[b];c&&c.keyboardDidShow(a)}},
dispatchKeyboardWillHide:function(a){if(this.impl)for(var b=0;b<this.impl._delegateList.length;b++){var c=this.impl._delegateList[b];c&&c.keyboardWillHide(a)}},dispatchKeyboardDidHide:function(a){if(this.impl)for(var b=0;b<this.impl._delegateList.length;b++){var c=this.impl._delegateList[b];c&&c.keyboardDidHide(a)}},addDelegate:function(a){a&&this.impl&&(-1<this.impl._delegateList.indexOf(a)||this.impl._delegateList.splice(0,0,a))},attachDelegateWithIME:function(a){if(!this.impl||!a||-1==this.impl._delegateList.indexOf(a))return!1;
if(this.impl._delegateWithIme){if(!this.impl._delegateWithIme.canDetachWithIME()||!a.canAttachWithIME())return!1;var b=this.impl._delegateWithIme;return this.impl._delegateWithIme=null,b.didDetachWithIME(),this._focusDomInput(a),!0}return a.canAttachWithIME()?(this._focusDomInput(a),!0):!1},_focusDomInput:function(a){cc.sys.isMobile?(this.impl._delegateWithIme=a,a.didAttachWithIME(),this._currentInputString=a.string||"",a=prompt("please enter your word:",this._currentInputString),null!=a&&this._processDomInputString(a),
this.dispatchInsertText("\n",1)):(this.impl._delegateWithIme=a,this._currentInputString=a.string||"",a.didAttachWithIME(),this._domInputControl.focus(),this._domInputControl.value=this._currentInputString,this._domInputControlTranslate())},_domInputControlTranslate:function(){/msie/i.test(navigator.userAgent)?(this._domInputControl.style.left=this._lastClickPosition.x+"px",this._domInputControl.style.top=this._lastClickPosition.y+"px"):this._domInputControl.translates(this._lastClickPosition.x,this._lastClickPosition.y)},
detachDelegateWithIME:function(a){return this.impl&&a?this.impl._delegateWithIme!=a?!1:a.canDetachWithIME()?(this.impl._delegateWithIme=null,a.didDetachWithIME(),cc._canvas.focus(),!0):!1:!1},removeDelegate:function(a){this.impl&&a&&-1!=this.impl._delegateList.indexOf(a)&&(this.impl._delegateWithIme&&a==this.impl._delegateWithIme&&(this.impl._delegateWithIme=null),cc.arrayRemoveObject(this.impl._delegateList,a))},processKeycode:function(a){32>a?a==cc.KEY.backspace?this.dispatchDeleteBackward():a==
cc.KEY.enter?this.dispatchInsertText("\n",1):a==cc.KEY.tab||a==cc.KEY.escape:255>a&&this.dispatchInsertText(String.fromCharCode(a),1)}});cc.IMEDispatcher.Impl=cc.Class.extend({_delegateWithIme:null,_delegateList:null,ctor:function(){this._delegateList=[]},findDelegate:function(a){for(var b=0;b<this._delegateList.length;b++)if(this._delegateList[b]==a)return b;return null}});cc.imeDispatcher=new cc.IMEDispatcher;
document.body?cc.imeDispatcher.init():cc._addEventListener(window,"load",function(){cc.imeDispatcher.init()},!1);cc.TextFieldDelegate=cc.Class.extend({onTextFieldAttachWithIME:function(){return!1},onTextFieldDetachWithIME:function(){return!1},onTextFieldInsertText:function(){return!1},onTextFieldDeleteBackward:function(){return!1},onDraw:function(){return!1}});
cc.TextFieldTTF=cc.LabelTTF.extend({delegate:null,colorSpaceHolder:null,_lens:null,_inputText:"",_placeHolder:"",_charCount:0,_className:"TextFieldTTF",ctor:function(a,b,c,d,e){this.colorSpaceHolder=cc.color(127,127,127);cc.imeDispatcher.addDelegate(this);cc.LabelTTF.prototype.ctor.call(this);void 0!==e?(this.initWithPlaceHolder("",b,c,d,e),a&&this.setPlaceHolder(a)):void 0===d&&void 0!==c&&(this.initWithString("",b,c),a&&this.setPlaceHolder(a))},getDelegate:function(){return this.delegate},setDelegate:function(a){this.delegate=
a},getCharCount:function(){return this._charCount},getColorSpaceHolder:function(){return this.colorSpaceHolder},setColorSpaceHolder:function(a){this.colorSpaceHolder=a},initWithPlaceHolder:function(a,b,c,d,e){switch(arguments.length){case 5:return a&&this.setPlaceHolder(a),this.initWithString(this._placeHolder,d,e,b,c);case 3:return a&&this.setPlaceHolder(a),this.initWithString(this._placeHolder,arguments[1],arguments[2]);default:throw"Argument must be non-nil ";}},setString:function(a){this._inputText=
(a=String(a))||"";this._inputText.length?cc.LabelTTF.prototype.setString.call(this,this._inputText):cc.LabelTTF.prototype.setString.call(this,this._placeHolder);this._charCount=this._inputText.length},getString:function(){return this._inputText},setPlaceHolder:function(a){this._placeHolder=a||"";this._inputText.length||cc.LabelTTF.prototype.setString.call(this,this._placeHolder)},getPlaceHolder:function(){return this._placeHolder},draw:function(a){a=a||cc._renderContext;if(!this.delegate||!this.delegate.onDraw(this)){if(this._inputText&&
0<this._inputText.length)return void cc.LabelTTF.prototype.draw.call(this,a);var b=this.color;this.color=this.colorSpaceHolder;cc._renderType===cc._RENDER_TYPE_CANVAS&&this._updateTexture();cc.LabelTTF.prototype.draw.call(this,a);this.color=b}},visit:function(a){this._super(a)},attachWithIME:function(){return cc.imeDispatcher.attachDelegateWithIME(this)},detachWithIME:function(){return cc.imeDispatcher.detachDelegateWithIME(this)},canAttachWithIME:function(){return this.delegate?!this.delegate.onTextFieldAttachWithIME(this):
!0},didAttachWithIME:function(){},canDetachWithIME:function(){return this.delegate?!this.delegate.onTextFieldDetachWithIME(this):!0},didDetachWithIME:function(){},deleteBackward:function(){var a=this._inputText.length;if(!(0==a||this.delegate&&this.delegate.onTextFieldDeleteBackward(this,this._inputText[a-1],1)))return 1>=a?(this._inputText="",this._charCount=0,void cc.LabelTTF.prototype.setString.call(this,this._placeHolder)):void(this.string=this._inputText.substring(0,a-1))},removeDelegate:function(){cc.imeDispatcher.removeDelegate(this)},
insertText:function(a){var b=a;a=b.indexOf("\n");if(-1<a&&(b=b.substring(0,a)),0<b.length){if(this.delegate&&this.delegate.onTextFieldInsertText(this,b,b.length))return;b=this._inputText+b;this._charCount=b.length;this.string=b}-1!=a&&(this.delegate&&this.delegate.onTextFieldInsertText(this,"\n",1)||this.detachWithIME())},getContentText:function(){return this._inputText},keyboardWillShow:function(){},keyboardDidShow:function(){},keyboardWillHide:function(){},keyboardDidHide:function(){}});_p=cc.TextFieldTTF.prototype;
_p.charCount;cc.defineGetterSetter(_p,"charCount",_p.getCharCount);_p.placeHolder;cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder);cc.TextFieldTTF.create=function(a,b,c,d,e){return new cc.TextFieldTTF(a,b,c,d,e)};cc.CONTROL_EVENT_TOTAL_NUMBER=9;cc.CONTROL_EVENT_TOUCH_DOWN=1;cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE=2;cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE=4;cc.CONTROL_EVENT_TOUCH_DRAG_ENTER=8;cc.CONTROL_EVENT_TOUCH_DRAG_EXIT=16;cc.CONTROL_EVENT_TOUCH_UP_INSIDE=32;
cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE=64;cc.CONTROL_EVENT_TOUCH_CANCEL=128;cc.CONTROL_EVENT_VALUECHANGED=256;cc.CONTROL_STATE_NORMAL=1;cc.CONTROL_STATE_HIGHLIGHTED=2;cc.CONTROL_STATE_DISABLED=4;cc.CONTROL_STATE_SELECTED=8;cc.CONTROL_STATE_INITIAL=8;
cc.Control=cc.Layer.extend({_isOpacityModifyRGB:!1,_hasVisibleParents:!1,_touchListener:null,_className:"Control",isOpacityModifyRGB:function(){return this._isOpacityModifyRGB},setOpacityModifyRGB:function(a){this._isOpacityModifyRGB=a;for(var b=this.getChildren(),c=0,d=b.length;d>c;c++){var e=b[c];e&&e.setOpacityModifyRGB(a)}},_state:cc.CONTROL_STATE_NORMAL,getState:function(){return this._state},_enabled:!1,_selected:!1,_highlighted:!1,_dispatchTable:null,setEnabled:function(a){this._state=(this._enabled=
a)?cc.CONTROL_STATE_NORMAL:cc.CONTROL_STATE_DISABLED;this.needsLayout()},isEnabled:function(){return this._enabled},setSelected:function(a){this._selected=a;this.needsLayout()},isSelected:function(){return this._selected},setHighlighted:function(a){this._highlighted=a;this.needsLayout()},isHighlighted:function(){return this._highlighted},hasVisibleParents:function(){for(var a=this.getParent();null!=a;a=a.getParent())if(!a.isVisible())return!1;return!0},ctor:function(){cc.Layer.prototype.ctor.call(this);
this._dispatchTable={};this._color=cc.color.WHITE},init:function(){if(cc.Layer.prototype.init.call(this)){this._state=cc.CONTROL_STATE_NORMAL;this._enabled=!0;this._highlighted=this._selected=!1;var a=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE});return this.onTouchBegan&&(a.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(a.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(a.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(a.onTouchCancelled=
this.onTouchCancelled.bind(this)),this._touchListener=a,!0}return!1},onEnter:function(){var a=this._touchListener;a._isRegistered()||cc.eventManager.addListener(a,this);cc.Node.prototype.onEnter.call(this)},sendActionsForControlEvents:function(a){for(var b=0,c=cc.CONTROL_EVENT_TOTAL_NUMBER;c>b;b++)if(a&1<<b)for(var d=this._dispatchListforControlEvent(1<<b),e=0,f=d.length;f>e;e++)d[e].invoke(this)},addTargetWithActionForControlEvents:function(a,b,c){for(var d=0,e=cc.CONTROL_EVENT_TOTAL_NUMBER;e>d;d++)c&
1<<d&&this._addTargetWithActionForControlEvent(a,b,1<<d)},removeTargetWithActionForControlEvents:function(a,b,c){for(var d=0,e=cc.CONTROL_EVENT_TOTAL_NUMBER;e>d;d++)c&1<<d&&this._removeTargetWithActionForControlEvent(a,b,1<<d)},getTouchLocation:function(a){a=a.getLocation();return this.convertToNodeSpace(a)},isTouchInside:function(a){a=a.getLocation();return a=this.getParent().convertToNodeSpace(a),cc.rectContainsPoint(this.getBoundingBox(),a)},_invocationWithTargetAndActionForControlEvent:function(){return null},
_dispatchListforControlEvent:function(a){return a=a.toString(),this._dispatchTable[a]||(this._dispatchTable[a]=[]),this._dispatchTable[a]},_addTargetWithActionForControlEvent:function(a,b,c){a=new cc.Invocation(a,b,c);this._dispatchListforControlEvent(c).push(a)},_removeTargetWithActionForControlEvent:function(a,b,c){c=this._dispatchListforControlEvent(c);if(a||b)for(var d=0;d<c.length;){var e=c[d],f=!0;a&&(f=a==e.getTarget());b&&(f=f&&b==e.getAction());f?cc.arrayRemoveObject(c,e):d++}else c.length=
0},needsLayout:function(){}});_p=cc.Control.prototype;_p.state;cc.defineGetterSetter(_p,"state",_p.getState);_p.enabled;cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled);_p.selected;cc.defineGetterSetter(_p,"selected",_p.isSelected,_p.setSelected);_p.highlighted;cc.defineGetterSetter(_p,"highlighted",_p.isHighlighted,_p.setHighlighted);_p=null;cc.Control.create=function(){var a=new cc.Control;return a&&a.init()?a:null};cc.CONTROL_ZOOM_ACTION_TAG=3435855873;
cc.ControlButton=cc.Control.extend({_doesAdjustBackgroundImage:!1,zoomOnTouchDown:!1,_preferredSize:null,_labelAnchorPoint:null,_currentTitle:null,_currentTitleColor:null,_titleLabel:null,_backgroundSprite:null,_opacity:0,_isPushed:!1,_titleDispatchTable:null,_titleColorDispatchTable:null,_titleLabelDispatchTable:null,_backgroundSpriteDispatchTable:null,_parentInited:!1,_marginV:0,_marginH:0,_className:"ControlButton",ctor:function(a,b,c){cc.Control.prototype.ctor.call(this);this._preferredSize=cc.size(0,
0);this._labelAnchorPoint=cc.p(0,0);this._currentTitle="";this._currentTitleColor=cc.color.WHITE;this._titleDispatchTable={};this._titleColorDispatchTable={};this._titleLabelDispatchTable={};this._backgroundSpriteDispatchTable={};void 0!=c?this.initWithTitleAndFontNameAndFontSize(a,b,c):void 0!=b?this.initWithLabelAndBackgroundSprite(a,b):void 0!=a?this.initWithBackgroundSprite(a):this.init()},init:function(){return this.initWithLabelAndBackgroundSprite(cc.LabelTTF.create("","Arial",12),cc.Scale9Sprite.create())},
needsLayout:function(){if(this._parentInited){this._titleLabel&&this._titleLabel.setVisible(!1);this._backgroundSprite&&this._backgroundSprite.setVisible(!1);this.setLabelAnchorPoint(this._labelAnchorPoint);var a=this._state;this._currentTitle=this.getTitleForState(a);this._currentTitleColor=this.getTitleColorForState(a);var b=this._titleLabel=this.getTitleLabelForState(a);b&&b.setString&&b.setString(this._currentTitle);b&&b.setColor(this._currentTitleColor);var c=this.getContentSize();b&&b.setPosition(c.width/
2,c.height/2);(a=this._backgroundSprite=this.getBackgroundSpriteForState(a))&&a.setPosition(c.width/2,c.height/2);c=cc.size(0,0);if(b){var d=b.getBoundingBox();c.width=d.width;c.height=d.height}this._doesAdjustBackgroundImage?a&&a.setContentSize(c.width+2*this._marginH,c.height+2*this._marginV):a&&(d=a.getPreferredSize(),d=cc.size(d.width,d.height),0>=d.width&&(d.width=c.width),0>=d.height&&(d.height=c.height),a.setContentSize(d));c=b?b.getBoundingBox():cc.rect(0,0,0,0);d=a?a.getBoundingBox():cc.rect(0,
0,0,0);c=cc.rectUnion(c,d);this.setContentSize(c.width,c.height);c=this.getContentSize();b&&(b.setPosition(c.width/2,c.height/2),b.setVisible(!0));a&&(a.setPosition(c.width/2,c.height/2),a.setVisible(!0))}},initWithLabelAndBackgroundSprite:function(a,b){if(!a)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): label should be non-null";if(!b)throw"cc.ControlButton.initWithLabelAndBackgroundSprite(): backgroundSprite should be non-null";if(cc.Control.prototype.init.call(this,!0)){this._parentInited=
!0;this._titleDispatchTable={};this._titleColorDispatchTable={};this._titleLabelDispatchTable={};this._backgroundSpriteDispatchTable={};this._isPushed=!1;this.zoomOnTouchDown=!0;this._currentTitle=null;this.setAdjustBackgroundImage(!0);this.setPreferredSize(cc.size(0,0));this.zoomOnTouchDown=!0;this.ignoreAnchorPointForPosition(!1);this.setAnchorPoint(.5,.5);this._titleLabel=a;this._backgroundSprite=b;this.setOpacity(255);this.setOpacityModifyRGB(!0);var c=a.getString();return this.setTitleForState(c,
cc.CONTROL_STATE_NORMAL),this.setTitleColorForState(a.getColor(),cc.CONTROL_STATE_NORMAL),this.setTitleLabelForState(a,cc.CONTROL_STATE_NORMAL),this.setBackgroundSpriteForState(b,cc.CONTROL_STATE_NORMAL),this._state=cc.CONTROL_STATE_NORMAL,this._marginH=24,this._marginV=12,this._labelAnchorPoint=cc.p(.5,.5),this.setPreferredSize(cc.size(0,0)),this.needsLayout(),!0}return!1},initWithTitleAndFontNameAndFontSize:function(a,b,c){a=cc.LabelTTF.create(a,b,c);return this.initWithLabelAndBackgroundSprite(a,
cc.Scale9Sprite.create())},initWithBackgroundSprite:function(a){var b=cc.LabelTTF.create("","Arial",30);return this.initWithLabelAndBackgroundSprite(b,a)},doesAdjustBackgroundImage:function(){return this._doesAdjustBackgroundImage},setAdjustBackgroundImage:function(a){this._doesAdjustBackgroundImage=a;this.needsLayout()},getZoomOnTouchDown:function(){return this.zoomOnTouchDown},setZoomOnTouchDown:function(a){return this.zoomOnTouchDown=a},getPreferredSize:function(){return this._preferredSize},setPreferredSize:function(a){if(0===
a.width&&0===a.height)this._doesAdjustBackgroundImage=!0;else{this._doesAdjustBackgroundImage=!1;var b=this._backgroundSpriteDispatchTable,c;for(c in b)b[c].setPreferredSize(a)}this._preferredSize=a;this.needsLayout()},getLabelAnchorPoint:function(){return this._labelAnchorPoint},setLabelAnchorPoint:function(a){this._labelAnchorPoint=a;this._titleLabel&&this._titleLabel.setAnchorPoint(a)},_getCurrentTitle:function(){return this._currentTitle},_getCurrentTitleColor:function(){return this._currentTitleColor},
getOpacity:function(){return this._opacity},setOpacity:function(a){cc.Control.prototype.setOpacity.call(this,a);var b=this._backgroundSpriteDispatchTable,c;for(c in b)b[c].setOpacity(a)},setColor:function(a){cc.Control.prototype.setColor.call(this,a);var b=this._backgroundSpriteDispatchTable,c;for(c in b)b[c].setColor(a)},getColor:function(){var a=this._realColor;return cc.color(a.r,a.g,a.b,a.a)},isPushed:function(){return this._isPushed},_getVerticalMargin:function(){return this._marginV},_getHorizontalOrigin:function(){return this._marginH},
setMargins:function(a,b){this._marginV=b;this._marginH=a;this.needsLayout()},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a);this.needsLayout()},setSelected:function(a){cc.Control.prototype.setSelected.call(this,a);this.needsLayout()},setHighlighted:function(a){this._state=a?cc.CONTROL_STATE_HIGHLIGHTED:cc.CONTROL_STATE_NORMAL;cc.Control.prototype.setHighlighted.call(this,a);a=this.getActionByTag(cc.CONTROL_ZOOM_ACTION_TAG);if(a&&this.stopAction(a),this.needsLayout(),this.zoomOnTouchDown)a=
this.isHighlighted()&&this.isEnabled()&&!this.isSelected()?1.1:1,a=cc.ScaleTo.create(.05,a),a.setTag(cc.CONTROL_ZOOM_ACTION_TAG),this.runAction(a)},onTouchBegan:function(a){return this.isTouchInside(a)&&this.isEnabled()&&this.isVisible()&&this.hasVisibleParents()?(this._isPushed=!0,this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DOWN),!0):!1},onTouchMoved:function(a){if(!this._enabled||!this._isPushed||this._selected)return void(this._highlighted&&this.setHighlighted(!1));
(a=this.isTouchInside(a))&&!this._highlighted?(this.setHighlighted(!0),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_ENTER)):a&&this._highlighted?this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_INSIDE):!a&&this._highlighted?(this.setHighlighted(!1),this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_EXIT)):a||this._highlighted||this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_DRAG_OUTSIDE)},onTouchEnded:function(a){this._isPushed=!1;this.setHighlighted(!1);
this.sendActionsForControlEvents(this.isTouchInside(a)?cc.CONTROL_EVENT_TOUCH_UP_INSIDE:cc.CONTROL_EVENT_TOUCH_UP_OUTSIDE)},onTouchCancelled:function(){this._isPushed=!1;this.setHighlighted(!1);this.sendActionsForControlEvents(cc.CONTROL_EVENT_TOUCH_CANCEL)},getTitleForState:function(a){var b=this._titleDispatchTable;return b?b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]:""},setTitleForState:function(a,b){this._titleDispatchTable[b]=a||"";this.getState()==b&&this.needsLayout()},getTitleColorForState:function(a){return(a=
this._titleColorDispatchTable[a])?a:(a=this._titleColorDispatchTable[cc.CONTROL_STATE_NORMAL],a?a:cc.color.WHITE)},setTitleColorForState:function(a,b){this._titleColorDispatchTable[b]=a;this.getState()==b&&this.needsLayout()},getTitleLabelForState:function(a){var b=this._titleLabelDispatchTable;return b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]},setTitleLabelForState:function(a,b){var c=this._titleLabelDispatchTable;if(c[b]){var d=c[b];d&&this.removeChild(d,!0)}c[b]=a;a.setVisible(!1);a.setAnchorPoint(.5,
.5);this.addChild(a,1);this.getState()==b&&this.needsLayout()},setTitleTTFForState:function(a,b){var c=this.getTitleForState(b);c||(c="");this.setTitleLabelForState(cc.LabelTTF.create(c,a,12),b)},getTitleTTFForState:function(a){a=this.getTitleLabelForState(a);return null!=a&&a instanceof cc.LabelTTF?a.getFontName():""},setTitleTTFSizeForState:function(a,b){var c=this.getTitleLabelForState(b);null!=c&&c instanceof cc.LabelTTF&&c.setFontSize(a)},getTitleTTFSizeForState:function(a){a=this.getTitleLabelForState(a);
return null!=a&&a instanceof cc.LabelTTF?a.getFontSize():0},setTitleBMFontForState:function(a,b){var c=this.getTitleForState(b);c||(c="");this.setTitleLabelForState(cc.LabelBMFont.create(c,a),b)},getTitleBMFontForState:function(a){a=this.getTitleLabelForState(a);return null!=a&&a instanceof cc.LabelBMFont?a.getFntFile():""},getBackgroundSpriteForState:function(a){var b=this._backgroundSpriteDispatchTable;return b[a]?b[a]:b[cc.CONTROL_STATE_NORMAL]},setBackgroundSpriteForState:function(a,b){var c=
this._backgroundSpriteDispatchTable;if(c[b]){var d=c[b];d&&this.removeChild(d,!0)}c[b]=a;a.setVisible(!1);a.setAnchorPoint(.5,.5);this.addChild(a);c=this._preferredSize;0===c.width&&0===c.height||a.setPreferredSize(c);this._state===b&&this.needsLayout()},setBackgroundSpriteFrameForState:function(a,b){var c=cc.Scale9Sprite.createWithSpriteFrame(a);this.setBackgroundSpriteForState(c,b)}});_p=cc.ControlButton.prototype;_p.adjustBackground;
cc.defineGetterSetter(_p,"adjustBackground",_p.getAdjustBackgroundImage,_p.setAdjustBackgroundImage);_p.preferredSize;cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize);_p.labelAnchor;cc.defineGetterSetter(_p,"labelAnchor",_p.getLabelAnchorPoint,_p.setLabelAnchorPoint);_p=null;cc.ControlButton.create=function(a,b,c){return new cc.ControlButton(a,b,c)};cc.RGBA=function(a,b,c,d){this.r=a;this.g=b;this.b=c;this.a=d};cc.HSV=function(a,b,c){this.h=a;this.s=b;this.v=c};
cc.ControlUtils={};cc.ControlUtils.addSpriteToTargetWithPosAndAnchor=function(a,b,c,d){return(a=cc.Sprite.create("#"+a))?(a.setPosition(c),a.setAnchorPoint(d),b.addChild(a),a):null};cc.ControlUtils.HSVfromRGB=function(a){var b,c,d,e=new cc.HSV;return b=a.r<a.g?a.r:a.g,b=b<a.b?b:a.b,c=a.r>a.g?a.r:a.g,c=c>a.b?c:a.b,e.v=c,d=c-b,0<c?(e.s=d/c,e.h=a.r>=c?(a.g-a.b)/d:a.g>=c?2+(a.b-a.r)/d:4+(a.r-a.g)/d,e.h*=60,0>e.h&&(e.h+=360),e):(e.s=0,e.h=-1,e)};
cc.ControlUtils.RGBfromHSV=function(a){var b,c,d,e,f,g,h=new cc.RGBA;if(h.a=1,0>=a.s)return a.h?(h.r=0,h.g=0,h.b=0,h):(h.r=a.v,h.g=a.v,h.b=a.v,h);switch(b=a.h,360<=b&&(b=0),b/=60,g=0|b,f=b-g,c=a.v*(1-a.s),d=a.v*(1-a.s*f),e=a.v*(1-a.s*(1-f)),g){case 0:h.r=a.v;h.g=e;h.b=c;break;case 1:h.r=d;h.g=a.v;h.b=c;break;case 2:h.r=c;h.g=a.v;h.b=e;break;case 3:h.r=c;h.g=d;h.b=a.v;break;case 4:h.r=e;h.g=c;h.b=a.v;break;default:h.r=a.v,h.g=c,h.b=d}return h};
cc.ControlUtils.CCRectUnion=function(a,b){return cc.rectUnion(a,b)};
cc.Invocation=cc.Class.extend({_action:null,_target:null,_controlEvent:null,ctor:function(a,b,c){this._target=a;this._action=b;this._controlEvent=c},getAction:function(){return this._action},getTarget:function(){return this._target},getControlEvent:function(){return this._controlEvent},invoke:function(a){this._target&&this._action&&("string"==typeof this._action?this._target[this._action](a,this._controlEvent):this._action.call(this._target,a,this._controlEvent))}});
cc.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_cacheSprite:null,_cacheCanvas:null,_cacheContext:null,_cacheTexture:null,_scale9Dirty:!0,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,_spriteFrameRotated:!1,
_textureLoaded:!1,_loadedEventListeners:null,_className:"Scale9Sprite",textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){this._textureLoaded=!0;for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0},_updateCapInset:function(){var a;a=this._insetLeft;var b=this._insetTop,c=this._insetRight,
d=this._spriteRect,e=this._insetBottom;a=0===a&&0===b&&0===c&&0===e?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(e,a,d.width-c-a,d.height-b-e):cc.rect(a,b,d.width-a-c,d.height-b-e);this.setCapInsets(a)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var a=this._contentSize,b=this._topLeft,c=this._topRight,d=this._bottomRight,e=this._bottomLeft,f=this._centre,g=this._centre.getContentSize(),h=b.getContentSize(),k=e.getContentSize(),
m=a.width-h.width-c.getContentSize().width,a=a.height-h.height-d.getContentSize().height,m=m/g.width,a=a/g.height,h=g.width*m,n=g.height*a,q=k.width,k=k.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){var r=Math.round(h);h!=r&&(h=r,m=h/g.width);r=Math.round(n);n!=r&&(n=r,a=n/g.height)}f.setScaleX(m);f.setScaleY(a);var g=this._left,r=this._right,s=this._top,u=this._bottom,t=cc.p(0,0);e.setAnchorPoint(t);d.setAnchorPoint(t);b.setAnchorPoint(t);c.setAnchorPoint(t);g.setAnchorPoint(t);r.setAnchorPoint(t);
s.setAnchorPoint(t);u.setAnchorPoint(t);f.setAnchorPoint(t);e.setPosition(0,0);d.setPosition(q+h,0);b.setPosition(0,k+n);c.setPosition(q+h,k+n);g.setPosition(0,k);g.setScaleY(a);r.setPosition(q+h,k);r.setScaleY(a);u.setPosition(q,0);u.setScaleX(m);s.setPosition(q,k+n);s.setScaleX(m);f.setPosition(q,k)}},_cacheScale9Sprite:function(){if(this._scale9Image){var a=this._contentSize,b=this._cacheCanvas,c=!1;(b.width!=a.width||b.height!=a.height)&&(b.width=a.width,b.height=a.height,this._cacheContext.translate(0,
a.height),c=!0);cc.view._setScaleXYForRenderTexture();this._scale9Image.visit(this._cacheContext);cc.view._resetScale();c&&this._cacheSprite.setTextureRect(cc.rect(0,0,a.width,a.height));this._cacheSprite.getParent()||this.addChild(this._cacheSprite)}},ctor:function(a,b,c){if(cc.Node.prototype.ctor.call(this),this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,0,0,0),this._loadedEventListeners=
[],cc._renderType===cc._RENDER_TYPE_CANVAS){var d=this._cacheCanvas=cc.newElement("canvas");d.width=1;d.height=1;this._cacheContext=d.getContext("2d");var e=this._cacheTexture=new cc.Texture2D;e.initWithElement(d);e.handleLoadedTexture();this._cacheSprite=new cc.Sprite(e);this._cacheSprite.setAnchorPoint(0,0);this.addChild(this._cacheSprite)}void 0!=a?a instanceof cc.SpriteFrame?this.initWithSpriteFrame(a,b):(d=cc.spriteFrameCache.getSpriteFrame(a),null!=d?this.initWithSpriteFrame(d,b):this.initWithFile(a,
b,c)):this.init()},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},setPreferredSize:function(a){this.setContentSize(a);this._preferredSize=a},_setPreferredWidth:function(a){this._setWidth(a);this._preferredSize.width=a},_setPreferredHeight:function(a){this._setHeight(a);this._preferredSize.height=
a},setOpacity:function(a){if(this._scale9Image){cc.Node.prototype.setOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setOpacity(a)}this._scale9Dirty=!0}},updateDisplayedOpacity:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.updateDisplayedOpacity(a)}this._scale9Dirty=!0}},setColor:function(a){if(this._scale9Image){cc.Node.prototype.setColor.call(this,
a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setColor(a)}this._scale9Dirty=!0}},updateDisplayedColor:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedColor.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&(cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Node.prototype.updateDisplayedColor.call(d,a),(255!==a.r||255!==a.g||255!==a.b)&&(d._changeTextureColor(),d._setNodeDirtyForCache())):d.updateDisplayedColor(a))}this._scale9Dirty=
!0}},getCapInsets:function(){return cc.rect(this._capInsets)},setCapInsets:function(a){if(this._scale9Image){var b=this._contentSize,c=b.width,b=b.height;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,a);this.setContentSize(c,b)}},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(a){this._insetLeft=a;this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(a){this._insetTop=a;this._updateCapInset()},getInsetRight:function(){return this._insetRight},
setInsetRight:function(a){this._insetRight=a;this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(a){this._insetBottom=a;this._updateCapInset()},setContentSize:function(a,b){cc.Node.prototype.setContentSize.call(this,a,b);this._positionsAreDirty=!0},_setWidth:function(a){cc.Node.prototype._setWidth.call(this,a);this._positionsAreDirty=!0},_setHeight:function(a){cc.Node.prototype._setHeight.call(this,a);this._positionsAreDirty=!0},visit:function(a){this._positionsAreDirty&&
(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0);this._scale9Dirty&&cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._scale9Dirty=!1,this._cacheScale9Sprite());cc.Node.prototype.visit.call(this,a)},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(a,b,c,d){return void 0===d&&(d=c,c=!1),a&&this.updateWithBatchNode(a,b,c,d),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,
.5),this._positionsAreDirty=!0,!0},initWithFile:function(a,b,c){if(a instanceof cc.Rect?(a=b,c=a,b=cc.rect(0,0,0,0)):(b=b||cc.rect(0,0,0,0),c=c||cc.rect(0,0,0,0)),!a)throw"cc.Scale9Sprite.initWithFile(): file should be non-null";var d=cc.textureCache.getTextureForKey(a);d||(d=cc.textureCache.addImage(a));var e=d.isLoaded();return this._textureLoaded=e,e||d.addLoadedEventListener(function(a){var b=this._preferredSize,b=cc.size(b.width,b.height);a=a.getContentSize();this.updateWithBatchNode(this._scale9Image,
cc.rect(0,0,a.width,a.height),!1,this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this),this.initWithBatchNode(cc.SpriteBatchNode.create(a,9),b,!1,c)},initWithSpriteFrame:function(a,b){if(!a||!a.getTexture())throw"cc.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null";b=b||cc.rect(0,0,0,0);var c=a.textureLoaded();(this._textureLoaded=c)||a.addLoadedEventListener(function(a){var b=this._preferredSize,
b=cc.size(b.width,b.height);this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this);c=cc.SpriteBatchNode.create(a.getTexture(),9);return this.initWithBatchNode(c,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),b)},initWithSpriteFrameName:function(a,b){if(!a)throw"cc.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null";
b=b||cc.rect(0,0,0,0);var c=cc.spriteFrameCache.getSpriteFrame(a);return null==c?(cc.log("cc.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(c,b)},resizableSpriteWithCapInsets:function(a){var b=new cc.Scale9Sprite;return b&&b.initWithBatchNode(this._scale9Image,this._spriteRect,!1,a)?b:null},setOpacityModifyRGB:function(a){if(this._scale9Image){this._opacityModifyRGB=a;var b=this._scale9Image.getChildren();if(b)for(var c=0,d=b.length;d>
c;c++)b[c].setOpacityModifyRGB(a)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(a,b,c,d){var e=this.getOpacity(),f=this.getColor();b=cc.rect(b.x,b.y,b.width,b.height);if(this.removeAllChildren(!0),this._scale9Image!=a&&(this._scale9Image=a),!this._scale9Image)return!1;a=a.getTexture();var g=a.isLoaded();if(this._textureLoaded=g,!g)return a.addLoadedEventListener(function(){this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this),!0;a=this._scale9Image;
a.removeAllChildren(!0);g=this._capInsets;g.x=d.x;g.y=d.y;g.width=d.width;g.height=d.height;this._spriteFrameRotated=c;g=a.getTexture();cc._rectEqualToZero(b)&&(b=g.getContentSize(),b=cc.rect(0,0,b.width,b.height));var h=this._spriteRect=b;h.x=b.x;h.y=b.y;h.width=b.width;h.height=b.height;this._originalSize.width=b.width;this._originalSize.height=b.height;h=this._preferredSize;0===h.width&&0===h.height&&(h.width=b.width,h.height=b.height);h=this._capInsetsInternal;d&&(h.x=d.x,h.y=d.y,h.width=d.width,
h.height=d.height);var k=b.width;d=b.height;cc._rectEqualToZero(h)&&(h.x=k/3,h.y=d/3,h.width=k/3,h.height=d/3);var m=h.x,n=h.width,q=k-(m+n),r=h.y,s=h.height,u=d-(r+s),t=0,v=0;d=cc.rect(t+.5|0,v+.5|0,m+.5|0,r+.5|0);var t=t+m,h=cc.rect(t+.5|0,v+.5|0,n+.5|0,r+.5|0),k=cc.rect(t+n+.5|0,v+.5|0,q+.5|0,r+.5|0),t=0,v=0+r,w=cc.rect(t+.5|0,v+.5|0,m+.5|0,s+.5|0),t=t+m,x=cc.rect(t+.5|0,v+.5|0,n+.5|0,s+.5|0),t=t+n,y=cc.rect(t+.5|0,v+.5|0,q+.5|0,s+.5|0),t=0,v=0+r+s,r=cc.rect(t+.5|0,v+.5|0,m+.5|0,u+.5|0),t=t+m,
m=cc.rect(t+.5|0,v+.5|0,n+.5|0,u+.5|0),t=t+n,n=cc.rect(t+.5|0,v+.5|0,q+.5|0,u+.5|0),q=cc.affineTransformMakeIdentity();if(c){c=x;var u=n,t=r,v=k,s=d,z=y,A=w,B=m,C=h,q=cc.affineTransformTranslate(q,b.height+b.x,b.y),q=cc.affineTransformRotate(q,1.57079633),x=cc.rectApplyAffineTransform(x,q),n=cc.rectApplyAffineTransform(n,q),r=cc.rectApplyAffineTransform(r,q),k=cc.rectApplyAffineTransform(k,q);d=cc.rectApplyAffineTransform(d,q);y=cc.rectApplyAffineTransform(y,q);w=cc.rectApplyAffineTransform(w,q);
m=cc.rectApplyAffineTransform(m,q);h=cc.rectApplyAffineTransform(h,q);c.x=x.x;c.y=x.y;u.x=n.x;u.y=n.y;t.x=r.x;t.y=r.y;v.x=k.x;v.y=k.y;s.x=d.x;s.y=d.y;z.x=y.x;z.y=y.y;A.x=w.x;A.y=w.y;B.x=m.x;B.y=m.y;C.x=h.x;C.y=h.y;this._centre=new cc.Sprite;this._centre.initWithTexture(g,c,!0);a.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE);this._top=new cc.Sprite;this._top.initWithTexture(g,C,!0);a.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP);this._bottom=new cc.Sprite;this._bottom.initWithTexture(g,
B,!0);a.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM);this._left=new cc.Sprite;this._left.initWithTexture(g,A,!0);a.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT);this._right=new cc.Sprite;this._right.initWithTexture(g,z,!0);a.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT);this._topLeft=new cc.Sprite;this._topLeft.initWithTexture(g,s,!0);a.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT);this._topRight=new cc.Sprite;this._topRight.initWithTexture(g,v,!0);a.addChild(this._topRight,
2,cc.Scale9Sprite.POSITIONS_TOPRIGHT);this._bottomLeft=new cc.Sprite;this._bottomLeft.initWithTexture(g,t,!0);a.addChild(this._bottomLeft,2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT);this._bottomRight=new cc.Sprite;this._bottomRight.initWithTexture(g,u,!0)}else q=cc.affineTransformTranslate(q,b.x,b.y),cc._rectApplyAffineTransformIn(x,q),cc._rectApplyAffineTransformIn(n,q),cc._rectApplyAffineTransformIn(r,q),cc._rectApplyAffineTransformIn(k,q),cc._rectApplyAffineTransformIn(d,q),cc._rectApplyAffineTransformIn(y,
q),cc._rectApplyAffineTransformIn(w,q),cc._rectApplyAffineTransformIn(m,q),cc._rectApplyAffineTransformIn(h,q),this._centre=new cc.Sprite,this._centre.initWithTexture(g,x),a.addChild(this._centre,0,cc.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(g,h),a.addChild(this._top,1,cc.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(g,m),a.addChild(this._bottom,1,cc.Scale9Sprite.POSITIONS_BOTTOM),this._left=new cc.Sprite,this._left.initWithTexture(g,
w),a.addChild(this._left,1,cc.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(g,y),a.addChild(this._right,1,cc.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(g,d),a.addChild(this._topLeft,2,cc.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(g,k),a.addChild(this._topRight,2,cc.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=new cc.Sprite,this._bottomLeft.initWithTexture(g,r),a.addChild(this._bottomLeft,
2,cc.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(g,n);a.addChild(this._bottomRight,2,cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT);return this.setContentSize(b.width,b.height),cc._renderType===cc._RENDER_TYPE_WEBGL&&this.addChild(a),this._spritesGenerated&&(this.setOpacity(e),this.setColor(f)),this._spritesGenerated=!0,!0},setSpriteFrame:function(a){var b=cc.SpriteBatchNode.create(a.getTexture(),9),c=a.textureLoaded();(this._textureLoaded=c)||a.addLoadedEventListener(function(a){var b=
this._preferredSize,b=cc.size(b.width,b.height);this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this);this.updateWithBatchNode(b,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),cc.rect(0,0,0,0));this._insetBottom=this._insetRight=this._insetTop=this._insetLeft=0}});_p=cc.Scale9Sprite.prototype;_p.preferredSize;
cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize);_p.capInsets;cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets);_p.insetLeft;cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft);_p.insetTop;cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop);_p.insetRight;cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight);_p.insetBottom;cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom);
_p=null;cc.Scale9Sprite.create=function(a,b,c){return new cc.Scale9Sprite(a,b,c)};cc.Scale9Sprite.createWithSpriteFrame=function(a,b){return new cc.Scale9Sprite(a,b)};cc.Scale9Sprite.createWithSpriteFrameName=function(a,b){return new cc.Scale9Sprite(a,b)};cc.Scale9Sprite.POSITIONS_CENTRE=0;cc.Scale9Sprite.POSITIONS_TOP=1;cc.Scale9Sprite.POSITIONS_LEFT=2;cc.Scale9Sprite.POSITIONS_RIGHT=3;cc.Scale9Sprite.POSITIONS_BOTTOM=4;cc.Scale9Sprite.POSITIONS_TOPRIGHT=5;cc.Scale9Sprite.POSITIONS_TOPLEFT=6;
cc.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7;cc.Spacer=cc.Layer.extend({});cc.Spacer.verticalSpacer=function(a){var b=new cc.Spacer;return b.init(),b.setContentSize(0,a),b};cc.Spacer.horizontalSpacer=function(a){var b=new cc.Spacer;return b.init(),b.setContentSize(a,0),b};
cc.MenuPassive=cc.Layer.extend({_color:null,_opacity:0,_className:"MenuPassive",ctor:function(){},getColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},setColor:function(a){var b=this._color;if(b.r=a.r,b.g=a.g,b.b=a.b,this._children&&0<this._children.length)for(b=0;b<this._children.length;b++)this._children[b]&&this._children[b].setColor(a);void 0===a.a||a.a_undefined||this.setOpacity(a.a)},getOpacity:function(){return this._opacity},setOpacity:function(a){if(this._opacity=a,this._children&&
0<this._children.length)for(var b=0;b<this._children.length;b++)this._children[b]&&this._children[b].setOpacity(a);this._color.a=a},initWithItems:function(a,b){if(this.init()){var c=cc.director.getWinSize();this.ignoreAnchorPointForPosition(!0);this.setAnchorPoint(.5,.5);this.setContentSize(c);this.setPosition(c.width/2,c.height/2);c=0;if(a){this.addChild(a,c);for(var d=0;d<b.length;d++)b[d]&&(c++,this.addChild(b[d],c))}return!0}return!1},alignItemsVertically:function(){this.alignItemsVerticallyWithPadding(cc.DEFAULT_PADDING)},
alignItemsVerticallyWithPadding:function(a){var b,c=-a;if(this._children&&0<this._children.length)for(b=0;b<this._children.length;b++)this._children[b]&&(c+=this._children[b].getContentSize().height*this._children[b].getScaleY()+a);var d=0,e=c/2;if(this._children&&0<this._children.length)for(b=0;b<this._children.length;b++)this._children[b]&&(d=Math.max(d,this._children[b].getContentSize().width),this._children[b].setPosition(0,e-this._children[b].getContentSize().height*this._children[b].getScaleY()/
2),e-=this._children[b].getContentSize().height*this._children[b].getScaleY()+a);this.setContentSize(d,c)},alignItemsHorizontally:function(){this.alignItemsHorizontallyWithPadding(cc.DEFAULT_PADDING)},alignItemsHorizontallyWithPadding:function(a){var b,c=-a;if(this._children&&0<this._children.length)for(b=0;b<this._children.length;b++)this._children[b]&&(c+=this._children[b].getContentSize().width*this._children[b].getScaleX()+a);var d=0,e=-c/2;if(this._children&&0<this._children.length)for(b=0;b<
this._children.length;b++)this._children[b]&&(d=Math.max(d,this._children[b].getContentSize().height),this._children[b].setPosition(e+this._children[b].getContentSize().width*this._children[b].getScaleX()/2,0),e+=this._children[b].getContentSize().width*this._children[b].getScaleX()+a);this.setContentSize(c,d)},alignItemsInColumns:function(){var a,b=[];for(a=1;a<arguments.length;a++)b.push(arguments[a]);var c,d,e=-5,f=0,g=0,h=0;if(this._children&&0<this._children.length)for(a=0;a<this._children.length;a++)this._children[a]&&
(f>=b.length?cc.log("cc.MenuPassive.alignItemsInColumns(): invalid row index"):(c=b[f],c)?(d=this._children[a].getContentSize().height,g=0|(g>=d||null==d?g:d),++h,h>=c&&(e+=g+5,h=0,g=0,++f)):cc.log("cc.MenuPassive.alignItemsInColumns(): can not have zero columns on a row"));var k=cc.director.getWinSize(),m=c=g=f=0,n=0,e=e/2;if(this._children&&0<this._children.length)for(a=0;a<this._children.length;a++)this._children[a]&&(0==c&&(c=b[f],m=k.width/(1+c),n=m),d=this._children[a].getContentSize().height,
g=0|(g>=d||null==d?g:d),this._children[a].setPosition(n-k.width/2,e-this._children[a].getContentSize().height/2),n+=m,++h,h>=c&&(e-=g+5,h=0,c=0,g=0,++f))},alignItemsInRows:function(){var a,b=[];for(a=1;a<arguments.length;a++)b.push(arguments[a]);var c,d,e=[],f=[],g=-10,h=-5,k=0,m=0,n=0;if(this._children&&0<this._children.length)for(a=0;a<this._children.length;a++)this._children[a]&&(k>=b.length?cc.log("cc.MenuPassive.alignItemsInRows(): invalid row index"):(c=b[k],c)?(d=this._children[a].getContentSize().width,
m=0|(m>=d||null==d?m:d),h+=0|this._children[a].getContentSize().height+5,++n,n>=c&&(e.push(m),f.push(h),g+=m+10,n=0,m=0,h=-5,++k)):cc.log("cc.MenuPassive.alignItemsInColumns(): can't have zero rows on a column"));h=cc.director.getWinSize();m=k=0;c=null;var g=-g/2,q=0;if(this._children&&0<this._children.length)for(a=0;a<this._children.length;a++)this._children[a]&&(null==c&&(c=b[k],q=f[k]),d=this._children[a].getContentSize().width,m=0|(m>=d||null==d?m:d),this._children[a].setPosition(g+e[k]/2,q-h.height/
2),q-=this._children[a].getContentSize().height+10,++n,n>=c&&(g+=m+5,n=0,c=0,m=0,++k))},setOpacityModifyRGB:function(){},isOpacityModifyRGB:function(){return!1}});cc.MenuPassive.create=function(a){a||(a=null);for(var b=[],c=1;c<arguments.length;c++)b.push(arguments[c]);return(c=new cc.MenuPassive)&&c.initWithItems(a,b)?c:null};cc.MenuPassive.createWithItem=function(a){return cc.MenuPassive.create(a,null)};
cc.ControlSaturationBrightnessPicker=cc.Control.extend({_saturation:0,_brightness:0,_background:null,_overlay:null,_shadow:null,_slider:null,_startPos:null,_boxPos:0,_boxSize:0,_className:"ControlSaturationBrightnessPicker",ctor:function(a,b){cc.Control.prototype.ctor.call(this);b&&this.initWithTargetAndPos(a,b)},getSaturation:function(){return this._saturation},getBrightness:function(){return this._brightness},getBackground:function(){return this._background},getOverlay:function(){return this._brightness},
getShadow:function(){return this._shadow},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(a,b){return cc.Control.prototype.init.call(this)?(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerBackground.png",a,b,cc.p(0,0)),this._overlay=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerOverlay.png",a,b,cc.p(0,0)),this._shadow=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPickerShadow.png",
a,b,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",a,b,cc.p(.5,.5)),this._startPos=b,this._boxPos=35,this._boxSize=this._background.getContentSize().width/2,!0):!1},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a);this._slider&&this._slider.setOpacity(a?255:128)},updateWithHSV:function(a){var b=new cc.HSV;b.s=1;b.h=a.h;b.v=1;a=cc.ControlUtils.RGBfromHSV(b);this._background.setColor(cc.color(0|255*a.r,0|255*a.g,0|255*a.b))},updateDraggerWithHSV:function(a){a=
cc.p(this._startPos.x+this._boxPos+this._boxSize*(1-a.s),this._startPos.y+this._boxPos+this._boxSize*a.v);this._updateSliderPosition(a)},_updateSliderPosition:function(a){var b=this._startPos.x+.5*this._background.getBoundingBox().width,c=this._startPos.y+.5*this._background.getBoundingBox().height,d=a.x-b,e=a.y-c,f=Math.sqrt(d*d+e*e),d=Math.atan2(e,d),e=.5*this._background.getBoundingBox().width;f>e&&(a.x=b+e*Math.cos(d),a.y=c+e*Math.sin(d));this._slider.setPosition(a);a.x<this._startPos.x+this._boxPos?
a.x=this._startPos.x+this._boxPos:a.x>this._startPos.x+this._boxPos+this._boxSize-1&&(a.x=this._startPos.x+this._boxPos+this._boxSize-1);a.y<this._startPos.y+this._boxPos?a.y=this._startPos.y+this._boxPos:a.y>this._startPos.y+this._boxPos+this._boxSize&&(a.y=this._startPos.y+this._boxPos+this._boxSize);this._saturation=1-Math.abs((this._startPos.x+this._boxPos-a.x)/this._boxSize);this._brightness=Math.abs((this._startPos.y+this._boxPos-a.y)/this._boxSize)},_checkSliderPosition:function(a){var b=this._startPos.x+
.5*this._background.getBoundingBox().width,c=this._startPos.y+.5*this._background.getBoundingBox().height,b=a.x-b,c=a.y-c;return Math.sqrt(b*b+c*c)<=.5*this._background.getBoundingBox().width?(this._updateSliderPosition(a),this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED),!0):!1},onTouchBegan:function(a){if(!this.isEnabled()||!this.isVisible())return!1;a=this.getTouchLocation(a);return this._checkSliderPosition(a)},onTouchMoved:function(a){a=this.getTouchLocation(a);this._checkSliderPosition(a)}});
_p=cc.ControlSaturationBrightnessPicker.prototype;_p.saturation;cc.defineGetterSetter(_p,"saturation",_p.getSaturation);_p.brightness;cc.defineGetterSetter(_p,"brightness",_p.getBrightness);_p.background;cc.defineGetterSetter(_p,"background",_p.getBackground);_p.overlay;cc.defineGetterSetter(_p,"overlay",_p.getOverlay);_p.shadow;cc.defineGetterSetter(_p,"shadow",_p.getShadow);_p.slider;cc.defineGetterSetter(_p,"slider",_p.getSlider);_p.startPos;cc.defineGetterSetter(_p,"startPos",_p.getStartPos);
_p=null;cc.ControlSaturationBrightnessPicker.create=function(a,b){return new cc.ControlSaturationBrightnessPicker(a,b)};
cc.ControlHuePicker=cc.Control.extend({_hue:0,_huePercentage:0,_background:null,_slider:null,_startPos:null,_className:"ControlHuePicker",ctor:function(a,b){cc.Control.prototype.ctor.call(this);b&&this.initWithTargetAndPos(a,b)},getHue:function(){return this._hue},setHue:function(a){this._hue=a;this.setHuePercentage(this._hue/360)},getHuePercentage:function(){return this._huePercentage},setHuePercentage:function(a){this._huePercentage=a;this._hue=360*this._huePercentage;var b=this._background.getBoundingBox(),
c=this._startPos.x+.5*b.width;a=this._startPos.y+.5*b.height;var b=.5*b.width-15,d=cc.degreesToRadians(360*this._huePercentage-180),c=c+b*Math.cos(d);a+=b*Math.sin(d);this._slider.setPosition(c,a)},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a);this._slider&&this._slider.setOpacity(a?255:128)},getBackground:function(){return this._background},getSlider:function(){return this._slider},getStartPos:function(){return this._startPos},initWithTargetAndPos:function(a,b){return cc.Control.prototype.init.call(this)?
(this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("huePickerBackground.png",a,b,cc.p(0,0)),this._slider=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("colourPicker.png",a,b,cc.p(.5,.5)),this._slider.setPosition(b.x,b.y+.5*this._background.getBoundingBox().height),this._startPos=b,this._hue=0,this._huePercentage=0,!0):!1},_updateSliderPosition:function(a){var b=this._background.getBoundingBox();a=Math.atan2(a.y-(this._startPos.y+.5*b.height),a.x-(this._startPos.x+.5*b.width));
a=cc.radiansToDegrees(a)+180;this.setHue(a);this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},_checkSliderPosition:function(a){var b=Math.sqrt(Math.pow(a.x+10,2)+Math.pow(a.y,2));return 80>b&&59<b?(this._updateSliderPosition(a),!0):!1},onTouchBegan:function(a){if(!this.isEnabled()||!this.isVisible())return!1;a=this.getTouchLocation(a);return this._checkSliderPosition(a)},onTouchMoved:function(a){a=this.getTouchLocation(a);this._checkSliderPosition(a)}});_p=cc.ControlHuePicker.prototype;
_p.hue;cc.defineGetterSetter(_p,"hue",_p.getHue,_p.setHue);_p.huePercent;cc.defineGetterSetter(_p,"huePercent",_p.getHuePercentage,_p.setHuePercentage);_p.background;cc.defineGetterSetter(_p,"background",_p.getBackground);_p.slider;cc.defineGetterSetter(_p,"slider",_p.getSlider);_p.startPos;cc.defineGetterSetter(_p,"startPos",_p.getStartPos);_p=null;cc.ControlHuePicker.create=function(a,b){return new cc.ControlHuePicker(a,b)};
cc.ControlColourPicker=cc.Control.extend({_hsv:null,_colourPicker:null,_huePicker:null,_background:null,_className:"ControlColourPicker",ctor:function(){cc.Control.prototype.ctor.call(this);this.init()},hueSliderValueChanged:function(a){this._hsv.h=a.getHue();a=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*a.r,0|255*a.g,0|255*a.b));this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED);this._updateControlPicker()},colourSliderValueChanged:function(a){this._hsv.s=
a.getSaturation();this._hsv.v=a.getBrightness();a=cc.ControlUtils.RGBfromHSV(this._hsv);cc.Control.prototype.setColor.call(this,cc.color(0|255*a.r,0|255*a.g,0|255*a.b));this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},setColor:function(a){cc.Control.prototype.setColor.call(this,a);var b=new cc.RGBA;b.r=a.r/255;b.g=a.g/255;b.b=a.b/255;b.a=1;this._hsv=cc.ControlUtils.HSVfromRGB(b);this._updateHueAndControlPicker()},getBackground:function(){return this._background},init:function(){if(cc.Control.prototype.init.call(this)){cc.spriteFrameCache.addSpriteFrames(res.CCControlColourPickerSpriteSheet_plist);
var a=cc.SpriteBatchNode.create(res.CCControlColourPickerSpriteSheet_png);this.addChild(a);this._hsv=new cc.HSV(0,0,0);this._background=cc.ControlUtils.addSpriteToTargetWithPosAndAnchor("menuColourPanelBackground.png",a,cc.p(0,0),cc.p(.5,.5));var b=cc.pSub(this._background.getPosition(),cc.p(this._background.getContentSize().width/2,this._background.getContentSize().height/2));return this._huePicker=cc.ControlHuePicker.create(a,cc.p(b.x+8,b.y+8)),this._colourPicker=cc.ControlSaturationBrightnessPicker.create(a,
cc.p(b.x+28,b.y+28)),this._huePicker.addTargetWithActionForControlEvents(this,this.hueSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._colourPicker.addTargetWithActionForControlEvents(this,this.colourSliderValueChanged,cc.CONTROL_EVENT_VALUECHANGED),this._updateHueAndControlPicker(),this.addChild(this._huePicker),this.addChild(this._colourPicker),this.setContentSize(this._background.getContentSize()),!0}return!1},_updateControlPicker:function(){this._huePicker.setHue(this._hsv.h);this._colourPicker.updateWithHSV(this._hsv)},
_updateHueAndControlPicker:function(){this._huePicker.setHue(this._hsv.h);this._colourPicker.updateWithHSV(this._hsv);this._colourPicker.updateDraggerWithHSV(this._hsv)},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a);null!=this._huePicker&&this._huePicker.setEnabled(a);this._colourPicker&&this._colourPicker.setEnabled(a)},onTouchBegan:function(){return!1}});_p=cc.ControlColourPicker.prototype;_p.background;cc.defineGetterSetter(_p,"background",_p.getBackground);_p=null;
cc.ControlColourPicker.create=function(){return new cc.ControlColourPicker};var res=res||{};res.CCControlColourPickerSpriteSheet_plist=res.CCControlColourPickerSpriteSheet_plist||"res/extensions/CCControlColourPickerSpriteSheet.plist";res.CCControlColourPickerSpriteSheet_png=res.CCControlColourPickerSpriteSheet_png||"res/extensions/CCControlColourPickerSpriteSheet.png";cc.SLIDER_MARGIN_H=24;cc.SLIDER_MARGIN_V=8;
cc.ControlSlider=cc.Control.extend({_value:0,_minimumValue:0,_maximumValue:0,_minimumAllowedValue:0,_maximumAllowedValue:0,_thumbSprite:null,_progressSprite:null,_backgroundSprite:null,_className:"ControlSlider",ctor:function(a,b,c){cc.Control.prototype.ctor.call(this);void 0!=c&&(bgSprite=cc.Sprite.create(a),progressSprite=cc.Sprite.create(b),thumbSprite=cc.Sprite.create(c),this.initWithSprites(bgSprite,progressSprite,thumbSprite))},getValue:function(){return this._value},setValue:function(a){a=
Math.max(a,this._minimumValue);this._value=a=Math.min(a,this._maximumValue);this.needsLayout();this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getMinimumValue:function(){return this._minimumValue},setMinimumValue:function(a){this._minimumAllowedValue=this._minimumValue=a;this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1);this.setValue(this._value)},getMaximumValue:function(){return this._maximumValue},setMaximumValue:function(a){this._maximumAllowedValue=
this._maximumValue=a;this._maximumValue<=this._minimumValue&&(this._minimumValue=this._maximumValue-1);this.setValue(this._value)},isTouchInside:function(a){a=a.getLocation();a=this.getParent().convertToNodeSpace(a);var b=this.getBoundingBox();return b.width+=this._thumbSprite.getContentSize().width,b.x-=this._thumbSprite.getContentSize().width/2,cc.rectContainsPoint(b,a)},locationFromTouch:function(a){a=a.getLocation();return a=this.convertToNodeSpace(a),0>a.x?a.x=0:a.x>this._backgroundSprite.getContentSize().width&&
(a.x=this._backgroundSprite.getContentSize().width),a},getMinimumAllowedValue:function(){return this._minimumAllowedValue},setMinimumAllowedValue:function(a){this._minimumAllowedValue=a},getMaximumAllowedValue:function(){return this._maximumAllowedValue},setMaximumAllowedValue:function(a){this._maximumAllowedValue=a},getThumbSprite:function(){return this._thumbSprite},getProgressSprite:function(){return this._progressSprite},getBackgroundSprite:function(){return this._backgroundSprite},initWithSprites:function(a,
b,c){return cc.Control.prototype.init.call(this)?(this.ignoreAnchorPointForPosition(!1),this._backgroundSprite=a,this._progressSprite=b,this._thumbSprite=c,a=cc.ControlUtils.CCRectUnion(a.getBoundingBox(),c.getBoundingBox()),this.setContentSize(a.width,a.height),this._backgroundSprite.setAnchorPoint(.5,.5),this._backgroundSprite.setPosition(a.width/2,a.height/2),this.addChild(this._backgroundSprite),this._progressSprite.setAnchorPoint(0,.5),this._progressSprite.setPosition(0,a.height/2),this.addChild(this._progressSprite),
this._thumbSprite.setPosition(0,a.height/2),this.addChild(this._thumbSprite),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0):!1},setEnabled:function(a){cc.Control.prototype.setEnabled.call(this,a);this._thumbSprite&&this._thumbSprite.setOpacity(a?255:128)},sliderBegan:function(a){this.setSelected(!0);this.getThumbSprite().setColor(cc.color.GRAY);this.setValue(this.valueForLocation(a))},sliderMoved:function(a){this.setValue(this.valueForLocation(a))},sliderEnded:function(){this.isSelected()&&
this.setValue(this.valueForLocation(this._thumbSprite.getPosition()));this._thumbSprite.setColor(cc.color.WHITE);this.setSelected(!1)},getTouchLocationInControl:function(a){a=a.getLocation();return a=this.convertToNodeSpace(a),0>a.x?a.x=0:a.x>this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H&&(a.x=this._backgroundSprite.getContentSize().width+cc.SLIDER_MARGIN_H),a},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;a=this.locationFromTouch(a);
return this.sliderBegan(a),!0},onTouchMoved:function(a){a=this.locationFromTouch(a);this.sliderMoved(a)},onTouchEnded:function(){this.sliderEnded(cc.p(0,0))},needsLayout:function(){this._thumbSprite.setPositionX((this._value-this._minimumValue)/(this._maximumValue-this._minimumValue)*this._backgroundSprite.getContentSize().width);var a=this._progressSprite.getTextureRect(),a=cc.rect(a.x,a.y,this._thumbSprite.getPositionX(),a.height);this._progressSprite.setTextureRect(a,this._progressSprite.isTextureRectRotated())},
valueForLocation:function(a){a=a.x/this._backgroundSprite.getContentSize().width;return Math.max(Math.min(this._minimumValue+a*(this._maximumValue-this._minimumValue),this._maximumAllowedValue),this._minimumAllowedValue)}});_p=cc.ControlSlider.prototype;_p.value;cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue);_p.minValue;cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue);_p.maxValue;cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue);_p.minAllowedValue;
cc.defineGetterSetter(_p,"minAllowedValue",_p.getMinimumAllowedValue,_p.setMinimumAllowedValue);_p.maxAllowedValue;cc.defineGetterSetter(_p,"maxAllowedValue",_p.getMaximumAllowedValue,_p.setMaximumAllowedValue);_p.thumbSprite;cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite);_p.progressSprite;cc.defineGetterSetter(_p,"progressSprite",_p.getProgressSprite);_p.backgroundSprite;cc.defineGetterSetter(_p,"backgroundSprite",_p.getBackgroundSprite);_p=null;
cc.ControlSlider.create=function(a,b,c){return new cc.ControlSlider(a,b,c)};
cc.ControlSwitch=cc.Control.extend({_switchSprite:null,_initialTouchXPosition:0,_moved:!1,_on:!1,_className:"ControlSwitch",ctor:function(a,b,c,d,e,f){cc.Control.prototype.ctor.call(this);f&&this.initWithMaskSprite(a,b,c,d,e,f)},initWithMaskSprite:function(a,b,c,d,e,f){if(!a)throw"cc.ControlSwitch.initWithMaskSprite(): maskSprite should be non-null.";if(!b)throw"cc.ControlSwitch.initWithMaskSprite(): onSprite should be non-null.";if(!c)throw"cc.ControlSwitch.initWithMaskSprite(): offSprite should be non-null.";
if(!d)throw"cc.ControlSwitch.initWithMaskSprite(): thumbSprite should be non-null.";return this.init()?(this._on=!0,this._switchSprite=new cc.ControlSwitchSprite,this._switchSprite.initWithMaskSprite(a,b,c,d,e,f),this._switchSprite.setPosition(this._switchSprite.getContentSize().width/2,this._switchSprite.getContentSize().height/2),this.addChild(this._switchSprite),this.ignoreAnchorPointForPosition(!1),this.setAnchorPoint(.5,.5),this.setContentSize(this._switchSprite.getContentSize()),!0):!1},setOn:function(a,
b){b=b||!1;var c=(this._on=a)?this._switchSprite.getOnPosition():this._switchSprite.getOffPosition();b?this._switchSprite.runAction(cc.ActionTween.create(.2,"sliderXPosition",this._switchSprite.getSliderXPosition(),c)):this._switchSprite.setSliderXPosition(c);this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},isOn:function(){return this._on},hasMoved:function(){return this._moved},setEnabled:function(a){this._enabled=a;this._switchSprite.setOpacity(a?255:128)},locationFromTouch:function(a){a=
a.getLocation();return this.convertToNodeSpace(a)},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;this._moved=!1;return this._initialTouchXPosition=this.locationFromTouch(a).x-this._switchSprite.getSliderXPosition(),this._switchSprite.getThumbSprite().setColor(cc.color.GRAY),this._switchSprite.needsLayout(),!0},onTouchMoved:function(a){a=this.locationFromTouch(a);a=cc.p(a.x-this._initialTouchXPosition,0);this._moved=!0;this._switchSprite.setSliderXPosition(a.x)},
onTouchEnded:function(a){a=this.locationFromTouch(a);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE);this.hasMoved()?this.setOn(!(a.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)},onTouchCancelled:function(a){a=this.locationFromTouch(a);this._switchSprite.getThumbSprite().setColor(cc.color.WHITE);this.hasMoved()?this.setOn(!(a.x<this._switchSprite.getContentSize().width/2),!0):this.setOn(!this._on,!0)}});
cc.ControlSwitch.create=function(a,b,c,d,e,f){return new cc.ControlSwitch(a,b,c,d,e,f)};
cc.ControlSwitchSprite=cc.Sprite.extend({_sliderXPosition:0,_onPosition:0,_offPosition:0,_textureLocation:0,_maskLocation:0,_maskSize:null,_onSprite:null,_offSprite:null,_thumbSprite:null,_onLabel:null,_offLabel:null,_clipper:null,_stencil:null,_backRT:null,ctor:function(){cc.Sprite.prototype.ctor.call(this);this._maskLocation=this._offPosition=this._onPosition=this._sliderXPosition=0;this._maskSize=cc.size(0,0);this._offLabel=this._onLabel=this._thumbSprite=this._offSprite=this._onSprite=null},initWithMaskSprite:function(a,
b,c,d,e,f){return cc.Sprite.prototype.initWithTexture.call(this,a.getTexture())?(this._onPosition=0,this._offPosition=-b.getContentSize().width+d.getContentSize().width/2,this._sliderXPosition=this._onPosition,this.setOnSprite(b),this.setOffSprite(c),this.setThumbSprite(d),this.setOnLabel(e),this.setOffLabel(f),this._stencil=a,a=this._maskSize=this._stencil.getContentSize(),this._stencil.setPosition(0,0),this._clipper=cc.ClippingNode.create(),this._clipper.setAnchorPoint(.5,.5),this._clipper.setPosition(a.width/
2,a.height/2),this._clipper.setStencil(this._stencil),this.addChild(this._clipper),this._clipper.addChild(b),this._clipper.addChild(c),this._clipper.addChild(e),this._clipper.addChild(f),this.addChild(this._thumbSprite),this.needsLayout(),!0):!1},needsLayout:function(){var a=this._maskSize;this._onSprite.setPosition(this._onSprite.getContentSize().width/2+this._sliderXPosition-a.width/2,this._onSprite.getContentSize().height/2-a.height/2);this._offSprite.setPosition(this._onSprite.getContentSize().width+
this._offSprite.getContentSize().width/2+this._sliderXPosition-a.width/2,this._offSprite.getContentSize().height/2-a.height/2);this._onLabel&&this._onLabel.setPosition(this._onSprite.getPositionX()-this._thumbSprite.getContentSize().width/6,this._onSprite.getContentSize().height/2-a.height/2);this._offLabel&&this._offLabel.setPosition(this._offSprite.getPositionX()+this._thumbSprite.getContentSize().width/6,this._offSprite.getContentSize().height/2-a.height/2);this._thumbSprite.setPosition(this._onSprite.getContentSize().width+
this._sliderXPosition,this._maskSize.height/2)},setSliderXPosition:function(a){a<=this._offPosition?a=this._offPosition:a>=this._onPosition&&(a=this._onPosition);this._sliderXPosition=a;this.needsLayout()},getSliderXPosition:function(){return this._sliderXPosition},_getOnSideWidth:function(){return this._onSprite.getContentSize().width},_getOffSideWidth:function(){return this._offSprite.getContentSize().height},updateTweenAction:function(a,b){cc.log("key = "+b+", value = "+a);this.setSliderXPosition(a)},
setOnPosition:function(a){this._onPosition=a},getOnPosition:function(){return this._onPosition},setOffPosition:function(a){this._offPosition=a},getOffPosition:function(){return this._offPosition},setMaskTexture:function(a){this._stencil.setTexture(a)},getMaskTexture:function(){return this._stencil.getTexture()},setTextureLocation:function(a){this._textureLocation=a},getTextureLocation:function(){return this._textureLocation},setMaskLocation:function(a){this._maskLocation=a},getMaskLocation:function(){return this._maskLocation},
setOnSprite:function(a){this._onSprite=a},getOnSprite:function(){return this._onSprite},setOffSprite:function(a){this._offSprite=a},getOffSprite:function(){return this._offSprite},setThumbSprite:function(a){this._thumbSprite=a},getThumbSprite:function(){return this._thumbSprite},setOnLabel:function(a){this._onLabel=a},getOnLabel:function(){return this._onLabel},setOffLabel:function(a){this._offLabel=a},getOffLabel:function(){return this._offLabel}});_p=cc.ControlSwitchSprite.prototype;_p.sliderX;
cc.defineGetterSetter(_p,"sliderX",_p.getSliderXPosition,_p.setSliderXPosition);_p.onPos;cc.defineGetterSetter(_p,"onPos",_p.getOnPosition,_p.setOnPosition);_p.offPos;cc.defineGetterSetter(_p,"offPos",_p.getOffPosition,_p.setOffPosition);_p.maskTexture;cc.defineGetterSetter(_p,"maskTexture",_p.getMaskTexture,_p.setMaskTexture);_p.maskPos;cc.defineGetterSetter(_p,"maskPos",_p.getMaskLocation,_p.setMaskLocation);_p.onSprite;cc.defineGetterSetter(_p,"onSprite",_p.getOnSprite,_p.setOnSprite);_p.offSprite;
cc.defineGetterSetter(_p,"offSprite",_p.getOffSprite,_p.setOffSprite);_p.thumbSprite;cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite);_p.onLabel;cc.defineGetterSetter(_p,"onLabel",_p.getOnLabel,_p.setOnLabel);_p.offLabel;cc.defineGetterSetter(_p,"offLabel",_p.getOffLabel,_p.setOffLabel);_p.onSideWidth;cc.defineGetterSetter(_p,"onSideWidth",_p._getOnSideWidth);_p.offSideWidth;cc.defineGetterSetter(_p,"offSideWidth",_p._getOffSideWidth);_p=null;
cc.CONTROL_STEPPER_PARTMINUS=0;cc.CONTROL_STEPPER_PARTPLUS=1;cc.CONTROL_STEPPER_PARTNONE=2;cc.CONTROL_STEPPER_LABELCOLOR_ENABLED=cc.color(55,55,55);cc.CONTROL_STEPPER_LABELCOLOR_DISABLED=cc.color(147,147,147);cc.CONTROL_STEPPER_LABELFONT="CourierNewPSMT";cc.AUTOREPEAT_DELTATIME=.15;cc.AUTOREPEAT_INCREASETIME_INCREMENT=12;
cc.ControlStepper=cc.Control.extend({_minusSprite:null,_plusSprite:null,_minusLabel:null,_plusLabel:null,_value:0,_continuous:!1,_autorepeat:!1,_wraps:!1,_minimumValue:0,_maximumValue:0,_stepValue:0,_touchInsideFlag:!1,_touchedPart:cc.CONTROL_STEPPER_PARTNONE,_autorepeatCount:0,_className:"ControlStepper",ctor:function(a,b){cc.Control.prototype.ctor.call(this);this._plusLabel=this._minusLabel=this._plusSprite=this._minusSprite=null;this._value=0;this._wraps=this._autorepeat=this._continuous=!1;this._stepValue=
this._maximumValue=this._minimumValue=0;this._touchInsideFlag=!1;this._touchedPart=cc.CONTROL_STEPPER_PARTNONE;this._autorepeatCount=0;b&&this.initWithMinusSpriteAndPlusSprite(a,b)},initWithMinusSpriteAndPlusSprite:function(a,b){if(!a)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Minus sprite should be non-null.";if(!b)throw"cc.ControlStepper.initWithMinusSpriteAndPlusSprite(): Plus sprite should be non-null.";if(this.init()){this._continuous=this._autorepeat=!0;this._minimumValue=0;
this._maximumValue=100;this._value=0;this._stepValue=1;this._wraps=!1;this.ignoreAnchorPointForPosition(!1);this.setMinusSprite(a);this._minusSprite.setPosition(a.getContentSize().width/2,a.getContentSize().height/2);this.addChild(this._minusSprite);this.setMinusLabel(cc.LabelTTF.create("-",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER));this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_DISABLED);this._minusLabel.setPosition(this._minusSprite.getContentSize().width/
2,this._minusSprite.getContentSize().height/2);this._minusSprite.addChild(this._minusLabel);this.setPlusSprite(b);this._plusSprite.setPosition(a.getContentSize().width+b.getContentSize().width/2,a.getContentSize().height/2);this.addChild(this._plusSprite);this.setPlusLabel(cc.LabelTTF.create("+",cc.CONTROL_STEPPER_LABELFONT,40,cc.size(40,40),cc.TEXT_ALIGNMENT_CENTER,cc.VERTICAL_TEXT_ALIGNMENT_CENTER));this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED);this._plusLabel.setPosition(this._plusSprite.getContentSize().width/
2,this._plusSprite.getContentSize().height/2);this._plusSprite.addChild(this._plusLabel);var c=cc.ControlUtils.CCRectUnion(this._minusSprite.getBoundingBox(),this._plusSprite.getBoundingBox());return this.setContentSize(this._minusSprite.getContentSize().width+this._plusSprite.getContentSize().height,c.height),!0}return!1},setWraps:function(a){(this._wraps=a)&&(this._minusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(cc.CONTROL_STEPPER_LABELCOLOR_ENABLED));this.setValue(this._value)},
getWraps:function(){return this._wraps},setMinimumValue:function(a){if(a>=this._maximumValue)throw"cc.ControlStepper.setMinimumValue(): minimumValue should be numerically less than maximumValue.";this._minimumValue=a;this.setValue(this._value)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(a){if(a<=this._minimumValue)throw"cc.ControlStepper.setMaximumValue(): maximumValue should be numerically less than maximumValue.";this._maximumValue=a;this.setValue(this._value)},
getMaximumValue:function(){return this._maximumValue},setValue:function(a){this.setValueWithSendingEvent(a,!0)},getValue:function(){return this._value},setStepValue:function(a){if(0>=a)throw"cc.ControlStepper.setMaximumValue(): stepValue should be numerically greater than 0.";this._stepValue=a},getStepValue:function(){return this._stepValue},isContinuous:function(){return this._continuous},setValueWithSendingEvent:function(a,b){a<this._minimumValue?a=this._wraps?this._maximumValue:this._minimumValue:
a>this._maximumValue&&(a=this._wraps?this._minimumValue:this._maximumValue);this._value=a;this._wraps||(this._minusLabel.setColor(a==this._minimumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED),this._plusLabel.setColor(a==this._maximumValue?cc.CONTROL_STEPPER_LABELCOLOR_DISABLED:cc.CONTROL_STEPPER_LABELCOLOR_ENABLED));b&&this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},startAutorepeat:function(){this._autorepeatCount=-1;this.schedule(this.update,
cc.AUTOREPEAT_DELTATIME,cc.REPEAT_FOREVER,3*cc.AUTOREPEAT_DELTATIME)},stopAutorepeat:function(){this.unschedule(this.update)},update:function(){this._autorepeatCount++;this._autorepeatCount<cc.AUTOREPEAT_INCREASETIME_INCREMENT&&0!=this._autorepeatCount%3||(this._touchedPart==cc.CONTROL_STEPPER_PARTMINUS?this.setValueWithSendingEvent(this._value-this._stepValue,this._continuous):this._touchedPart==cc.CONTROL_STEPPER_PARTPLUS&&this.setValueWithSendingEvent(this._value+this._stepValue,this._continuous))},
updateLayoutUsingTouchLocation:function(a){a.x<this._minusSprite.getContentSize().width&&this._value>this._minimumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTMINUS,this._minusSprite.setColor(cc.color.GRAY),this._plusSprite.setColor(cc.color.WHITE)):a.x>=this._minusSprite.getContentSize().width&&this._value<this._maximumValue?(this._touchedPart=cc.CONTROL_STEPPER_PARTPLUS,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.GRAY)):(this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,
this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE))},onTouchBegan:function(a){if(!this.isTouchInside(a)||!this.isEnabled()||!this.isVisible())return!1;a=this.getTouchLocation(a);return this.updateLayoutUsingTouchLocation(a),this._touchInsideFlag=!0,this._autorepeat&&this.startAutorepeat(),!0},onTouchMoved:function(a){this.isTouchInside(a)?(a=this.getTouchLocation(a),this.updateLayoutUsingTouchLocation(a),this._touchInsideFlag||(this._touchInsideFlag=!0,this._autorepeat&&
this.startAutorepeat())):(this._touchInsideFlag=!1,this._touchedPart=cc.CONTROL_STEPPER_PARTNONE,this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat())},onTouchEnded:function(a){if(this._minusSprite.setColor(cc.color.WHITE),this._plusSprite.setColor(cc.color.WHITE),this._autorepeat&&this.stopAutorepeat(),this.isTouchInside(a))a=this.getTouchLocation(a),this.setValue(this._value+(a.x<this._minusSprite.getContentSize().width?0-this._stepValue:
this._stepValue))},setMinusSprite:function(a){this._minusSprite=a},getMinusSprite:function(){return this._minusSprite},setPlusSprite:function(a){this._plusSprite=a},getPlusSprite:function(){return this._plusSprite},setMinusLabel:function(a){this._minusLabel=a},getMinusLabel:function(){return this._minusLabel},setPlusLabel:function(a){this._plusLabel=a},getPlusLabel:function(){return this._plusLabel}});_p=cc.ControlStepper.prototype;_p.wraps;cc.defineGetterSetter(_p,"wraps",_p.getWraps,_p.setWraps);
_p.value;cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue);_p.minValue;cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue);_p.maxValue;cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue);_p.stepValue;cc.defineGetterSetter(_p,"stepValue",_p.getStepValue,_p.setStepValue);_p.continuous;cc.defineGetterSetter(_p,"continuous",_p.isContinuous);_p.minusSprite;cc.defineGetterSetter(_p,"minusSprite",_p.getMinusSprite,_p.setMinusSprite);_p.plusSprite;
cc.defineGetterSetter(_p,"plusSprite",_p.getPlusSprite,_p.setPlusSprite);_p.minusLabel;cc.defineGetterSetter(_p,"minusLabel",_p.getMinusLabel,_p.setMinusLabel);_p.plusLabel;cc.defineGetterSetter(_p,"plusLabel",_p.getPlusLabel,_p.setPlusLabel);_p=null;cc.ControlStepper.create=function(a,b){return new cc.ControlStepper(a,b)};
cc.ControlPotentiometer=cc.Control.extend({_thumbSprite:null,_progressTimer:null,_previousLocation:null,_value:0,_minimumValue:0,_maximumValue:1,_className:"ControlPotentiometer",ctor:function(a,b,c){if(cc.Control.prototype.ctor.call(this),void 0!=c)a=cc.Sprite.create(a),c=cc.Sprite.create(c),b=cc.ProgressTimer.create(cc.Sprite.create(b)),this.initWithTrackSprite_ProgressTimer_ThumbSprite(a,b,c)},initWithTrackSprite_ProgressTimer_ThumbSprite:function(a,b,c){return this.init()?(this.setProgressTimer(b),
this.setThumbSprite(c),this._thumbSprite.setPosition(b.getPosition()),this.addChild(c,2),this.addChild(b,1),this.addChild(a),this.setContentSize(a.getContentSize()),this._minimumValue=0,this._maximumValue=1,this.setValue(this._minimumValue),!0):!1},setEnabled:function(a){this.setEnabled(a);this._thumbSprite!=NULL&&this._thumbSprite.setOpacity(a?255:128)},setValue:function(a){a<this._minimumValue&&(a=this._minimumValue);a>this._maximumValue&&(a=this._maximumValue);this._value=a;a=(a-this._minimumValue)/
(this._maximumValue-this._minimumValue);this._progressTimer.setPercentage(100*a);this._thumbSprite.setRotation(360*a);this.sendActionsForControlEvents(cc.CONTROL_EVENT_VALUECHANGED)},getValue:function(){return this._value},setMinimumValue:function(a){this._minimumValue=a;this._minimumValue>=this._maximumValue&&(this._maximumValue=this._minimumValue+1);this.setValue(this._maximumValue)},getMinimumValue:function(){return this._minimumValue},setMaximumValue:function(a){this._maximumValue=a;this._maximumValue<=
this._minimumValue&&(this._minimumValue=this._maximumValue-1);this.setValue(this._minimumValue)},getMaximumValue:function(){return this._maximumValue},isTouchInside:function(a){a=this.getTouchLocation(a);return this.distanceBetweenPointAndPoint(this._progressTimer.getPosition(),a)<Math.min(this.getContentSize().width/2,this.getContentSize().height/2)},onTouchBegan:function(a){return this.isTouchInside(a)&&this.isEnabled()&&this.isVisible()?(this._previousLocation=this.getTouchLocation(a),this.potentiometerBegan(this._previousLocation),
!0):!1},onTouchMoved:function(a){a=this.getTouchLocation(a);this.potentiometerMoved(a)},onTouchEnded:function(){this.potentiometerEnded(cc.p(0,0))},distanceBetweenPointAndPoint:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)},angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint:function(a,b,c,d){var e=d.x-c.x;c=d.y-c.y;a=Math.atan2(b.x-a.x,b.y-a.y);e=Math.atan2(e,c);return 180*(a-e)/Math.PI},potentiometerBegan:function(){this.setSelected(!0);this.getThumbSprite().setColor(cc.color.GRAY)},
potentiometerMoved:function(a){var b=this.angleInDegreesBetweenLineFromPoint_toPoint_toLineFromPoint_toPoint(this._progressTimer.getPosition(),a,this._progressTimer.getPosition(),this._previousLocation);180<b?b-=360:-180>b&&(b+=360);this.setValue(this._value+b/360*(this._maximumValue-this._minimumValue));this._previousLocation=a},potentiometerEnded:function(){this.getThumbSprite().setColor(cc.color.WHITE);this.setSelected(!1)},setThumbSprite:function(a){this._thumbSprite=a},getThumbSprite:function(){return this._thumbSprite},
setProgressTimer:function(a){this._progressTimer=a},getProgressTimer:function(){return this._progressTimer},setPreviousLocation:function(a){this._previousLocation=a},getPreviousLocation:function(){return this._previousLocation}});_p=cc.ControlPotentiometer.prototype;_p.value;cc.defineGetterSetter(_p,"value",_p.getValue,_p.setValue);_p.minValue;cc.defineGetterSetter(_p,"minValue",_p.getMinimumValue,_p.setMinimumValue);_p.maxValue;cc.defineGetterSetter(_p,"maxValue",_p.getMaximumValue,_p.setMaximumValue);
_p.progressTimer;cc.defineGetterSetter(_p,"progressTimer",_p.getProgressTimer,_p.setProgressTimer);_p.thumbSprite;cc.defineGetterSetter(_p,"thumbSprite",_p.getThumbSprite,_p.setThumbSprite);_p.prevLocation;cc.defineGetterSetter(_p,"prevLocation",_p.getPreviousLocation,_p.setPreviousLocation);_p=null;cc.ControlPotentiometer.create=function(a,b,c){return new cc.ControlPotentiometer(a,b,c)};cc.SCROLLVIEW_DIRECTION_NONE=-1;cc.SCROLLVIEW_DIRECTION_HORIZONTAL=0;cc.SCROLLVIEW_DIRECTION_VERTICAL=1;
cc.SCROLLVIEW_DIRECTION_BOTH=2;var SCROLL_DEACCEL_RATE=.95,SCROLL_DEACCEL_DIST=1,BOUNCE_DURATION=.15,INSET_RATIO=.2,MOVE_INCH=.04375,BOUNCE_BACK_FACTOR=.35;cc.convertDistanceFromPointToInch=function(a){var b=cc.view,b=(b.getScaleX()+b.getScaleY())/2;return a*b/160};cc.ScrollViewDelegate=cc.Class.extend({scrollViewDidScroll:function(){},scrollViewDidZoom:function(){}});
cc.ScrollView=cc.Layer.extend({_zoomScale:0,_minZoomScale:0,_maxZoomScale:0,_delegate:null,_direction:cc.SCROLLVIEW_DIRECTION_BOTH,_dragging:!1,_contentOffset:null,_container:null,_touchMoved:!1,_maxInset:null,_minInset:null,_bounceable:!1,_clippingToBounds:!1,_scrollDistance:null,_touchPoint:null,_touchLength:0,_touches:null,_viewSize:null,_minScale:0,_maxScale:0,_parentScissorRect:null,_scissorRestored:!1,_tmpViewRect:null,_touchListener:null,_className:"ScrollView",ctor:function(a,b){cc.Layer.prototype.ctor.call(this);
this._contentOffset=cc.p(0,0);this._maxInset=cc.p(0,0);this._minInset=cc.p(0,0);this._scrollDistance=cc.p(0,0);this._touchPoint=cc.p(0,0);this._touches=[];this._viewSize=cc.size(0,0);this._parentScissorRect=new cc.Rect(0,0,0,0);this._tmpViewRect=new cc.Rect(0,0,0,0);void 0!=b?this.initWithViewSize(a,b):this.initWithViewSize(cc.size(200,200),null)},init:function(){return this.initWithViewSize(cc.size(200,200),null)},initWithViewSize:function(a,b){var c=cc.p(0,0);return cc.Layer.prototype.init.call(this)?
(this._container=b,this._container||(this._container=cc.Layer.create(),this._container.ignoreAnchorPointForPosition(!1),this._container.setAnchorPoint(c)),this.setViewSize(a),this.setTouchEnabled(!0),this._touches.length=0,this._delegate=null,this._bounceable=!0,this._clippingToBounds=!0,this._direction=cc.SCROLLVIEW_DIRECTION_BOTH,this._container.setPosition(c),this._touchLength=0,this.addChild(this._container),this._minScale=this._maxScale=1,!0):!1},setContentOffset:function(a,b){if(b)return void this.setContentOffsetInDuration(a,
BOUNCE_DURATION);if(!this._bounceable){var c=this.minContainerOffset(),d=this.maxContainerOffset();a.x=Math.max(c.x,Math.min(d.x,a.x));a.y=Math.max(c.y,Math.min(d.y,a.y))}this._container.setPosition(a);c=this._delegate;null!=c&&c.scrollViewDidScroll&&c.scrollViewDidScroll(this)},getContentOffset:function(){var a=this._container.getPosition();return cc.p(a.x,a.y)},setContentOffsetInDuration:function(a,b){var c=cc.MoveTo.create(b,a),d=cc.CallFunc.create(this._stoppedAnimatedScroll,this);this._container.runAction(cc.Sequence.create(c,
d));this.schedule(this._performedAnimatedScroll)},setZoomScale:function(a,b){if(b)return void this.setZoomScaleInDuration(a,BOUNCE_DURATION);var c=this._container;if(c.getScale()!=a){var d,e;0==this._touchLength?(e=this._viewSize,e=cc.p(.5*e.width,.5*e.height),e=this.convertToWorldSpace(e)):e=this._touchPoint;d=c.convertToNodeSpace(e);c.setScale(Math.max(this._minScale,Math.min(this._maxScale,a)));d=c.convertToWorldSpace(d);e=cc.pSub(e,d);this._delegate&&this._delegate.scrollViewDidZoom&&this._delegate.scrollViewDidZoom(this);
this.setContentOffset(cc.pAdd(c.getPosition(),e))}},getZoomScale:function(){return this._container.getScale()},setZoomScaleInDuration:function(a,b){if(0<b){var c=this._container.getScale();c!=a&&(c=cc.ActionTween.create(b,"zoomScale",c,a),this.runAction(c))}else this.setZoomScale(a)},minContainerOffset:function(){var a=this._container,b=a.getContentSize(),c=this._viewSize;return cc.p(c.width-b.width*a.getScaleX(),c.height-b.height*a.getScaleY())},maxContainerOffset:function(){return cc.p(0,0)},isNodeVisible:function(a){var b=
this.getContentOffset(),c=this.getViewSize(),d=this.getZoomScale(),b=cc.rect(-b.x/d,-b.y/d,c.width/d,c.height/d);return cc.rectIntersectsRect(b,a.getBoundingBox())},pause:function(){this._container.pause();for(var a=this._container.getChildren(),b=0;b<a.length;b++)a[b].pause();this._super()},resume:function(){for(var a=this._container.getChildren(),b=0,c=a.length;c>b;b++)a[b].resume();this._container.resume();this._super()},isDragging:function(){return this._dragging},isTouchMoved:function(){return this._touchMoved},
isBounceable:function(){return this._bounceable},setBounceable:function(a){this._bounceable=a},getViewSize:function(){return this._viewSize},setViewSize:function(a){this._viewSize=a;cc.Node.prototype.setContentSize.call(this,a)},getContainer:function(){return this._container},setContainer:function(a){a&&(this.removeAllChildren(!0),this._container=a,a.ignoreAnchorPointForPosition(!1),a.setAnchorPoint(0,0),this.addChild(a),this.setViewSize(this._viewSize))},getDirection:function(){return this._direction},
setDirection:function(a){this._direction=a},getDelegate:function(){return this._delegate},setDelegate:function(a){this._delegate=a},onTouchBegan:function(a){if(!this.isVisible())return!1;var b=this._getViewRect(),c=this._container,d=c.convertToWorldSpace(c.convertTouchToNodeSpace(a)),e=this._touches;return 2<e.length||this._touchMoved||!cc.rectContainsPoint(b,d)?!1:(e.push(a),1===e.length?(this._touchPoint=this.convertTouchToNodeSpace(a),this._touchMoved=!1,this._dragging=!0,this._scrollDistance.x=
0,this._scrollDistance.y=0,this._touchLength=0):2==e.length&&(this._touchPoint=cc.pMidpoint(this.convertTouchToNodeSpace(e[0]),this.convertTouchToNodeSpace(e[1])),this._touchLength=cc.pDistance(c.convertTouchToNodeSpace(e[0]),c.convertTouchToNodeSpace(e[1])),this._dragging=!1),!0)},onTouchMoved:function(a){if(this.isVisible())if(1===this._touches.length&&this._dragging){this._touchMoved=!0;var b,c=(this._getViewRect(),this.convertTouchToNodeSpace(a));a=cc.pSub(c,this._touchPoint);var d=0,e=this._direction;
if(e===cc.SCROLLVIEW_DIRECTION_VERTICAL)d=a.y,b=this._container.getPositionY(),this.minContainerOffset().y<=b&&b<=this.maxContainerOffset().y||(a.y*=BOUNCE_BACK_FACTOR);else if(e===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)d=a.x,b=this._container.getPositionX(),this.minContainerOffset().x<=b&&b<=this.maxContainerOffset().x||(a.x*=BOUNCE_BACK_FACTOR);else{d=Math.sqrt(a.x*a.x+a.y*a.y);b=this._container.getPositionY();var f=this.minContainerOffset(),g=this.maxContainerOffset();f.y<=b&&b<=g.y||(a.y*=BOUNCE_BACK_FACTOR);
b=this._container.getPositionX();f.x<=b&&b<=g.x||(a.x*=BOUNCE_BACK_FACTOR)}if(this._touchMoved||!(Math.abs(cc.convertDistanceFromPointToInch(d))<MOVE_INCH))if(this._touchMoved||(a.x=0,a.y=0),this._touchPoint=c,this._touchMoved=!0,this._dragging){switch(e){case cc.SCROLLVIEW_DIRECTION_VERTICAL:a.x=0;break;case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:a.y=0}c=this._container.getPosition();b=c.x+a.x;c=c.y+a.y;this._scrollDistance=a;this.setContentOffset(cc.p(b,c))}}else 2!==this._touches.length||this._dragging||
(a=cc.pDistance(this._container.convertTouchToNodeSpace(this._touches[0]),this._container.convertTouchToNodeSpace(this._touches[1])),this.setZoomScale(this.getZoomScale()*a/this._touchLength))},onTouchEnded:function(){this.isVisible()&&(1==this._touches.length&&this._touchMoved&&this.schedule(this._deaccelerateScrolling),this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},onTouchCancelled:function(){this.isVisible()&&(this._touches.length=0,this._dragging=!1,this._touchMoved=!1)},setContentSize:function(a,
b){null!=this.getContainer()&&(void 0===b?this.getContainer().setContentSize(a):this.getContainer().setContentSize(a,b),this.updateInset())},_setWidth:function(a){var b=this.getContainer();null!=b&&(b._setWidth(a),this.updateInset())},_setHeight:function(a){var b=this.getContainer();null!=b&&(b._setHeight(a),this.updateInset())},getContentSize:function(){return this._container.getContentSize()},updateInset:function(){if(null!=this.getContainer()){var a=this._viewSize,b=this.maxContainerOffset();this._maxInset.x=
b.x+a.width*INSET_RATIO;this._maxInset.y=b.y+a.height*INSET_RATIO;b=this.minContainerOffset();this._minInset.x=b.x-a.width*INSET_RATIO;this._minInset.y=b.y-a.height*INSET_RATIO}},isClippingToBounds:function(){return this._clippingToBounds},setClippingToBounds:function(a){this._clippingToBounds=a},visit:function(a){if(this.isVisible()){var b,c,d=a||cc._renderContext,e=this._children;if(cc._renderType===cc._RENDER_TYPE_CANVAS){if(d.save(),this.transform(d),this._beforeDraw(d),e&&0<e.length){c=e.length;
this.sortAllChildren();for(a=0;c>a&&(b=e[a],b&&0>b._localZOrder);a++)b.visit(d);for(this.draw(d);c>a;a++)e[a].visit(d)}else this.draw(d);this._afterDraw();d.restore()}else{cc.kmGLPushMatrix();var f=this.grid;if(f&&f.isActive()&&(f.beforeDraw(),this.transformAncestors()),this.transform(d),this._beforeDraw(d),e&&0<e.length){c=e.length;for(a=0;c>a&&(b=e[a],b&&0>b._localZOrder);a++)b.visit();for(this.draw(d);c>a;a++)e[a].visit()}else this.draw(d);this._afterDraw(d);f&&f.isActive()&&f.afterDraw(this);
cc.kmGLPopMatrix()}}},addChild:function(a,b,c){if(!a)throw Error("child must not nil!");b=b||a.getLocalZOrder();c=c||a.getTag();this._container!=a?this._container.addChild(a,b,c):cc.Layer.prototype.addChild.call(this,a,b,c)},isTouchEnabled:function(){return null!=this._touchListener},setTouchEnabled:function(a){(this._touchListener&&cc.eventManager.removeListener(this._touchListener),this._touchListener=null,a)?(a=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE}),this.onTouchBegan&&
(a.onTouchBegan=this.onTouchBegan.bind(this)),this.onTouchMoved&&(a.onTouchMoved=this.onTouchMoved.bind(this)),this.onTouchEnded&&(a.onTouchEnded=this.onTouchEnded.bind(this)),this.onTouchCancelled&&(a.onTouchCancelled=this.onTouchCancelled.bind(this)),this._touchListener=a,cc.eventManager.addListener(a,this)):(this._touchMoved=this._dragging=!1,this._touches.length=0)},_initWithViewSize:function(){return null},_relocateContainer:function(a){var b=this.minContainerOffset(),c=this.maxContainerOffset(),
d=this._direction,e=this._container.getPosition(),f=e.x,g=e.y;(d===cc.SCROLLVIEW_DIRECTION_BOTH||d===cc.SCROLLVIEW_DIRECTION_HORIZONTAL)&&(f=Math.max(f,b.x),f=Math.min(f,c.x));(d==cc.SCROLLVIEW_DIRECTION_BOTH||d==cc.SCROLLVIEW_DIRECTION_VERTICAL)&&(g=Math.min(g,c.y),g=Math.max(g,b.y));g==e.y&&f==e.x||this.setContentOffset(cc.p(f,g),a)},_deaccelerateScrolling:function(){if(this._dragging)return void this.unschedule(this._deaccelerateScrolling);var a,b,c=this._container.getPosition(),d=this._scrollDistance;
this._container.setPosition(c.x+d.x,c.y+d.y);this._bounceable?(a=this._maxInset,b=this._minInset):(a=this.maxContainerOffset(),b=this.minContainerOffset());var c=this._container.getPositionX(),e=this._container.getPositionY();d.x*=SCROLL_DEACCEL_RATE;d.y*=SCROLL_DEACCEL_RATE;this.setContentOffset(cc.p(c,e));(Math.abs(d.x)<=SCROLL_DEACCEL_DIST&&Math.abs(d.y)<=SCROLL_DEACCEL_DIST||e>a.y||e<b.y||c>a.x||c<b.x||c==a.x||c==b.x||e==a.y||e==b.y)&&(this.unschedule(this._deaccelerateScrolling),this._relocateContainer(!0))},
_performedAnimatedScroll:function(){return this._dragging?void this.unschedule(this._performedAnimatedScroll):void(this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this))},_stoppedAnimatedScroll:function(){this.unschedule(this._performedAnimatedScroll);this._delegate&&this._delegate.scrollViewDidScroll&&this._delegate.scrollViewDidScroll(this)},_beforeDraw:function(a){if(this._clippingToBounds){this._scissorRestored=!1;var b=this._getViewRect(),c=cc.view,d=this.getScaleX(),
e=this.getScaleY();a=a||cc._renderContext;if(cc._renderType===cc._RENDER_TYPE_CANVAS)b=this._viewSize.width*d*c.getScaleX(),c=this._viewSize.height*e*c.getScaleY(),a.beginPath(),a.rect(0,0,b,-c),a.clip(),a.closePath();else if(c=cc.view,c.isScissorEnabled()){if(this._scissorRestored=!0,this._parentScissorRect=c.getScissorRect(),cc.rectIntersection(b,this._parentScissorRect)){var f=this._parentScissorRect;a=Math.max(b.x,f.x);e=Math.max(b.y,f.y);d=Math.min(b.x+b.width,f.x+f.width);b=Math.min(b.y+b.height,
f.y+f.height);c.setScissorInPoints(a,e,d-a,b-e)}}else a.enable(a.SCISSOR_TEST),c.setScissorInPoints(b.x,b.y,b.width,b.height)}},_afterDraw:function(a){this._clippingToBounds&&cc._renderType===cc._RENDER_TYPE_WEBGL&&(this._scissorRestored?(a=this._parentScissorRect,cc.view.setScissorInPoints(a.x,a.y,a.width,a.height)):(a=a||cc._renderContext,a.disable(a.SCISSOR_TEST)))},_handleZoom:function(){},_getViewRect:function(){for(var a=this.convertToWorldSpace(cc.p(0,0)),b=this._viewSize,c=this.getScaleX(),
d=this.getScaleY(),e=this._parent;null!=e;e=e.getParent())c*=e.getScaleX(),d*=e.getScaleY();0>c&&(a.x+=b.width*c,c=-c);0>d&&(a.y+=b.height*d,d=-d);e=this._tmpViewRect;return e.x=a.x,e.y=a.y,e.width=b.width*c,e.height=b.height*d,e}});_p=cc.ScrollView.prototype;_p.minOffset;cc.defineGetterSetter(_p,"minOffset",_p.minContainerOffset);_p.maxOffset;cc.defineGetterSetter(_p,"maxOffset",_p.maxContainerOffset);_p.bounceable;cc.defineGetterSetter(_p,"bounceable",_p.isBounceable,_p.setBounceable);_p.viewSize;
cc.defineGetterSetter(_p,"viewSize",_p.getViewSize,_p.setViewSize);_p.container;cc.defineGetterSetter(_p,"container",_p.getContainer,_p.setContainer);_p.direction;cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection);_p.delegate;cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate);_p.clippingToBounds;cc.defineGetterSetter(_p,"clippingToBounds",_p.isClippingToBounds,_p.setClippingToBounds);_p=null;cc.ScrollView.create=function(a,b){return new cc.ScrollView(a,b)};
cc.SortableObject=cc.Class.extend({setObjectID:function(){},getObjectID:function(){return 0}});cc.SortedObject=cc.SortableObject.extend({_objectID:0,ctor:function(){this._objectID=0},setObjectID:function(a){this._objectID=a},getObjectID:function(){return this._objectID}});var _compareObject=function(a,b){return a.getObjectID()-b.getObjectID()};
cc.ArrayForObjectSorting=cc.Class.extend({_saveObjectArr:null,ctor:function(){this._saveObjectArr=[]},insertSortedObject:function(a){if(!a)throw"cc.ArrayForObjectSorting.insertSortedObject(): addObject should be non-null.";var b=this.indexOfSortedObject(a);this.insertObject(a,b)},removeSortedObject:function(a){if(0!=this.count()){var b=this.indexOfSortedObject(a);b<this.count()&&b!=cc.INVALID_INDEX&&this.objectAtIndex(b).getObjectID()==a.getObjectID()&&this.removeObjectAtIndex(b)}},setObjectID_ofSortedObject:function(a,
b){var c=this.indexOfSortedObject(b);if(c<this.count()&&c!=cc.INVALID_INDEX){var d=this.objectAtIndex(c);d.getObjectID()==b.getObjectID()&&(this.removeObjectAtIndex(c),d.setObjectID(a),this.insertSortedObject(d))}},objectWithObjectID:function(a){if(0==this.count())return null;var b=new cc.SortedObject;b.setObjectID(a);var c=this.indexOfSortedObject(b);return c<this.count()&&c!=cc.INVALID_INDEX&&(b=this.objectAtIndex(c),b.getObjectID()!=a&&(b=null)),b},getObjectWithObjectID:function(){return null},
indexOfSortedObject:function(a){var b=0;if(a){var c=0;a=a.getObjectID();for(var d=this._saveObjectArr,e=0;e<d.length;e++){var f=d[e].getObjectID();if(a==f||a>=c&&f>a)break;c=f;b++}}else b=cc.INVALID_INDEX;return b},count:function(){return this._saveObjectArr.length},lastObject:function(){var a=this._saveObjectArr;return 0==a.length?null:a[a.length-1]},objectAtIndex:function(a){return this._saveObjectArr[a]},addObject:function(a){this._saveObjectArr.push(a);this._saveObjectArr.sort(_compareObject)},
removeObjectAtIndex:function(a){this._saveObjectArr.splice(a,1);this._saveObjectArr.sort(_compareObject)},insertObject:function(a,b){this._saveObjectArr.splice(b,0,a);this._saveObjectArr.sort(_compareObject)}});cc.TABLEVIEW_FILL_TOPDOWN=0;cc.TABLEVIEW_FILL_BOTTOMUP=1;cc.TableViewCell=cc.Node.extend({_idx:0,_className:"TableViewCell",getIdx:function(){return this._idx},setIdx:function(a){this._idx=a},reset:function(){this._idx=cc.INVALID_INDEX},setObjectID:function(a){this._idx=a},getObjectID:function(){return this._idx}});
_p=cc.TableViewCell.prototype;_p.objectId;cc.defineGetterSetter(_p,"objectId",_p.getObjectID,_p.setObjectID);_p=null;cc.TableViewDelegate=cc.ScrollViewDelegate.extend({tableCellTouched:function(){},tableCellHighlight:function(){},tableCellUnhighlight:function(){},tableCellWillRecycle:function(){}});cc.TableViewDataSource=cc.Class.extend({tableCellSizeForIndex:function(a){return this.cellSizeForTable(a)},cellSizeForTable:function(){return cc.size(0,0)},tableCellAtIndex:function(){return null},numberOfCellsInTableView:function(){return 0}});
cc.TableView=cc.ScrollView.extend({_vOrdering:null,_indices:null,_cellsFreed:null,_dataSource:null,_tableViewDelegate:null,_oldDirection:null,_cellsPositions:null,_touchedCell:null,ctor:function(a,b,c){cc.ScrollView.prototype.ctor.call(this);this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;this._cellsPositions=[];this.initWithViewSize(b,c);this.setDataSource(a);this._updateCellPositions();this._updateContentSize()},__indexFromOffset:function(a){var b=0,c=this._dataSource.numberOfCellsInTableView(this)-
1;switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:a=a.x;break;default:a=a.y}for(var d=this._cellsPositions;c>=b;){var e=0|b+(c-b)/2,f=d[e],g=d[e+1];if(a>=f&&g>=a)return e;f>a?c=e-1:b=e+1}return 0>=b?0:-1},_indexFromOffset:function(a){var b={x:a.x,y:a.y};a=this._dataSource.numberOfCellsInTableView(this)-1;this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(b.y=this.getContainer().getContentSize().height-b.y);b=this.__indexFromOffset(b);return-1!=b&&(b=Math.max(0,b),b>a&&(b=cc.INVALID_INDEX)),
b},__offsetFromIndex:function(a){switch(this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:a=cc.p(this._cellsPositions[a],0);break;default:a=cc.p(0,this._cellsPositions[a])}return a},_offsetFromIndex:function(a){var b=this.__offsetFromIndex(a);a=this._dataSource.tableCellSizeForIndex(this,a);return this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(b.y=this.getContainer().getContentSize().height-b.y-a.height),b},_updateCellPositions:function(){var a=this._dataSource.numberOfCellsInTableView(this),
b=this._cellsPositions;if(0<a){for(var c,d=0,e=this._dataSource,f=0;a>f;f++)switch(b[f]=d,c=e.tableCellSizeForIndex(this,f),this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:d+=c.width;break;default:d+=c.height}this._cellsPositions[a]=d}},_updateContentSize:function(){var a=cc.size(0,0),b=this._dataSource.numberOfCellsInTableView(this);if(0<b)switch(a=this._cellsPositions[b],this.getDirection()){case cc.SCROLLVIEW_DIRECTION_HORIZONTAL:a=cc.size(a,this._viewSize.height);break;default:a=
cc.size(this._viewSize.width,a)}this.setContentSize(a);this._oldDirection!=this._direction&&(this.setContentOffset(this._direction==cc.SCROLLVIEW_DIRECTION_HORIZONTAL?cc.p(0,0):cc.p(0,this.minContainerOffset().y)),this._oldDirection=this._direction)},_moveCellOutOfSight:function(a){this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,a);this._cellsFreed.addObject(a);this._cellsUsed.removeSortedObject(a);cc.arrayRemoveObject(this._indices,
a.getIdx());a.reset();a.getParent()==this.getContainer()&&this.getContainer().removeChild(a,!0)},_setIndexForCell:function(a,b){b.setAnchorPoint(0,0);b.setPosition(this._offsetFromIndex(a));b.setIdx(a)},_addCellIfNecessary:function(a){a.getParent()!=this.getContainer()&&this.getContainer().addChild(a);this._cellsUsed.insertSortedObject(a);var b=this._indices;a=a.getIdx();-1==b.indexOf(a)&&(b.push(a),b.sort(function(a,b){return a-b}))},getDataSource:function(){return this._dataSource},setDataSource:function(a){this._dataSource=
a},getDelegate:function(){return this._tableViewDelegate},setDelegate:function(a){this._tableViewDelegate=a},setVerticalFillOrder:function(a){this._vOrdering!=a&&(this._vOrdering=a,0<this._cellsUsed.count()&&this.reloadData())},getVerticalFillOrder:function(){return this._vOrdering},initWithViewSize:function(a,b){return cc.ScrollView.prototype.initWithViewSize.call(this,a,b)?(this._cellsUsed=new cc.ArrayForObjectSorting,this._cellsFreed=new cc.ArrayForObjectSorting,this._indices=[],this._tableViewDelegate=
null,this._vOrdering=cc.TABLEVIEW_FILL_BOTTOMUP,this.setDirection(cc.SCROLLVIEW_DIRECTION_VERTICAL),cc.ScrollView.prototype.setDelegate.call(this,this),!0):!1},updateCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-1)){var b=this.cellAtIndex(a);b&&this._moveCellOutOfSight(b);b=this._dataSource.tableCellAtIndex(this,a);this._setIndexForCell(a,b);this._addCellIfNecessary(b)}},insertCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-
1)){var b,c=this._cellsUsed;if(b=c.objectWithObjectID(a))for(var d=b=c.indexOfSortedObject(b);d<c.count();d++)b=c.objectAtIndex(d),this._setIndexForCell(b.getIdx()+1,b);b=this._dataSource.tableCellAtIndex(this,a);this._setIndexForCell(a,b);this._addCellIfNecessary(b);this._updateCellPositions();this._updateContentSize()}},removeCellAtIndex:function(a){if(!(a==cc.INVALID_INDEX||a>this._dataSource.numberOfCellsInTableView(this)-1)){var b=this.cellAtIndex(a);if(b){var c=this._cellsUsed,d=c.indexOfSortedObject(b);
this._moveCellOutOfSight(b);cc.arrayRemoveObject(this._indices,a);this._updateCellPositions();for(a=c.count()-1;a>d;a--)b=c.objectAtIndex(a),this._setIndexForCell(b.getIdx()-1,b)}}},reloadData:function(){this._oldDirection=cc.SCROLLVIEW_DIRECTION_NONE;for(var a=this._cellsUsed,b=this._cellsFreed,c=this.getContainer(),d=0,e=a.count();e>d;d++){var f=a.objectAtIndex(d);this._tableViewDelegate&&this._tableViewDelegate.tableCellWillRecycle&&this._tableViewDelegate.tableCellWillRecycle(this,f);b.addObject(f);
f.reset();f.getParent()==c&&c.removeChild(f,!0)}this._indices=[];this._cellsUsed=new cc.ArrayForObjectSorting;this._updateCellPositions();this._updateContentSize();0<this._dataSource.numberOfCellsInTableView(this)&&this.scrollViewDidScroll(this)},dequeueCell:function(){if(0===this._cellsFreed.count())return null;var a=this._cellsFreed.objectAtIndex(0);return this._cellsFreed.removeObjectAtIndex(0),a},cellAtIndex:function(a){return-1==this._indices.indexOf(a)?null:this._cellsUsed.objectWithObjectID(a)},
scrollViewDidScroll:function(){var a=this._dataSource.numberOfCellsInTableView(this);if(0!==a){null!=this._tableViewDelegate&&this._tableViewDelegate.scrollViewDidScroll&&this._tableViewDelegate.scrollViewDidScroll(this);var b=0,c=this._viewSize,b=this.getContainer(),d=this.getContentOffset();d.x*=-1;d.y*=-1;var e=Math.max(a-1,0);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN&&(d.y+=c.height/b.getScaleY());var f=this._indexFromOffset(d);f===cc.INVALID_INDEX&&(f=a-1);this._vOrdering===cc.TABLEVIEW_FILL_TOPDOWN?
d.y-=c.height/b.getScaleY():d.y+=c.height/b.getScaleY();d.x+=c.width/b.getScaleX();c=this._indexFromOffset(d);c===cc.INVALID_INDEX&&(c=a-1);d=this._cellsUsed;if(0<d.count())for(a=d.objectAtIndex(0),b=a.getIdx();f>b&&(this._moveCellOutOfSight(a),0<d.count());)a=d.objectAtIndex(0),b=a.getIdx();if(0<d.count())for(a=d.lastObject(),b=a.getIdx();e>=b&&b>c&&(this._moveCellOutOfSight(a),0<d.count());)a=d.lastObject(),b=a.getIdx();for(e=this._indices;c>=f;f++)-1==e.indexOf(f)&&this.updateCellAtIndex(f)}},
scrollViewDidZoom:function(){},onTouchEnded:function(a,b){if(this.isVisible()){if(this._touchedCell){var c=this.getBoundingBox(),d=cc.p(c.x,c.y),d=this._parent.convertToWorldSpace(d);c.x=d.x;c.y=d.y;d=this._tableViewDelegate;cc.rectContainsPoint(c,a.getLocation())&&null!=d&&(d.tableCellUnhighlight&&d.tableCellUnhighlight(this,this._touchedCell),d.tableCellTouched&&d.tableCellTouched(this,this._touchedCell));this._touchedCell=null}cc.ScrollView.prototype.onTouchEnded.call(this,a,b)}},onTouchBegan:function(a,
b){if(!this.isVisible())return!1;var c=cc.ScrollView.prototype.onTouchBegan.call(this,a,b);if(1===this._touches.length){var d;d=this.getContainer().convertTouchToNodeSpace(a);d=this._indexFromOffset(d);(this._touchedCell=d===cc.INVALID_INDEX?null:this.cellAtIndex(d))&&null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellHighlight&&this._tableViewDelegate.tableCellHighlight(this,this._touchedCell)}else this._touchedCell&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&
this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null);return c},onTouchMoved:function(a,b){cc.ScrollView.prototype.onTouchMoved.call(this,a,b);this._touchedCell&&this.isTouchMoved()&&(null!=this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)},onTouchCancelled:function(a,b){cc.ScrollView.prototype.onTouchCancelled.call(this,a,b);this._touchedCell&&(null!=
this._tableViewDelegate&&this._tableViewDelegate.tableCellUnhighlight&&this._tableViewDelegate.tableCellUnhighlight(this,this._touchedCell),this._touchedCell=null)}});_p=cc.TableView.prototype;_p.dataSource;cc.defineGetterSetter(_p,"dataSource",_p.getDataSource,_p.setDataSource);_p.delegate;cc.defineGetterSetter(_p,"delegate",_p.getDelegate,_p.setDelegate);_p.verticalFillOrder;cc.defineGetterSetter(_p,"verticalFillOrder",_p.getVerticalFillOrder,_p.setVerticalFillOrder);_p=null;
cc.TableView.create=function(a,b,c){return cc.TableView(a,b,c)};
cc.ProtectedNode=cc.Node.extend({_protectedChildren:null,_reorderProtectedChildDirty:!1,_insertProtectedChild:function(a,b){this._reorderProtectedChildDirty=!0;this._protectedChildren.push(a);a._setLocalZOrder(b)},ctor:function(){cc.Node.prototype.ctor.call(this);this._protectedChildren=[]},addProtectedChild:function(a,b,c){cc.assert(null!=a,"child must be non-nil");cc.assert(!a.parent,"child already added. It can't be added again");b=b||a.getLocalZOrder();c&&a.setTag(c);this._insertProtectedChild(a,
b);a.setParent(this);a.setOrderOfArrival(cc.s_globalOrderOfArrival);this._running&&(a.onEnter(),this._isTransitionFinished&&a.onEnterTransitionDidFinish());this._cascadeColorEnabled&&this._enableCascadeColor();this._cascadeOpacityEnabled&&this._enableCascadeOpacity()},getProtectedChildByTag:function(a){cc.assert(a!=cc.NODE_TAG_INVALID,"Invalid tag");for(var b=this._protectedChildren,c=0,d=b.length;d>c;c++)if(b.getTag()==a)return b[c];return null},removeProtectedChild:function(a,b){null==b&&(b=!0);
var c=this._protectedChildren;if(0!==c.length){var d=c.indexOf(a);-1<d&&(this._running&&(a.onExitTransitionDidStart(),a.onExit()),b&&a.cleanup(),a.setParent(null),c.splice(d,1))}},removeProtectedChildByTag:function(a,b){cc.assert(a!=cc.NODE_TAG_INVALID,"Invalid tag");null==b&&(b=!0);var c=this.getProtectedChildByTag(a);null==c?cc.log("cocos2d: removeChildByTag(tag = %d): child not found!",a):this.removeProtectedChild(c,b)},removeAllProtectedChildren:function(){this.removeAllProtectedChildrenWithCleanup(!0)},
removeAllProtectedChildrenWithCleanup:function(a){null==a&&(a=!0);for(var b=this._protectedChildren,c=0,d=b.length;d>c;c++){var e=b[c];this._running&&(e.onExitTransitionDidStart(),e.onExit());a&&e.cleanup();e.setParent(null)}b.length=0},reorderProtectedChild:function(a,b){cc.assert(null!=a,"Child must be non-nil");this._reorderProtectedChildDirty=!0;a.setOrderOfArrival(cc.s_globalOrderOfArrival++);a._setLocalZOrder(b)},sortAllProtectedChildren:function(){if(this._reorderProtectedChildDirty){var a,
b,c,d=this._protectedChildren,e=d.length;for(a=1;e>a;a++){c=d[a];for(b=a-1;0<=b&&(c._localZOrder<d[b]._localZOrder||c._localZOrder===d[b]._localZOrder&&c.arrivalOrder<d[b].arrivalOrder);)d[b+1]=d[b],b--;d[b+1]=c}this._reorderProtectedChildDirty=!1}},visit:null,_visitForCanvas:function(a){if(this._visible){var b,c,d=a||cc._renderContext,e=this._children,f=this._protectedChildren,g=this._children.length,h=f.length;d.save();this.transform(d);this.sortAllChildren();this.sortAllProtectedChildren();for(a=
0;g>a&&(c=e[a],0>c._localZOrder);a++)c.visit(d);for(b=0;h>b&&(c=f[b],0>c._localZOrder);b++)c.visit(d);for(this.draw(d);g>a;a++)e[a]&&e[a].visit(d);for(;h>b;b++)f[b]&&f[b].visit(d);this._cacheDirty=!1;this.arrivalOrder=0;d.restore()}},_visitForWebGL:function(){if(this._visible){var a,b,c=cc._renderContext,d=cc.current_stack;d.stack.push(d.top);cc.kmMat4Assign(this._stackMatrix,d.top);d.top=this._stackMatrix;var e=this.grid;e&&e._active&&e.beforeDraw();this.transform();var f=this._children,g=this._protectedChildren,
h=f.length,k=g.length;this.sortAllChildren();this.sortAllProtectedChildren();for(a=0;h>a&&f[a]&&0>f[a]._localZOrder;a++)f[a].visit();for(b=0;k>b&&g[b]&&0>g[b]._localZOrder;b++)g[b].visit();for(this.draw(c);h>a;a++)f[a]&&f[a].visit();for(;k>b;b++)g[b]&&g[b].visit();this.arrivalOrder=0;e&&e._active&&e.afterDraw(this);d.top=d.stack.pop()}},cleanup:function(){cc.Node.prototype.cleanup.call(this);for(var a=this._protectedChildren,b=0,c=a.length;c>b;b++)a[b].cleanup()},onEnter:function(){cc.Node.prototype.onEnter.call(this);
for(var a=this._protectedChildren,b=0,c=a.length;c>b;b++)a[b].onEnter()},onEnterTransitionDidFinish:function(){cc.Node.prototype.onEnterTransitionDidFinish.call(this);for(var a=this._protectedChildren,b=0,c=a.length;c>b;b++)a[b].onEnterTransitionDidFinish()},onExit:function(){cc.Node.prototype.onExit.call(this);for(var a=this._protectedChildren,b=0,c=a.length;c>b;b++)a[b].onExit()},onExitTransitionDidStart:function(){cc.Node.prototype.onExitTransitionDidStart.call(this);for(var a=this._protectedChildren,
b=0,c=a.length;c>b;b++)a[b].onExitTransitionDidStart()},updateDisplayedOpacity:function(a){this._displayedOpacity=this._realOpacity*a/255;this._updateColor();var b,c,d=this._displayedOpacity;if(this._cascadeOpacityEnabled)for(c=this._children,a=0,b=c.length;b>a;a++)c[a].updateDisplayedOpacity&&c[a].updateDisplayedOpacity(d);c=this._protectedChildren;a=0;for(b=c.length;b>a;a++)c[a]&&c[a].updateDisplayedOpacity(d)},updateDisplayedColor:function(a){var b=this._displayedColor,c=this._realColor;b.r=c.r*
a.r/255;b.g=c.g*a.g/255;b.b=c.b*a.b/255;this._updateColor();var d;if(this._cascadeColorEnabled)for(d=this._children,a=0,c=d.length;c>a;a++)d[a].updateDisplayedColor&&d[a].updateDisplayedColor(b);d=this._protectedChildren;a=0;for(c=d.length;c>a;a++)d[a]&&d[a].updateDisplayedColor(b)},_disableCascadeOpacity:function(){this._displayedOpacity=this._realOpacity;var a,b,c=this._children;for(a=0;a<c.length;a++)(b=c[a])&&b.updateDisplayedOpacity(255);c=this._protectedChildren;for(a=0;a<c.length;a++)(b=c[a])&&
b.updateDisplayedOpacity(255)},_disableCascadeColor:function(){var a,b,c=cc.color.WHITE,d=this._children;a=0;for(b=d.length;b>a;a++)d[a].updateDisplayedColor(c);d=this._protectedChildren;a=0;for(b=d.length;b>a;a++)d[a].setColor(c)}});cc.ProtectedNode.prototype.visit=cc._renderType===cc._RENDER_TYPE_CANVAS?cc.ProtectedNode.prototype._visitForCanvas:cc.ProtectedNode.prototype._visitForWebGL;cc.ProtectedNode.create=function(){return new cc.ProtectedNode};var ccui=ccui||{};ccui.Class=ccui.Class||cc.Class;
ccui.Class.extend=ccui.Class.extend||cc.Class.extend;ccui.Node=ccui.Node||cc.Node;ccui.Node.extend=ccui.Node.extend||cc.Node.extend;ccui.ProtectedNode=ccui.ProtectedNode||cc.ProtectedNode;ccui.ProtectedNode.extend=ccui.ProtectedNode.extend||cc.ProtectedNode.extend;ccui.cocosGUIVersion="CocosGUI v1.0.0.0";
ccui.Widget=ccui.ProtectedNode.extend({_enabled:!0,_bright:!0,_touchEnabled:!1,_brightStyle:null,_touchBeganPosition:null,_touchMovePosition:null,_touchEndPosition:null,_touchEventListener:null,_touchEventSelector:null,_name:"default",_widgetType:null,_actionTag:0,_customSize:null,_layoutParameterDictionary:null,_layoutParameterType:0,_focused:!1,_focusEnabled:!0,_ignoreSize:!1,_affectByClipping:!1,_sizeType:null,_sizePercent:null,_positionType:null,_positionPercent:null,_reorderWidgetChildDirty:!1,
_hit:!1,_nodes:null,_touchListener:null,_className:"Widget",_flippedX:!1,_flippedY:!1,_opacity:255,_highlight:!1,_touchEventCallback:null,ctor:function(){cc.ProtectedNode.prototype.ctor.call(this);this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE;this._touchBeganPosition=cc.p(0,0);this._touchMovePosition=cc.p(0,0);this._touchEndPosition=cc.p(0,0);this._widgetType=ccui.Widget.TYPE_WIDGET;this._customSize=cc.size(0,0);this._layoutParameterDictionary={};this._sizeType=ccui.Widget.SIZE_ABSOLUTE;this._sizePercent=
cc.p(0,0);this._positionType=ccui.Widget.POSITION_ABSOLUTE;this._positionPercent=cc.p(0,0);this._nodes=[];this._layoutParameterType=ccui.LayoutParameter.NONE;this.init()},init:function(){return cc.ProtectedNode.prototype.init.call(this)?(this._layoutParameterDictionary={},this._initRenderer(),this.setBright(!0),this.onFocusChanged=this.onFocusChange.bind(this),this.onNextFocusedWidget=null,this.setAnchorPoint(cc.p(.5,.5)),this.ignoreContentAdaptWithSize(!0),!0):!1},onEnter:function(){this.updateSizeAndPosition();
cc.ProtectedNode.prototype.onEnter.call(this)},onExit:function(){this.unscheduleUpdate();cc.ProtectedNode.prototype.onExit.call(this)},visit:function(a){this._visible&&(this._adaptRenderers(),cc.ProtectedNode.prototype.visit.call(this,a))},getWidgetParent:function(){var a=this.getParent();return a instanceof ccui.Widget?a:null},_updateContentSizeWithTextureSize:function(a){this.setContentSize(this._ignoreSize?a:this._customSize)},_isAncestorsEnabled:function(){var a=this._getAncensterWidget(this);
return null==a?!0:a&&!a.isEnabled()?!1:a._isAncestorsEnabled()},_getAncensterWidget:function(a){if(null==a)return null;a=a.getParent();return null==a?null:a instanceof ccui.Widget?a:this._getAncensterWidget(a.getParent())},_isAncestorsVisible:function(a){return null==a?!0:(a=a.getParent())&&!a.isVisible()?!1:this._isAncestorsVisible(a)},_cleanupWidget:function(){this._eventDispatcher.removeEventListener(this._touchListener);ccui.Widget._focusedWidget==this&&(ccui.Widget._focusedWidget=null)},setEnabled:function(a){this._enabled=
a},_initRenderer:function(){},setContentSize:function(a,b){var c=void 0===b?a.width:a,d=void 0===b?a.height:b;if(cc.Node.prototype.setContentSize.call(this,c,d),this._customSize.width=c,this._customSize.height=d,this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),this._running){var e=this.getWidgetParent(),e=e?e.getContentSize():this._parent.getContentSize();this._sizePercent.x=0<e.width?c/e.width:0;this._sizePercent.y=0<e.height?d/e.height:0}this._onSizeChanged()},_setWidth:function(a){if(cc.Node.prototype._setWidth.call(this,
a),this._customSize.width=a,this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),this._running)a=(a=this.getWidgetParent())?a.width:this._parent.width,this._sizePercent.x=0<a?this._customSize.width/a:0;this._onSizeChanged()},_setHeight:function(a){if(cc.Node.prototype._setHeight.call(this,a),this._customSize.height=a,this._ignoreSize&&(this._contentSize=this.getVirtualRendererSize()),this._running)a=(a=this.getWidgetParent())?a.height:this._parent.height,this._sizePercent.y=0<a?this._customSize.height/
a:0;this._onSizeChanged()},setSizePercent:function(a){this._sizePercent.x=a.x;this._sizePercent.y=a.y;var b=this._customSize.width,c=this._customSize.height;if(this._running){var d=this.getWidgetParent();d?(b=d.width*a.x,c=d.height*a.y):(b=this._parent.width*a.x,c=this._parent.height*a.y)}this._ignoreSize?this.setContentSize(this.getVirtualRendererSize()):this.setContentSize(b,c);this._customSize.width=b;this._customSize.height=c},_setWidthPercent:function(a){this._sizePercent.x=a;var b=this._customSize.width;
this._running&&(b=this.getWidgetParent(),b=(b?b.width:this._parent.width)*a);this._setWidth(this._ignoreSize?this.getVirtualRendererSize().width:b);this._customSize.width=b},_setHeightPercent:function(a){this._sizePercent.y=a;var b=this._customSize.height;this._running&&(b=this.getWidgetParent(),b=(b?b.height:this._parent.height)*a);this._setHeight(this._ignoreSize?this.getVirtualRendererSize().height:b);this._customSize.height=b},updateSizeAndPosition:function(a){a||(a=(a=this.getWidgetParent())?
a.getLayoutSize():this._parent.getContentSize());switch(this._sizeType){case ccui.Widget.SIZE_ABSOLUTE:this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():this._customSize);this._sizePercent.x=0<a.width?this._customSize.width/a.width:0;this._sizePercent.y=0<a.height?this._customSize.height/a.height:0;break;case ccui.Widget.SIZE_PERCENT:var b=cc.size(a.width*this._sizePercent.x,a.height*this._sizePercent.y);this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():b);this._customSize.width=
b.width;this._customSize.height=b.height}this._onSizeChanged();b=this.getPosition();switch(this._positionType){case ccui.Widget.POSITION_ABSOLUTE:0>=a.width||0>=a.height?this._positionPercent.x=this._positionPercent.y=0:(this._positionPercent.x=b.x/a.width,this._positionPercent.y=b.y/a.height);break;case ccui.Widget.POSITION_PERCENT:b=cc.p(a.width*this._positionPercent.x,a.height*this._positionPercent.y)}if(this._parent instanceof ccui.ImageView&&(a=this._parent._imageRenderer)&&!a._textureLoaded)return;
this.setPosition(b)},setSizeType:function(a){this._sizeType=a},getSizeType:function(){return this._sizeType},ignoreContentAdaptWithSize:function(a){this._ignoreSize!=a&&(this._ignoreSize=a,this.setContentSize(a?this.getVirtualRendererSize():this._customSize),this._onSizeChanged())},isIgnoreContentAdaptWithSize:function(){return this._ignoreSize},getCustomSize:function(){return cc.size(this._customSize)},getLayoutSize:function(){return cc.size(this._contentSize)},getSizePercent:function(){return cc.p(this._sizePercent)},
_getWidthPercent:function(){return this._sizePercent.x},_getHeightPercent:function(){return this._sizePercent.y},getWorldPosition:function(){return this.convertToWorldSpace(cc.p(this._anchorPoint.x*this._contentSize.width,this._anchorPoint.y*this._contentSize.height))},getVirtualRenderer:function(){return this},getVirtualRendererSize:function(){return cc.size(this._contentSize)},_onSizeChanged:function(){for(var a=this.getChildren(),b=0,c=a.length;c>b;b++){var d=a[b];d instanceof ccui.Widget&&d.updateSizeAndPosition()}},
setTouchEnabled:function(a){this._touchEnabled!==a&&(this._touchEnabled=a,this._touchEnabled?(this._touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:this.onTouchBegan.bind(this),onTouchMoved:this.onTouchMoved.bind(this),onTouchEnded:this.onTouchEnded.bind(this)}),cc.eventManager.addListener(this._touchListener,this)):cc.eventManager.removeListener(this._touchListener))},isTouchEnabled:function(){return this._touchEnabled},isHighlighted:function(){return this._highlight},
setHighlighted:function(a){a!=this._highlight&&(this._highlight=a,this._bright?this.setBrightStyle(this._highlight?ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:ccui.Widget.BRIGHT_STYLE_NORMAL):this._onPressStateChangedToDisabled())},isFocused:function(){return this._focused},setFocused:function(a){(this._focused=a)&&(ccui.Widget._focusedWidget=this)},isFocusEnabled:function(){return this._focusEnabled},setFocusEnabled:function(a){this._focused=a},findNextFocusedWidget:function(a,b){if(null==this.onNextFocusedWidget||
null==this.onNextFocusedWidget(a)){var c=b instanceof ccui.Layout;if(this.isFocused()||c){var d=this.getParent();return null==d?c?b.findNextFocusedWidget(a,b):b:d.findNextFocusedWidget(a,b)}return b}c=this.onNextFocusedWidget(a);return this.dispatchFocusEvent(this,c),c},requestFocus:function(){this!=ccui.Widget._focusedWidget&&this.dispatchFocusEvent(ccui.Widget._focusedWidget,this)},getCurrentFocusedWidget:function(){return ccui.Widget._focusedWidget},enableDpadNavigation:function(){},onFocusChanged:null,
onNextFocusedWidget:null,interceptTouchEvent:function(a,b,c){var d=this.getWidgetParent();d&&d.interceptTouchEvent(a,b,c)},onFocusChange:function(a,b){a&&a.setFocused(!1);b&&b.setFocused(!0)},dispatchFocusEvent:function(a,b){a&&!a.isFocused()&&(a=ccui.Widget._focusedWidget);b!=a&&(b&&b.onFocusChanged&&b.onFocusChanged(a,b),a&&b.onFocusChanged&&a.onFocusChanged(a,b),cc.eventManager.dispatchEvent(new cc.EventFocus(a,b)))},setBright:function(a){(this._bright=a)?(this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,
this.setBrightStyle(ccui.Widget.BRIGHT_STYLE_NORMAL)):this._onPressStateChangedToDisabled()},setBrightStyle:function(a){if(this._brightStyle!=a)switch(a=a||ccui.Widget.BRIGHT_STYLE_NORMAL,this._brightStyle=a,this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:this._onPressStateChangedToNormal();break;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:this._onPressStateChangedToPressed()}},_onPressStateChangedToNormal:function(){},_onPressStateChangedToPressed:function(){},_onPressStateChangedToDisabled:function(){},
didNotSelectSelf:function(){},onTouchBegan:function(a){if(this._hit=!1,this.isVisible()&&this.isEnabled()&&this._isAncestorsEnabled()&&this._isAncestorsVisible(this)){var b=a.getLocation();this._touchBeganPosition.x=b.x;this._touchBeganPosition.y=b.y;this.hitTest(this._touchBeganPosition)&&this.isClippingParentContainsPoint(this._touchBeganPosition)&&(this._hit=!0)}if(!this._hit)return!1;this.setHighlighted(!0);b=this.getWidgetParent();return b&&b.interceptTouchEvent(ccui.Widget.TOUCH_BEGAN,this,
a),this._pushDownEvent(),!0},onTouchMoved:function(a){var b=a.getLocation();this._touchMovePosition.x=b.x;this._touchMovePosition.y=b.y;this.setHighlighted(this.hitTest(b));(b=this.getWidgetParent())&&b.interceptTouchEvent(ccui.Widget.TOUCH_MOVED,this,a);this._moveEvent()},onTouchEnded:function(a){var b=a.getLocation();this._touchEndPosition.x=b.x;this._touchEndPosition.y=b.y;(b=this.getWidgetParent())&&b.interceptTouchEvent(ccui.Widget.TOUCH_ENDED,this,a);a=this._highlight;this.setHighlighted(!1);
a?this._releaseUpEvent():this._cancelUpEvent()},onTouchCancelled:function(){this.setHighlighted(!1);this._cancelUpEvent()},onTouchLongClicked:function(){this.longClickEvent()},_pushDownEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_BEGAN);this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_BEGAN)},_moveEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_MOVED);
this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_MOVED)},_releaseUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_ENDED);this._touchEventListener&&this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_ENDED)},_cancelUpEvent:function(){this._touchEventCallback&&this._touchEventCallback(this,ccui.Widget.TOUCH_CANCELED);this._touchEventListener&&
this._touchEventSelector&&this._touchEventSelector.call(this._touchEventListener,this,ccui.Widget.TOUCH_CANCELED)},longClickEvent:function(){},addTouchEventListener:function(a,b){void 0===b?this._touchEventCallback=a:(this._touchEventSelector=a,this._touchEventListener=b)},hitTest:function(a){var b=cc.rect(0,0,this._contentSize.width,this._contentSize.height);return cc.rectContainsPoint(b,this.convertToNodeSpace(a))},isClippingParentContainsPoint:function(a){this._affectByClipping=!1;for(var b=this.getParent(),
c=null;b;){if(b instanceof ccui.Layout&&b.isClippingEnabled()){this._affectByClipping=!0;c=b;break}b=b.getParent()}return this._affectByClipping&&c?c.hitTest(a)?c.isClippingParentContainsPoint(a):!1:!0},checkChildInfo:function(a,b,c){var d=this.getWidgetParent();d&&d.checkChildInfo(a,b,c)},setPosition:function(a,b){if(this._running){var c=this.getWidgetParent();c&&(c=c.getContentSize(),0>=c.width||0>=c.height?(this._positionPercent.x=0,this._positionPercent.y=0):void 0==b?(this._positionPercent.x=
a/c.width,this._positionPercent.y=b/c.height):(this._positionPercent.x=a.x/c.width,this._positionPercent.y=a.y/c.height))}cc.Node.prototype.setPosition.call(this,a,b)},setPositionX:function(a){if(this._running){var b=this.getWidgetParent();b&&(b=b.width,this._positionPercent.x=0>=b?0:a/b)}cc.Node.prototype.setPositionX.call(this,a)},setPositionY:function(a){if(this._running){var b=this.getWidgetParent();b&&(b=b.height,this._positionPercent.y=0>=b?0:a/b)}cc.Node.prototype.setPositionY.call(this,a)},
setPositionPercent:function(a){if(this._positionPercent=a,this._running)if(a=this.getWidgetParent())a=a.getSize(),this.setPosition(a.width*this._positionPercent.x,a.height*this._positionPercent.y)},_setXPercent:function(a){if(this._positionPercent.x=a,this._running){var b=this.getWidgetParent();b&&this.setPositionX(b.width*a)}},_setYPercent:function(a){if(this._positionPercent.y=a,this._running){var b=this.getWidgetParent();b&&this.setPositionY(b.height*a)}},getPositionPercent:function(){return cc.p(this._positionPercent)},
_getXPercent:function(){return this._positionPercent.x},_getYPercent:function(){return this._positionPercent.y},setPositionType:function(a){this._positionType=a},getPositionType:function(){return this._positionType},setFlippedX:function(a){this._flippedX=a;this._updateFlippedX()},isFlippedX:function(){return this._flippedX},setFlippedY:function(a){this._flippedY=a;this._updateFlippedY()},isFlippedY:function(){return this._flippedY},_updateFlippedX:function(){},_updateFlippedY:function(){},_adaptRenderers:function(){},
isBright:function(){return this._bright},isEnabled:function(){return this._enabled},getLeftBoundary:function(){return this.getPositionX()-this._getAnchorX()*this._contentSize.width},getBottomBoundary:function(){return this.getPositionY()-this._getAnchorY()*this._contentSize.height},getRightBoundary:function(){return this.getLeftBoundary()+this._contentSize.width},getTopBoundary:function(){return this.getBottomBoundary()+this._contentSize.height},getTouchBeganPosition:function(){return cc.p(this._touchBeganPosition)},
getTouchMovePosition:function(){return cc.p(this._touchMovePosition)},getTouchEndPosition:function(){return cc.p(this._touchEndPosition)},getWidgetType:function(){return this._widgetType},setLayoutParameter:function(a){a&&(this._layoutParameterDictionary[a.getLayoutType()]=a,this._layoutParameterType=a.getLayoutType())},getLayoutParameter:function(a){return a=a||this._layoutParameterType,this._layoutParameterDictionary[a]},getDescription:function(){return"Widget"},clone:function(){var a=this._createCloneInstance();
return a._copyProperties(this),a._copyClonedWidgetChildren(this),a},_createCloneInstance:function(){return ccui.Widget.create()},_copyClonedWidgetChildren:function(a){a=a.getChildren();for(var b=0;b<a.length;b++){var c=a[b];c instanceof ccui.Widget&&this.addChild(c.clone())}},_copySpecialProperties:function(){},_copyProperties:function(a){this.setEnabled(a.isEnabled());this.setVisible(a.isVisible());this.setBright(a.isBright());this.setTouchEnabled(a.isTouchEnabled());this.setLocalZOrder(a.getLocalZOrder());
this.setTag(a.getTag());this.setName(a.getName());this.setActionTag(a.getActionTag());this._ignoreSize=a._ignoreSize;this.setContentSize(a._contentSize);this._customSize.width=a._customSize.width;this._customSize.height=a._customSize.height;this._copySpecialProperties(a);this._sizeType=a.getSizeType();this._sizePercent.x=a._sizePercent.x;this._sizePercent.y=a._sizePercent.y;this._positionType=a._positionType;this._positionPercent.x=a._positionPercent.x;this._positionPercent.y=a._positionPercent.y;
this.setPosition(a.getPosition());this.setAnchorPoint(a.getAnchorPoint());this.setScaleX(a.getScaleX());this.setScaleY(a.getScaleY());this.setRotation(a.getRotation());this.setRotationX(a.getRotationX());this.setRotationY(a.getRotationY());this.setFlippedX(a.isFlippedX());this.setFlippedY(a.isFlippedY());this.setColor(a.getColor());this.setOpacity(a.getOpacity());this._touchEventCallback=a._touchEventCallback;this._touchEventListener=a._touchEventListener;this._touchEventSelector=a._touchEventSelector;
this._focused=a._focused;this._focusEnabled=a._focusEnabled;for(var b in a._layoutParameterDictionary){var c=a._layoutParameterDictionary[b];c&&this.setLayoutParameter(c.clone())}this._onSizeChanged()},setActionTag:function(a){this._actionTag=a},getActionTag:function(){return this._actionTag},getLeftInParent:function(){return cc.log("getLeftInParent is deprecated. Please use getLeftBoundary instead."),this.getLeftBoundary()},getBottomInParent:function(){return cc.log("getBottomInParent is deprecated. Please use getBottomBoundary instead."),
this.getBottomBoundary()},getRightInParent:function(){return cc.log("getRightInParent is deprecated. Please use getRightBoundary instead."),this.getRightBoundary()},getTopInParent:function(){return cc.log("getTopInParent is deprecated. Please use getTopBoundary instead."),this.getTopBoundary()},getTouchEndPos:function(){return cc.log("getTouchEndPos is deprecated. Please use getTouchEndPosition instead."),this.getTouchEndPosition()},getTouchMovePos:function(){return cc.log("getTouchMovePos is deprecated. Please use getTouchMovePosition instead."),
this.getTouchMovePosition()},clippingParentAreaContainPoint:function(a){cc.log("clippingParentAreaContainPoint is deprecated. Please use isClippingParentContainsPoint instead.");this.isClippingParentContainsPoint(a)},getTouchStartPos:function(){return cc.log("getTouchStartPos is deprecated. Please use getTouchBeganPosition instead."),this.getTouchBeganPosition()},setSize:function(a){this.setContentSize(a)},getSize:function(){return this.getContentSize()},addNode:function(a,b,c){return a instanceof
ccui.Widget?void cc.log("Please use addChild to add a Widget."):(cc.Node.prototype.addChild.call(this,a,b,c),void this._nodes.push(a))},getNodeByTag:function(a){for(var b=this._nodes,c=0;c<b.length;c++){var d=b[c];if(d&&d.getTag()==a)return d}return null},getNodes:function(){return this._nodes},removeNode:function(a,b){cc.Node.prototype.removeChild.call(this,a,b);cc.arrayRemoveObject(this._nodes,a)},removeNodeByTag:function(a){var b=this.getNodeByTag(a);b?this.removeNode(b):cc.log("cocos2d: removeNodeByTag(tag = %d): child not found!",
a)},removeAllNodes:function(){for(var a=0;a<this._nodes.length;a++)cc.Node.prototype.removeChild.call(this,this._nodes[a]);this._nodes.length=0},_findLayout:function(){for(var a=this._parent;a;){if(a._doLayout){a._doLayoutDirty=!0;break}a=a._parent}},_updateChildrenDisplayedRGBA:function(){this.setColor(this.getColor());this.setOpacity(this.getOpacity())}});_p=ccui.Widget.prototype;_p.xPercent;cc.defineGetterSetter(_p,"xPercent",_p._getXPercent,_p._setXPercent);_p.yPercent;
cc.defineGetterSetter(_p,"yPercent",_p._getYPercent,_p._setYPercent);_p.widthPercent;cc.defineGetterSetter(_p,"widthPercent",_p._getWidthPercent,_p._setWidthPercent);_p.heightPercent;cc.defineGetterSetter(_p,"heightPercent",_p._getHeightPercent,_p._setHeightPercent);_p.widgetParent;cc.defineGetterSetter(_p,"widgetParent",_p.getWidgetParent);_p.enabled;cc.defineGetterSetter(_p,"enabled",_p.isEnabled,_p.setEnabled);_p.focused;cc.defineGetterSetter(_p,"focused",_p.isFocused,_p.setFocused);_p.sizeType;
cc.defineGetterSetter(_p,"sizeType",_p.getSizeType,_p.setSizeType);_p.widgetType;cc.defineGetterSetter(_p,"widgetType",_p.getWidgetType);_p.touchEnabled;cc.defineGetterSetter(_p,"touchEnabled",_p.isTouchEnabled,_p.setTouchEnabled);_p.updateEnabled;cc.defineGetterSetter(_p,"updateEnabled",_p.isUpdateEnabled,_p.setUpdateEnabled);_p.bright;cc.defineGetterSetter(_p,"bright",_p.isBright,_p.setBright);_p.name;cc.defineGetterSetter(_p,"name",_p.getName,_p.setName);_p.actionTag;
cc.defineGetterSetter(_p,"actionTag",_p.getActionTag,_p.setActionTag);_p.opacity;cc.defineGetterSetter(_p,"opacity",_p.getOpacity,_p.setOpacity);_p=null;ccui.Widget.create=function(){return new ccui.Widget};ccui.Widget._focusedWidget=null;ccui.Widget.getCurrentFocusedWidget=function(){return ccui.Widget._focusedWidget};ccui.Widget.BRIGHT_STYLE_NONE=-1;ccui.Widget.BRIGHT_STYLE_NORMAL=0;ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT=1;ccui.Widget.TYPE_WIDGET=0;ccui.Widget.TYPE_CONTAINER=1;ccui.Widget.LEFT=0;
ccui.Widget.RIGHT=1;ccui.Widget.UP=0;ccui.Widget.DOWN=1;ccui.Widget.LOCAL_TEXTURE=0;ccui.Widget.PLIST_TEXTURE=1;ccui.Widget.TOUCH_BEGAN=0;ccui.Widget.TOUCH_MOVED=1;ccui.Widget.TOUCH_ENDED=2;ccui.Widget.TOUCH_CANCELED=3;ccui.Widget.SIZE_ABSOLUTE=0;ccui.Widget.SIZE_PERCENT=1;ccui.Widget.POSITION_ABSOLUTE=0;ccui.Widget.POSITION_PERCENT=1;cc.EventFocus=cc.Event.extend({_widgetGetFocus:null,_widgetLoseFocus:null,ctor:function(a,b){this._widgetGetFocus=b;this._widgetLoseFocus=a}});
ccui.Scale9Sprite=cc.Node.extend({_spriteRect:null,_capInsetsInternal:null,_positionsAreDirty:!1,_scale9Image:null,_topLeft:null,_top:null,_topRight:null,_left:null,_centre:null,_right:null,_bottomLeft:null,_bottom:null,_bottomRight:null,_cacheSprite:null,_cacheCanvas:null,_cacheContext:null,_cacheTexture:null,_scale9Dirty:!0,_opacityModifyRGB:!1,_originalSize:null,_preferredSize:null,_opacity:0,_color:null,_capInsets:null,_insetLeft:0,_insetTop:0,_insetRight:0,_insetBottom:0,_spritesGenerated:!1,
_spriteFrameRotated:!1,_textureLoaded:!1,_loadedEventListeners:null,_className:"Scale9Sprite",textureLoaded:function(){return this._textureLoaded},addLoadedEventListener:function(a,b){this._loadedEventListeners.push({eventCallback:a,eventTarget:b})},_callLoadedEventCallbacks:function(){this._textureLoaded=!0;for(var a=this._loadedEventListeners,b=0,c=a.length;c>b;b++){var d=a[b];d.eventCallback.call(d.eventTarget,this)}a.length=0},_updateCapInset:function(){var a;a=this._insetLeft;var b=this._insetTop,
c=this._insetRight,d=this._spriteRect,e=this._insetBottom;a=0===a&&0===b&&0===c&&0===e?cc.rect(0,0,0,0):this._spriteFrameRotated?cc.rect(e,a,d.width-c-a,d.height-b-e):cc.rect(a,b,d.width-a-c,d.height-b-e);this.setCapInsets(a)},_updatePositions:function(){if(this._topLeft&&this._topRight&&this._bottomRight&&this._bottomLeft&&this._centre){var a=this._contentSize,b=this._topLeft,c=this._topRight,d=this._bottomRight,e=this._bottomLeft,f=this._centre,g=this._centre.getContentSize(),h=b.getContentSize(),
k=e.getContentSize(),m=a.width-h.width-c.getContentSize().width,a=a.height-h.height-d.getContentSize().height,m=m/g.width,a=a/g.height,h=g.width*m,n=g.height*a,q=k.width,k=k.height;if(cc._renderType==cc._RENDER_TYPE_WEBGL){var r=Math.round(h);h!=r&&(h=r,m=h/g.width);r=Math.round(n);n!=r&&(n=r,a=n/g.height)}f.setScaleX(m);f.setScaleY(a);var g=this._left,r=this._right,s=this._top,u=this._bottom,t=cc.p(0,0);e.setAnchorPoint(t);d.setAnchorPoint(t);b.setAnchorPoint(t);c.setAnchorPoint(t);g.setAnchorPoint(t);
r.setAnchorPoint(t);s.setAnchorPoint(t);u.setAnchorPoint(t);f.setAnchorPoint(t);e.setPosition(0,0);d.setPosition(q+h,0);b.setPosition(0,k+n);c.setPosition(q+h,k+n);g.setPosition(0,k);g.setScaleY(a);r.setPosition(q+h,k);r.setScaleY(a);u.setPosition(q,0);u.setScaleX(m);s.setPosition(q,k+n);s.setScaleX(m);f.setPosition(q,k)}},_cacheScale9Sprite:function(){if(this._scale9Image){var a=this._contentSize,b=this._cacheCanvas,c=!1;(b.width!=a.width||b.height!=a.height)&&(b.width=a.width,b.height=a.height,
this._cacheContext.translate(0,a.height),c=!0);cc.view._setScaleXYForRenderTexture();this._scale9Image.visit(this._cacheContext);cc.view._resetScale();c&&this._cacheSprite.setTextureRect(cc.rect(0,0,a.width,a.height));this._cacheSprite.getParent()||this.addChild(this._cacheSprite)}},ctor:function(a,b,c){if(cc.Node.prototype.ctor.call(this),this._spriteRect=cc.rect(0,0,0,0),this._capInsetsInternal=cc.rect(0,0,0,0),this._originalSize=cc.size(0,0),this._preferredSize=cc.size(0,0),this._capInsets=cc.rect(0,
0,0,0),this._loadedEventListeners=[],cc._renderType===cc._RENDER_TYPE_CANVAS){var d=this._cacheCanvas=cc.newElement("canvas");d.width=1;d.height=1;this._cacheContext=d.getContext("2d");var e=this._cacheTexture=new cc.Texture2D;e.initWithElement(d);e.handleLoadedTexture();this._cacheSprite=new cc.Sprite(e);this._cacheSprite.setAnchorPoint(0,0);this.addChild(this._cacheSprite)}void 0!=a?a instanceof cc.SpriteFrame?this.initWithSpriteFrame(a,b):(d=cc.spriteFrameCache.getSpriteFrame(a),null!=d?this.initWithSpriteFrame(d,
b):this.initWithFile(a,b,c)):this.init()},getOriginalSize:function(){return cc.size(this._originalSize)},getPreferredSize:function(){return cc.size(this._preferredSize)},_getPreferredWidth:function(){return this._preferredSize.width},_getPreferredHeight:function(){return this._preferredSize.height},setPreferredSize:function(a){this.setContentSize(a);this._preferredSize=a},_setPreferredWidth:function(a){this._setWidth(a);this._preferredSize.width=a},_setPreferredHeight:function(a){this._setHeight(a);
this._preferredSize.height=a},setOpacity:function(a){if(this._scale9Image){cc.Node.prototype.setOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setOpacity(a)}this._scale9Dirty=!0}},updateDisplayedOpacity:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedOpacity.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.updateDisplayedOpacity(a)}this._scale9Dirty=!0}},setColor:function(a){if(this._scale9Image){cc.Node.prototype.setColor.call(this,
a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&d.setColor(a)}this._scale9Dirty=!0}},updateDisplayedColor:function(a){if(this._scale9Image){cc.Node.prototype.updateDisplayedColor.call(this,a);for(var b=this._scale9Image.getChildren(),c=0;c<b.length;c++){var d=b[c];d&&(cc._renderType===cc._RENDER_TYPE_CANVAS?(cc.Node.prototype.updateDisplayedColor.call(d,a),(255!==a.r||255!==a.g||255!==a.b)&&(d._changeTextureColor(),d._setNodeDirtyForCache())):d.updateDisplayedColor(a))}this._scale9Dirty=
!0}},getCapInsets:function(){return cc.rect(this._capInsets)},setCapInsets:function(a){if(this._scale9Image){var b=this._contentSize,c=b.width,b=b.height;this.updateWithBatchNode(this._scale9Image,this._spriteRect,this._spriteFrameRotated,a);this.setContentSize(c,b)}},getInsetLeft:function(){return this._insetLeft},setInsetLeft:function(a){this._insetLeft=a;this._updateCapInset()},getInsetTop:function(){return this._insetTop},setInsetTop:function(a){this._insetTop=a;this._updateCapInset()},getInsetRight:function(){return this._insetRight},
setInsetRight:function(a){this._insetRight=a;this._updateCapInset()},getInsetBottom:function(){return this._insetBottom},setInsetBottom:function(a){this._insetBottom=a;this._updateCapInset()},setContentSize:function(a,b){cc.Node.prototype.setContentSize.call(this,a,b);this._positionsAreDirty=!0},_setWidth:function(a){cc.Node.prototype._setWidth.call(this,a);this._positionsAreDirty=!0},_setHeight:function(a){cc.Node.prototype._setHeight.call(this,a);this._positionsAreDirty=!0},visit:function(a){this._positionsAreDirty&&
(this._updatePositions(),this._positionsAreDirty=!1,this._scale9Dirty=!0);this._scale9Dirty&&cc._renderType===cc._RENDER_TYPE_CANVAS&&(this._scale9Dirty=!1,this._cacheScale9Sprite());cc.Node.prototype.visit.call(this,a)},init:function(){return this.initWithBatchNode(null,cc.rect(0,0,0,0),!1,cc.rect(0,0,0,0))},initWithBatchNode:function(a,b,c,d){return void 0===d&&(d=c,c=!1),a&&this.updateWithBatchNode(a,b,c,d),this.setCascadeColorEnabled(!0),this.setCascadeOpacityEnabled(!0),this.setAnchorPoint(.5,
.5),this._positionsAreDirty=!0,!0},initWithFile:function(a,b,c){if(a instanceof cc.Rect?(a=b,c=a,b=cc.rect(0,0,0,0)):(b=b||cc.rect(0,0,0,0),c=c||cc.rect(0,0,0,0)),!a)throw"ccui.Scale9Sprite.initWithFile(): file should be non-null";var d=cc.textureCache.getTextureForKey(a);d||(d=cc.textureCache.addImage(a));var e=d.isLoaded();return this._textureLoaded=e,e||d.addLoadedEventListener(function(a){var b=this._preferredSize,b=cc.size(b.width,b.height);a=a.getContentSize();this.updateWithBatchNode(this._scale9Image,
cc.rect(0,0,a.width,a.height),!1,this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this),this.initWithBatchNode(cc.SpriteBatchNode.create(a,9),b,!1,c)},initWithSpriteFrame:function(a,b){if(!a||!a.getTexture())throw"ccui.Scale9Sprite.initWithSpriteFrame(): spriteFrame should be non-null and its texture should be non-null";b=b||cc.rect(0,0,0,0);var c=a.textureLoaded();(this._textureLoaded=c)||a.addLoadedEventListener(function(a){var b=this._preferredSize,
b=cc.size(b.width,b.height);this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this);c=cc.SpriteBatchNode.create(a.getTexture(),9);return this.initWithBatchNode(c,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),b)},initWithSpriteFrameName:function(a,b){if(!a)throw"ccui.Scale9Sprite.initWithSpriteFrameName(): spriteFrameName should be non-null";
b=b||cc.rect(0,0,0,0);var c=cc.spriteFrameCache.getSpriteFrame(a);return null==c?(cc.log("ccui.Scale9Sprite.initWithSpriteFrameName(): can't find the sprite frame by spriteFrameName"),!1):this.initWithSpriteFrame(c,b)},resizableSpriteWithCapInsets:function(a){var b=new ccui.Scale9Sprite;return b&&b.initWithBatchNode(this._scale9Image,this._spriteRect,!1,a)?b:null},setOpacityModifyRGB:function(a){if(this._scale9Image){this._opacityModifyRGB=a;var b=this._scale9Image.getChildren();if(b)for(var c=0,
d=b.length;d>c;c++)b[c].setOpacityModifyRGB(a)}},isOpacityModifyRGB:function(){return this._opacityModifyRGB},updateWithBatchNode:function(a,b,c,d){var e=this.getOpacity(),f=this.getColor();b=cc.rect(b.x,b.y,b.width,b.height);if(this.removeAllChildren(!0),this._scale9Image!=a&&(this._scale9Image=a),!this._scale9Image)return!1;a=a.getTexture();var g=a.isLoaded();if(this._textureLoaded=g,!g)return a.addLoadedEventListener(function(){this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this),
!0;a=this._scale9Image;a.removeAllChildren(!0);g=this._capInsets;g.x=d.x;g.y=d.y;g.width=d.width;g.height=d.height;this._spriteFrameRotated=c;g=a.getTexture();cc._rectEqualToZero(b)&&(b=g.getContentSize(),b=cc.rect(0,0,b.width,b.height));var h=this._spriteRect=b;h.x=b.x;h.y=b.y;h.width=b.width;h.height=b.height;this._originalSize.width=b.width;this._originalSize.height=b.height;h=this._preferredSize;0===h.width&&0===h.height&&(h.width=b.width,h.height=b.height);h=this._capInsetsInternal;d&&(h.x=d.x,
h.y=d.y,h.width=d.width,h.height=d.height);var k=b.width;d=b.height;cc._rectEqualToZero(h)&&(h.x=k/3,h.y=d/3,h.width=k/3,h.height=d/3);var m=h.x,n=h.width,q=k-(m+n),r=h.y,s=h.height,u=d-(r+s),t=0,v=0;d=cc.rect(t+.5|0,v+.5|0,m+.5|0,r+.5|0);var t=t+m,h=cc.rect(t+.5|0,v+.5|0,n+.5|0,r+.5|0),k=cc.rect(t+n+.5|0,v+.5|0,q+.5|0,r+.5|0),t=0,v=0+r,w=cc.rect(t+.5|0,v+.5|0,m+.5|0,s+.5|0),t=t+m,x=cc.rect(t+.5|0,v+.5|0,n+.5|0,s+.5|0),t=t+n,y=cc.rect(t+.5|0,v+.5|0,q+.5|0,s+.5|0),t=0,v=0+r+s,r=cc.rect(t+.5|0,v+.5|
0,m+.5|0,u+.5|0),t=t+m,m=cc.rect(t+.5|0,v+.5|0,n+.5|0,u+.5|0),t=t+n,n=cc.rect(t+.5|0,v+.5|0,q+.5|0,u+.5|0),q=cc.affineTransformMakeIdentity();if(c){c=x;var u=n,t=r,v=k,s=d,z=y,A=w,B=m,C=h,q=cc.affineTransformTranslate(q,b.height+b.x,b.y),q=cc.affineTransformRotate(q,1.57079633),x=cc.rectApplyAffineTransform(x,q),n=cc.rectApplyAffineTransform(n,q),r=cc.rectApplyAffineTransform(r,q),k=cc.rectApplyAffineTransform(k,q);d=cc.rectApplyAffineTransform(d,q);y=cc.rectApplyAffineTransform(y,q);w=cc.rectApplyAffineTransform(w,
q);m=cc.rectApplyAffineTransform(m,q);h=cc.rectApplyAffineTransform(h,q);c.x=x.x;c.y=x.y;u.x=n.x;u.y=n.y;t.x=r.x;t.y=r.y;v.x=k.x;v.y=k.y;s.x=d.x;s.y=d.y;z.x=y.x;z.y=y.y;A.x=w.x;A.y=w.y;B.x=m.x;B.y=m.y;C.x=h.x;C.y=h.y;this._centre=new cc.Sprite;this._centre.initWithTexture(g,c,!0);a.addChild(this._centre,0,ccui.Scale9Sprite.POSITIONS_CENTRE);this._top=new cc.Sprite;this._top.initWithTexture(g,C,!0);a.addChild(this._top,1,ccui.Scale9Sprite.POSITIONS_TOP);this._bottom=new cc.Sprite;this._bottom.initWithTexture(g,
B,!0);a.addChild(this._bottom,1,ccui.Scale9Sprite.POSITIONS_BOTTOM);this._left=new cc.Sprite;this._left.initWithTexture(g,A,!0);a.addChild(this._left,1,ccui.Scale9Sprite.POSITIONS_LEFT);this._right=new cc.Sprite;this._right.initWithTexture(g,z,!0);a.addChild(this._right,1,ccui.Scale9Sprite.POSITIONS_RIGHT);this._topLeft=new cc.Sprite;this._topLeft.initWithTexture(g,s,!0);a.addChild(this._topLeft,2,ccui.Scale9Sprite.POSITIONS_TOPLEFT);this._topRight=new cc.Sprite;this._topRight.initWithTexture(g,v,
!0);a.addChild(this._topRight,2,ccui.Scale9Sprite.POSITIONS_TOPRIGHT);this._bottomLeft=new cc.Sprite;this._bottomLeft.initWithTexture(g,t,!0);a.addChild(this._bottomLeft,2,ccui.Scale9Sprite.POSITIONS_BOTTOMLEFT);this._bottomRight=new cc.Sprite;this._bottomRight.initWithTexture(g,u,!0)}else q=cc.affineTransformTranslate(q,b.x,b.y),cc._rectApplyAffineTransformIn(x,q),cc._rectApplyAffineTransformIn(n,q),cc._rectApplyAffineTransformIn(r,q),cc._rectApplyAffineTransformIn(k,q),cc._rectApplyAffineTransformIn(d,
q),cc._rectApplyAffineTransformIn(y,q),cc._rectApplyAffineTransformIn(w,q),cc._rectApplyAffineTransformIn(m,q),cc._rectApplyAffineTransformIn(h,q),this._centre=new cc.Sprite,this._centre.initWithTexture(g,x),a.addChild(this._centre,0,ccui.Scale9Sprite.POSITIONS_CENTRE),this._top=new cc.Sprite,this._top.initWithTexture(g,h),a.addChild(this._top,1,ccui.Scale9Sprite.POSITIONS_TOP),this._bottom=new cc.Sprite,this._bottom.initWithTexture(g,m),a.addChild(this._bottom,1,ccui.Scale9Sprite.POSITIONS_BOTTOM),
this._left=new cc.Sprite,this._left.initWithTexture(g,w),a.addChild(this._left,1,ccui.Scale9Sprite.POSITIONS_LEFT),this._right=new cc.Sprite,this._right.initWithTexture(g,y),a.addChild(this._right,1,ccui.Scale9Sprite.POSITIONS_RIGHT),this._topLeft=new cc.Sprite,this._topLeft.initWithTexture(g,d),a.addChild(this._topLeft,2,ccui.Scale9Sprite.POSITIONS_TOPLEFT),this._topRight=new cc.Sprite,this._topRight.initWithTexture(g,k),a.addChild(this._topRight,2,ccui.Scale9Sprite.POSITIONS_TOPRIGHT),this._bottomLeft=
new cc.Sprite,this._bottomLeft.initWithTexture(g,r),a.addChild(this._bottomLeft,2,ccui.Scale9Sprite.POSITIONS_BOTTOMLEFT),this._bottomRight=new cc.Sprite,this._bottomRight.initWithTexture(g,n);a.addChild(this._bottomRight,2,ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT);return this.setContentSize(b.width,b.height),cc._renderType===cc._RENDER_TYPE_WEBGL&&this.addChild(a),this._spritesGenerated&&(this.setOpacity(e),this.setColor(f)),this._spritesGenerated=!0,!0},setSpriteFrame:function(a){var b=cc.SpriteBatchNode.create(a.getTexture(),
9),c=a.textureLoaded();(this._textureLoaded=c)||a.addLoadedEventListener(function(a){var b=this._preferredSize,b=cc.size(b.width,b.height);this.updateWithBatchNode(this._scale9Image,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),this._capInsets);this.setPreferredSize(b);this._positionsAreDirty=!0;this._callLoadedEventCallbacks()},this);this.updateWithBatchNode(b,a.getRect(),cc._renderType==cc._RENDER_TYPE_WEBGL&&a.isRotated(),cc.rect(0,0,0,0));this._insetBottom=this._insetRight=
this._insetTop=this._insetLeft=0}});_p=ccui.Scale9Sprite.prototype;_p.preferredSize;cc.defineGetterSetter(_p,"preferredSize",_p.getPreferredSize,_p.setPreferredSize);_p.capInsets;cc.defineGetterSetter(_p,"capInsets",_p.getCapInsets,_p.setCapInsets);_p.insetLeft;cc.defineGetterSetter(_p,"insetLeft",_p.getInsetLeft,_p.setInsetLeft);_p.insetTop;cc.defineGetterSetter(_p,"insetTop",_p.getInsetTop,_p.setInsetTop);_p.insetRight;cc.defineGetterSetter(_p,"insetRight",_p.getInsetRight,_p.setInsetRight);_p.insetBottom;
cc.defineGetterSetter(_p,"insetBottom",_p.getInsetBottom,_p.setInsetBottom);_p=null;ccui.Scale9Sprite.create=function(a,b,c){return new ccui.Scale9Sprite(a,b,c)};ccui.Scale9Sprite.createWithSpriteFrame=function(a,b){return new ccui.Scale9Sprite(a,b)};ccui.Scale9Sprite.createWithSpriteFrameName=function(a,b){return new ccui.Scale9Sprite(a,b)};ccui.Scale9Sprite.POSITIONS_CENTRE=0;ccui.Scale9Sprite.POSITIONS_TOP=1;ccui.Scale9Sprite.POSITIONS_LEFT=2;ccui.Scale9Sprite.POSITIONS_RIGHT=3;
ccui.Scale9Sprite.POSITIONS_BOTTOM=4;ccui.Scale9Sprite.POSITIONS_TOPRIGHT=5;ccui.Scale9Sprite.POSITIONS_TOPLEFT=6;ccui.Scale9Sprite.POSITIONS_BOTTOMRIGHT=7;
ccui.Layout=ccui.Widget.extend({_clippingEnabled:!1,_backGroundScale9Enabled:null,_backGroundImage:null,_backGroundImageFileName:null,_backGroundImageCapInsets:null,_colorType:null,_bgImageTexType:ccui.Widget.LOCAL_TEXTURE,_colorRender:null,_gradientRender:null,_color:null,_startColor:null,_endColor:null,_alongVector:null,_opacity:255,_backGroundImageTextureSize:null,_layoutType:null,_doLayoutDirty:!0,_clippingRectDirty:!0,_clippingType:null,_clippingStencil:null,_handleScissor:!1,_scissorRectDirty:!1,
_clippingRect:null,_clippingParent:null,_className:"Layout",_backGroundImageColor:null,_finalPositionX:0,_finalPositionY:0,_currentStencilEnabled:0,_currentStencilWriteMask:0,_currentStencilFunc:0,_currentStencilRef:0,_currentStencilValueMask:0,_currentStencilFail:0,_currentStencilPassDepthFail:0,_currentStencilPassDepthPass:0,_currentDepthWriteMask:0,_currentAlphaTestEnabled:0,_currentAlphaTestFunc:0,_currentAlphaTestRef:0,_backGroundImageOpacity:0,_mask_layer_le:0,_loopFocus:!1,__passFocusToChild:!1,
_isFocusPassing:!1,ctor:function(){this._layoutType=ccui.Layout.ABSOLUTE;this._widgetType=ccui.Widget.TYPE_CONTAINER;this._clippingType=ccui.Layout.CLIPPING_STENCIL;this._colorType=ccui.Layout.BG_COLOR_NONE;ccui.Widget.prototype.ctor.call(this);this._backGroundImageCapInsets=cc.rect(0,0,0,0);this._color=cc.color(255,255,255,255);this._startColor=cc.color(255,255,255,255);this._endColor=cc.color(255,255,255,255);this._alongVector=cc.p(0,-1);this._backGroundImageTextureSize=cc.size(0,0);this._clippingRect=
cc.rect(0,0,0,0);this._backGroundImageColor=cc.color(255,255,255,255)},onEnter:function(){ccui.Widget.prototype.onEnter.call(this);this._clippingStencil&&this._clippingStencil.onEnter();this._clippingRectDirty=this._doLayoutDirty=!0},onExit:function(){ccui.Widget.prototype.onExit.call(this);this._clippingStencil&&this._clippingStencil.onExit()},setLoopFocus:function(a){this._loopFocus=a},isLoopFocus:function(){return this._loopFocus},setPassFocusToChild:function(a){this.__passFocusToChild=a},isPassFocusToChild:function(){return this.__passFocusToChild},
findNextFocusedWidget:function(a,b){if(this._isFocusPassing||this.isFocused()){var c=this.getParent();if(this._isFocusPassing=!1,this.__passFocusToChild){var d=this._passFocusToChild(a,b);return d instanceof ccui.Layout&&c?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,this)):d}return null==c?this:(c._isFocusPassing=!0,c.findNextFocusedWidget(a,this))}if(!(b.isFocused()||b instanceof ccui.Layout))return b;if(this._layoutType==ccui.Layout.LINEAR_HORIZONTAL)switch(a){case ccui.Widget.LEFT:return this._getPreviousFocusedWidget(a,
b);case ccui.Widget.RIGHT:return this._getNextFocusedWidget(a,b);case ccui.Widget.DOWN:case ccui.Widget.UP:return this._isLastWidgetInContainer(this,a)?this._isWidgetAncestorSupportLoopFocus(b,a)?this.findNextFocusedWidget(a,this):b:this.findNextFocusedWidget(a,this);default:return cc.assert(0,"Invalid Focus Direction"),b}else{if(this._layoutType!=ccui.Layout.LINEAR_VERTICAL)return cc.assert(0,"Un Supported Layout type, please use VBox and HBox instead!!!"),b;switch(a){case ccui.Widget.LEFT:case ccui.Widget.RIGHT:return this._isLastWidgetInContainer(this,
a)?this._isWidgetAncestorSupportLoopFocus(b,a)?this.findNextFocusedWidget(a,this):b:this.findNextFocusedWidget(a,this);case ccui.Widget.DOWN:return this._getNextFocusedWidget(a,b);case ccui.Widget.UP:return this._getPreviousFocusedWidget(a,b);default:return cc.assert(0,"Invalid Focus Direction"),b}}},onPassFocusToChild:null,init:function(){return ccui.Widget.prototype.init.call(this)?(this.ignoreContentAdaptWithSize(!1),this.setContentSize(cc.size(0,0)),this.setAnchorPoint(0,0),this.onPassFocusToChild=
this._findNearestChildWidgetIndex.bind(this),!0):!1},__stencilDraw:function(a){a=a||cc._renderContext;for(var b=this._clippingStencil,c=cc.view.getScaleX(),d=cc.view.getScaleY(),e=0;e<b._buffer.length;e++){var f=b._buffer[e].verts,g=f[0];a.beginPath();a.moveTo(g.x*c,-g.y*d);for(var g=1,h=f.length;h>g;g++)a.lineTo(f[g].x*c,-f[g].y*d)}},addChild:function(a,b,c){a instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(a);ccui.Widget.prototype.addChild.call(this,a,b,c);this._doLayoutDirty=
!0},removeChild:function(a,b){ccui.Widget.prototype.removeChild.call(this,a,b);this._doLayoutDirty=!0},removeAllChildren:function(a){ccui.Widget.prototype.removeAllChildren.call(this,a);this._doLayoutDirty=!0},removeAllChildrenWithCleanup:function(a){ccui.Widget.prototype.removeAllChildrenWithCleanup.call(this,a);this._doLayoutDirty=!0},isClippingEnabled:function(){return this._clippingEnabled},visit:function(a){if(this._visible)if(this._adaptRenderers(),this._doLayout(),this._clippingEnabled)switch(this._clippingType){case ccui.Layout.CLIPPING_STENCIL:this._stencilClippingVisit(a);
break;case ccui.Layout.CLIPPING_SCISSOR:this._scissorClippingVisit(a)}else ccui.Widget.prototype.visit.call(this,a)},_stencilClippingVisit:null,_stencilClippingVisitForWebGL:function(a){var b=a||cc._renderContext;if(this._clippingStencil&&this._clippingStencil.isVisible()){if(ccui.Layout._layer+1==cc.stencilBits)return ccui.Layout._visit_once=!0,ccui.Layout._visit_once&&(cc.log("Nesting more than "+cc.stencilBits+"stencils is not supported. Everything will be drawn without stencil for this node and its childs."),
ccui.Layout._visit_once=!1),void cc.Node.prototype.visit.call(this,a);ccui.Layout._layer++;var c=1<<ccui.Layout._layer,d=c|c-1;a=b.isEnabled(b.STENCIL_TEST);var e=b.getParameter(b.STENCIL_WRITEMASK),f=b.getParameter(b.STENCIL_FUNC),g=b.getParameter(b.STENCIL_REF),h=b.getParameter(b.STENCIL_VALUE_MASK),k=b.getParameter(b.STENCIL_FAIL),m=b.getParameter(b.STENCIL_PASS_DEPTH_FAIL),n=b.getParameter(b.STENCIL_PASS_DEPTH_PASS);b.enable(b.STENCIL_TEST);b.stencilMask(c);var q=b.getParameter(b.DEPTH_WRITEMASK);
b.depthMask(!1);b.stencilFunc(b.NEVER,c,c);b.stencilOp(b.ZERO,b.KEEP,b.KEEP);cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLPushMatrix();cc.kmGLLoadIdentity();cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLPushMatrix();cc.kmGLLoadIdentity();cc._drawingUtil.drawSolidRect(cc.p(-1,-1),cc.p(1,1),cc.color(255,255,255,255));cc.kmGLMatrixMode(cc.KM_GL_PROJECTION);cc.kmGLPopMatrix();cc.kmGLMatrixMode(cc.KM_GL_MODELVIEW);cc.kmGLPopMatrix();b.stencilFunc(b.NEVER,c,c);b.stencilOp(b.REPLACE,b.KEEP,b.KEEP);cc.kmGLPushMatrix();
this.transform();this._clippingStencil.visit();b.depthMask(q);b.stencilFunc(b.EQUAL,d,d);b.stencilOp(b.KEEP,b.KEEP,b.KEEP);d=c=0;this.sortAllChildren();this.sortAllProtectedChildren();for(var r,q=this._children,s=this._protectedChildren,u=q.length,t=s.length;u>c&&(r=q[c],r&&0>r.getLocalZOrder());c++)r.visit();for(;t>d&&(r=s[d],r&&0>r.getLocalZOrder());d++)r.visit();for(this.draw();u>c;c++)q[c].visit();for(;t>d;d++)s[d].visit();b.stencilFunc(f,g,h);b.stencilOp(k,m,n);b.stencilMask(e);a||b.disable(b.STENCIL_TEST);
ccui.Layout._layer--;cc.kmGLPopMatrix()}},_stencilClippingVisitForCanvas:function(a){if(this._clippingStencil&&this._clippingStencil.isVisible()){a=a||cc._renderContext;if(this._clippingStencil instanceof cc.Sprite){var b=a.canvas,c=ccui.Layout._getSharedCache();c.width=b.width;c.height=b.height;c.getContext("2d").drawImage(b,0,0);a.save();cc.ProtectedNode.prototype.visit.call(this,a);a.globalCompositeOperation="destination-in";this.transform(a);this._clippingStencil.visit();a.restore();a.save();
a.setTransform(1,0,0,1,0,0);a.globalCompositeOperation="destination-over";a.drawImage(c,0,0)}else{var d=this._children;a.save();this.transform(a);this._clippingStencil.visit(a);a.clip();this.sortAllChildren();this.sortAllProtectedChildren();for(var e,f=this._protectedChildren,g=d.length,h=f.length,c=0;g>c&&(b=d[c],b&&0>b._localZOrder);c++)b.visit(a);for(e=0;h>e&&(b=f[e],b&&0>b._localZOrder);e++)b.visit(a);for(;g>c;c++)d[c].visit(a);for(;h>e;e++)f[e].visit(a)}a.restore()}},_scissorClippingVisit:null,
_scissorClippingVisitForWebGL:function(a){var b=this._getClippingRect();a=a||cc._renderContext;this._handleScissor&&a.enable(a.SCISSOR_TEST);cc.view.setScissorInPoints(b.x,b.y,b.width,b.height);cc.Node.prototype.visit.call(this);this._handleScissor&&a.disable(a.SCISSOR_TEST)},setClippingEnabled:function(a){if(a!=this._clippingEnabled)switch(this._clippingEnabled=a,this._clippingType){case ccui.Layout.CLIPPING_STENCIL:a?(this._clippingStencil=cc.DrawNode.create(),cc._renderType===cc._RENDER_TYPE_CANVAS&&
(this._clippingStencil.draw=this.__stencilDraw.bind(this)),this._running&&this._clippingStencil.onEnter(),this._setStencilClippingSize(this._contentSize)):(this._running&&this._clippingStencil&&this._clippingStencil.onExit(),this._clippingStencil=null)}},setClippingType:function(a){if(a!=this._clippingType){var b=this.isClippingEnabled();this.setClippingEnabled(!1);this._clippingType=a;this.setClippingEnabled(b)}},getClippingType:function(){return this._clippingType},_setStencilClippingSize:function(a){if(this._clippingEnabled&&
this._clippingType==ccui.Layout.CLIPPING_STENCIL){var b=[];b[0]=cc.p(0,0);b[1]=cc.p(a.width,0);b[2]=cc.p(a.width,a.height);b[3]=cc.p(0,a.height);a=cc.color.GREEN;this._clippingStencil.clear();this._clippingStencil.drawPoly(b,4,a,0,a)}},_getClippingRect:function(){if(this._clippingRectDirty){var a,b=this.convertToWorldSpace(cc.p(0,0));a=this.nodeToWorldTransform();var c=this._contentSize.width*a.a,d=this._contentSize.height*a.d;for(a=this;a;)if(a=a.getParent(),a&&a instanceof ccui.Layout&&a.isClippingEnabled()){this._clippingParent=
a;break}if(this._clippingParent){a=this._clippingParent._getClippingRect();var e=b.x-c*this._anchorPoint.x,f=b.y-d*this._anchorPoint.y,g=c,h=d,k=b.x-a.x;0>k&&(e=a.x,g+=k);c=b.x+c-(a.x+a.width);0<c&&(g-=c);c=b.y+d-(a.y+a.height);0<c&&(h-=c);b=b.y-a.y;0>b&&(f=a.x,h+=b);0>g&&(g=0);0>h&&(h=0);this._clippingRect.x=e;this._clippingRect.y=f;this._clippingRect.width=g;this._clippingRect.height=h}else this._clippingRect.x=b.x-c*this._anchorPoint.x,this._clippingRect.y=b.y-d*this._anchorPoint.y,this._clippingRect.width=
c,this._clippingRect.height=d;this._clippingRectDirty=!1}return this._clippingRect},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);var a=this._contentSize;this._setStencilClippingSize(a);this._clippingRectDirty=this._doLayoutDirty=!0;this._backGroundImage&&(this._backGroundImage.setPosition(.5*a.width,.5*a.height),this._backGroundScale9Enabled&&this._backGroundImage instanceof ccui.Scale9Sprite&&this._backGroundImage.setPreferredSize(a));this._colorRender&&this._colorRender.setContentSize(a);
this._gradientRender&&this._gradientRender.setContentSize(a)},setBackGroundImageScale9Enabled:function(a){this._backGroundScale9Enabled!=a&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundScale9Enabled=a,this._addBackGroundImage(),this.setBackGroundImage(this._backGroundImageFileName,this._bgImageTexType),this.setBackGroundImageCapInsets(this._backGroundImageCapInsets))},isBackGroundImageScale9Enabled:function(){return this._backGroundScale9Enabled},setBackGroundImage:function(a,
b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;null==this._backGroundImage&&this._addBackGroundImage();this._backGroundImageFileName=a;this._bgImageTexType=b;var c=this._backGroundImage;if(this._backGroundScale9Enabled){switch(this._bgImageTexType){case ccui.Widget.LOCAL_TEXTURE:c.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:c.initWithSpriteFrameName(a)}c.setPreferredSize(this._contentSize)}else switch(this._bgImageTexType){case ccui.Widget.LOCAL_TEXTURE:c.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:c.initWithSpriteFrameName(a)}this._backGroundImageTextureSize=
c.getContentSize();c.setPosition(.5*this._contentSize.width,.5*this._contentSize.height);this._updateBackGroundImageColor()}},setBackGroundImageCapInsets:function(a){if(a){var b=this._backGroundImageCapInsets;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._backGroundScale9Enabled&&this._backGroundImage.setCapInsets(a)}},getBackGroundImageCapInsets:function(){return cc.rect(this._backGroundImageCapInsets)},_supplyTheLayoutParameterLackToChild:function(a){if(a)switch(this._layoutType){case ccui.Layout.LINEAR_HORIZONTAL:case ccui.Layout.LINEAR_VERTICAL:var b=
a.getLayoutParameter(ccui.LayoutParameter.LINEAR);b||a.setLayoutParameter(ccui.LinearLayoutParameter.create());break;case ccui.Layout.RELATIVE:(b=a.getLayoutParameter(ccui.LayoutParameter.RELATIVE))||a.setLayoutParameter(ccui.RelativeLayoutParameter.create())}},_addBackGroundImage:function(){this._backGroundScale9Enabled?(this._backGroundImage=ccui.Scale9Sprite.create(),this._backGroundImage.setPreferredSize(this._contentSize)):this._backGroundImage=cc.Sprite.create();this.addProtectedChild(this._backGroundImage,
ccui.Layout.BACKGROUND_IMAGE_ZORDER,-1);this._backGroundImage.setPosition(this._contentSize.width/2,this._contentSize.height/2)},removeBackGroundImage:function(){this._backGroundImage&&(this.removeProtectedChild(this._backGroundImage),this._backGroundImage=null,this._backGroundImageFileName="",this._backGroundImageTextureSize.width=0,this._backGroundImageTextureSize.height=0)},setBackGroundColorType:function(a){if(this._colorType!=a){switch(this._colorType){case ccui.Layout.BG_COLOR_NONE:this._colorRender&&
(this.removeProtectedChild(this._colorRender),this._colorRender=null);this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null);break;case ccui.Layout.BG_COLOR_SOLID:this._colorRender&&(this.removeProtectedChild(this._colorRender),this._colorRender=null);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender&&(this.removeProtectedChild(this._gradientRender),this._gradientRender=null)}switch(this._colorType=a,this._colorType){case ccui.Layout.BG_COLOR_SOLID:this._colorRender=
new cc.LayerColor;this._colorRender.setContentSize(this._contentSize);this._colorRender.setOpacity(this._opacity);this._colorRender.setColor(this._color);this.addProtectedChild(this._colorRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1);break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender=new cc.LayerGradient(cc.color(255,0,0,255),cc.color(0,255,0,255)),this._gradientRender.setContentSize(this._contentSize),this._gradientRender.setOpacity(this._opacity),this._gradientRender.setStartColor(this._startColor),
this._gradientRender.setEndColor(this._endColor),this._gradientRender.setVector(this._alongVector),this.addProtectedChild(this._gradientRender,ccui.Layout.BACKGROUND_RENDERER_ZORDER,-1)}}},getBackGroundColorType:function(){return this._colorType},setBackGroundColor:function(a,b){b?(this._startColor.r=a.r,this._startColor.g=a.g,this._startColor.b=a.b,this._gradientRender&&this._gradientRender.setStartColor(a),this._endColor.r=b.r,this._endColor.g=b.g,this._endColor.b=b.b,this._gradientRender&&this._gradientRender.setEndColor(b)):
(this._color.r=a.r,this._color.g=a.g,this._color.b=a.b,this._colorRender&&this._colorRender.setColor(a))},getBackGroundColor:function(){var a=this._color;return cc.color(a.r,a.g,a.b,a.a)},getBackGroundStartColor:function(){var a=this._startColor;return cc.color(a.r,a.g,a.b,a.a)},getBackGroundEndColor:function(){var a=this._endColor;return cc.color(a.r,a.g,a.b,a.a)},setBackGroundColorOpacity:function(a){switch(this._opacity=a,this._colorType){case ccui.Layout.BG_COLOR_SOLID:this._colorRender.setOpacity(a);
break;case ccui.Layout.BG_COLOR_GRADIENT:this._gradientRender.setOpacity(a)}},getBackGroundColorOpacity:function(){return this._opacity},setBackGroundColorVector:function(a){this._alongVector.x=a.x;this._alongVector.y=a.y;this._gradientRender&&this._gradientRender.setVector(a)},getBackGroundColorVector:function(){return this._alongVector},setBackGroundImageColor:function(a){this._backGroundImageColor.r=a.r;this._backGroundImageColor.g=a.g;this._backGroundImageColor.b=a.b;this._updateBackGroundImageColor()},
setBackGroundImageOpacity:function(a){this._backGroundImageColor.a=a;this.getBackGroundImageColor()},getBackGroundImageColor:function(){var a=this._backGroundImageColor;return cc.color(a.r,a.g,a.b,a.a)},getBackGroundImageOpacity:function(){return this._backGroundImageColor.a},_updateBackGroundImageColor:function(){this._backGroundImage&&this._backGroundImage.setColor(this._backGroundImageColor)},getBackGroundImageTextureSize:function(){return this._backGroundImageTextureSize},setLayoutType:function(a){this._layoutType=
a;a=this._children;for(var b=null,c=0;c<a.length;c++)b=a[c],b instanceof ccui.Widget&&this._supplyTheLayoutParameterLackToChild(b);this._doLayoutDirty=!0},getLayoutType:function(){return this._layoutType},requestDoLayout:function(){this._doLayoutDirty=!0},_doLayout:function(){if(this._doLayoutDirty){this.sortAllChildren();var a=ccui.getLayoutManager(this._layoutType);a&&a._doLayout(this);this._doLayoutDirty=!1}},_getLayoutContentSize:function(){return this.getContentSize()},_getLayoutElements:function(){return this.getChildren()},
_onBeforeVisitStencil:function(){},_drawFullScreenQuadClearStencil:function(){},_onAfterDrawStencil:function(){},_onAfterVisitStencil:function(){},_onAfterVisitScissor:function(){},_onAfterVisitScissor:function(){},_updateBackGroundImageOpacity:function(){this._backGroundImage&&this._backGroundImage.setOpacity(this._backGroundImageOpacity)},_updateBackGroundImageRGBA:function(){this._backGroundImage&&(this._backGroundImage.setColor(this._backGroundImageColor),this._backGroundImage.setOpacity(this._backGroundImageOpacity))},
_getLayoutAccumulatedSize:function(){for(var a,b=this.getChildren(),c=cc.size(0,0),d=0,e=0,f=b.length;f>e;e++)if(a=b[e],null!=a&&a instanceof ccui.Layout)a=a._getLayoutAccumulatedSize(),c.width+=a.width,c.height+=a.height;else if(a instanceof ccui.Widget){d++;var g=a.getLayoutParameter().getMargin();a=a.getContentSize();c.width+=a.width+.5*(g.right+g.left);c.height+=a.height+.5*(g.top+g.bottom)}b=this.getLayoutType();return b==ccui.Layout.LINEAR_HORIZONTAL&&(c.height-=c.height/d*(d-1)),b==ccui.Layout.LINEAR_VERTICAL&&
(c.width-=c.width/d*(d-1)),c},_findNearestChildWidgetIndex:function(a,b){if(null==b||b==this)return this._findFirstFocusEnabledWidgetIndex();var c,d=0,e=this.getChildren(),f=e.length,g=cc.FLT_MAX,h=0;if(a==ccui.Widget.LEFT||a==ccui.Widget.RIGHT||a==ccui.Widget.DOWN||a==ccui.Widget.UP){for(c=this._getWorldCenterPoint(b);f>d;){var k=e[d];k&&k instanceof ccui.Widget&&k.isFocusEnabled()&&(k=k instanceof ccui.Layout?k._calculateNearestDistance(b):cc.pLength(cc.pSub(this._getWorldCenterPoint(k),c)),g>k&&
(h=d,g=k));d++}return h}return cc.log("invalid focus direction!"),0},_findFarthestChildWidgetIndex:function(a,b){if(null==b||b==this)return this._findFirstFocusEnabledWidgetIndex();var c=0,d=this.getChildren(),e=d.length,f=-cc.FLT_MAX,g=0;if(a==ccui.Widget.LEFT||a==ccui.Widget.RIGHT||a==ccui.Widget.DOWN||a==ccui.Widget.UP){for(var h=this._getWorldCenterPoint(b);e>c;){var k=d[c];k&&k instanceof ccui.Widget&&k.isFocusEnabled()&&(k=k instanceof ccui.Layout?k._calculateFarthestDistance(b):cc.pLength(cc.pSub(this._getWorldCenterPoint(k),
h)),k>f&&(g=c,f=k));c++}return g}return cc.log("invalid focus direction!!!"),0},_calculateNearestDistance:function(a){for(var b=cc.FLT_MAX,c=this._getWorldCenterPoint(a),d=this._children,e=0,f=d.length;f>e;e++){var g;g=d[e];if(g instanceof ccui.Layout)g=g._calculateNearestDistance(a);else{if(!(g instanceof ccui.Widget&&g.isFocusEnabled()))continue;g=cc.pLength(cc.pSub(this._getWorldCenterPoint(g),c))}b>g&&(b=g)}return b},_calculateFarthestDistance:function(a){for(var b=-cc.FLT_MAX,c=this._getWorldCenterPoint(a),
d=this._children,e=0,f=d.length;f>e;e++){var g;g=d[e];if(g instanceof ccui.Layout)g=g._calculateFarthestDistance(a);else{if(!(g instanceof ccui.Widget&&g.isFocusEnabled()))continue;g=this._getWorldCenterPoint(g);g=cc.pLength(cc.pSub(g,c))}g>b&&(b=g)}return b},_findProperSearchingFunctor:function(a,b){if(null!=b){var c=this._getWorldCenterPoint(b),d=this._getWorldCenterPoint(this._findFirstNonLayoutWidget());a==ccui.Widget.LEFT?this.onPassFocusToChild=c.x>d.x?this._findNearestChildWidgetIndex.bind(this):
this._findFarthestChildWidgetIndex.bind(this):a==ccui.Widget.RIGHT?this.onPassFocusToChild=c.x>d.x?this._findFarthestChildWidgetIndex.bind(this):this._findNearestChildWidgetIndex.bind(this):a==ccui.Widget.DOWN?this.onPassFocusToChild=c.y>d.y?this._findNearestChildWidgetIndex.bind(this):this._findFarthestChildWidgetIndex.bind(this):a==ccui.Widget.UP?this.onPassFocusToChild=c.y<d.y?this._findNearestChildWidgetIndex.bind(this):this._findFarthestChildWidgetIndex.bind(this):cc.log("invalid direction!")}},
_findFirstNonLayoutWidget:function(){for(var a=this._children,b=0,c=a.length;c>b;b++){var d=a[b];if(d instanceof ccui.Layout){if(d=d._findFirstNonLayoutWidget())return d}else if(d instanceof cc.Widget)return d}return null},_findFirstFocusEnabledWidgetIndex:function(){for(var a=0,b=this.getChildren(),c=b.length;c>a;){var d=b[a];if(d&&d instanceof ccui.Widget&&d.isFocusEnabled())return a;a++}return 0},_findFocusEnabledChildWidgetByIndex:function(a){var b=this._getChildWidgetByIndex(a);return b?b.isFocusEnabled()?
b:(a+=1,this._findFocusEnabledChildWidgetByIndex(a)):null},_getWorldCenterPoint:function(a){var b=a instanceof ccui.Layout?a._getLayoutAccumulatedSize():a.getContentSize();return a.convertToWorldSpace(cc.p(b.width/2,b.height/2))},_getNextFocusedWidget:function(a,b){var c=null,d=this._children,e=d.indexOf(b);return e+=1,e<d.length?(c=this._getChildWidgetByIndex(e),c?c.isFocusEnabled()?c instanceof ccui.Layout?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,c)):(this.dispatchFocusEvent(b,c),c):this._getNextFocusedWidget(a,
c):b):this._loopFocus?this._checkFocusEnabledChild()?(e=0,c=this._getChildWidgetByIndex(e),c.isFocusEnabled()?c instanceof ccui.Layout?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,c)):(this.dispatchFocusEvent(b,c),c):this._getNextFocusedWidget(a,c)):b instanceof ccui.Layout?b:this._focusedWidget:this._isLastWidgetInContainer(b,a)?this._isWidgetAncestorSupportLoopFocus(this,a)?this.findNextFocusedWidget(a,this):b instanceof ccui.Layout?b:this._focusedWidget:this.findNextFocusedWidget(a,this)},_getPreviousFocusedWidget:function(a,
b){var c=null,d=this._children,e=d.indexOf(b);return e-=1,0<=e?(c=this._getChildWidgetByIndex(e),c.isFocusEnabled()?c instanceof ccui.Layout?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,c)):(this.dispatchFocusEvent(b,c),c):this._getPreviousFocusedWidget(a,c)):this._loopFocus?this._checkFocusEnabledChild()?(e=d.length-1,c=this._getChildWidgetByIndex(e),c.isFocusEnabled()?c instanceof ccui.Layout?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,c)):(this.dispatchFocusEvent(b,c),c):this._getPreviousFocusedWidget(a,
c)):b instanceof ccui.Layout?b:this._focusedWidget:this._isLastWidgetInContainer(b,a)?this._isWidgetAncestorSupportLoopFocus(this,a)?this.findNextFocusedWidget(a,this):b instanceof ccui.Layout?b:this._focusedWidget:this.findNextFocusedWidget(a,this)},_getChildWidgetByIndex:function(a){for(var b=this._children,c=b.length,d=0,e=a;c>a;){var f=b[a];if(f&&f instanceof ccui.Widget)return f;d++;a++}for(a=0;e>a;){if((c=b[a])&&c instanceof ccui.Widget)return c;d++;a++}return null},_isLastWidgetInContainer:function(a,
b){var c=a.getParent();if(c instanceof ccui.Layout)return!0;var d=c.getChildren(),e=d.indexOf(a);if(c.getLayoutType()==ccui.Layout.LINEAR_HORIZONTAL){if(b==ccui.Widget.LEFT)return 0==e?this._isLastWidgetInContainer(c,b):!1;if(b==ccui.Widget.RIGHT)return e==d.length-1?this._isLastWidgetInContainer(c,b):!1;if(b==ccui.Widget.DOWN||b==ccui.Widget.UP)return this._isLastWidgetInContainer(c,b)}else{if(c.getLayoutType()!=ccui.Layout.LINEAR_VERTICAL)return cc.log("invalid layout Type"),!1;if(b==ccui.Widget.UP)return 0==
e?this._isLastWidgetInContainer(c,b):!1;if(b==ccui.Widget.DOWN)return e==d.length-1?this._isLastWidgetInContainer(c,b):!1;if(b==ccui.Widget.LEFT||b==ccui.Widget.RIGHT)return this._isLastWidgetInContainer(c,b)}},_isWidgetAncestorSupportLoopFocus:function(a,b){var c=a.getParent();if(null==c)return!1;if(!c.isLoopFocus())return this._isWidgetAncestorSupportLoopFocus(c,b);var d=c.getLayoutType();return d==ccui.Layout.LINEAR_HORIZONTAL?b==ccui.Widget.LEFT||b==ccui.Widget.RIGHT?!0:this._isWidgetAncestorSupportLoopFocus(c,
b):d==ccui.Layout.LINEAR_VERTICAL?b==ccui.Widget.DOWN||b==ccui.Widget.UP?!0:this._isWidgetAncestorSupportLoopFocus(c,b):void cc.assert(0,"invalid layout type")},_passFocusToChild:function(a,b){if(this._checkFocusEnabledChild()){var c=ccui.Widget.getCurrentFocusedWidget();this._findProperSearchingFunctor(a,c);c=this.onPassFocusToChild(a,c);c=this._getChildWidgetByIndex(c);return c instanceof ccui.Layout?(c._isFocusPassing=!0,c.findNextFocusedWidget(a,c)):(this.dispatchFocusEvent(b,c),c)}return this},
_checkFocusEnabledChild:function(){for(var a=this._children,b=0,c=a.length;c>b;b++){var d=a[b];if(d&&d instanceof ccui.Widget&&d.isFocusEnabled())return!0}return!1},getDescription:function(){return"Layout"},_createCloneInstance:function(){return ccui.Layout.create()},_copyClonedWidgetChildren:function(a){ccui.Widget.prototype._copyClonedWidgetChildren.call(this,a)},_copySpecialProperties:function(a){a instanceof ccui.Layout&&(this.setBackGroundImageScale9Enabled(a._backGroundScale9Enabled),this.setBackGroundImage(a._backGroundImageFileName,
a._bgImageTexType),this.setBackGroundImageCapInsets(a._backGroundImageCapInsets),this.setBackGroundColorType(a._colorType),this.setBackGroundColor(a._color),this.setBackGroundColor(a._startColor,a._endColor),this.setBackGroundColorOpacity(a._opacity),this.setBackGroundColorVector(a._alongVector),this.setLayoutType(a._layoutType),this.setClippingEnabled(a._clippingEnabled),this.setClippingType(a._clippingType),this._loopFocus=a._loopFocus,this.__passFocusToChild=a.__passFocusToChild)}});
ccui.Layout._init_once=null;ccui.Layout._visit_once=null;ccui.Layout._layer=-1;ccui.Layout._sharedCache=null;cc._renderType==cc._RENDER_TYPE_WEBGL?(ccui.Layout.prototype._stencilClippingVisit=ccui.Layout.prototype._stencilClippingVisitForWebGL,ccui.Layout.prototype._scissorClippingVisit=ccui.Layout.prototype._scissorClippingVisitForWebGL):(ccui.Layout.prototype._stencilClippingVisit=ccui.Layout.prototype._stencilClippingVisitForCanvas,ccui.Layout.prototype._scissorClippingVisit=ccui.Layout.prototype._stencilClippingVisitForCanvas);
ccui.Layout._getSharedCache=function(){return cc.ClippingNode._sharedCache||(cc.ClippingNode._sharedCache=cc.newElement("canvas"))};_p=ccui.Layout.prototype;_p.clippingEnabled;cc.defineGetterSetter(_p,"clippingEnabled",_p.isClippingEnabled,_p.setClippingEnabled);_p.clippingType;cc.defineGetterSetter(_p,"clippingType",null,_p.setClippingType);_p.layoutType;cc.defineGetterSetter(_p,"layoutType",_p.getLayoutType,_p.setLayoutType);_p=null;ccui.Layout.create=function(){return new ccui.Layout};
ccui.Layout.BG_COLOR_NONE=0;ccui.Layout.BG_COLOR_SOLID=1;ccui.Layout.BG_COLOR_GRADIENT=2;ccui.Layout.ABSOLUTE=0;ccui.Layout.LINEAR_VERTICAL=1;ccui.Layout.LINEAR_HORIZONTAL=2;ccui.Layout.RELATIVE=3;ccui.Layout.CLIPPING_STENCIL=0;ccui.Layout.CLIPPING_SCISSOR=1;ccui.Layout.BACKGROUND_IMAGE_ZORDER=-2;ccui.Layout.BACKGROUND_RENDERER_ZORDER=-2;
ccui.Margin=ccui.Class.extend({left:0,top:0,right:0,bottom:0,ctor:function(a,b,c,d){a&&void 0===b&&(this.left=a.left,this.top=a.top,this.right=a.right,this.bottom=a.bottom);void 0!==d&&(this.left=a,this.top=b,this.right=c,this.bottom=d)},setMargin:function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d},equals:function(a){return this.left==a.left&&this.top==a.top&&this.right==a.right&&this.bottom==a.bottom}});ccui.MarginZero=function(){return new ccui.Margin(0,0,0,0)};
ccui.LayoutParameter=ccui.Class.extend({_margin:null,_layoutParameterType:null,ctor:function(){this._margin=new ccui.Margin;this._layoutParameterType=ccui.LayoutParameter.NONE},setMargin:function(a,b,c,d){"object"==typeof a?(this._margin.left=a.left,this._margin.top=a.top,this._margin.right=a.right,this._margin.bottom=a.bottom):(this._margin.left=a,this._margin.top=b,this._margin.right=c,this._margin.bottom=d)},getMargin:function(){return this._margin},getLayoutType:function(){return this._layoutParameterType},
clone:function(){var a=this._createCloneInstance();return a._copyProperties(this),a},_createCloneInstance:function(){return new ccui.LayoutParameter},_copyProperties:function(a){this._margin.bottom=a._margin.bottom;this._margin.left=a._margin.left;this._margin.right=a._margin.right;this._margin.top=a._margin.top}});ccui.LayoutParameter.create=function(){return new ccui.LayoutParameter};ccui.LayoutParameter.NONE=0;ccui.LayoutParameter.LINEAR=1;ccui.LayoutParameter.RELATIVE=2;
ccui.LinearLayoutParameter=ccui.LayoutParameter.extend({_linearGravity:null,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this);this._linearGravity=ccui.LinearLayoutParameter.NONE;this._layoutParameterType=ccui.LayoutParameter.LINEAR},setGravity:function(a){this._linearGravity=a},getGravity:function(){return this._linearGravity},_createCloneInstance:function(){return ccui.LinearLayoutParameter.create()},_copyProperties:function(a){ccui.LayoutParameter.prototype._copyProperties.call(this,
a);a instanceof ccui.LinearLayoutParameter&&this.setGravity(a._linearGravity)}});ccui.LinearLayoutParameter.create=function(){return new ccui.LinearLayoutParameter};ccui.LinearLayoutParameter.NONE=0;ccui.LinearLayoutParameter.LEFT=1;ccui.LinearLayoutParameter.TOP=2;ccui.LinearLayoutParameter.RIGHT=3;ccui.LinearLayoutParameter.BOTTOM=4;ccui.LinearLayoutParameter.CENTER_VERTICAL=5;ccui.LinearLayoutParameter.CENTER_HORIZONTAL=6;
ccui.RelativeLayoutParameter=ccui.LayoutParameter.extend({_relativeAlign:null,_relativeWidgetName:"",_relativeLayoutName:"",_put:!1,ctor:function(){ccui.LayoutParameter.prototype.ctor.call(this);this._relativeAlign=ccui.RelativeLayoutParameter.NONE;this._relativeLayoutName=this._relativeWidgetName="";this._put=!1;this._layoutParameterType=ccui.LayoutParameter.RELATIVE},setAlign:function(a){this._relativeAlign=a},getAlign:function(){return this._relativeAlign},setRelativeToWidgetName:function(a){this._relativeWidgetName=
a},getRelativeToWidgetName:function(){return this._relativeWidgetName},setRelativeName:function(a){this._relativeLayoutName=a},getRelativeName:function(){return this._relativeLayoutName},_createCloneInstance:function(){return ccui.RelativeLayoutParameter.create()},_copyProperties:function(a){ccui.LayoutParameter.prototype._copyProperties.call(this,a);a instanceof ccui.RelativeLayoutParameter&&(this.setAlign(a._relativeAlign),this.setRelativeToWidgetName(a._relativeWidgetName),this.setRelativeName(a._relativeLayoutName))}});
ccui.RelativeLayoutParameter.create=function(){return new ccui.RelativeLayoutParameter};ccui.RelativeLayoutParameter.NONE=0;ccui.RelativeLayoutParameter.PARENT_TOP_LEFT=1;ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL=2;ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT=3;ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL=4;ccui.RelativeLayoutParameter.CENTER_IN_PARENT=5;ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL=6;ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM=7;
ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL=8;ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM=9;ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN=10;ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER=11;ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN=12;ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN=13;ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER=14;ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN=15;
ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN=16;ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER=17;ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN=18;ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN=19;ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER=20;ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN=21;ccui.LINEAR_GRAVITY_NONE=0;ccui.LINEAR_GRAVITY_LEFT=1;ccui.LINEAR_GRAVITY_TOP=2;ccui.LINEAR_GRAVITY_RIGHT=3;ccui.LINEAR_GRAVITY_BOTTOM=4;
ccui.LINEAR_GRAVITY_CENTER_VERTICAL=5;ccui.LINEAR_GRAVITY_CENTER_HORIZONTAL=6;ccui.RELATIVE_ALIGN_NONE=0;ccui.RELATIVE_ALIGN_PARENT_TOP_LEFT=1;ccui.RELATIVE_ALIGN_PARENT_TOP_CENTER_HORIZONTAL=2;ccui.RELATIVE_ALIGN_PARENT_TOP_RIGHT=3;ccui.RELATIVE_ALIGN_PARENT_LEFT_CENTER_VERTICAL=4;ccui.RELATIVE_ALIGN_PARENT_CENTER=5;ccui.RELATIVE_ALIGN_PARENT_RIGHT_CENTER_VERTICAL=6;ccui.RELATIVE_ALIGN_PARENT_LEFT_BOTTOM=7;ccui.RELATIVE_ALIGN_PARENT_BOTTOM_CENTER_HORIZONTAL=8;
ccui.RELATIVE_ALIGN_PARENT_RIGHT_BOTTOM=9;ccui.RELATIVE_ALIGN_LOCATION_ABOVE_LEFT=10;ccui.RELATIVE_ALIGN_LOCATION_ABOVE_CENTER=11;ccui.RELATIVE_ALIGN_LOCATION_ABOVE_RIGHT=12;ccui.RELATIVE_ALIGN_LOCATION_LEFT_TOP=13;ccui.RELATIVE_ALIGN_LOCATION_LEFT_CENTER=14;ccui.RELATIVE_ALIGN_LOCATION_LEFT_BOTTOM=15;ccui.RELATIVE_ALIGN_LOCATION_RIGHT_TOP=16;ccui.RELATIVE_ALIGN_LOCATION_RIGHT_CENTER=17;ccui.RELATIVE_ALIGN_LOCATION_RIGHT_BOTTOM=18;ccui.RELATIVE_ALIGN_LOCATION_BELOW_TOP=19;
ccui.RELATIVE_ALIGN_LOCATION_BELOW_CENTER=20;ccui.RELATIVE_ALIGN_LOCATION_BELOW_BOTTOM=21;ccui.getLayoutManager=function(a){switch(a){case ccui.Layout.LINEAR_VERTICAL:return ccui.linearVerticalLayoutManager;case ccui.Layout.LINEAR_HORIZONTAL:return ccui.linearHorizontalLayoutManager;case ccui.Layout.RELATIVE:return ccui.relativeLayoutManager}return null};
ccui.linearVerticalLayoutManager={_doLayout:function(a){var b=a._getLayoutContentSize();a=a._getLayoutElements();for(var c=b.height,d=0,e=a.length;e>d;d++){var f=a[d];if(f){var g=f.getLayoutParameter();if(g){var h=g.getGravity(),k=f.getAnchorPoint(),m=f.getContentSize(),n=k.x*m.width,c=c-(1-k.y)*m.height;switch(h){case ccui.LinearLayoutParameter.RIGHT:n=b.width-(1-k.x)*m.width;break;case ccui.LinearLayoutParameter.CENTER_HORIZONTAL:n=b.width/2-m.width*(.5-k.x)}g=g.getMargin();n+=g.left;c-=g.top;f.setPosition(n,
c);c=f.getPositionY()-f.getAnchorPoint().y*f.getContentSize().height-g.bottom}}}}};
ccui.linearHorizontalLayoutManager={_doLayout:function(a){var b=a._getLayoutContentSize();a=a._getLayoutElements();for(var c=0,d=0,e=a.length;e>d;d++){var f=a[d];if(f){var g=f.getLayoutParameter();if(g){var h=g.getGravity(),k=f.getAnchorPoint(),m=f.getSize(),c=c+k.x*m.width,n=b.height-(1-k.y)*m.height;switch(h){case ccui.LinearLayoutParameter.BOTTOM:n=k.y*m.height;break;case ccui.LinearLayoutParameter.CENTER_VERTICAL:n=b.height/2-m.height*(.5-k.y)}g=g.getMargin();c+=g.left;n-=g.top;f.setPosition(c,
n);c=f.getRightBoundary()+g.right}}}}};
ccui.relativeLayoutManager={_unlayoutChildCount:0,_widgetChildren:[],_widget:null,_finalPositionX:0,_finalPositionY:0,_relativeWidgetLP:null,_doLayout:function(a){for(var b=this._widgetChildren=this._getAllWidgets(a);0<this._unlayoutChildCount;){for(var c=0,d=b.length;d>c;c++){this._widget=b[c];var e=this._widget.getLayoutParameter();e&&!e._put&&this._calculateFinalPositionWithRelativeWidget(a)&&(this._calculateFinalPositionWithRelativeAlign(),this._widget.setPosition(this._finalPositionX,this._finalPositionY),
e._put=!0)}this._unlayoutChildCount--}this._widgetChildren.length=0},_getAllWidgets:function(a){a=a._getLayoutElements();for(var b=this._widgetChildren,c=b.length=0,d=a.length;d>c;c++){var e=a[c];e&&(e.getLayoutParameter()._put=!1,this._unlayoutChildCount++,b.push(e))}return b},_getRelativeWidget:function(a){var b=null;if((a=a.getLayoutParameter().getRelativeToWidgetName())&&0!=a.length)for(var c=this._widgetChildren,d=0,e=c.length;e>d;d++){var f=c[d];if(f){var g=f.getLayoutParameter();if(g&&g.getRelativeName()==
a){b=f;this._relativeWidgetLP=g;break}}}return b},_calculateFinalPositionWithRelativeWidget:function(a){var b=this._widget,c=b.getAnchorPoint(),d=b.getContentSize();this._finalPositionY=this._finalPositionX=0;var e=this._getRelativeWidget(b),b=b.getLayoutParameter().getAlign();a=a._getLayoutContentSize();switch(b){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX=c.x*d.width;this._finalPositionY=a.height-(1-c.y)*d.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionX=
.5*a.width-d.width*(.5-c.x);this._finalPositionY=a.height-(1-c.y)*d.height;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX=a.width-(1-c.x)*d.width;this._finalPositionY=a.height-(1-c.y)*d.height;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX=c.x*d.width;this._finalPositionY=.5*a.height-d.height*(.5-c.y);break;case ccui.RelativeLayoutParameter.CENTER_IN_PARENT:this._finalPositionX=.5*a.width-d.width*(.5-c.x);this._finalPositionY=
.5*a.height-d.height*(.5-c.y);break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX=a.width-(1-c.x)*d.width;this._finalPositionY=.5*a.height-d.height*(.5-c.y);break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX=c.x*d.width;this._finalPositionY=c.y*d.height;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionX=.5*a.width-d.width*(.5-c.x);this._finalPositionY=c.y*d.height;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX=
a.width-(1-c.x)*d.width;this._finalPositionY=c.y*d.height;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getTopBoundary()+c.y*d.height;this._finalPositionX=e.getLeftBoundary()+c.x*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=e.getContentSize();this._finalPositionY=e.getTopBoundary()+c.y*d.height;
this._finalPositionX=e.getLeftBoundary()+.5*a.width+c.x*d.width-.5*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getTopBoundary()+c.y*d.height;this._finalPositionX=e.getRightBoundary()-(1-c.x)*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getTopBoundary()-(1-
c.y)*d.height;this._finalPositionX=e.getLeftBoundary()-(1-c.x)*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=e.getContentSize();this._finalPositionX=e.getLeftBoundary()-(1-c.x)*d.width;this._finalPositionY=e.getBottomBoundary()+.5*a.height+c.y*d.height-.5*d.height}break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;
this._finalPositionY=e.getBottomBoundary()+c.y*d.height;this._finalPositionX=e.getLeftBoundary()-(1-c.x)*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getTopBoundary()-(1-c.y)*d.height;this._finalPositionX=e.getRightBoundary()+c.x*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=e.getContentSize();
this._finalPositionX=e.getRightBoundary()+c.x*d.width;this._finalPositionY=e.getBottomBoundary()+.5*a.height+c.y*d.height-.5*d.height}break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getBottomBoundary()+c.y*d.height;this._finalPositionX=e.getRightBoundary()+c.x*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;
this._finalPositionY=e.getBottomBoundary()-(1-c.y)*d.height;this._finalPositionX=e.getLeftBoundary()+c.x*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:if(e){if(this._relativeWidgetLP&&!this._relativeWidgetLP._put)return!1;a=e.getContentSize();this._finalPositionY=e.getBottomBoundary()-(1-c.y)*d.height;this._finalPositionX=e.getLeftBoundary()+.5*a.width+c.x*d.width-.5*d.width}break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:if(e){if(this._relativeWidgetLP&&
!this._relativeWidgetLP._put)return!1;this._finalPositionY=e.getBottomBoundary()-(1-c.y)*d.height;this._finalPositionX=e.getRightBoundary()-(1-c.x)*d.width}}return!0},_calculateFinalPositionWithRelativeAlign:function(){var a=this._widget.getLayoutParameter(),b=a.getMargin();switch(a.getAlign()){case ccui.RelativeLayoutParameter.NONE:case ccui.RelativeLayoutParameter.PARENT_TOP_LEFT:this._finalPositionX+=b.left;this._finalPositionY-=b.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_CENTER_HORIZONTAL:this._finalPositionY-=
b.top;break;case ccui.RelativeLayoutParameter.PARENT_TOP_RIGHT:this._finalPositionX-=b.right;this._finalPositionY-=b.top;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_CENTER_VERTICAL:this._finalPositionX+=b.left;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_CENTER_VERTICAL:this._finalPositionX-=b.right;break;case ccui.RelativeLayoutParameter.PARENT_LEFT_BOTTOM:this._finalPositionX+=b.left;this._finalPositionY+=b.bottom;break;case ccui.RelativeLayoutParameter.PARENT_BOTTOM_CENTER_HORIZONTAL:this._finalPositionY+=
b.bottom;break;case ccui.RelativeLayoutParameter.PARENT_RIGHT_BOTTOM:this._finalPositionX-=b.right;this._finalPositionY+=b.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_LEFTALIGN:this._finalPositionY+=b.bottom;this._finalPositionX+=b.left;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_RIGHTALIGN:this._finalPositionY+=b.bottom;this._finalPositionX-=b.right;break;case ccui.RelativeLayoutParameter.LOCATION_ABOVE_CENTER:this._finalPositionY+=b.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_TOPALIGN:this._finalPositionX-=
b.right;this._finalPositionY-=b.top;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_BOTTOMALIGN:this._finalPositionX-=b.right;this._finalPositionY+=b.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_LEFT_OF_CENTER:this._finalPositionX-=b.right;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_TOPALIGN:this._finalPositionX+=b.left;this._finalPositionY-=b.top;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_BOTTOMALIGN:this._finalPositionX+=b.left;this._finalPositionY+=
b.bottom;break;case ccui.RelativeLayoutParameter.LOCATION_RIGHT_OF_CENTER:this._finalPositionX+=b.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_LEFTALIGN:this._finalPositionY-=b.top;this._finalPositionX+=b.left;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_RIGHTALIGN:this._finalPositionY-=b.top;this._finalPositionX-=b.right;break;case ccui.RelativeLayoutParameter.LOCATION_BELOW_CENTER:this._finalPositionY-=b.top}}};
ccui.HBox=ccui.Layout.extend({ctor:function(a){a?this.initWithSize(a):this.init()},init:function(){return ccui.Layout.prototype.init.call(this)?(this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL),!0):!1},initWithSize:function(a){return this.init()?(this.setContentSize(a),!0):!1}});ccui.HBox.create=function(a){return new ccui.HBox(a)};
ccui.RelativeBox=ccui.Layout.extend({ctor:function(a){a?this.initWithSize(a):this.init()},init:function(){return ccui.Layout.prototype.init.call(this)?(this.setLayoutType(ccui.Layout.RELATIVE),!0):!1},initWithSize:function(a){return this.init()?(this.setContentSize(a),!0):!1}});ccui.RelativeBox.create=function(a){return new ccui.RelativeBox(a)};
ccui.VBox=ccui.Layout.extend({ctor:function(a){a?this.initWithSize(a):this.init()},init:function(){return ccui.Layout.prototype.init.call(this)?(this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),!0):!1},initWithSize:function(a){return this.init()?(this.setContentSize(a),!0):!1}});ccui.VBox.create=function(a){return new ccui.VBox(a)};
ccui.helper={seekWidgetByTag:function(a,b){if(!a)return null;if(a.getTag()==b)return a;for(var c=a.getChildren(),d=c.length,e=0;d>e;e++){var f=ccui.helper.seekWidgetByTag(c[e],b);if(null!=f)return f}return null},seekWidgetByName:function(a,b){if(!a)return null;if(a.getName()==b)return a;for(var c=a.getChildren(),d=c.length,e=0;d>e;e++){var f=ccui.helper.seekWidgetByName(c[e],b);if(null!=f)return f}return null},seekWidgetByRelativeName:function(a,b){if(!a)return null;for(var c=a.getChildren(),d=c.length,
e=0;d>e;e++){var f=c[e],g=f.getLayoutParameter(ccui.LayoutParameter.RELATIVE);if(g&&g.getRelativeName()==b)return f}return null},seekActionWidgetByActionTag:function(a,b){if(!a)return null;if(a.getActionTag()==b)return a;for(var c=a.getChildren(),d=0;d<c.length;d++){var e=ccui.helper.seekActionWidgetByActionTag(c[d],b);if(null!=e)return e}return null}};
ccui.Button=ccui.Widget.extend({_buttonNormalRenderer:null,_buttonClickedRenderer:null,_buttonDisableRenderer:null,_titleRenderer:null,_normalFileName:"",_clickedFileName:"",_disabledFileName:"",_prevIgnoreSize:!0,_scale9Enabled:!1,_capInsetsNormal:null,_capInsetsPressed:null,_capInsetsDisabled:null,_normalTexType:ccui.Widget.LOCAL_TEXTURE,_pressedTexType:ccui.Widget.LOCAL_TEXTURE,_disabledTexType:ccui.Widget.LOCAL_TEXTURE,_normalTextureSize:null,_pressedTextureSize:null,_disabledTextureSize:null,
pressedActionEnabled:!1,_titleColor:null,_normalTextureScaleXInSize:1,_normalTextureScaleYInSize:1,_pressedTextureScaleXInSize:1,_pressedTextureScaleYInSize:1,_normalTextureLoaded:!1,_pressedTextureLoaded:!1,_disabledTextureLoaded:!1,_className:"Button",_normalTextureAdaptDirty:!0,_pressedTextureAdaptDirty:!0,_disabledTextureAdaptDirty:!0,_fontName:"Thonburi",_fontSize:12,_type:0,ctor:function(a,b,c,d){this._capInsetsNormal=cc.rect(0,0,0,0);this._capInsetsPressed=cc.rect(0,0,0,0);this._capInsetsDisabled=
cc.rect(0,0,0,0);this._normalTextureSize=cc.size(0,0);this._pressedTextureSize=cc.size(0,0);this._disabledTextureSize=cc.size(0,0);this._titleColor=cc.color.WHITE;ccui.Widget.prototype.ctor.call(this);this.setTouchEnabled(!0);d&&this.init(a,b,c,d)},init:function(a,b,c,d){if(ccui.Widget.prototype.init.call(this)){if(void 0===a)return!0;this.loadTextures(a,b,c,d)}return!1},_initRenderer:function(){this._buttonNormalRenderer=cc.Sprite.create();this._buttonClickedRenderer=cc.Sprite.create();this._buttonDisableRenderer=
cc.Sprite.create();this._titleRenderer=new cc.LabelTTF("");this._titleRenderer.setAnchorPoint(.5,.5);this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1);this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1);this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,-1);this.addProtectedChild(this._titleRenderer,ccui.Button.TITLE_RENDERER_ZORDER,-1)},setScale9Enabled:function(a){this._scale9Enabled!=
a&&((this._brightStyle=ccui.Widget.BRIGHT_STYLE_NONE,this._scale9Enabled=a,this.removeProtectedChild(this._buttonNormalRenderer),this.removeProtectedChild(this._buttonClickedRenderer),this.removeProtectedChild(this._buttonDisableRenderer),this._scale9Enabled?(this._buttonNormalRenderer=new ccui.Scale9Sprite,this._buttonClickedRenderer=new ccui.Scale9Sprite,this._buttonDisableRenderer=new ccui.Scale9Sprite):(this._buttonNormalRenderer=cc.Sprite.create(),this._buttonClickedRenderer=cc.Sprite.create(),
this._buttonDisableRenderer=cc.Sprite.create()),this.loadTextureNormal(this._normalFileName,this._normalTexType),this.loadTexturePressed(this._clickedFileName,this._pressedTexType),this.loadTextureDisabled(this._disabledFileName,this._disabledTexType),this.addProtectedChild(this._buttonNormalRenderer,ccui.Button.NORMAL_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonClickedRenderer,ccui.Button.PRESSED_RENDERER_ZORDER,-1),this.addProtectedChild(this._buttonDisableRenderer,ccui.Button.DISABLED_RENDERER_ZORDER,
-1),this._scale9Enabled)?(a=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=a):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsetsNormalRenderer(this._capInsetsNormal),this.setCapInsetsPressedRenderer(this._capInsetsPressed),this.setCapInsetsDisabledRenderer(this._capInsetsDisabled),this.setBright(this._bright))},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(a){(!this._scale9Enabled||this._scale9Enabled&&!a)&&
(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,a),this._prevIgnoreSize=a)},getVirtualRendererSize:function(){return cc.size(this._normalTextureSize)},loadTextures:function(a,b,c,d){this.loadTextureNormal(a,d);this.loadTexturePressed(b,d);this.loadTextureDisabled(c,d)},loadTextureNormal:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._normalFileName=a;this._normalTexType=b;var c=this;if(this._buttonNormalRenderer.texture&&this._buttonNormalRenderer.texture.isLoaded()||this._buttonNormalRenderer.addLoadedEventListener(function(){c._findLayout();
c._normalTextureSize=c._buttonNormalRenderer.getContentSize();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._buttonNormalRenderer.setColor(c.getColor());c._buttonNormalRenderer.setOpacity(c.getOpacity());c._updateContentSizeWithTextureSize(c._normalTextureSize);c._normalTextureLoaded=!0;c._normalTextureAdaptDirty=!0}),this._scale9Enabled){var d=this._buttonNormalRenderer;switch(this._normalTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}d.setCapInsets(this._capInsetsNormal)}else switch(d=
this._buttonNormalRenderer,this._normalTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}this._normalTextureSize=this._buttonNormalRenderer.getContentSize();this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._updateContentSizeWithTextureSize(this._normalTextureSize);this._normalTextureAdaptDirty=this._normalTextureLoaded=!0}},loadTexturePressed:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;
this._clickedFileName=a;this._pressedTexType=b;var c=this;if(this._buttonClickedRenderer.texture&&this._buttonClickedRenderer.texture.isLoaded()||this._buttonClickedRenderer.addLoadedEventListener(function(){c._findLayout();c._pressedTextureSize=c._buttonClickedRenderer.getContentSize();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._pressedTextureLoaded=!0;c._pressedTextureAdaptDirty=!0}),this._scale9Enabled){var d=this._buttonClickedRenderer;switch(this._pressedTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);
break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}d.setCapInsets(this._capInsetsPressed)}else switch(d=this._buttonClickedRenderer,this._pressedTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}this._pressedTextureSize=this._buttonClickedRenderer.getContentSize();this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._pressedTextureAdaptDirty=this._pressedTextureLoaded=!0}},loadTextureDisabled:function(a,
b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._disabledFileName=a;this._disabledTexType=b;var c=this;if(this._buttonDisableRenderer.texture&&this._buttonDisableRenderer.texture.isLoaded()||this._buttonDisableRenderer.addLoadedEventListener(function(){c._findLayout();c._disabledTextureSize=c._buttonDisableRenderer.getContentSize();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._disabledTextureLoaded=!0;c._disabledTextureAdaptDirty=!0}),this._scale9Enabled){var d=this._buttonDisableRenderer;
switch(this._disabledTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}d.setCapInsets(this._capInsetsDisabled)}else switch(d=this._buttonDisableRenderer,this._disabledTexType){case ccui.Widget.LOCAL_TEXTURE:d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:d.initWithSpriteFrameName(a)}this._disabledTextureSize=this._buttonDisableRenderer.getContentSize();this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();
this._disabledTextureAdaptDirty=this._disabledTextureLoaded=!0}},setCapInsets:function(a){this.setCapInsetsNormalRenderer(a);this.setCapInsetsPressedRenderer(a);this.setCapInsetsDisabledRenderer(a)},setCapInsetsNormalRenderer:function(a){if(a){var b=this._capInsetsNormal;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._buttonNormalRenderer.setCapInsets(a)}},getCapInsetsNormalRenderer:function(){return cc.rect(this._capInsetsNormal)},setCapInsetsPressedRenderer:function(a){if(a){var b=
this._capInsetsPressed;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._buttonClickedRenderer.setCapInsets(a)}},getCapInsetsPressedRenderer:function(){return cc.rect(this._capInsetsPressed)},setCapInsetsDisabledRenderer:function(a){if(a){var b=this._capInsetsDisabled;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._buttonDisableRenderer.setCapInsets(a)}},getCapInsetsDisabledRenderer:function(){return cc.rect(this._capInsetsDisabled)},_onPressStateChangedToNormal:function(){if(this._buttonNormalRenderer.setVisible(!0),
this._buttonClickedRenderer.setVisible(!1),this._buttonDisableRenderer.setVisible(!1),this._pressedTextureLoaded){if(this.pressedActionEnabled){this._buttonNormalRenderer.stopAllActions();this._buttonClickedRenderer.stopAllActions();var a=cc.scaleTo(.05,this._normalTextureScaleXInSize,this._normalTextureScaleYInSize);this._buttonNormalRenderer.runAction(a);this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize)}}else this._scale9Enabled?this._updateTexturesRGBA():
(this._buttonNormalRenderer.stopAllActions(),this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize))},_onPressStateChangedToPressed:function(){var a=this._buttonNormalRenderer;if(this._pressedTextureLoaded){if(a.setVisible(!1),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),this.pressedActionEnabled){a.stopAllActions();this._buttonClickedRenderer.stopAllActions();var b=cc.scaleTo(.05,this._pressedTextureScaleXInSize+
.1,this._pressedTextureScaleYInSize+.1);this._buttonClickedRenderer.runAction(b);a.setScale(this._pressedTextureScaleXInSize+.1,this._pressedTextureScaleYInSize+.1)}}else a.setVisible(!0),this._buttonClickedRenderer.setVisible(!0),this._buttonDisableRenderer.setVisible(!1),this._scale9Enabled?a.setColor(cc.color.GRAY):(a.stopAllActions(),a.setScale(this._normalTextureScaleXInSize+.1,this._normalTextureScaleYInSize+.1))},_onPressStateChangedToDisabled:function(){this._buttonNormalRenderer.setVisible(!1);
this._buttonClickedRenderer.setVisible(!1);this._buttonDisableRenderer.setVisible(!0);this._buttonNormalRenderer.setScale(this._normalTextureScaleXInSize,this._normalTextureScaleYInSize);this._buttonClickedRenderer.setScale(this._pressedTextureScaleXInSize,this._pressedTextureScaleYInSize)},_updateFlippedX:function(){var a=this._flippedX?-1:1;this._titleRenderer.setScaleX(a);this._scale9Enabled?(this._buttonNormalRenderer.setScaleX(a),this._buttonClickedRenderer.setScaleX(a),this._buttonDisableRenderer.setScaleX(a)):
(this._buttonNormalRenderer.setFlippedX(this._flippedX),this._buttonClickedRenderer.setFlippedX(this._flippedX),this._buttonDisableRenderer.setFlippedX(this._flippedX))},_updateFlippedY:function(){var a=this._flippedY?-1:1;this._titleRenderer.setScaleY(a);this._scale9Enabled?(this._buttonNormalRenderer.setScaleY(a),this._buttonClickedRenderer.setScaleY(a),this._buttonDisableRenderer.setScaleY(a)):(this._buttonNormalRenderer.setFlippedY(this._flippedY),this._buttonClickedRenderer.setFlippedY(this._flippedY),
this._buttonDisableRenderer.setFlippedY(this._flippedY))},_updateTexturesRGBA:function(){this._buttonNormalRenderer.setColor(this.getColor());this._buttonClickedRenderer.setColor(this.getColor());this._buttonDisableRenderer.setColor(this.getColor());this._buttonNormalRenderer.setOpacity(this.getOpacity());this._buttonClickedRenderer.setOpacity(this.getOpacity());this._buttonDisableRenderer.setOpacity(this.getOpacity())},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._updateTitleLocation();
this._disabledTextureAdaptDirty=this._pressedTextureAdaptDirty=this._normalTextureAdaptDirty=!0},getVirtualRenderer:function(){if(!this._bright)return this._buttonDisableRenderer;switch(this._brightStyle){case ccui.Widget.BRIGHT_STYLE_NORMAL:return this._buttonNormalRenderer;case ccui.Widget.BRIGHT_STYLE_HIGH_LIGHT:return this._buttonClickedRenderer;default:return null}},_normalTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||(this._buttonNormalRenderer.setScale(1),
this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonNormalRenderer.setPreferredSize(this._contentSize),this._normalTextureScaleXInSize=this._normalTextureScaleYInSize=1;else{var a=this._normalTextureSize;if(0>=a.width||0>=a.height)return void this._buttonNormalRenderer.setScale(1);var b=this._contentSize.width/a.width,a=this._contentSize.height/a.height;this._buttonNormalRenderer.setScaleX(b);this._buttonNormalRenderer.setScaleY(a);this._normalTextureScaleXInSize=
b;this._normalTextureScaleYInSize=a}this._buttonNormalRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_pressedTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||(this._buttonClickedRenderer.setScale(1),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1);else if(this._scale9Enabled)this._buttonClickedRenderer.setPreferredSize(this._contentSize),this._pressedTextureScaleXInSize=this._pressedTextureScaleYInSize=1;else{var a=this._pressedTextureSize;
if(0>=a.width||0>=a.height)return void this._buttonClickedRenderer.setScale(1);var b=this._contentSize.width/a.width,a=this._contentSize.height/a.height;this._buttonClickedRenderer.setScaleX(b);this._buttonClickedRenderer.setScaleY(a);this._pressedTextureScaleXInSize=b;this._pressedTextureScaleYInSize=a}this._buttonClickedRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_disabledTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||this._buttonDisableRenderer.setScale(1);
else if(this._scale9Enabled)this._buttonDisableRenderer.setPreferredSize(this._contentSize);else{var a=this._disabledTextureSize;if(0>=a.width||0>=a.height)return void this._buttonDisableRenderer.setScale(1);var b=this._contentSize.height/a.height;this._buttonDisableRenderer.setScaleX(this._contentSize.width/a.width);this._buttonDisableRenderer.setScaleY(b)}this._buttonDisableRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},_adaptRenderers:function(){this._normalTextureAdaptDirty&&
(this._normalTextureScaleChangedWithSize(),this._normalTextureAdaptDirty=!1);this._pressedTextureAdaptDirty&&(this._pressedTextureScaleChangedWithSize(),this._pressedTextureAdaptDirty=!1);this._disabledTextureAdaptDirty&&(this._disabledTextureScaleChangedWithSize(),this._disabledTextureAdaptDirty=!1)},_updateTitleLocation:function(){this._titleRenderer.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},setPressedActionEnabled:function(a){this.pressedActionEnabled=a},setTitleText:function(a){this._titleRenderer.setString(a)},
getTitleText:function(){return this._titleRenderer.getString()},setTitleColor:function(a){this._titleColor.r=a.r;this._titleColor.g=a.g;this._titleColor.b=a.b;this._titleRenderer.updateDisplayedColor(a)},getTitleColor:function(){return this._titleRenderer.getColor()},setTitleFontSize:function(a){this._titleRenderer.setFontSize(a)},getTitleFontSize:function(){return this._titleRenderer.getFontSize()},setTitleFontName:function(a){this._titleRenderer.setFontName(a);this._fontName=a},getTitleFontName:function(){return this._titleRenderer.getFontName()},
_setTitleFont:function(a){this._titleRenderer.font=a},_getTitleFont:function(){return this._titleRenderer.font},getDescription:function(){return"Button"},_createCloneInstance:function(){return ccui.Button.create()},_copySpecialProperties:function(a){this._prevIgnoreSize=a._prevIgnoreSize;this.setScale9Enabled(a._scale9Enabled);this.loadTextureNormal(a._normalFileName,a._normalTexType);this.loadTexturePressed(a._clickedFileName,a._pressedTexType);this.loadTextureDisabled(a._disabledFileName,a._disabledTexType);
this.setCapInsetsNormalRenderer(a._capInsetsNormal);this.setCapInsetsPressedRenderer(a._capInsetsPressed);this.setCapInsetsDisabledRenderer(a._capInsetsDisabled);this.setTitleText(a.getTitleText());this.setTitleFontName(a.getTitleFontName());this.setTitleFontSize(a.getTitleFontSize());this.setTitleColor(a.getTitleColor());this.setPressedActionEnabled(a.pressedActionEnabled)}});_p=ccui.Button.prototype;_p.titleText;cc.defineGetterSetter(_p,"titleText",_p.getTitleText,_p.setTitleText);_p.titleFont;
cc.defineGetterSetter(_p,"titleFont",_p._getTitleFont,_p._setTitleFont);_p.titleFontSize;cc.defineGetterSetter(_p,"titleFontSize",_p.getTitleFontSize,_p.setTitleFontSize);_p.titleFontName;cc.defineGetterSetter(_p,"titleFontName",_p.getTitleFontName,_p.setTitleFontName);_p.titleColor;cc.defineGetterSetter(_p,"titleColor",_p.getTitleColor,_p.setTitleColor);_p=null;ccui.Button.create=function(a,b,c,d){return new ccui.Button(a,b,c,d)};ccui.Button.NORMAL_RENDERER_ZORDER=-2;
ccui.Button.PRESSED_RENDERER_ZORDER=-2;ccui.Button.DISABLED_RENDERER_ZORDER=-2;ccui.Button.TITLE_RENDERER_ZORDER=-1;ccui.Button.SYSTEM=0;ccui.Button.TTF=1;
ccui.CheckBox=ccui.Widget.extend({_backGroundBoxRenderer:null,_backGroundSelectedBoxRenderer:null,_frontCrossRenderer:null,_backGroundBoxDisabledRenderer:null,_frontCrossDisabledRenderer:null,_isSelected:!0,_checkBoxEventListener:null,_checkBoxEventSelector:null,_checkBoxEventCallback:null,_backGroundTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundSelectedTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossTexType:ccui.Widget.LOCAL_TEXTURE,_backGroundDisabledTexType:ccui.Widget.LOCAL_TEXTURE,_frontCrossDisabledTexType:ccui.Widget.LOCAL_TEXTURE,
_backGroundFileName:"",_backGroundSelectedFileName:"",_frontCrossFileName:"",_backGroundDisabledFileName:"",_frontCrossDisabledFileName:"",_className:"CheckBox",_backGroundBoxRendererAdaptDirty:!0,_backGroundSelectedBoxRendererAdaptDirty:!0,_frontCrossRendererAdaptDirty:!0,_backGroundBoxDisabledRendererAdaptDirty:!0,_frontCrossDisabledRendererAdaptDirty:!0,ctor:function(a,b,c,d,e,f){ccui.Widget.prototype.ctor.call(this);this.setTouchEnabled(!0);f&&this.init(a,b,c,d,e,f)},init:function(a,b,c,d,e,f){return ccui.Widget.prototype.init.call(this)?
(this._isSelected=!0,this.setSelectedState(!1),void 0===a&&this.loadTextures(a,b,c,d,e,f),!0):!1},_initRenderer:function(){this._backGroundBoxRenderer=cc.Sprite.create();this._backGroundSelectedBoxRenderer=cc.Sprite.create();this._frontCrossRenderer=cc.Sprite.create();this._backGroundBoxDisabledRenderer=cc.Sprite.create();this._frontCrossDisabledRenderer=cc.Sprite.create();this.addProtectedChild(this._backGroundBoxRenderer,ccui.CheckBox.BOX_RENDERER_ZORDER,-1);this.addProtectedChild(this._backGroundSelectedBoxRenderer,
ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER,-1);this.addProtectedChild(this._frontCrossRenderer,ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER,-1);this.addProtectedChild(this._backGroundBoxDisabledRenderer,ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER,-1);this.addProtectedChild(this._frontCrossDisabledRenderer,ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER,-1)},loadTextures:function(a,b,c,d,e,f){this.loadTextureBackGround(a,f);this.loadTextureBackGroundSelected(b,f);this.loadTextureFrontCross(c,f);this.loadTextureBackGroundDisabled(d,
f);this.loadTextureFrontCrossDisabled(e,f)},loadTextureBackGround:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._backGroundFileName=a;this._backGroundTexType=b;var c=this._backGroundBoxRenderer,d=this;switch(c.texture&&c.texture.isLoaded()||c.addLoadedEventListener(function(){d._findLayout();d._updateFlippedX();d._updateFlippedY();d._updateChildrenDisplayedRGBA();d._updateContentSizeWithTextureSize(d._backGroundBoxRenderer.getContentSize());d._backGroundBoxRendererAdaptDirty=!0}),this._backGroundTexType){case ccui.Widget.LOCAL_TEXTURE:c.initWithFile(a);
break;case ccui.Widget.PLIST_TEXTURE:c.initWithSpriteFrameName(a)}c.textureLoaded()||(this._backGroundBoxRenderer.setContentSize(this._customSize),c.addLoadedEventListener(function(){this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize())},this));this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._updateContentSizeWithTextureSize(this._backGroundBoxRenderer.getContentSize());this._backGroundBoxRendererAdaptDirty=!0}},loadTextureBackGroundSelected:function(a,
b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._backGroundSelectedFileName=a;this._backGroundSelectedTexType=b;var c=this;switch(this._backGroundSelectedBoxRenderer.texture&&this._backGroundSelectedBoxRenderer.texture.isLoaded()||this._backGroundSelectedBoxRenderer.addLoadedEventListener(function(){c._findLayout();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._backGroundSelectedBoxRendererAdaptDirty=!0}),this._backGroundSelectedTexType){case ccui.Widget.LOCAL_TEXTURE:this._backGroundSelectedBoxRenderer.initWithFile(a);
break;case ccui.Widget.PLIST_TEXTURE:this._backGroundSelectedBoxRenderer.initWithSpriteFrameName(a)}this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._backGroundSelectedBoxRendererAdaptDirty=!0}},loadTextureFrontCross:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._frontCrossFileName=a;this._frontCrossTexType=b;var c=this;switch(this._frontCrossRenderer.texture&&this._frontCrossRenderer.texture.isLoaded()||this._frontCrossRenderer.addLoadedEventListener(function(){c._findLayout();
c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._frontCrossRendererAdaptDirty=!0}),this._frontCrossTexType){case ccui.Widget.LOCAL_TEXTURE:this._frontCrossRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._frontCrossRenderer.initWithSpriteFrameName(a)}this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._frontCrossRendererAdaptDirty=!0}},loadTextureBackGroundDisabled:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._backGroundDisabledFileName=
a;this._backGroundDisabledTexType=b;var c=this;switch(this._backGroundBoxDisabledRenderer.texture&&this._backGroundBoxDisabledRenderer.texture.isLoaded()||this._backGroundBoxDisabledRenderer.addLoadedEventListener(function(){c._findLayout();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._backGroundBoxDisabledRendererAdaptDirty=!0}),this._backGroundDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:this._backGroundBoxDisabledRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._backGroundBoxDisabledRenderer.initWithSpriteFrameName(a)}this._updateFlippedX();
this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._backGroundBoxDisabledRendererAdaptDirty=!0}},loadTextureFrontCrossDisabled:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._frontCrossDisabledFileName=a;this._frontCrossDisabledTexType=b;var c=this;switch(this._frontCrossDisabledRenderer.texture&&this._frontCrossDisabledRenderer.texture.isLoaded()||this._frontCrossDisabledRenderer.addLoadedEventListener(function(){c._findLayout();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();
c._frontCrossDisabledRendererAdaptDirty=!0}),this._frontCrossDisabledTexType){case ccui.Widget.LOCAL_TEXTURE:this._frontCrossDisabledRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._frontCrossDisabledRenderer.initWithSpriteFrameName(a)}this._updateFlippedX();this._updateFlippedY();this._updateChildrenDisplayedRGBA();this._frontCrossDisabledRendererAdaptDirty=!0}},_onPressStateChangedToNormal:function(){this._backGroundBoxRenderer.setVisible(!0);this._backGroundSelectedBoxRenderer.setVisible(!1);
this._backGroundBoxDisabledRenderer.setVisible(!1);this._frontCrossDisabledRenderer.setVisible(!1)},_onPressStateChangedToPressed:function(){this._backGroundBoxRenderer.setVisible(!1);this._backGroundSelectedBoxRenderer.setVisible(!0);this._backGroundBoxDisabledRenderer.setVisible(!1);this._frontCrossDisabledRenderer.setVisible(!1)},_onPressStateChangedToDisabled:function(){this._backGroundBoxRenderer.setVisible(!1);this._backGroundSelectedBoxRenderer.setVisible(!1);this._backGroundBoxDisabledRenderer.setVisible(!0);
this._frontCrossRenderer.setVisible(!1);this._isSelected&&this._frontCrossDisabledRenderer.setVisible(!0)},setSelectedState:function(a){a!=this._isSelected&&(this._isSelected=a,this._frontCrossRenderer.setVisible(this._isSelected))},getSelectedState:function(){return this._isSelected},_selectedEvent:function(){this._checkBoxEventCallback&&this._checkBoxEventCallback(this,ccui.CheckBox.EVENT_SELECTED);this._checkBoxEventListener&&this._checkBoxEventSelector&&this._checkBoxEventSelector.call(this._checkBoxEventListener,
this,ccui.CheckBox.EVENT_SELECTED)},_unSelectedEvent:function(){this._checkBoxEventCallback&&this._checkBoxEventCallback(this,ccui.CheckBox.EVENT_UNSELECTED);this._checkBoxEventListener&&this._checkBoxEventSelector&&this._checkBoxEventSelector.call(this._checkBoxEventListener,this,ccui.CheckBox.EVENT_UNSELECTED)},_releaseUpEvent:function(){ccui.Widget.prototype._releaseUpEvent.call(this);this._isSelected?(this.setSelectedState(!1),this._unSelectedEvent()):(this.setSelectedState(!0),this._selectedEvent())},
addEventListenerCheckBox:function(a,b){this._checkBoxEventSelector=a;this._checkBoxEventListener=b},addEventListener:function(a){this._checkBoxEventCallback=a},getVirtualRendererSize:function(){return this._backGroundBoxRenderer.getContentSize()},_updateFlippedX:function(){this._backGroundBoxRenderer.setFlippedX(this._flippedX);this._backGroundSelectedBoxRenderer.setFlippedX(this._flippedX);this._frontCrossRenderer.setFlippedX(this._flippedX);this._backGroundBoxDisabledRenderer.setFlippedX(this._flippedX);
this._frontCrossDisabledRenderer.setFlippedX(this._flippedX)},_updateFlippedY:function(){this._backGroundBoxRenderer.setFlippedY(this._flippedY);this._backGroundSelectedBoxRenderer.setFlippedY(this._flippedY);this._frontCrossRenderer.setFlippedY(this._flippedY);this._backGroundBoxDisabledRenderer.setFlippedY(this._flippedY);this._frontCrossDisabledRenderer.setFlippedY(this._flippedY)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._frontCrossDisabledRendererAdaptDirty=
this._backGroundBoxDisabledRendererAdaptDirty=this._frontCrossRendererAdaptDirty=this._backGroundSelectedBoxRendererAdaptDirty=this._backGroundBoxRendererAdaptDirty=!0},getVirtualRenderer:function(){return this._backGroundBoxRenderer},_backGroundTextureScaleChangedWithSize:function(){var a=this._backGroundBoxRenderer,b=this._contentSize;if(this._ignoreSize)a.setScale(1);else{var c=a.getContentSize();if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);
a.setScaleY(d)}a.setPosition(.5*b.width,.5*b.height)},_backGroundSelectedTextureScaleChangedWithSize:function(){var a=this._backGroundSelectedBoxRenderer,b=this._contentSize;if(this._ignoreSize)a.setScale(1);else{var c=a.getContentSize();if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);a.setScaleY(d)}a.setPosition(.5*b.width,.5*b.height)},_frontCrossTextureScaleChangedWithSize:function(){var a=this._frontCrossRenderer,b=this._contentSize;if(this._ignoreSize)a.setScale(1);
else{var c=a.getContentSize();if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);a.setScaleY(d)}a.setPosition(.5*b.width,.5*b.height)},_backGroundDisabledTextureScaleChangedWithSize:function(){var a=this._backGroundBoxDisabledRenderer,b=this._contentSize;if(this._ignoreSize)a.setScale(1);else{var c=a.getContentSize();if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);a.setScaleY(d)}a.setPosition(.5*
b.width,.5*b.height)},_frontCrossDisabledTextureScaleChangedWithSize:function(){var a=this._frontCrossDisabledRenderer,b=this._contentSize;if(this._ignoreSize)a.setScale(1);else{var c=a.getContentSize();if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);a.setScaleY(d)}a.setPosition(.5*b.width,.5*b.height)},getDescription:function(){return"CheckBox"},_createCloneInstance:function(){return ccui.CheckBox.create()},_copySpecialProperties:function(a){a instanceof
ccui.CheckBox&&(this.loadTextureBackGround(a._backGroundFileName,a._backGroundTexType),this.loadTextureBackGroundSelected(a._backGroundSelectedFileName,a._backGroundSelectedTexType),this.loadTextureFrontCross(a._frontCrossFileName,a._frontCrossTexType),this.loadTextureBackGroundDisabled(a._backGroundDisabledFileName,a._backGroundDisabledTexType),this.loadTextureFrontCrossDisabled(a._frontCrossDisabledFileName,a._frontCrossDisabledTexType),this.setSelectedState(a._isSelected),this._checkBoxEventListener=
a._checkBoxEventListener,this._checkBoxEventSelector=a._checkBoxEventSelector,this._checkBoxEventCallback=a._checkBoxEventCallback)},_adaptRenderers:function(){this._backGroundBoxRendererAdaptDirty&&(this._backGroundTextureScaleChangedWithSize(),this._backGroundBoxRendererAdaptDirty=!1);this._backGroundSelectedBoxRendererAdaptDirty&&(this._backGroundSelectedTextureScaleChangedWithSize(),this._backGroundSelectedBoxRendererAdaptDirty=!1);this._frontCrossRendererAdaptDirty&&(this._frontCrossTextureScaleChangedWithSize(),
this._frontCrossRendererAdaptDirty=!1);this._backGroundBoxDisabledRendererAdaptDirty&&(this._backGroundDisabledTextureScaleChangedWithSize(),this._backGroundBoxDisabledRendererAdaptDirty=!1);this._frontCrossDisabledRendererAdaptDirty&&(this._frontCrossDisabledTextureScaleChangedWithSize(),this._frontCrossDisabledRendererAdaptDirty=!1)}});_p=ccui.CheckBox.prototype;_p.selected;cc.defineGetterSetter(_p,"selected",_p.getSelectedState,_p.setSelectedState);_p=null;
ccui.CheckBox.create=function(a,b,c,d,e,f){return new ccui.CheckBox(a,b,c,d,e,f)};ccui.CheckBox.EVENT_SELECTED=0;ccui.CheckBox.EVENT_UNSELECTED=1;ccui.CheckBox.BOX_RENDERER_ZORDER=-1;ccui.CheckBox.BOX_SELECTED_RENDERER_ZORDER=-1;ccui.CheckBox.BOX_DISABLED_RENDERER_ZORDER=-1;ccui.CheckBox.FRONT_CROSS_RENDERER_ZORDER=-1;ccui.CheckBox.FRONT_CROSS_DISABLED_RENDERER_ZORDER=-1;
ccui.ImageView=ccui.Widget.extend({_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_imageRenderer:null,_textureFile:"",_imageTexType:ccui.Widget.LOCAL_TEXTURE,_imageTextureSize:null,_className:"ImageView",_imageRendererAdaptDirty:!0,ctor:function(a,b){this._capInsets=cc.rect(0,0,0,0);this._imageTextureSize=cc.size(this._capInsets.width,this._capInsets.height);ccui.Widget.prototype.ctor.call(this);b&&this.init(a,b)},init:function(a,b){return ccui.Widget.prototype.init.call(this)?(void 0===a?this._imageTexType=
ccui.Widget.LOCAL_TEXTURE:this.loadTexture(a,b),!0):!1},_initRenderer:function(){this._imageRenderer=cc.Sprite.create();this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1)},loadTexture:function(a,b){if(a){var c=this;b=b||ccui.Widget.LOCAL_TEXTURE;this._textureFile=a;this._imageTexType=b;var d=c._imageRenderer;switch(c._imageTexType){case ccui.Widget.LOCAL_TEXTURE:c._scale9Enabled?(d.initWithFile(a),d.setCapInsets(c._capInsets)):d.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:c._scale9Enabled?
(d.initWithSpriteFrameName(a),d.setCapInsets(c._capInsets)):d.initWithSpriteFrameName(a)}d.texture&&d.texture.isLoaded()||d.addLoadedEventListener(function(){c._findLayout();c._imageTextureSize=d.getContentSize();c._updateFlippedX();c._updateFlippedY();c._updateChildrenDisplayedRGBA();c._updateContentSizeWithTextureSize(c._imageTextureSize);c._imageRendererAdaptDirty=!0});c._imageTextureSize=d.getContentSize();c._updateFlippedX();c._updateFlippedY();this._updateChildrenDisplayedRGBA();c._updateContentSizeWithTextureSize(c._imageTextureSize);
c._imageRendererAdaptDirty=!0}},setTextureRect:function(a){this._scale9Enabled||this._imageRenderer.setTextureRect(a)},_updateFlippedX:function(){this._scale9Enabled?this._imageRenderer.setScaleX(this._flippedX?-1:1):this._imageRenderer.setFlippedX(this._flippedX)},_updateFlippedY:function(){this._scale9Enabled?this._imageRenderer.setScaleY(this._flippedY?-1:1):this._imageRenderer.setFlippedY(this._flippedY)},setScale9Enabled:function(a){this._scale9Enabled!=a&&((this._scale9Enabled=a,this.removeProtectedChild(this._imageRenderer),
this._imageRenderer=null,this._imageRenderer=this._scale9Enabled?new ccui.Scale9Sprite:cc.Sprite.create(),this.loadTexture(this._textureFile,this._imageTexType),this.addProtectedChild(this._imageRenderer,ccui.ImageView.RENDERER_ZORDER,-1),this._scale9Enabled)?(a=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=a):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsets(this._capInsets))},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(a){(!this._scale9Enabled||
this._scale9Enabled&&!a)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,a),this._prevIgnoreSize=a)},setCapInsets:function(a){if(a){var b=this._capInsets;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._imageRenderer.setCapInsets(a)}},getCapInsets:function(){return cc.rect(this._capInsets)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._imageRendererAdaptDirty=!0},_adaptRenderers:function(){this._imageRendererAdaptDirty&&(this._imageTextureScaleChangedWithSize(),
this._imageRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return cc.size(this._imageTextureSize)},getVirtualRenderer:function(){return this._imageRenderer},_imageTextureScaleChangedWithSize:function(){if(this._ignoreSize)this._scale9Enabled||this._imageRenderer.setScale(1);else if(this._scale9Enabled)this._imageRenderer.setPreferredSize(this._contentSize);else{var a=this._imageRenderer.getContentSize();if(0>=a.width||0>=a.height)return void this._imageRenderer.setScale(1);this._imageRenderer.setScaleX(this._contentSize.width/
a.width);this._imageRenderer.setScaleY(this._contentSize.height/a.height)}this._imageRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"ImageView"},_createCloneInstance:function(){return ccui.ImageView.create()},_copySpecialProperties:function(a){a instanceof ccui.ImageView&&(this._prevIgnoreSize=a._prevIgnoreSize,this.setScale9Enabled(a._scale9Enabled),this.loadTexture(a._textureFile,a._imageTexType),this.setCapInsets(a._capInsets))}});
ccui.ImageView.create=function(a,b){return new ccui.ImageView(a,b)};ccui.ImageView.RENDERER_ZORDER=-1;
ccui.LoadingBar=ccui.Widget.extend({_direction:null,_percent:100,_totalLength:0,_barRenderer:null,_renderBarTexType:ccui.Widget.LOCAL_TEXTURE,_barRendererTextureSize:null,_scale9Enabled:!1,_prevIgnoreSize:!0,_capInsets:null,_textureFile:"",_isTextureLoaded:!1,_className:"LoadingBar",_barRendererAdaptDirty:!0,ctor:function(a,b){this._direction=ccui.LoadingBar.TYPE_LEFT;this._barRendererTextureSize=cc.size(0,0);this._capInsets=cc.rect(0,0,0,0);ccui.Widget.prototype.ctor.call(this);void 0!==a&&this.loadTexture(a);
void 0!==b&&this.setPercent(b)},_initRenderer:function(){this._barRenderer=cc.Sprite.create();cc.Node.prototype.addChild.call(this,this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1);this._barRenderer.setAnchorPoint(0,.5)},setDirection:function(a){if(this._direction!=a)switch(this._direction=a,this._direction){case ccui.LoadingBar.TYPE_LEFT:this._barRenderer.setAnchorPoint(0,.5);this._barRenderer.setPosition(.5*-this._totalLength,0);this._scale9Enabled||this._barRenderer.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:this._barRenderer.setAnchorPoint(1,
.5),this._barRenderer.setPosition(.5*this._totalLength,0),this._scale9Enabled||this._barRenderer.setFlippedX(!0)}},getDirection:function(){return this._direction},loadTexture:function(a,b){if(a){this._renderBarTexType=b=b||ccui.Widget.LOCAL_TEXTURE;this._textureFile=a;var c=this._barRenderer,d=this;switch(c.texture&&c.texture.isLoaded()||c.addLoadedEventListener(function(){d._findLayout();var a=c.getContentSize();switch(d._barRendererTextureSize.width=a.width,d._barRendererTextureSize.height=a.height,
d._direction){case ccui.LoadingBar.TYPE_LEFT:c.setAnchorPoint(0,.5);d._scale9Enabled||c.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:c.setAnchorPoint(1,.5),d._scale9Enabled||c.setFlippedX(!0)}d._updateChildrenDisplayedRGBA();d._barRendererScaleChangedWithSize();d._updateContentSizeWithTextureSize(d._barRendererTextureSize);d._barRendererAdaptDirty=!0}),this._renderBarTexType){case ccui.Widget.LOCAL_TEXTURE:this._scale9Enabled?(c.initWithFile(a),c.setCapInsets(this._capInsets)):c.initWithFile(a);
break;case ccui.Widget.PLIST_TEXTURE:this._scale9Enabled?(c.initWithSpriteFrameName(a),c.setCapInsets(this._capInsets)):c.initWithSpriteFrameName(a)}var e=c.getContentSize();switch(this._barRendererTextureSize.width=e.width,this._barRendererTextureSize.height=e.height,this._direction){case ccui.LoadingBar.TYPE_LEFT:c.setAnchorPoint(0,.5);this._scale9Enabled||c.setFlippedX(!1);break;case ccui.LoadingBar.TYPE_RIGHT:c.setAnchorPoint(1,.5),this._scale9Enabled||c.setFlippedX(!0)}this._updateChildrenDisplayedRGBA();
this._barRendererScaleChangedWithSize();this._updateContentSizeWithTextureSize(this._barRendererTextureSize);this._barRendererAdaptDirty=!0}},setScale9Enabled:function(a){this._scale9Enabled!=a&&((this._scale9Enabled=a,this.removeProtectedChild(this._barRenderer),this._barRenderer=this._scale9Enabled?new ccui.Scale9Sprite:cc.Sprite.create(),this.loadTexture(this._textureFile,this._renderBarTexType),this.addProtectedChild(this._barRenderer,ccui.LoadingBar.RENDERER_ZORDER,-1),this._scale9Enabled)?(a=
this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=a):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsets(this._capInsets),this.setPercent(this._percent))},isScale9Enabled:function(){return this._scale9Enabled},setCapInsets:function(a){if(a){var b=this._capInsets;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._barRenderer.setCapInsets(a)}},getCapInsets:function(){return cc.rect(this._capInsets)},setPercent:function(a){if(!(0>
a||100<a||(this._percent=a,0>=this._totalLength)))if(a=this._percent/100,this._scale9Enabled)this._setScale9Scale();else{var b=this._barRenderer.getTextureRect();b.width=this._barRendererTextureSize.width*a;this._barRenderer.setTextureRect(cc.rect(b.x,b.y,this._barRendererTextureSize.width*a,this._barRendererTextureSize.height))}},setContentSize:function(a,b){ccui.Widget.prototype.setContentSize.call(this,a,b);this._totalLength=void 0===b?a.width:a},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);
this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1)},ignoreContentAdaptWithSize:function(a){(!this._scale9Enabled||this._scale9Enabled&&!a)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,a),this._prevIgnoreSize=a)},getVirtualRendererSize:function(){return cc.size(this._barRendererTextureSize)},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){var a=
this._barRenderer,b=this._contentSize;if(this._ignoreSize)this._scale9Enabled||(this._totalLength=this._barRendererTextureSize.width,a.setScale(1));else if(this._totalLength=b.width,this._scale9Enabled)this._setScale9Scale();else{var c=this._barRendererTextureSize;if(0>=c.width||0>=c.height)return void a.setScale(1);var d=b.height/c.height;a.setScaleX(b.width/c.width);a.setScaleY(d)}switch(this._direction){case ccui.LoadingBar.TYPE_LEFT:a.setPosition(0,.5*b.height);break;case ccui.LoadingBar.TYPE_RIGHT:a.setPosition(this._totalLength,
.5*b.height)}},_setScale9Scale:function(){this._barRenderer.setPreferredSize(cc.size(this._percent/100*this._totalLength,this._contentSize.height))},getDescription:function(){return"LoadingBar"},_createCloneInstance:function(){return ccui.LoadingBar.create()},_copySpecialProperties:function(a){a instanceof ccui.LoadingBar&&(this._prevIgnoreSize=a._prevIgnoreSize,this.setScale9Enabled(a._scale9Enabled),this.loadTexture(a._textureFile,a._renderBarTexType),this.setCapInsets(a._capInsets),this.setPercent(a._percent),
this.setDirection(a._direction))}});_p=ccui.LoadingBar.prototype;_p.direction;cc.defineGetterSetter(_p,"direction",_p.getDirection,_p.setDirection);_p.percent;cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent);_p=null;ccui.LoadingBar.create=function(a,b){return new ccui.LoadingBar(a,b)};ccui.LoadingBar.TYPE_LEFT=0;ccui.LoadingBar.TYPE_RIGHT=1;ccui.LoadingBar.RENDERER_ZORDER=-1;
ccui.Slider=ccui.Widget.extend({_barRenderer:null,_progressBarRenderer:null,_progressBarTextureSize:null,_slidBallNormalRenderer:null,_slidBallPressedRenderer:null,_slidBallDisabledRenderer:null,_slidBallRenderer:null,_barLength:0,_percent:0,_scale9Enabled:!1,_prevIgnoreSize:!0,_textureFile:"",_progressBarTextureFile:"",_slidBallNormalTextureFile:"",_slidBallPressedTextureFile:"",_slidBallDisabledTextureFile:"",_capInsetsBarRenderer:null,_capInsetsProgressBarRenderer:null,_sliderEventListener:null,
_sliderEventSelector:null,_barTexType:ccui.Widget.LOCAL_TEXTURE,_progressBarTexType:ccui.Widget.LOCAL_TEXTURE,_ballNTexType:ccui.Widget.LOCAL_TEXTURE,_ballPTexType:ccui.Widget.LOCAL_TEXTURE,_ballDTexType:ccui.Widget.LOCAL_TEXTURE,_isTextureLoaded:!1,_className:"Slider",_barRendererAdaptDirty:!0,_progressBarRendererDirty:!0,ctor:function(){this._progressBarTextureSize=cc.size(0,0);this._capInsetsBarRenderer=cc.rect(0,0,0,0);this._capInsetsProgressBarRenderer=cc.rect(0,0,0,0);ccui.Widget.prototype.ctor.call(this)},
init:function(){return ccui.Widget.prototype.init.call(this)},_initRenderer:function(){this._barRenderer=cc.Sprite.create();this._progressBarRenderer=cc.Sprite.create();this._progressBarRenderer.setAnchorPoint(0,.5);this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,-1);this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1);this._slidBallNormalRenderer=cc.Sprite.create();this._slidBallPressedRenderer=cc.Sprite.create();this._slidBallPressedRenderer.setVisible(!1);
this._slidBallDisabledRenderer=cc.Sprite.create();this._slidBallDisabledRenderer.setVisible(!1);this._slidBallRenderer=new cc.Node;this._slidBallRenderer.addChild(this._slidBallNormalRenderer);this._slidBallRenderer.addChild(this._slidBallPressedRenderer);this._slidBallRenderer.addChild(this._slidBallDisabledRenderer);this.addProtectedChild(this._slidBallRenderer,ccui.Slider.BALL_RENDERER_ZORDER,-1)},loadBarTexture:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._textureFile=a;this._barTexType=
b;var c=this._barRenderer,d=this;switch(c.texture&&c.texture.isLoaded()||c.addLoadedEventListener(function(){d._findLayout();d._updateChildrenDisplayedRGBA();d._barRendererAdaptDirty=!0;d._progressBarRendererDirty=!0;d._updateContentSizeWithTextureSize(d._barRenderer.getContentSize())}),this._barTexType){case ccui.Widget.LOCAL_TEXTURE:c.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:c.initWithSpriteFrameName(a)}this._updateChildrenDisplayedRGBA();this._progressBarRendererDirty=this._barRendererAdaptDirty=
!0;this._updateContentSizeWithTextureSize(this._barRenderer.getContentSize())}},loadProgressBarTexture:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._progressBarTextureFile=a;this._progressBarTexType=b;var c=this._progressBarRenderer,d=this;switch(c.texture&&c.texture.isLoaded()||c.addLoadedEventListener(function(){d._findLayout();d._updateChildrenDisplayedRGBA();d._progressBarRenderer.setAnchorPoint(cc.p(0,.5));var a=d._progressBarRenderer.getContentSize();d._progressBarTextureSize={width:a.width,
height:a.height};d._progressBarRendererDirty=!0}),this._progressBarTexType){case ccui.Widget.LOCAL_TEXTURE:c.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:c.initWithSpriteFrameName(a)}this._updateChildrenDisplayedRGBA();this._progressBarRenderer.setAnchorPoint(cc.p(0,.5));c=this._progressBarRenderer.getContentSize();this._progressBarTextureSize={width:c.width,height:c.height};this._progressBarRendererDirty=!0}},setScale9Enabled:function(a){this._scale9Enabled!=a&&((this._scale9Enabled=a,this.removeProtectedChild(this._barRenderer,
!0),this.removeProtectedChild(this._progressBarRenderer,!0),this._barRenderer=null,this._progressBarRenderer=null,this._scale9Enabled?(this._barRenderer=new ccui.Scale9Sprite,this._progressBarRenderer=new ccui.Scale9Sprite):(this._barRenderer=cc.Sprite.create(),this._progressBarRenderer=cc.Sprite.create()),this.loadBarTexture(this._textureFile,this._barTexType),this.loadProgressBarTexture(this._progressBarTextureFile,this._progressBarTexType),this.addProtectedChild(this._barRenderer,ccui.Slider.BASEBAR_RENDERER_ZORDER,
-1),this.addProtectedChild(this._progressBarRenderer,ccui.Slider.PROGRESSBAR_RENDERER_ZORDER,-1),this._scale9Enabled)?(a=this._ignoreSize,this.ignoreContentAdaptWithSize(!1),this._prevIgnoreSize=a):this.ignoreContentAdaptWithSize(this._prevIgnoreSize),this.setCapInsetsBarRenderer(this._capInsetsBarRenderer),this.setCapInsetProgressBarRenderer(this._capInsetsProgressBarRenderer))},isScale9Enabled:function(){return this._scale9Enabled},ignoreContentAdaptWithSize:function(a){(!this._scale9Enabled||this._scale9Enabled&&
!a)&&(ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,a),this._prevIgnoreSize=a)},setCapInsets:function(a){this.setCapInsetsBarRenderer(a);this.setCapInsetProgressBarRenderer(a)},setCapInsetsBarRenderer:function(a){if(a){var b=this._capInsetsBarRenderer;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._barRenderer.setCapInsets(a)}},getCapInsetsBarRenderer:function(){return cc.rect(this._capInsetsBarRenderer)},setCapInsetProgressBarRenderer:function(a){if(a){var b=
this._capInsetsProgressBarRenderer;b.x=a.x;b.y=a.y;b.width=a.width;b.height=a.height;this._scale9Enabled&&this._progressBarRenderer.setCapInsets(a)}},getCapInsetsProgressBarRenderer:function(){return cc.rect(this._capInsetsProgressBarRenderer)},loadSlidBallTextures:function(a,b,c,d){this.loadSlidBallTextureNormal(a,d);this.loadSlidBallTexturePressed(b,d);this.loadSlidBallTextureDisabled(c,d)},loadSlidBallTextureNormal:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._slidBallNormalTextureFile=
a;this._ballNTexType=b;var c=this;switch(this._slidBallNormalRenderer.texture&&this._slidBallNormalRenderer.texture.isLoaded()||this._slidBallNormalRenderer.addLoadedEventListener(function(){c._updateChildrenDisplayedRGBA()}),this._ballNTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallNormalRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallNormalRenderer.initWithSpriteFrameName(a)}this._updateChildrenDisplayedRGBA()}},loadSlidBallTexturePressed:function(a,b){if(a){b=
b||ccui.Widget.LOCAL_TEXTURE;this._slidBallPressedTextureFile=a;this._ballPTexType=b;var c=this;switch(this._slidBallPressedRenderer.texture&&this._slidBallPressedRenderer.texture.isLoaded()||this._slidBallPressedRenderer.addLoadedEventListener(function(){c._updateChildrenDisplayedRGBA()}),this._ballPTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallPressedRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallPressedRenderer.initWithSpriteFrameName(a)}this._updateChildrenDisplayedRGBA()}},
loadSlidBallTextureDisabled:function(a,b){if(a){b=b||ccui.Widget.LOCAL_TEXTURE;this._slidBallDisabledTextureFile=a;this._ballDTexType=b;var c=this;switch(this._slidBallDisabledRenderer.texture&&this._slidBallDisabledRenderer.texture.isLoaded()||this._slidBallDisabledRenderer.addLoadedEventListener(function(){c._updateChildrenDisplayedRGBA()}),this._ballDTexType){case ccui.Widget.LOCAL_TEXTURE:this._slidBallDisabledRenderer.initWithFile(a);break;case ccui.Widget.PLIST_TEXTURE:this._slidBallDisabledRenderer.initWithSpriteFrameName(a)}this._updateChildrenDisplayedRGBA()}},
setPercent:function(a){100<a&&(a=100);0>a&&(a=0);this._percent=a;a=a/100*this._barLength;if(this._slidBallRenderer.setPosition(cc.p(a,this._contentSize.height/2)),this._scale9Enabled)this._progressBarRenderer.setPreferredSize(cc.size(a,this._progressBarTextureSize.height));else{var b=this._progressBarRenderer,c=b.getTextureRect();b.setTextureRect(cc.rect(c.x,c.y,a,c.height),b.isTextureRectRotated())}},hitTest:function(a){a=this._slidBallNormalRenderer.convertToNodeSpace(a);var b=this._slidBallNormalRenderer.getContentSize(),
b=cc.rect(0,0,b.width,b.height);return a.x>=b.x&&a.x<=b.x+b.width&&a.y>=b.y&&a.y<=b.y+b.height},onTouchBegan:function(a,b){var c=ccui.Widget.prototype.onTouchBegan.call(this,a,b);if(this._hit){var d=this.convertToNodeSpace(this._touchBeganPosition);this.setPercent(this._getPercentWithBallPos(d.x));this._percentChangedEvent()}return c},onTouchMoved:function(a){a=a.getLocation();a=this.convertToNodeSpace(a);this.setPercent(this._getPercentWithBallPos(a.x));this._percentChangedEvent()},onTouchEnded:function(a,
b){ccui.Widget.prototype.onTouchEnded.call(this,a,b)},onTouchCancelled:function(a,b){ccui.Widget.prototype.onTouchCancelled.call(this,a,b)},_getPercentWithBallPos:function(a){return a/this._barLength*100},addEventListenerSlider:function(a,b){this._sliderEventSelector=a;this._sliderEventListener=b},addEventListener:function(a){this._eventCallback=a},_percentChangedEvent:function(){this._sliderEventListener&&this._sliderEventSelector&&this._sliderEventSelector.call(this._sliderEventListener,this,ccui.Slider.EVENT_PERCENT_CHANGED);
this._eventCallback&&this._eventCallback(ccui.Slider.EVENT_PERCENT_CHANGED)},getPercent:function(){return this._percent},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._progressBarRendererDirty=this._barRendererAdaptDirty=!0},_adaptRenderers:function(){this._barRendererAdaptDirty&&(this._barRendererScaleChangedWithSize(),this._barRendererAdaptDirty=!1);this._progressBarRendererDirty&&(this._progressBarRendererScaleChangedWithSize(),this._progressBarRendererDirty=!1)},
getVirtualRendererSize:function(){return this._barRenderer.getContentSize()},getVirtualRenderer:function(){return this._barRenderer},_barRendererScaleChangedWithSize:function(){if(this._ignoreSize)this._barRenderer.setScale(1),this._barLength=this._contentSize.width;else if(this._barLength=this._contentSize.width,this._scale9Enabled)this._barRenderer.setPreferredSize(this._contentSize);else{var a=this._barRenderer.getContentSize();if(0>=a.width||0>=a.height)return void this._barRenderer.setScale(1);
var b=this._contentSize.height/a.height;this._barRenderer.setScaleX(this._contentSize.width/a.width);this._barRenderer.setScaleY(b)}this._barRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2);this.setPercent(this._percent)},_progressBarRendererScaleChangedWithSize:function(){if(this._ignoreSize){if(!this._scale9Enabled){var a=this._progressBarTextureSize,b=this._contentSize.width/a.width,a=this._contentSize.height/a.height;this._progressBarRenderer.setScaleX(b);this._progressBarRenderer.setScaleY(a)}}else if(this._scale9Enabled)this._progressBarRenderer.setPreferredSize(this._contentSize),
this._progressBarTextureSize=this._progressBarRenderer.getContentSize();else{a=this._progressBarTextureSize;if(0>=a.width||0>=a.height)return void this._progressBarRenderer.setScale(1);b=this._contentSize.width/a.width;a=this._contentSize.height/a.height;this._progressBarRenderer.setScaleX(b);this._progressBarRenderer.setScaleY(a)}this._progressBarRenderer.setPosition(0,this._contentSize.height/2);this.setPercent(this._percent)},_onPressStateChangedToNormal:function(){this._slidBallNormalRenderer.setVisible(!0);
this._slidBallPressedRenderer.setVisible(!1);this._slidBallDisabledRenderer.setVisible(!1)},_onPressStateChangedToPressed:function(){this._slidBallNormalRenderer.setVisible(!1);this._slidBallPressedRenderer.setVisible(!0);this._slidBallDisabledRenderer.setVisible(!1)},_onPressStateChangedToDisabled:function(){this._slidBallNormalRenderer.setVisible(!1);this._slidBallPressedRenderer.setVisible(!1);this._slidBallDisabledRenderer.setVisible(!0)},getDescription:function(){return"Slider"},_createCloneInstance:function(){return ccui.Slider.create()},
_copySpecialProperties:function(a){this._prevIgnoreSize=a._prevIgnoreSize;this.setScale9Enabled(a._scale9Enabled);this.loadBarTexture(a._textureFile,a._barTexType);this.loadProgressBarTexture(a._progressBarTextureFile,a._progressBarTexType);this.loadSlidBallTextureNormal(a._slidBallNormalTextureFile,a._ballNTexType);this.loadSlidBallTexturePressed(a._slidBallPressedTextureFile,a._ballPTexType);this.loadSlidBallTextureDisabled(a._slidBallDisabledTextureFile,a._ballDTexType);this.setPercent(a.getPercent());
this._sliderEventListener=a._sliderEventListener;this._sliderEventSelector=a._sliderEventSelector;this._eventCallback=a._eventCallback}});_p=ccui.Slider.prototype;_p.percent;cc.defineGetterSetter(_p,"percent",_p.getPercent,_p.setPercent);_p=null;ccui.Slider.create=function(){return new ccui.Slider};ccui.Slider.EVENT_PERCENT_CHANGED=0;ccui.Slider.BASEBAR_RENDERER_ZORDER=-3;ccui.Slider.PROGRESSBAR_RENDERER_ZORDER=-2;ccui.Slider.BALL_RENDERER_ZORDER=-1;
ccui.Text=ccui.Widget.extend({_touchScaleChangeEnabled:!1,_normalScaleValueX:1,_normalScaleValueY:1,_fontName:"Thonburi",_fontSize:10,_onSelectedScaleOffset:.5,_labelRenderer:"",_textAreaSize:null,_textVerticalAlignment:0,_textHorizontalAlignment:0,_className:"Text",_type:null,_labelRendererAdaptDirty:!0,ctor:function(a,b,c){this._type=ccui.Text.Type.SYSTEM;this._textAreaSize=cc.size(0,0);ccui.Widget.prototype.ctor.call(this);c&&this.init(a,b,c)},init:function(a,b,c){return ccui.Widget.prototype.init.call(this)?
(0<arguments.length&&(this.setString(a),this.setFontName(b),this.setFontSize(c)),!0):!1},_initRenderer:function(){this._labelRenderer=new cc.LabelTTF;this.addProtectedChild(this._labelRenderer,ccui.Text.RENDERER_ZORDER,-1)},setText:function(a){cc.log("Please use the setString");this.setString(a)},setString:function(a){this._labelRenderer.setString(a);this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());this._labelRendererAdaptDirty=!0},getStringValue:function(){return cc.log("Please use the getString"),
this._labelRenderer.getString()},getString:function(){return this._labelRenderer.getString()},getStringLength:function(){return this._labelRenderer.getStringLength()},setFontSize:function(a){this._labelRenderer.setFontSize(a);this._fontSize=a;this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());this._labelRendererAdaptDirty=!0},getFontSize:function(){return this._fontSize},setFontName:function(a){this._fontName=a;this._labelRenderer.setFontName(a);this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());
this._labelRendererAdaptDirty=!0},getFontName:function(){return this._fontName},_setFont:function(a){var b=cc.LabelTTF._fontStyleRE.exec(a);b&&(this._fontSize=parseInt(b[1]),this._fontName=b[2],this._labelRenderer._setFont(a),this._labelScaleChangedWithSize())},_getFont:function(){return this._labelRenderer._getFont()},getType:function(){return this._type},setTextAreaSize:function(a){this._labelRenderer.setDimensions(a);this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());
this._labelRendererAdaptDirty=!0},getTextAreaSize:function(){return this._labelRenderer.getDimensions()},setTextHorizontalAlignment:function(a){this._labelRenderer.setHorizontalAlignment(a);this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());this._labelRendererAdaptDirty=!0},getTextHorizontalAlignment:function(){return this._labelRenderer.getHorizontalAlignment()},setTextVerticalAlignment:function(a){this._labelRenderer.setVerticalAlignment(a);this._updateContentSizeWithTextureSize(this._labelRenderer.getContentSize());
this._labelRendererAdaptDirty=!0},getTextVerticalAlignment:function(){return this._labelRenderer.getVerticalAlignment()},setTouchScaleChangeEnabled:function(a){this._touchScaleChangeEnabled=a},isTouchScaleChangeEnabled:function(){return this._touchScaleChangeEnabled},_onPressStateChangedToNormal:function(){this._touchScaleChangeEnabled&&(this._labelRenderer.setScaleX(this._normalScaleValueX),this._labelRenderer.setScaleY(this._normalScaleValueY))},_onPressStateChangedToPressed:function(){this._touchScaleChangeEnabled&&
(this._labelRenderer.setScaleX(this._normalScaleValueX+this._onSelectedScaleOffset),this._labelRenderer.setScaleY(this._normalScaleValueY+this._onSelectedScaleOffset))},_onPressStateChangedToDisabled:function(){},_updateFlippedX:function(){this._labelRenderer.setScaleX(this._flippedX?-1:1)},_updateFlippedY:function(){this._labelRenderer.setScaleY(this._flippedY?-1:1)},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._labelRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelRendererAdaptDirty&&
(this._labelScaleChangedWithSize(),this._labelRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelRenderer},_labelScaleChangedWithSize:function(){var a=this._contentSize;if(this._ignoreSize)this._labelRenderer.setScale(1),this._normalScaleValueX=this._normalScaleValueY=1;else{this._labelRenderer.setDimensions(cc.size(a.width,a.height));var b=this._labelRenderer.getContentSize();if(0>=b.width||0>=b.height)return void this._labelRenderer.setScale(1);
var c=a.width/b.width,b=a.height/b.height;this._labelRenderer.setScaleX(c);this._labelRenderer.setScaleY(b);this._normalScaleValueX=c;this._normalScaleValueY=b}this._labelRenderer.setPosition(a.width/2,a.height/2)},getDescription:function(){return"Label"},enableShadow:function(a,b,c){this._labelRenderer.enableShadow(a,b,c)},enableOutline:function(a,b){this._labelRenderer.enableOutline(a,b)},enableGlow:function(a){this._type==ccui.Text.Type.TTF&&this._labelRenderer.enableGlow(a)},disableEffect:function(){this._labelRenderer.disableEffect&&
this._labelRenderer.disableEffect()},_createCloneInstance:function(){return ccui.Text.create()},_copySpecialProperties:function(a){a instanceof ccui.Text&&(this.setFontName(a._fontName),this.setFontSize(a.getFontSize()),this.setString(a.getString()),this.setTouchScaleChangeEnabled(a.touchScaleEnabled),this.setTextAreaSize(a._textAreaSize),this.setTextHorizontalAlignment(a._labelRenderer.getHorizontalAlignment()),this.setTextVerticalAlignment(a._labelRenderer.getVerticalAlignment()))},_setBoundingWidth:function(a){this._textAreaSize.width=
a;this._labelRenderer._setBoundingWidth(a);this._labelScaleChangedWithSize()},_setBoundingHeight:function(a){this._textAreaSize.height=a;this._labelRenderer._setBoundingHeight(a);this._labelScaleChangedWithSize()},_getBoundingWidth:function(){return this._textAreaSize.width},_getBoundingHeight:function(){return this._textAreaSize.height}});_p=ccui.Text.prototype;_p.boundingWidth;cc.defineGetterSetter(_p,"boundingWidth",_p._getBoundingWidth,_p._setBoundingWidth);_p.boundingHeight;
cc.defineGetterSetter(_p,"boundingHeight",_p._getBoundingHeight,_p._setBoundingHeight);_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);_p.stringLength;cc.defineGetterSetter(_p,"stringLength",_p.getStringLength);_p.font;cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont);_p.fontSize;cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize);_p.fontName;cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName);_p.textAlign;
cc.defineGetterSetter(_p,"textAlign",_p.getTextHorizontalAlignment,_p.setTextHorizontalAlignment);_p.verticalAlign;cc.defineGetterSetter(_p,"verticalAlign",_p.getTextVerticalAlignment,_p.setTextVerticalAlignment);_p=null;ccui.Label=ccui.Text.create=function(a,b,c){return new ccui.Text(a,b,c)};ccui.Text.RENDERER_ZORDER=-1;ccui.Text.Type={SYSTEM:0,TTF:1};
ccui.TextAtlas=ccui.Widget.extend({_labelAtlasRenderer:null,_stringValue:"",_charMapFileName:"",_itemWidth:0,_itemHeight:0,_startCharMap:"",_className:"TextAtlas",_labelAtlasRendererAdaptDirty:null,ctor:function(a,b,c,d,e){ccui.Widget.prototype.ctor.call(this);e&&this.setProperty(a,b,c,d,e)},_initRenderer:function(){this._labelAtlasRenderer=new cc.LabelAtlas;this._labelAtlasRenderer.setAnchorPoint(cc.p(.5,.5));this.addProtectedChild(this._labelAtlasRenderer,ccui.TextAtlas.RENDERER_ZORDER,-1)},setProperty:function(a,
b,c,d,e){this._stringValue=a;this._charMapFileName=b;this._itemWidth=c;this._itemHeight=d;this._startCharMap=e;this._labelAtlasRenderer.initWithString(a,this._charMapFileName,this._itemWidth,this._itemHeight,this._startCharMap[0]);this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize());this._labelAtlasRendererAdaptDirty=!0},setString:function(a){this._stringValue=a;this._labelAtlasRenderer.setString(a);this._updateContentSizeWithTextureSize(this._labelAtlasRenderer.getContentSize());
this._labelAtlasRendererAdaptDirty=!0},setStringValue:function(a){cc.log("Please use the setString");this.setString(a)},getStringValue:function(){return cc.log("Please use the getString"),this.getString()},getString:function(){return this._labelAtlasRenderer.getString()},getStringLength:function(){return this._labelAtlasRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._labelAtlasRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelAtlasRendererAdaptDirty&&
(this._labelAtlasScaleChangedWithSize(),this._labelAtlasRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelAtlasRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelAtlasRenderer},_labelAtlasScaleChangedWithSize:function(){var a=this._labelAtlasRenderer;if(this._ignoreSize)a.setScale(1);else{var b=a.getContentSize();if(0>=b.width||0>=b.height)return void a.setScale(1);a.setScaleX(this._contentSize.width/b.width);a.setScaleY(this._contentSize.height/b.height)}a.setPosition(this._contentSize.width/
2,this._contentSize.height/2)},getDescription:function(){return"LabelAtlas"},_copySpecialProperties:function(a){a&&this.setProperty(a._stringValue,a._charMapFileName,a._itemWidth,a._itemHeight,a._startCharMap)},_createCloneInstance:function(){return ccui.TextAtlas.create()}});_p=ccui.TextAtlas.prototype;_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);_p=null;ccui.TextAtlas.create=function(a,b,c,d,e){return new ccui.TextAtlas(a,b,c,d,e)};ccui.TextAtlas.RENDERER_ZORDER=-1;
ccui.LabelBMFont=ccui.TextBMFont=ccui.Widget.extend({_labelBMFontRenderer:null,_fntFileHasInit:!1,_fntFileName:"",_stringValue:"",_className:"TextBMFont",_labelBMFontRendererAdaptDirty:!0,ctor:function(a,b){ccui.Widget.prototype.ctor.call(this);void 0!=b&&(this.setFntFile(b),this.setString(a))},_initRenderer:function(){this._labelBMFontRenderer=new cc.LabelBMFont;this.addProtectedChild(this._labelBMFontRenderer,ccui.TextBMFont.RENDERER_ZORDER,-1)},setFntFile:function(a){if(a){var b=this;b._fntFileName=
a;b._fntFileHasInit=!0;b._labelBMFontRenderer.initWithString(this._stringValue,a);a=b._labelBMFontRenderer;a._textureLoaded||a.addLoadedEventListener(function(){b.updateSizeAndPosition()})}},setText:function(a){cc.log("Please use the setString");this.setString(a)},setString:function(a){this._stringValue=a;this._fntFileHasInit&&(this._labelBMFontRenderer.setString(a),this._updateContentSizeWithTextureSize(this._labelBMFontRenderer.getContentSize()),this._labelBMFontRendererAdaptDirty=!0)},getString:function(){return this._stringValue},
getStringLength:function(){return this._labelBMFontRenderer.getStringLength()},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._labelBMFontRendererAdaptDirty=!0},_adaptRenderers:function(){this._labelBMFontRendererAdaptDirty&&(this._labelBMFontScaleChangedWithSize(),this._labelBMFontRendererAdaptDirty=!1)},getVirtualRendererSize:function(){return this._labelBMFontRenderer.getContentSize()},getVirtualRenderer:function(){return this._labelBMFontRenderer},_labelBMFontScaleChangedWithSize:function(){var a=
this._labelBMFontRenderer;if(this._ignoreSize)a.setScale(1);else{var b=a.getContentSize();if(0>=b.width||0>=b.height)return void a.setScale(1);a.setScaleX(this._contentSize.width/b.width);a.setScaleY(this._contentSize.height/b.height)}a.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getDescription:function(){return"TextBMFont"},_createCloneInstance:function(){return new ccui.TextBMFont},_copySpecialProperties:function(a){this.setFntFile(a._fntFileName);this.setString(a._stringValue)}});
_p=ccui.TextBMFont.prototype;_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setStringValue);_p=null;ccui.TextBMFont.create=function(a,b){return new ccui.TextBMFont(a,b)};ccui.TextBMFont.RENDERER_ZORDER=-1;
ccui._TextFieldRenderer=cc.TextFieldTTF.extend({_maxLengthEnabled:!1,_maxLength:0,_passwordEnabled:!1,_passwordStyleText:"",_attachWithIME:!1,_detachWithIME:!1,_insertText:!1,_deleteBackward:!1,_className:"_TextFieldRenderer",_textFieldRendererAdaptDirty:!0,ctor:function(){cc.TextFieldTTF.prototype.ctor.call(this);this._maxLengthEnabled=!1;this._maxLength=0;this._passwordEnabled=!1;this._passwordStyleText="*";this._deleteBackward=this._insertText=this._detachWithIME=this._attachWithIME=!1},onEnter:function(){cc.TextFieldTTF.prototype.onEnter.call(this);
cc.TextFieldTTF.prototype.setDelegate.call(this,this)},onTextFieldAttachWithIME:function(){return this.setAttachWithIME(!0),!1},onTextFieldInsertText:function(a,b,c){return 1==c&&"\n"==b?!1:(this.setInsertText(!0),this._maxLengthEnabled&&cc.TextFieldTTF.prototype.getCharCount.call(this)>=this._maxLength)},onTextFieldDeleteBackward:function(){return this.setDeleteBackward(!0),!1},onTextFieldDetachWithIME:function(){return this.setDetachWithIME(!0),!1},insertText:function(a,b){if("\n"!=a&&this._maxLengthEnabled&&
this.getString().length>=this._maxLength)return void(this._passwordEnabled&&this.setPasswordText(this.getString()));cc.TextFieldTTF.prototype.insertText.call(this,a,b);this._passwordEnabled&&0<cc.TextFieldTTF.prototype.getCharCount.call(this)&&this.setPasswordText(this.getString())},deleteBackward:function(){cc.TextFieldTTF.prototype.deleteBackward.call(this);0<cc.TextFieldTTF.prototype.getCharCount.call(this)&&this._passwordEnabled&&this.setPasswordText(this._inputText)},openIME:function(){cc.TextFieldTTF.prototype.attachWithIME.call(this)},
closeIME:function(){cc.TextFieldTTF.prototype.detachWithIME.call(this)},setMaxLengthEnabled:function(a){this._maxLengthEnabled=a},isMaxLengthEnabled:function(){return this._maxLengthEnabled},setMaxLength:function(a){this._maxLength=a},getMaxLength:function(){return this._maxLength},getCharCount:function(){return cc.TextFieldTTF.prototype.getCharCount.call(this)},setPasswordEnabled:function(a){this._passwordEnabled=a},isPasswordEnabled:function(){return this._passwordEnabled},setPasswordStyleText:function(a){if(!(1<
a.length)){var b=a.charCodeAt(0);33>b||126<b||(this._passwordStyleText=a)}},setPasswordText:function(a){var b="",c=a.length;a=c;this._maxLengthEnabled&&c>this._maxLength&&(a=this._maxLength);for(c=0;a>c;++c)b+=this._passwordStyleText;cc.LabelTTF.prototype.setString.call(this,b)},setAttachWithIME:function(a){this._attachWithIME=a},getAttachWithIME:function(){return this._attachWithIME},setDetachWithIME:function(a){this._detachWithIME=a},getDetachWithIME:function(){return this._detachWithIME},setInsertText:function(a){this._insertText=
a},getInsertText:function(){return this._insertText},setDeleteBackward:function(a){this._deleteBackward=a},getDeleteBackward:function(){return this._deleteBackward},onDraw:function(){return!1}});ccui._TextFieldRenderer.create=function(a,b,c){var d=new ccui._TextFieldRenderer;return d&&d.initWithString("",b,c)?(a&&d.setPlaceHolder(a),d):null};
ccui.TextField=ccui.Widget.extend({_textFieldRenderer:null,_touchWidth:0,_touchHeight:0,_useTouchArea:!1,_textFieldEventListener:null,_textFieldEventSelector:null,_passwordStyleText:"",_textFieldRendererAdaptDirty:!0,_fontName:"",_fontSize:12,ctor:function(a,b,c){ccui.Widget.prototype.ctor.call(this);a&&this.setPlaceHolder(a);b&&this.setFontName(b);c&&this.setFontSize(c)},init:function(){return ccui.Widget.prototype.init.call(this)?(this.setTouchEnabled(!0),!0):!1},onEnter:function(){ccui.Widget.prototype.onEnter.call(this);
this.scheduleUpdate()},_initRenderer:function(){this._textFieldRenderer=ccui._TextFieldRenderer.create("input words here","Thonburi",20);this.addProtectedChild(this._textFieldRenderer,ccui.TextField.RENDERER_ZORDER,-1)},setTouchSize:function(a){this._touchWidth=a.width;this._touchHeight=a.height},setTouchAreaEnabled:function(a){this._useTouchArea=a},hitTest:function(a){if(this._useTouchArea){a=this.convertToNodeSpace(a);var b=cc.rect(-this._touchWidth*this._anchorPoint.x,-this._touchHeight*this._anchorPoint.y,
this._touchWidth,this._touchHeight);return a.x>=b.x&&a.x<=b.x+b.width&&a.y>=b.y&&a.y<=b.y+b.height}return ccui.Widget.prototype.hitTest.call(this,a)},getTouchSize:function(){return cc.size(this._touchWidth,this._touchHeight)},setText:function(a){cc.log("Please use the setString");this.setString(a)},setString:function(a){a&&(a=String(a),this.isMaxLengthEnabled()&&(a=a.substr(0,this.getMaxLength())),this.isPasswordEnabled()?(this._textFieldRenderer.setPasswordText(a),this._textFieldRenderer.setString(""),
this._textFieldRenderer.insertText(a,a.length)):this._textFieldRenderer.setString(a),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))},setPlaceHolder:function(a){this._textFieldRenderer.setPlaceHolder(a);this._textFieldRendererAdaptDirty=!0;this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getPlaceHolder:function(){return this._textFieldRenderer.getPlaceHolder()},setFontSize:function(a){this._textFieldRenderer.setFontSize(a);
this._fontSize=a;this._textFieldRendererAdaptDirty=!0;this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontSize:function(){return this._fontSize},setFontName:function(a){this._textFieldRenderer.setFontName(a);this._fontName=a;this._textFieldRendererAdaptDirty=!0;this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize())},getFontName:function(){return this._fontName},didNotSelectSelf:function(){this._textFieldRenderer.detachWithIME()},getStringValue:function(){return cc.log("Please use the getString"),
this.getString()},getString:function(){return this._textFieldRenderer.getString()},getStringLength:function(){return this._textFieldRenderer.getStringLength()},onTouchBegan:function(a,b){var c=this,d=ccui.Widget.prototype.onTouchBegan.call(c,a,b);return c._hit&&setTimeout(function(){c._textFieldRenderer.attachWithIME()},0),d},setMaxLengthEnabled:function(a){this._textFieldRenderer.setMaxLengthEnabled(a)},isMaxLengthEnabled:function(){return this._textFieldRenderer.isMaxLengthEnabled()},setMaxLength:function(a){this._textFieldRenderer.setMaxLength(a);
this.setString(this.getString())},getMaxLength:function(){return this._textFieldRenderer.getMaxLength()},setPasswordEnabled:function(a){this._textFieldRenderer.setPasswordEnabled(a)},isPasswordEnabled:function(){return this._textFieldRenderer.isPasswordEnabled()},setPasswordStyleText:function(a){this._textFieldRenderer.setPasswordStyleText(a);this._passwordStyleText=a;this.setString(this.getString())},getPasswordStyleText:function(){return this._passwordStyleText},update:function(){this.getAttachWithIME()&&
(this._attachWithIMEEvent(),this.setAttachWithIME(!1));this.getDetachWithIME()&&(this._detachWithIMEEvent(),this.setDetachWithIME(!1));this.getInsertText()&&(this._insertTextEvent(),this.setInsertText(!1),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()));this.getDeleteBackward()&&(this._deleteBackwardEvent(),this.setDeleteBackward(!1),this._textFieldRendererAdaptDirty=!0,this._updateContentSizeWithTextureSize(this._textFieldRenderer.getContentSize()))},
getAttachWithIME:function(){return this._textFieldRenderer.getAttachWithIME()},setAttachWithIME:function(a){this._textFieldRenderer.setAttachWithIME(a)},getDetachWithIME:function(){return this._textFieldRenderer.getDetachWithIME()},setDetachWithIME:function(a){this._textFieldRenderer.setDetachWithIME(a)},getInsertText:function(){return this._textFieldRenderer.getInsertText()},setInsertText:function(a){this._textFieldRenderer.setInsertText(a)},getDeleteBackward:function(){return this._textFieldRenderer.getDeleteBackward()},
setDeleteBackward:function(a){this._textFieldRenderer.setDeleteBackward(a)},_attachWithIMEEvent:function(){this._textFieldEventListener&&this._textFieldEventSelector&&this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_ATTACH_WITH_IME);this._eventCallback&&this._eventCallback(this,ccui.TextField.EVENT_ATTACH_WITH_IME)},_detachWithIMEEvent:function(){this._textFieldEventListener&&this._textFieldEventSelector&&this._textFieldEventSelector.call(this._textFieldEventListener,
this,ccui.TextField.EVENT_DETACH_WITH_IME);this._eventCallback&&this._eventCallback(this,ccui.TextField.EVENT_DETACH_WITH_IME)},_insertTextEvent:function(){this._textFieldEventListener&&this._textFieldEventSelector&&this._textFieldEventSelector.call(this._textFieldEventListener,this,ccui.TextField.EVENT_INSERT_TEXT);this._eventCallback&&this._eventCallback(this,ccui.TextField.EVENT_INSERT_TEXT)},_deleteBackwardEvent:function(){this._textFieldEventListener&&this._textFieldEventSelector&&this._textFieldEventSelector.call(this._textFieldEventListener,
this,ccui.TextField.EVENT_DELETE_BACKWARD);this._eventCallback&&this._eventCallback(this,ccui.TextField.EVENT_DELETE_BACKWARD)},addEventListenerTextField:function(a,b){this._textFieldEventSelector=a;this._textFieldEventListener=b},addEventListener:function(a){this._eventCallback=a},_onSizeChanged:function(){ccui.Widget.prototype._onSizeChanged.call(this);this._textFieldRendererAdaptDirty=!0},_adaptRenderers:function(){this._textFieldRendererAdaptDirty&&(this._textfieldRendererScaleChangedWithSize(),
this._textFieldRendererAdaptDirty=!1)},_textfieldRendererScaleChangedWithSize:function(){this._ignoreSize||this._textFieldRenderer.setDimensions(this._contentSize);this._textFieldRenderer.setPosition(this._contentSize.width/2,this._contentSize.height/2)},getVirtualRendererSize:function(){return this._textFieldRenderer.getContentSize()},getVirtualRenderer:function(){return this._textFieldRenderer},getDescription:function(){return"TextField"},attachWithIME:function(){this._textFieldRenderer.attachWithIME()},
_createCloneInstance:function(){return ccui.TextField.create()},_copySpecialProperties:function(a){this.setString(a._textFieldRenderer.getString());this.setPlaceHolder(a.getString());this.setFontSize(a._textFieldRenderer.getFontSize());this.setFontName(a._textFieldRenderer.getFontName());this.setMaxLengthEnabled(a.isMaxLengthEnabled());this.setMaxLength(a.getMaxLength());this.setPasswordEnabled(a.isPasswordEnabled());this.setPasswordStyleText(a._passwordStyleText);this.setAttachWithIME(a.getAttachWithIME());
this.setDetachWithIME(a.getDetachWithIME());this.setInsertText(a.getInsertText());this.setDeleteBackward(a.getDeleteBackward())},setTextAreaSize:function(a){this.setContentSize(a)},setTextHorizontalAlignment:function(a){this._textFieldRenderer.setHorizontalAlignment(a)},setTextVerticalAlignment:function(a){this._textFieldRenderer.setVerticalAlignment(a)},_setFont:function(a){this._textFieldRender._setFont(a);this._textFieldRendererAdaptDirty=!0},_getFont:function(){return this._textFieldRender._getFont()}});
ccui.TextField.create=function(a,b,c){return new ccui.TextField(a,b,c)};_p=ccui.TextField.prototype;_p.string;cc.defineGetterSetter(_p,"string",_p.getString,_p.setString);_p.placeHolder;cc.defineGetterSetter(_p,"placeHolder",_p.getPlaceHolder,_p.setPlaceHolder);_p.font;cc.defineGetterSetter(_p,"font",_p._getFont,_p._setFont);_p.fontSize;cc.defineGetterSetter(_p,"fontSize",_p.getFontSize,_p.setFontSize);_p.fontName;cc.defineGetterSetter(_p,"fontName",_p.getFontName,_p.setFontName);_p.maxLengthEnabled;
cc.defineGetterSetter(_p,"maxLengthEnabled",_p.isMaxLengthEnabled,_p.setMaxLengthEnabled);_p.maxLength;cc.defineGetterSetter(_p,"maxLength",_p.getMaxLength,_p.setMaxLength);_p.passwordEnabled;cc.defineGetterSetter(_p,"passwordEnabled",_p.isPasswordEnabled,_p.setPasswordEnabled);_p=null;ccui.TextField.EVENT_ATTACH_WITH_IME=0;ccui.TextField.EVENT_DETACH_WITH_IME=1;ccui.TextField.EVENT_INSERT_TEXT=2;ccui.TextField.EVENT_DELETE_BACKWARD=3;ccui.TextField.RENDERER_ZORDER=-1;
ccui.RichElement=ccui.Class.extend({_type:0,_tag:0,_color:null,_opacity:0,ctor:function(){this._tag=this._type=0;this._color=cc.color(255,255,255,255)},init:function(a,b,c){this._tag=a;this._color.r=b.r;this._color.g=b.g;this._color.b=b.b;this._opacity=c;this._color.a=void 0===c?b.a:c}});
ccui.RichElementText=ccui.RichElement.extend({_text:"",_fontName:"",_fontSize:0,ctor:function(a,b,c,d,e,f){ccui.RichElement.prototype.ctor.call(this);this._type=ccui.RichElement.TEXT;this._fontName=this._text="";this._fontSize=0;f&&this.init(a,b,c,d,e,f)},init:function(a,b,c,d,e,f){ccui.RichElement.prototype.init.call(this,a,b,c);this._text=d;this._fontName=e;this._fontSize=f}});ccui.RichElementText.create=function(a,b,c,d,e,f){return new ccui.RichElementText(a,b,c,d,e,f)};
ccui.RichElementImage=ccui.RichElement.extend({_filePath:"",_textureRect:null,_textureType:0,ctor:function(a,b,c,d){ccui.RichElement.prototype.ctor.call(this);this._type=ccui.RichElement.IMAGE;this._filePath="";this._textureRect=cc.rect(0,0,0,0);this._textureType=0;d&&this.init(a,b,c,d)},init:function(a,b,c,d){ccui.RichElement.prototype.init.call(this,a,b,c);this._filePath=d}});ccui.RichElementImage.create=function(a,b,c,d){return new ccui.RichElementImage(a,b,c,d)};
ccui.RichElementCustomNode=ccui.RichElement.extend({_customNode:null,ctor:function(a,b,c,d){ccui.RichElement.prototype.ctor.call(this);this._type=ccui.RichElement.CUSTOM;this._customNode=null;d&&this.init(a,b,c,d)},init:function(a,b,c,d){ccui.RichElement.prototype.init.call(this,a,b,c);this._customNode=d}});ccui.RichElementCustomNode.create=function(a,b,c,d){return new ccui.RichElementCustomNode(a,b,c,d)};
ccui.RichText=ccui.Widget.extend({_formatTextDirty:!1,_richElements:null,_elementRenders:null,_leftSpaceWidth:0,_verticalSpace:0,_elementRenderersContainer:null,ctor:function(){ccui.Widget.prototype.ctor.call(this);this._formatTextDirty=!1;this._richElements=[];this._elementRenders=[];this._verticalSpace=this._leftSpaceWidth=0},_initRenderer:function(){this._elementRenderersContainer=new cc.Node;this._elementRenderersContainer.setAnchorPoint(.5,.5);this.addProtectedChild(this._elementRenderersContainer,
0,-1)},insertElement:function(a,b){this._richElements.splice(b,0,a);this._formatTextDirty=!0},pushBackElement:function(a){this._richElements.push(a);this._formatTextDirty=!0},removeElement:function(a){"number"==typeof a?this._richElements.splice(a,1):cc.arrayRemoveObject(this._richElements,a);this._formatTextDirty=!0},formatText:function(){if(this._formatTextDirty){this._elementRenderersContainer.removeAllChildren();this._elementRenders.length=0;var a,b,c=this._richElements;if(this._ignoreSize)for(this._addNewLine(),
a=0;a<c.length;a++){b=c[a];var d=null;switch(b._type){case ccui.RichElement.TEXT:d=new cc.LabelTTF(b._text,b._fontName,b._fontSize);break;case ccui.RichElement.IMAGE:d=cc.Sprite.create(b._filePath);break;case ccui.RichElement.CUSTOM:d=b._customNode}d.setColor(b._color);d.setOpacity(b._color.a);this._pushToContainer(d)}else for(this._addNewLine(),a=0;a<c.length;a++)switch(b=c[a],b._type){case ccui.RichElement.TEXT:this._handleTextRenderer(b._text,b._fontName,b._fontSize,b._color);break;case ccui.RichElement.IMAGE:this._handleImageRenderer(b._filePath,
b._color,b._color.a);break;case ccui.RichElement.CUSTOM:this._handleCustomRenderer(b._customNode)}this.formatRenderers();this._formatTextDirty=!1}},_handleTextRenderer:function(a,b,c,d){var e=new cc.LabelTTF(a,b,c),f=e.getContentSize().width;(this._leftSpaceWidth-=f,0>this._leftSpaceWidth)?(e=a.length*(1- -this._leftSpaceWidth/f),f=a.substr(0,e),a=a.substr(e,a.length-1),0<e&&(e=new cc.LabelTTF(f.substr(0,e),b,c),e.setColor(d),e.setOpacity(d.a),this._pushToContainer(e)),this._addNewLine(),this._handleTextRenderer(a,
b,c,d)):(e.setColor(d),e.setOpacity(d.a),this._pushToContainer(e))},_handleImageRenderer:function(a){a=cc.Sprite.create(a);this._handleCustomRenderer(a)},_handleCustomRenderer:function(a){var b=a.getContentSize();this._leftSpaceWidth-=b.width;0>this._leftSpaceWidth?(this._addNewLine(),this._pushToContainer(a),this._leftSpaceWidth-=b.width):this._pushToContainer(a)},_addNewLine:function(){this._leftSpaceWidth=this._customSize.width;this._elementRenders.push([])},formatRenderers:function(){var a,b,
c,d,e,f=0,g=this._elementRenderersContainer,h=this._elementRenders;if(this._ignoreSize){a=0;c=h[0];for(b=d=0;b<c.length;b++)e=c[b],e.setAnchorPoint(cc.p(0,0)),e.setPosition(cc.p(d,0)),g.addChild(e,1,b),e=e.getContentSize(),a+=e.width,f=Math.max(f,e.height),d+=e.width;g.setContentSize(a,f)}else{var k=[];for(a=0;a<h.length;a++){c=h[a];for(b=d=0;b<c.length;b++)e=c[b],d=Math.max(e.getContentSize().height,d);k[a]=d;f+=k[a]}f=this._customSize.height;for(a=0;a<h.length;a++)for(c=h[a],d=0,f-=k[a]+this._verticalSpace,
b=0;b<c.length;b++)e=c[b],e.setAnchorPoint(cc.p(0,0)),e.setPosition(cc.p(d,f)),g.addChild(e,1),d+=e.getContentSize().width;g.setContentSize(this._contentSize)}b=h.length;for(a=0;b>a;a++)h[a].length=0;this._elementRenders.length=0;this.setContentSize(this._ignoreSize?this.getVirtualRendererSize():this._customSize);this._updateContentSizeWithTextureSize(this._contentSize);g.setPosition(.5*this._contentSize.width,.5*this._contentSize.height)},_pushToContainer:function(a){0>=this._elementRenders.length||
this._elementRenders[this._elementRenders.length-1].push(a)},visit:function(a){this._enabled&&(this.formatText(),ccui.Widget.prototype.visit.call(this,a))},setVerticalSpace:function(a){this._verticalSpace=a},setAnchorPoint:function(a){ccui.Widget.prototype.setAnchorPoint.call(this,a);this._elementRenderersContainer.setAnchorPoint(a)},_setAnchorX:function(a){ccui.Widget.prototype._setAnchorX.call(this,a);this._elementRenderersContainer._setAnchorX(a)},_setAnchorY:function(a){ccui.Widget.prototype._setAnchorY.call(this,
a);this._elementRenderersContainer._setAnchorY(a)},getVirtualRendererSize:function(){return this._elementRenderersContainer.getContentSize()},ignoreContentAdaptWithSize:function(a){this._ignoreSize!=a&&(this._formatTextDirty=!0,ccui.Widget.prototype.ignoreContentAdaptWithSize.call(this,a))},getContentSize:function(){return this.formatText(),cc.Node.prototype.getContentSize.call(this)},_getWidth:function(){return this.formatText(),cc.Node.prototype._getWidth.call(this)},_getHeight:function(){return this.formatText(),
cc.Node.prototype._getHeight.call(this)},getDescription:function(){return"RichText"}});ccui.RichText.create=function(){return new ccui.RichText};ccui.RichElement.TEXT=0;ccui.RichElement.IMAGE=1;ccui.RichElement.CUSTOM=2;
ccui.ScrollView=ccui.Layout.extend({_innerContainer:null,direction:null,_autoScrollDir:null,_topBoundary:0,_bottomBoundary:0,_leftBoundary:0,_rightBoundary:0,_bounceTopBoundary:0,_bounceBottomBoundary:0,_bounceLeftBoundary:0,_bounceRightBoundary:0,_autoScroll:!1,_autoScrollAddUpTime:0,_autoScrollOriginalSpeed:0,_autoScrollAcceleration:0,_isAutoScrollSpeedAttenuated:!1,_needCheckAutoScrollDestination:!1,_autoScrollDestination:null,_bePressed:!1,_slidTime:0,_moveChildPoint:null,_childFocusCancelOffset:0,
_leftBounceNeeded:!1,_topBounceNeeded:!1,_rightBounceNeeded:!1,_bottomBounceNeeded:!1,bounceEnabled:!1,_bouncing:!1,_bounceDir:null,_bounceOriginalSpeed:0,inertiaScrollEnabled:!1,_scrollViewEventListener:null,_scrollViewEventSelector:null,_className:"ScrollView",_eventCallback:null,ctor:function(){ccui.Layout.prototype.ctor.call(this);this.direction=ccui.ScrollView.DIR_NONE;this._autoScrollDir=cc.p(0,0);this._autoScrollAcceleration=-1E3;this._autoScrollDestination=cc.p(0,0);this._slidTime=0;this._moveChildPoint=
cc.p(0,0);this._childFocusCancelOffset=5;this._bounceDir=cc.p(0,0);this._bounceOriginalSpeed=0;this.inertiaScrollEnabled=!0;this.setTouchEnabled(!0)},init:function(){return ccui.Layout.prototype.init.call(this)?(this.setClippingEnabled(!0),this._innerContainer.setTouchEnabled(!1),!0):!1},onEnter:function(){ccui.Layout.prototype.onEnter.call(this);this.scheduleUpdate(!0)},findNextFocusedWidget:function(a,b){return this.getLayoutType()==ccui.Layout.LINEAR_VERTICAL||this.getLayoutType()==ccui.Layout.LINEAR_HORIZONTAL?
this._innerContainer.findNextFocusedWidget(a,b):ccui.Widget.prototype.findNextFocusedWidget.call(this,a,b)},_initRenderer:function(){ccui.Layout.prototype._initRenderer.call(this);this._innerContainer=ccui.Layout.create();this.addProtectedChild(this._innerContainer,1,1)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this);var a=this._contentSize;this._topBoundary=a.height;this._rightBoundary=a.width;var b=a.width/3,c=a.height/3;this._bounceTopBoundary=a.height-c;this._bounceBottomBoundary=
c;this._bounceLeftBoundary=b;this._bounceRightBoundary=a.width-b;b=this._innerContainer.getContentSize();this._innerContainer.setContentSize(cc.size(Math.max(b.width,a.width),Math.max(b.height,a.height)));this._innerContainer.setPosition(0,a.height-this._innerContainer.getContentSize().height)},setInnerContainerSize:function(a){var b=this._innerContainer,c=this._contentSize,d=c.width,e=c.height,f=b.getContentSize();a.width<c.width?cc.log("Inner width <= ScrollView width, it will be force sized!"):
d=a.width;a.height<c.height?cc.log("Inner height <= ScrollView height, it will be force sized!"):e=a.height;b.setContentSize(cc.size(d,e));var g,h;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:g=b.getContentSize();h=f.height-g.height;this._scrollChildren(0,h);break;case ccui.ScrollView.DIR_HORIZONTAL:b.getRightBoundary()<=c.width&&(g=b.getContentSize(),h=f.width-g.width,this._scrollChildren(h,0));break;case ccui.ScrollView.DIR_BOTH:g=b.getContentSize(),a=f.height-g.height,f=b.getRightBoundary()<=
c.width?f.width-g.width:0,this._scrollChildren(f,a)}f=b.getContentSize();g=b.getPosition();a=b.getAnchorPoint();0<b.getLeftBoundary()&&b.setPosition(a.x*f.width,g.y);b.getRightBoundary()<c.width&&b.setPosition(c.width-(1-a.x)*f.width,g.y);0<g.y&&b.setPosition(g.x,a.y*f.height);b.getTopBoundary()<c.height&&b.setPosition(g.x,c.height-(1-a.y)*f.height)},_setInnerWidth:function(a){var b=this._contentSize.width,c=b,d=this._innerContainer,e=d.width;switch(b>a?cc.log("Inner width <= scrollview width, it will be force sized!"):
c=a,d.width=c,this.direction){case ccui.ScrollView.DIR_HORIZONTAL:case ccui.ScrollView.DIR_BOTH:d.getRightBoundary()<=b&&this._scrollChildren(e-d.width,0)}a=d.anchorX;0<d.getLeftBoundary()&&(d.x=a*c);d.getRightBoundary()<b&&(d.x=b-(1-a)*c)},_setInnerHeight:function(a){var b=this._contentSize.height,c=b,d=this._innerContainer,e=d.height;switch(b>a?cc.log("Inner height <= scrollview height, it will be force sized!"):c=a,d.height=c,this.direction){case ccui.ScrollView.DIR_VERTICAL:case ccui.ScrollView.DIR_BOTH:this._scrollChildren(0,
e-c)}a=d.anchorY;0<d.getLeftBoundary()&&(d.y=a*c);d.getRightBoundary()<b&&(d.y=b-(1-a)*c)},getInnerContainerSize:function(){return this._innerContainer.getContentSize()},_getInnerWidth:function(){return this._innerContainer.width},_getInnerHeight:function(){return this._innerContainer.height},addChild:function(a,b,c){return a?(b=b||a.getLocalZOrder(),c=c||a.getTag(),this._innerContainer.addChild(a,b,c)):!1},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(a){this._innerContainer.removeAllChildrenWithCleanup(a)},
removeChild:function(a,b){return this._innerContainer.removeChild(a,b)},getChildren:function(){return this._innerContainer.getChildren()},getChildrenCount:function(){return this._innerContainer.getChildrenCount()},getChildByTag:function(a){return this._innerContainer.getChildByTag(a)},getChildByName:function(a){return this._innerContainer.getChildByName(a)},_moveChildren:function(a,b){var c=this._innerContainer;this._moveChildPoint.x=c.x+a;this._moveChildPoint.y=c.y+b;this._innerContainer.setPosition(this._moveChildPoint)},
_autoScrollChildren:function(a){var b=this._autoScrollAddUpTime;if(this._autoScrollAddUpTime+=a,this._isAutoScrollSpeedAttenuated)0>=this._autoScrollOriginalSpeed+this._autoScrollAcceleration*this._autoScrollAddUpTime?(this._stopAutoScrollChildren(),this._checkNeedBounce()):(b=(this._autoScrollOriginalSpeed+this._autoScrollAcceleration*(2*b+a)*.5)*a,this._scrollChildren(b*this._autoScrollDir.x,b*this._autoScrollDir.y)||(this._stopAutoScrollChildren(),this._checkNeedBounce()));else if(this._needCheckAutoScrollDestination){var b=
this._autoScrollDir.x*a*this._autoScrollOriginalSpeed,c=this._autoScrollDir.y*a*this._autoScrollOriginalSpeed;a=this._checkCustomScrollDestination(b,c);b=this._scrollChildren(b,c);a&&b||(this._stopAutoScrollChildren(),this._checkNeedBounce())}else this._scrollChildren(this._autoScrollDir.x*a*this._autoScrollOriginalSpeed,this._autoScrollDir.y*a*this._autoScrollOriginalSpeed)||(this._stopAutoScrollChildren(),this._checkNeedBounce())},_bounceChildren:function(a){var b=this._bounceOriginalSpeed,c=this._bounceDir;
0>=b&&this._stopBounceChildren();this._bounceScrollChildren(c.x*a*b,c.y*a*b)||this._stopBounceChildren()},_checkNeedBounce:function(){if(!this.bounceEnabled)return!1;this._checkBounceBoundary();var a=this._topBounceNeeded,b=this._bottomBounceNeeded,c=this._leftBounceNeeded,d=this._rightBounceNeeded;if(a||b||c||d){var e,f,g=this._contentSize,h=this._innerContainer;return a&&c?(e=cc.pSub(cc.p(0,g.height),cc.p(h.getLeftBoundary(),h.getTopBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),
this._startBounceChildren(f)):a&&d?(e=cc.pSub(cc.p(g.width,g.height),cc.p(h.getRightBoundary(),h.getTopBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):b&&c?(e=cc.pSub(cc.p(0,0),cc.p(h.getLeftBoundary(),h.getBottomBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):b&&d?(e=cc.pSub(cc.p(g.width,0),cc.p(h.getRightBoundary(),h.getBottomBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):
a?(e=cc.pSub(cc.p(0,g.height),cc.p(0,h.getTopBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):b?(e=cc.pSub(cc.p(0,0),cc.p(0,h.getBottomBoundary())),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):c?(e=cc.pSub(cc.p(0,0),cc.p(h.getLeftBoundary(),0)),f=cc.pLength(e)/.2,this._bounceDir=cc.pNormalize(e),this._startBounceChildren(f)):d&&(e=cc.pSub(cc.p(g.width,0),cc.p(h.getRightBoundary(),0)),f=cc.pLength(e)/.2,this._bounceDir=
cc.pNormalize(e),this._startBounceChildren(f)),!0}return!1},_checkBounceBoundary:function(){var a=this._innerContainer;a.getBottomBoundary()>this._bottomBoundary?(this._scrollToBottomEvent(),this._bottomBounceNeeded=!0):this._bottomBounceNeeded=!1;a.getTopBoundary()<this._topBoundary?(this._scrollToTopEvent(),this._topBounceNeeded=!0):this._topBounceNeeded=!1;a.getRightBoundary()<this._rightBoundary?(this._scrollToRightEvent(),this._rightBounceNeeded=!0):this._rightBounceNeeded=!1;a.getLeftBoundary()>
this._leftBoundary?(this._scrollToLeftEvent(),this._leftBounceNeeded=!0):this._leftBounceNeeded=!1},_startBounceChildren:function(a){this._bounceOriginalSpeed=a;this._bouncing=!0},_stopBounceChildren:function(){this._bouncing=!1;this._bounceOriginalSpeed=0;this._bottomBounceNeeded=this._topBounceNeeded=this._rightBounceNeeded=this._leftBounceNeeded=!1},_startAutoScrollChildrenWithOriginalSpeed:function(a,b,c,d){this._stopAutoScrollChildren();this._autoScrollDir.x=a.x;this._autoScrollDir.y=a.y;this._isAutoScrollSpeedAttenuated=
c;this._autoScrollOriginalSpeed=b;this._autoScroll=!0;this._autoScrollAcceleration=d},_startAutoScrollChildrenWithDestination:function(a,b,c){this._needCheckAutoScrollDestination=!1;this._autoScrollDestination=a;var d=cc.pSub(a,this._innerContainer.getPosition());a=cc.pNormalize(d);var e=0,f=-1E3,d=cc.pLength(d);c?(f=-(2*d)/(b*b),e=2*d/b):(this._needCheckAutoScrollDestination=!0,e=d/b);this._startAutoScrollChildrenWithOriginalSpeed(a,e,c,f)},_jumpToDestination:function(a,b){void 0!==a.x&&(b=a.y,a=
a.x);var c=a,d=b;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:0>=b&&(d=Math.max(b,this._contentSize.height-this._innerContainer.getContentSize().height));break;case ccui.ScrollView.DIR_HORIZONTAL:0>=a&&(c=Math.max(a,this._contentSize.width-this._innerContainer.getContentSize().width));break;case ccui.ScrollView.DIR_BOTH:0>=b&&(d=Math.max(b,this._contentSize.height-this._innerContainer.getContentSize().height)),0>=a&&(c=Math.max(a,this._contentSize.width-this._innerContainer.getContentSize().width))}this._innerContainer.setPosition(c,
d)},_stopAutoScrollChildren:function(){this._autoScroll=!1;this._autoScrollAddUpTime=this._autoScrollOriginalSpeed=0},_bounceScrollChildren:function(a,b){var c,d,e,f,g=!0;f=this._innerContainer;0<a&&0<b?(c=a,d=b,e=f.getRightBoundary(),e+c>=this._rightBoundary&&(c=this._rightBoundary-e,this._bounceRightEvent(),g=!1),f=f.getTopBoundary(),f+b>=this._topBoundary&&(d=this._topBoundary-f,this._bounceTopEvent(),g=!1),this._moveChildren(c,d)):0>a&&0<b?(c=a,d=b,e=f.getLeftBoundary(),e+c<=this._leftBoundary&&
(c=this._leftBoundary-e,this._bounceLeftEvent(),g=!1),f=f.getTopBoundary(),f+b>=this._topBoundary&&(d=this._topBoundary-f,this._bounceTopEvent(),g=!1),this._moveChildren(c,d)):0>a&&0>b?(c=a,d=b,e=f.getLeftBoundary(),e+c<=this._leftBoundary&&(c=this._leftBoundary-e,this._bounceLeftEvent(),g=!1),f=f.getBottomBoundary(),f+b<=this._bottomBoundary&&(d=this._bottomBoundary-f,this._bounceBottomEvent(),g=!1),this._moveChildren(c,d)):0<a&&0>b?(c=a,d=b,e=f.getRightBoundary(),e+c>=this._rightBoundary&&(c=this._rightBoundary-
e,this._bounceRightEvent(),g=!1),f=f.getBottomBoundary(),f+b<=this._bottomBoundary&&(d=this._bottomBoundary-f,this._bounceBottomEvent(),g=!1),this._moveChildren(c,d)):0==a&&0<b?(d=b,f=f.getTopBoundary(),f+b>=this._topBoundary&&(d=this._topBoundary-f,this._bounceTopEvent(),g=!1),this._moveChildren(0,d)):0==a&&0>b?(d=b,f=f.getBottomBoundary(),f+b<=this._bottomBoundary&&(d=this._bottomBoundary-f,this._bounceBottomEvent(),g=!1),this._moveChildren(0,d)):0<a&&0==b?(c=a,e=f.getRightBoundary(),e+c>=this._rightBoundary&&
(c=this._rightBoundary-e,this._bounceRightEvent(),g=!1),this._moveChildren(c,0)):0>a&&0==b&&(c=a,d=f.getLeftBoundary(),d+c<=this._leftBoundary&&(c=this._leftBoundary-d,this._bounceLeftEvent(),g=!1),this._moveChildren(c,0));return g},_checkCustomScrollDestination:function(a,b){var c,d,e,f,g=!0,h=this._innerContainer,k=this._autoScrollDestination;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:0<this._autoScrollDir.y?(c=h.getBottomBoundary(),c+b>=k.y&&(g=!1)):(c=h.getBottomBoundary(),c+b<=
k.y&&(g=!1));break;case ccui.ScrollView.DIR_HORIZONTAL:0<this._autoScrollDir.x?(d=h.getLeftBoundary(),d+a>=k.x&&(g=!1)):(d=h.getLeftBoundary(),d+a<=k.x&&(g=!1));break;case ccui.ScrollView.DIR_BOTH:0<a&&0<b?(d=h.getLeftBoundary(),d+a>=k.x&&(g=!1),c=h.getBottomBoundary(),c+b>=k.y&&(g=!1)):0>a&&0<b?(e=h.getRightBoundary(),e+a<=k.x&&(g=!1),c=h.getBottomBoundary(),c+b>=k.y&&(g=!1)):0>a&&0>b?(e=h.getRightBoundary(),e+a<=k.x&&(g=!1),f=h.getTopBoundary(),f+b<=k.y&&(g=!1)):0<a&&0>b?(d=h.getLeftBoundary(),
d+a>=k.x&&(g=!1),f=h.getTopBoundary(),f+b<=k.y&&(g=!1)):0==a&&0<b?(c=h.getBottomBoundary(),c+b>=k.y&&(g=!1)):0>a&&0==b?(e=h.getRightBoundary(),e+a<=k.x&&(g=!1)):0==a&&0>b?(f=h.getTopBoundary(),f+b<=k.y&&(g=!1)):0<a&&0==b&&(d=h.getLeftBoundary(),d+a>=k.x&&(g=!1))}return g},_scrollChildren:function(a,b){var c=!0;switch(this._scrollingEvent(),this.direction){case ccui.ScrollView.DIR_VERTICAL:c=this._scrollChildrenVertical(a,b);break;case ccui.ScrollView.DIR_HORIZONTAL:c=this._scrollChildrenHorizontal(a,
b);break;case ccui.ScrollView.DIR_BOTH:c=this._scrollChildrenBoth(a,b)}return c},_scrollChildrenVertical:function(a,b){var c,d,e=b,f=!0,g=this._innerContainer;return this.bounceEnabled?(c=g.getBottomBoundary(),c+b>=this._bounceBottomBoundary&&(e=this._bounceBottomBoundary-c,this._scrollToBottomEvent(),f=!1),d=g.getTopBoundary(),d+b<=this._bounceTopBoundary&&(e=this._bounceTopBoundary-d,this._scrollToTopEvent(),f=!1)):(c=g.getBottomBoundary(),c+b>=this._bottomBoundary&&(e=this._bottomBoundary-c,this._scrollToBottomEvent(),
f=!1),d=g.getTopBoundary(),d+b<=this._topBoundary&&(e=this._topBoundary-d,this._scrollToTopEvent(),f=!1)),this._moveChildren(0,e),f},_scrollChildrenHorizontal:function(a){var b,c,d=!0,e=a,f=this._innerContainer;return this.bounceEnabled?(b=f.getRightBoundary(),b+a<=this._bounceRightBoundary&&(e=this._bounceRightBoundary-b,this._scrollToRightEvent(),d=!1),c=f.getLeftBoundary(),c+a>=this._bounceLeftBoundary&&(e=this._bounceLeftBoundary-c,this._scrollToLeftEvent(),d=!1)):(b=f.getRightBoundary(),b+a<=
this._rightBoundary&&(e=this._rightBoundary-b,this._scrollToRightEvent(),d=!1),c=f.getLeftBoundary(),c+a>=this._leftBoundary&&(e=this._leftBoundary-c,this._scrollToLeftEvent(),d=!1)),this._moveChildren(e,0),d},_scrollChildrenBoth:function(a,b){var c,d,e,f,g=!0,h=a,k=b,m=this._innerContainer;return this.bounceEnabled?0<a&&0<b?(c=m.getLeftBoundary(),c+a>=this._bounceLeftBoundary&&(h=this._bounceLeftBoundary-c,this._scrollToLeftEvent(),g=!1),d=m.getBottomBoundary(),d+b>=this._bounceBottomBoundary&&(k=
this._bounceBottomBoundary-d,this._scrollToBottomEvent(),g=!1)):0>a&&0<b?(e=m.getRightBoundary(),e+a<=this._bounceRightBoundary&&(h=this._bounceRightBoundary-e,this._scrollToRightEvent(),g=!1),d=m.getBottomBoundary(),d+b>=this._bounceBottomBoundary&&(k=this._bounceBottomBoundary-d,this._scrollToBottomEvent(),g=!1)):0>a&&0>b?(e=m.getRightBoundary(),e+a<=this._bounceRightBoundary&&(h=this._bounceRightBoundary-e,this._scrollToRightEvent(),g=!1),f=m.getTopBoundary(),f+b<=this._bounceTopBoundary&&(k=this._bounceTopBoundary-
f,this._scrollToTopEvent(),g=!1)):0<a&&0>b?(c=m.getLeftBoundary(),c+a>=this._bounceLeftBoundary&&(h=this._bounceLeftBoundary-c,this._scrollToLeftEvent(),g=!1),f=m.getTopBoundary(),f+b<=this._bounceTopBoundary&&(k=this._bounceTopBoundary-f,this._scrollToTopEvent(),g=!1)):0==a&&0<b?(d=m.getBottomBoundary(),d+b>=this._bounceBottomBoundary&&(k=this._bounceBottomBoundary-d,this._scrollToBottomEvent(),g=!1)):0>a&&0==b?(e=m.getRightBoundary(),e+a<=this._bounceRightBoundary&&(h=this._bounceRightBoundary-
e,this._scrollToRightEvent(),g=!1)):0==a&&0>b?(f=m.getTopBoundary(),f+b<=this._bounceTopBoundary&&(k=this._bounceTopBoundary-f,this._scrollToTopEvent(),g=!1)):0<a&&0==b&&(c=m.getLeftBoundary(),c+a>=this._bounceLeftBoundary&&(h=this._bounceLeftBoundary-c,this._scrollToLeftEvent(),g=!1)):0<a&&0<b?(c=m.getLeftBoundary(),c+a>=this._leftBoundary&&(h=this._leftBoundary-c,this._scrollToLeftEvent(),g=!1),d=m.getBottomBoundary(),d+b>=this._bottomBoundary&&(k=this._bottomBoundary-d,this._scrollToBottomEvent(),
g=!1)):0>a&&0<b?(e=m.getRightBoundary(),e+a<=this._rightBoundary&&(h=this._rightBoundary-e,this._scrollToRightEvent(),g=!1),d=m.getBottomBoundary(),d+b>=this._bottomBoundary&&(k=this._bottomBoundary-d,this._scrollToBottomEvent(),g=!1)):0>a&&0>b?(e=m.getRightBoundary(),e+a<=this._rightBoundary&&(h=this._rightBoundary-e,this._scrollToRightEvent(),g=!1),f=m.getTopBoundary(),f+b<=this._topBoundary&&(k=this._topBoundary-f,this._scrollToTopEvent(),g=!1)):0<a&&0>b?(c=m.getLeftBoundary(),c+a>=this._leftBoundary&&
(h=this._leftBoundary-c,this._scrollToLeftEvent(),g=!1),f=this._innerContainer.getTopBoundary(),f+b<=this._topBoundary&&(k=this._topBoundary-f,this._scrollToTopEvent(),g=!1)):0==a&&0<b?(d=this._innerContainer.getBottomBoundary(),d+b>=this._bottomBoundary&&(k=this._bottomBoundary-d,this._scrollToBottomEvent(),g=!1)):0>a&&0==b?(e=this._innerContainer.getRightBoundary(),e+a<=this._rightBoundary&&(h=this._rightBoundary-e,this._scrollToRightEvent(),g=!1)):0==a&&0>b?(f=this._innerContainer.getTopBoundary(),
f+b<=this._topBoundary&&(k=this._topBoundary-f,this._scrollToTopEvent(),g=!1)):0<a&&0==b&&(c=this._innerContainer.getLeftBoundary(),c+a>=this._leftBoundary&&(h=this._leftBoundary-c,this._scrollToLeftEvent(),g=!1)),this._moveChildren(h,k),g},scrollToBottom:function(a,b){this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),0),a,b)},scrollToTop:function(a,b){this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),this._contentSize.height-
this._innerContainer.getContentSize().height),a,b)},scrollToLeft:function(a,b){this._startAutoScrollChildrenWithDestination(cc.p(0,this._innerContainer.getPositionY()),a,b)},scrollToRight:function(a,b){this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY()),a,b)},scrollToTopLeft:function(a,b){return this.direction!=ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollChildrenWithDestination(cc.p(0,
this._contentSize.height-this._innerContainer.getContentSize().height),a,b)},scrollToTopRight:function(a,b){if(this.direction!=ccui.ScrollView.DIR_BOTH)return void cc.log("Scroll direction is not both!");var c=this._innerContainer.getContentSize();this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-c.width,this._contentSize.height-c.height),a,b)},scrollToBottomLeft:function(a,b){return this.direction!=ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollChildrenWithDestination(cc.p(0,
0),a,b)},scrollToBottomRight:function(a,b){return this.direction!=ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._startAutoScrollChildrenWithDestination(cc.p(this._contentSize.width-this._innerContainer.getContentSize().width,0),a,b)},scrollToPercentVertical:function(a,b,c){var d=this._contentSize.height-this._innerContainer.getContentSize().height,e=-d;this._startAutoScrollChildrenWithDestination(cc.p(this._innerContainer.getPositionX(),d+a*e/100),b,c)},scrollToPercentHorizontal:function(a,
b,c){var d=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollChildrenWithDestination(cc.p(-(a*d/100),this._innerContainer.getPositionY()),b,c)},scrollToPercentBothDirection:function(a,b,c){if(this.direction==ccui.ScrollView.DIR_BOTH){var d=this._contentSize.height-this._innerContainer.getContentSize().height,e=-d,f=this._innerContainer.getContentSize().width-this._contentSize.width;this._startAutoScrollChildrenWithDestination(cc.p(-(a.x*f/100),d+a.y*e/100),b,
c)}},jumpToBottom:function(){this._jumpToDestination(this._innerContainer.getPositionX(),0)},jumpToTop:function(){this._jumpToDestination(this._innerContainer.getPositionX(),this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToLeft:function(){this._jumpToDestination(0,this._innerContainer.getPositionY())},jumpToRight:function(){this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,this._innerContainer.getPositionY())},jumpToTopLeft:function(){return this.direction!=
ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._jumpToDestination(0,this._contentSize.height-this._innerContainer.getContentSize().height)},jumpToTopRight:function(){if(this.direction!=ccui.ScrollView.DIR_BOTH)return void cc.log("Scroll direction is not both!");var a=this._innerContainer.getContentSize();this._jumpToDestination(this._contentSize.width-a.width,this._contentSize.height-a.height)},jumpToBottomLeft:function(){return this.direction!=ccui.ScrollView.DIR_BOTH?
void cc.log("Scroll direction is not both!"):void this._jumpToDestination(0,0)},jumpToBottomRight:function(){return this.direction!=ccui.ScrollView.DIR_BOTH?void cc.log("Scroll direction is not both!"):void this._jumpToDestination(this._contentSize.width-this._innerContainer.getContentSize().width,0)},jumpToPercentVertical:function(a){var b=this._contentSize.height-this._innerContainer.getContentSize().height,c=-b;this._jumpToDestination(this._innerContainer.getPositionX(),b+a*c/100)},jumpToPercentHorizontal:function(a){var b=
this._innerContainer.getContentSize().width-this._contentSize.width;this._jumpToDestination(-(a*b/100),this._innerContainer.getPositionY())},jumpToPercentBothDirection:function(a){if(this.direction==ccui.ScrollView.DIR_BOTH){var b=this._innerContainer.getContentSize(),c=this._contentSize.height-b.height;this._jumpToDestination(-(a.x*(b.width-this._contentSize.width)/100),c+a.y*-c/100)}},_startRecordSlidAction:function(){this._autoScroll&&this._stopAutoScrollChildren();this._bouncing&&this._stopBounceChildren();
this._slidTime=0},_endRecordSlidAction:function(){if(!this._checkNeedBounce()&&this.inertiaScrollEnabled&&!(.016>=this._slidTime)){var a,b=0;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:b=this._touchEndPosition.y-this._touchBeganPosition.y;a=0>b?ccui.ScrollView.SCROLLDIR_DOWN:ccui.ScrollView.SCROLLDIR_UP;break;case ccui.ScrollView.DIR_HORIZONTAL:b=this._touchEndPosition.x-this._touchBeganPosition.x;a=0>b?ccui.ScrollView.SCROLLDIR_LEFT:ccui.ScrollView.SCROLLDIR_RIGHT;break;case ccui.ScrollView.DIR_BOTH:a=
cc.pSub(this._touchEndPosition,this._touchBeganPosition),b=cc.pLength(a),a=cc.pNormalize(a)}b=Math.min(Math.abs(b)/this._slidTime,ccui.ScrollView.AUTO_SCROLL_MAX_SPEED);this._startAutoScrollChildrenWithOriginalSpeed(a,b,!0,-1E3);this._slidTime=0}},_handlePressLogic:function(){this._startRecordSlidAction();this._bePressed=!0},_handleMoveLogic:function(a){a=cc.pSub(a.getLocation(),a.getPreviousLocation());switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:this._scrollChildren(0,a.y);break;case ccui.ScrollView.DIR_HORIZONTAL:this._scrollChildren(a.x,
0);break;case ccui.ScrollView.DIR_BOTH:this._scrollChildren(a.x,a.y)}},_handleReleaseLogic:function(){this._endRecordSlidAction();this._bePressed=!1},onTouchBegan:function(a,b){var c=ccui.Layout.prototype.onTouchBegan.call(this,a,b);return this._hit&&this._handlePressLogic(a),c},onTouchMoved:function(a,b){ccui.Layout.prototype.onTouchMoved.call(this,a,b);this._handleMoveLogic(a)},onTouchEnded:function(a,b){ccui.Layout.prototype.onTouchEnded.call(this,a,b);this._handleReleaseLogic(a)},onTouchCancelled:function(a,
b){ccui.Layout.prototype.onTouchCancelled.call(this,a,b)},update:function(a){this._autoScroll&&this._autoScrollChildren(a);this._bouncing&&this._bounceChildren(a);this._recordSlidTime(a)},_recordSlidTime:function(a){this._bePressed&&(this._slidTime+=a)},interceptTouchEvent:function(a,b,c){var d=c.getLocation();switch(a){case ccui.Widget.TOUCH_BEGAN:this._touchBeganPosition.x=d.x;this._touchBeganPosition.y=d.y;this._handlePressLogic(c);break;case ccui.Widget.TOUCH_MOVED:cc.pLength(cc.pSub(b.getTouchBeganPosition(),
d))>this._childFocusCancelOffset&&(b.setHighlighted(!1),this._touchMovePosition.x=d.x,this._touchMovePosition.y=d.y,this._handleMoveLogic(c));break;case ccui.Widget.TOUCH_CANCELED:case ccui.Widget.TOUCH_ENDED:this._touchEndPosition.x=d.x,this._touchEndPosition.y=d.y,this._handleReleaseLogic(c)}},_scrollToTopEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_TOP);this._eventCallback&&
this._eventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_TOP)},_scrollToBottomEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM)},_scrollToLeftEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,
this,ccui.ScrollView.EVENT_SCROLL_TO_LEFT);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_LEFT)},_scrollToRightEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_SCROLL_TO_RIGHT)},_scrollingEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&
this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_SCROLLING);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_SCROLLING)},_bounceTopEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_TOP);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_BOUNCE_TOP)},_bounceBottomEvent:function(){this._scrollViewEventListener&&
this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_BOTTOM);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_BOUNCE_BOTTOM)},_bounceLeftEvent:function(){this._scrollViewEventListener&&this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_LEFT);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_BOUNCE_LEFT)},_bounceRightEvent:function(){this._scrollViewEventListener&&
this._scrollViewEventSelector&&this._scrollViewEventSelector.call(this._scrollViewEventListener,this,ccui.ScrollView.EVENT_BOUNCE_RIGHT);this._eventCallback&&this._eventCallback(this,ccui.ScrollView.EVENT_BOUNCE_RIGHT)},addEventListenerScrollView:function(a,b){this._scrollViewEventSelector=a;this._scrollViewEventListener=b},addEventListener:function(a){this._eventCallback=a},setDirection:function(a){this.direction=a},getDirection:function(){return this.direction},setBounceEnabled:function(a){this.bounceEnabled=
a},isBounceEnabled:function(){return this.bounceEnabled},setInertiaScrollEnabled:function(a){this.inertiaScrollEnabled=a},isInertiaScrollEnabled:function(){return this.inertiaScrollEnabled},getInnerContainer:function(){return this._innerContainer},setLayoutType:function(a){this._innerContainer.setLayoutType(a)},getLayoutType:function(){return this._innerContainer.getLayoutType()},_doLayout:function(){this._doLayoutDirty&&(this._doLayoutDirty=!1)},getDescription:function(){return"ScrollView"},_createCloneInstance:function(){return ccui.ScrollView.create()},
_copyClonedWidgetChildren:function(a){ccui.Layout.prototype._copyClonedWidgetChildren.call(this,a)},_copySpecialProperties:function(a){a instanceof ccui.ScrollView&&(ccui.Layout.prototype._copySpecialProperties.call(this,a),this.setInnerContainerSize(a.getInnerContainerSize()),this.setDirection(a.direction),this.setBounceEnabled(a.bounceEnabled),this.setInertiaScrollEnabled(a.inertiaScrollEnabled),this._scrollViewEventListener=a._scrollViewEventListener,this._scrollViewEventSelector=a._scrollViewEventSelector,
this._eventCallback=a._eventCallback)},getNodeByTag:function(a){return this._innerContainer.getNodeByTag(a)},getNodes:function(){return this._innerContainer.getNodes()},removeNode:function(a){this._innerContainer.removeNode(a)},removeNodeByTag:function(a){this._innerContainer.removeNodeByTag(a)},removeAllNodes:function(){this._innerContainer.removeAllNodes()},addNode:function(a,b,c){this._innerContainer.addNode(a,b,c)}});_p=ccui.ScrollView.prototype;_p.innerWidth;
cc.defineGetterSetter(_p,"innerWidth",_p._getInnerWidth,_p._setInnerWidth);_p.innerHeight;cc.defineGetterSetter(_p,"innerHeight",_p._getInnerHeight,_p._setInnerHeight);_p=null;ccui.ScrollView.create=function(){return new ccui.ScrollView};ccui.ScrollView.DIR_NONE=0;ccui.ScrollView.DIR_VERTICAL=1;ccui.ScrollView.DIR_HORIZONTAL=2;ccui.ScrollView.DIR_BOTH=3;ccui.ScrollView.EVENT_SCROLL_TO_TOP=0;ccui.ScrollView.EVENT_SCROLL_TO_BOTTOM=1;ccui.ScrollView.EVENT_SCROLL_TO_LEFT=2;
ccui.ScrollView.EVENT_SCROLL_TO_RIGHT=3;ccui.ScrollView.EVENT_SCROLLING=4;ccui.ScrollView.EVENT_BOUNCE_TOP=5;ccui.ScrollView.EVENT_BOUNCE_BOTTOM=6;ccui.ScrollView.EVENT_BOUNCE_LEFT=7;ccui.ScrollView.EVENT_BOUNCE_RIGHT=8;ccui.ScrollView.AUTO_SCROLL_MAX_SPEED=1E3;ccui.ScrollView.SCROLLDIR_UP=cc.p(0,1);ccui.ScrollView.SCROLLDIR_DOWN=cc.p(0,-1);ccui.ScrollView.SCROLLDIR_LEFT=cc.p(-1,0);ccui.ScrollView.SCROLLDIR_RIGHT=cc.p(1,0);
ccui.ListView=ccui.ScrollView.extend({_model:null,_items:null,_gravity:null,_itemsMargin:0,_curSelectedIndex:0,_refreshViewDirty:!0,_listViewEventListener:null,_listViewEventSelector:null,_eventCallback:null,ctor:function(){ccui.ScrollView.prototype.ctor.call(this);this._items=[];this._gravity=ccui.ListView.GRAVITY_CENTER_HORIZONTAL;this.setTouchEnabled(!0);this.init()},init:function(){return ccui.ScrollView.prototype.init.call(this)?(this.setLayoutType(ccui.Layout.LINEAR_VERTICAL),!0):!1},setItemModel:function(a){a&&
(this._model=a)},_updateInnerContainerSize:function(){var a,b,c=this._items;switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:a=c.length;var d=(a-1)*this._itemsMargin;for(b=0;a>b;b++)d+=c[b].getContentSize().height;this.setInnerContainerSize(cc.size(this._contentSize.width,d));break;case ccui.ScrollView.DIR_HORIZONTAL:a=c.length;d=(a-1)*this._itemsMargin;for(b=0;a>b;b++)d+=c[b].getContentSize().width;this.setInnerContainerSize(cc.size(d,this._contentSize.height))}},_remedyLayoutParameter:function(a){if(a){var b;
switch(this.direction){case ccui.ScrollView.DIR_VERTICAL:if(b=a.getLayoutParameter())switch(b.setMargin(0==this.getIndex(a)?ccui.MarginZero():new ccui.Margin(0,this._itemsMargin,0,0)),this._gravity){case ccui.ListView.GRAVITY_LEFT:b.setGravity(ccui.LinearLayoutParameter.LEFT);break;case ccui.ListView.GRAVITY_RIGHT:b.setGravity(ccui.LinearLayoutParameter.RIGHT);break;case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:b.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL)}else{b=ccui.LinearLayoutParameter.create();
switch(this._gravity){case ccui.ListView.GRAVITY_LEFT:b.setGravity(ccui.LinearLayoutParameter.LEFT);break;case ccui.ListView.GRAVITY_RIGHT:b.setGravity(ccui.LinearLayoutParameter.RIGHT);break;case ccui.ListView.GRAVITY_CENTER_HORIZONTAL:b.setGravity(ccui.LinearLayoutParameter.CENTER_HORIZONTAL)}b.setMargin(0==this.getIndex(a)?ccui.MarginZero():new ccui.Margin(0,this._itemsMargin,0,0));a.setLayoutParameter(b)}break;case ccui.ScrollView.DIR_HORIZONTAL:if(b=a.getLayoutParameter())switch(b.setMargin(0==
this.getIndex(a)?ccui.MarginZero():new ccui.Margin(this._itemsMargin,0,0,0)),this._gravity){case ccui.ListView.GRAVITY_TOP:b.setGravity(ccui.LinearLayoutParameter.TOP);break;case ccui.ListView.GRAVITY_BOTTOM:b.setGravity(ccui.LinearLayoutParameter.BOTTOM);break;case ccui.ListView.GRAVITY_CENTER_VERTICAL:b.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL)}else{b=ccui.LinearLayoutParameter.create();switch(this._gravity){case ccui.ListView.GRAVITY_TOP:b.setGravity(ccui.LinearLayoutParameter.TOP);
break;case ccui.ListView.GRAVITY_BOTTOM:b.setGravity(ccui.LinearLayoutParameter.BOTTOM);break;case ccui.ListView.GRAVITY_CENTER_VERTICAL:b.setGravity(ccui.LinearLayoutParameter.CENTER_VERTICAL)}b.setMargin(0==this.getIndex(a)?ccui.MarginZero():new ccui.Margin(this._itemsMargin,0,0,0));a.setLayoutParameter(b)}}}},pushBackDefaultItem:function(){if(this._model){var a=this._model.clone();this._remedyLayoutParameter(a);this.addChild(a);this._refreshViewDirty=!0}},insertDefaultItem:function(a){if(this._model){var b=
this._model.clone();this._items.splice(a,0,b);ccui.ScrollView.prototype.addChild.call(this,b);this._remedyLayoutParameter(b);this._refreshViewDirty=!0}},pushBackCustomItem:function(a){this._remedyLayoutParameter(a);this.addChild(a);this._refreshViewDirty=!0},addChild:function(a,b,c){a&&(b=b||a.getLocalZOrder(),c=c||a.getName(),ccui.ScrollView.prototype.addChild.call(this,a,b,c),a instanceof ccui.Widget&&this._items.push(a))},removeChild:function(a,b){if(a){var c=this._items.indexOf(a);-1<c&&this._items.splice(c,
1);ccui.ScrollView.prototype.removeChild.call(this,a,b)}},removeAllChildren:function(){this.removeAllChildrenWithCleanup(!0)},removeAllChildrenWithCleanup:function(a){ccui.ScrollView.prototype.removeAllChildrenWithCleanup.call(this,a);this._items=[]},insertCustomItem:function(a,b){this._items.splice(b,0,a);ccui.ScrollView.prototype.addChild.call(this,a);this._remedyLayoutParameter(a);this._refreshViewDirty=!0},removeItem:function(a){(a=this.getItem(a))&&(this.removeChild(a,!0),this._refreshViewDirty=
!0)},removeLastItem:function(){this.removeItem(this._items.length-1)},removeAllItems:function(){this.removeAllChildren()},getItem:function(a){return 0>a||a>=this._items.length?null:this._items[a]},getItems:function(){return this._items},getIndex:function(a){return this._items.indexOf(a)},setGravity:function(a){this._gravity!=a&&(this._gravity=a,this._refreshViewDirty=!0)},setItemsMargin:function(a){this._itemsMargin!=a&&(this._itemsMargin=a,this._refreshViewDirty=!0)},getItemsMargin:function(){return this._itemsMargin},
setDirection:function(a){switch(a){case ccui.ScrollView.DIR_VERTICAL:this.setLayoutType(ccui.Layout.LINEAR_VERTICAL);break;case ccui.ScrollView.DIR_HORIZONTAL:this.setLayoutType(ccui.Layout.LINEAR_HORIZONTAL);break;case ccui.ScrollView.DIR_BOTH:return;default:return}ccui.ScrollView.prototype.setDirection.call(this,a)},requestRefreshView:function(){this._refreshViewDirty=!0},refreshView:function(){for(var a=this._items,b=0;b<a.length;b++){var c=a[b];c.setLocalZOrder(b);this._remedyLayoutParameter(c)}this._updateInnerContainerSize()},
doLayout:function(){this._doLayout()},_doLayout:function(){ccui.Layout.prototype._doLayout.call(this);this._refreshViewDirty&&(this.refreshView(),this._refreshViewDirty=!1)},addEventListenerListView:function(a,b){this._listViewEventListener=b;this._listViewEventSelector=a},addEventListener:function(a){this._eventCallback=a},_selectedItemEvent:function(a){a=a==ccui.Widget.TOUCH_BEGAN?ccui.ListView.ON_SELECTED_ITEM_START:ccui.ListView.ON_SELECTED_ITEM_END;this._listViewEventListener&&this._listViewEventSelector&&
this._listViewEventSelector.call(this._listViewEventListener,this,a);this._eventCallback&&this._eventCallback(this,a)},interceptTouchEvent:function(a,b,c){if(ccui.ScrollView.prototype.interceptTouchEvent.call(this,a,b,c),a!=ccui.Widget.TOUCH_MOVED){for(c=b;c;){if(c&&c.getParent()==this._innerContainer){this._curSelectedIndex=this.getIndex(c);break}c=c.getParent()}b.isHighlighted()&&this._selectedItemEvent(a)}},getCurSelectedIndex:function(){return this._curSelectedIndex},_onSizeChanged:function(){ccui.ScrollView.prototype._onSizeChanged.call(this);
this._refreshViewDirty=!0},getDescription:function(){return"ListView"},_createCloneInstance:function(){return ccui.ListView.create()},_copyClonedWidgetChildren:function(a){a=a.getItems();for(var b=0;b<a.length;b++)this.pushBackCustomItem(a[b].clone())},_copySpecialProperties:function(a){a instanceof ccui.ListView&&(ccui.ScrollView.prototype._copySpecialProperties.call(this,a),this.setItemModel(a._model),this.setItemsMargin(a._itemsMargin),this.setGravity(a._gravity),this._listViewEventListener=a._listViewEventListener,
this._listViewEventSelector=a._listViewEventSelector,this._eventCallback=a._eventCallback)}});ccui.ListView.create=function(){return new ccui.ListView};ccui.ListView.EVENT_SELECTED_ITEM=0;ccui.ListView.ON_SELECTED_ITEM_START=0;ccui.ListView.ON_SELECTED_ITEM_END=1;ccui.ListView.GRAVITY_LEFT=0;ccui.ListView.GRAVITY_RIGHT=1;ccui.ListView.GRAVITY_CENTER_HORIZONTAL=2;ccui.ListView.GRAVITY_TOP=3;ccui.ListView.GRAVITY_BOTTOM=4;ccui.ListView.GRAVITY_CENTER_VERTICAL=5;
ccui.PageView=ccui.Layout.extend({_curPageIdx:0,_pages:null,_touchMoveDirection:null,_touchStartLocation:0,_touchMoveStartLocation:0,_movePagePoint:null,_leftBoundaryChild:null,_rightBoundaryChild:null,_leftBoundary:0,_rightBoundary:0,_isAutoScrolling:!1,_autoScrollDistance:0,_autoScrollSpeed:0,_autoScrollDirection:0,_childFocusCancelOffset:0,_pageViewEventListener:null,_pageViewEventSelector:null,_className:"PageView",_eventCallback:null,ctor:function(){ccui.Layout.prototype.ctor.call(this);this._pages=
[];this._touchMoveDirection=ccui.PageView.TOUCH_DIR_LEFT;this._rightBoundaryChild=this._leftBoundaryChild=this._movePagePoint=null;this._childFocusCancelOffset=5;this._pageViewEventSelector=this._pageViewEventListener=null;this.setTouchEnabled(!0)},init:function(){return ccui.Layout.prototype.init.call(this)?(this.setClippingEnabled(!0),!0):!1},onEnter:function(){ccui.Layout.prototype.onEnter.call(this);this.scheduleUpdate(!0)},addWidgetToPage:function(a,b,c){if(a&&!(0>b)){var d=this._getPageCount();
0>b||b>=d?c&&(b>d&&cc.log("pageIdx is %d, it will be added as page id [%d]",b,d),b=this._createPage(),b.addChild(a),this.addPage(b)):(b=this._pages[b])&&b.addChild(a)}},_createPage:function(){var a=ccui.Layout.create();return a.setContentSize(this.getContentSize()),a},addPage:function(a){a&&-1==this._pages.indexOf(a)&&(this.addChild(a),this._pages.push(a),this._doLayoutDirty=!0)},insertPage:function(a,b){if(!(0>b)&&a&&-1==this._pages.indexOf(a)){var c=this._getPageCount();b>=c?this.addPage(a):(this._pages[b]=
a,this.addChild(a));this._doLayoutDirty=!0}},removePage:function(a){a&&(this.removeChild(a),a=this._pages.indexOf(a),-1<a&&this._pages.splice(a,1),this._doLayoutDirty=!0)},removePageAtIndex:function(a){0>a||a>=this._pages.length||(a=this._pages[a])&&this.removePage(a)},removeAllPages:function(){for(var a=this._pages,b=0,c=a.length;c>b;b++)this.removeChild(a[b]);this._pages.length=0},_updateBoundaryPages:function(){var a=this._pages;return 0>=a.length?(this._leftBoundaryChild=null,void(this._rightBoundaryChild=
null)):(this._leftBoundaryChild=a[0],void(this._rightBoundaryChild=a[a.length-1]))},_getPageCount:function(){return this._pages.length},_getPositionXByIndex:function(a){return this.getContentSize().width*(a-this._curPageIdx)},_onSizeChanged:function(){ccui.Layout.prototype._onSizeChanged.call(this);this._rightBoundary=this.getContentSize().width;this._doLayoutDirty=!0},_updateAllPagesSize:function(){for(var a=this.getContentSize(),b=this._pages,c=0,d=b.length;d>c;c++)b[c].setContentSize(a)},_updateAllPagesPosition:function(){var a=
this._getPageCount();if(0>=a)return void(this._curPageIdx=0);this._curPageIdx>=a&&(this._curPageIdx=a-1);for(var b=this.getContentSize().width,c=this._pages,d=0;a>d;d++)c[d].setPosition(cc.p((d-this._curPageIdx)*b,0))},scrollToPage:function(a){0>a||a>=this._pages.length||(this._curPageIdx=a,this._autoScrollDistance=-this._pages[a].getPosition().x,this._autoScrollSpeed=Math.abs(this._autoScrollDistance)/.2,this._autoScrollDirection=0<this._autoScrollDistance?ccui.PageView.DIRECTION_RIGHT:ccui.PageView.DIRECTION_LEFT,
this._isAutoScrolling=!0)},update:function(a){this._isAutoScrolling&&this._autoScroll(a)},setLayoutType:function(){},getLayoutType:function(){return ccui.Layout.ABSOLUTE},_autoScroll:function(a){switch(this._autoScrollDirection){case ccui.PageView.DIRECTION_LEFT:a*=this._autoScrollSpeed;0<=this._autoScrollDistance+a?(a=-this._autoScrollDistance,this._autoScrollDistance=0,this._isAutoScrolling=!1):this._autoScrollDistance+=a;this._scrollPages(-a);this._isAutoScrolling||this._pageTurningEvent();break;
case ccui.PageView.DIRECTION_RIGHT:a*=this._autoScrollSpeed,0>=this._autoScrollDistance-a?(a=this._autoScrollDistance,this._autoScrollDistance=0,this._isAutoScrolling=!1):this._autoScrollDistance-=a,this._scrollPages(a),this._isAutoScrolling||this._pageTurningEvent()}},onTouchMoved:function(a){this._handleMoveLogic(a);var b=this.getWidgetParent();b&&b.interceptTouchEvent(ccui.Widget.TOUCH_MOVED,this,a);this._moveEvent()},onTouchEnded:function(a,b){ccui.Layout.prototype.onTouchEnded.call(this,a,b);
this._handleReleaseLogic(a)},onTouchCancelled:function(a,b){ccui.Layout.prototype.onTouchCancelled.call(this,a,b);this._handleReleaseLogic(a)},_doLayout:function(){this._doLayoutDirty&&(this._updateAllPagesPosition(),this._updateAllPagesSize(),this._updateBoundaryPages(),this._doLayoutDirty=!1)},_movePages:function(a){for(var b=this._pages,c=b.length,d=0;c>d;d++){var e=b[d];e.setPositionX(e.getPositionX()+a)}},_scrollPages:function(a){if(0>=this._pages.length||!this._leftBoundaryChild||!this._rightBoundaryChild)return!1;
var b=a;switch(this._touchMoveDirection){case ccui.PageView.TOUCH_DIR_LEFT:var c=this._rightBoundaryChild.getRightBoundary();if(c+a<=this._rightBoundary)return b=this._rightBoundary-c,this._movePages(b),!1;break;case ccui.PageView.TOUCH_DIR_RIGHT:if(c=this._leftBoundaryChild.getLeftBoundary(),c+a>=this._leftBoundary)return b=this._leftBoundary-c,this._movePages(b),!1}return this._movePages(b),!0},_handleMoveLogic:function(a){a=a.getLocation().x-a.getPreviousLocation().x;0>a?this._touchMoveDirection=
ccui.PageView.TOUCH_DIR_LEFT:0<a&&(this._touchMoveDirection=ccui.PageView.TOUCH_DIR_RIGHT);this._scrollPages(a)},_handleReleaseLogic:function(){if(!(0>=this._pages.length)){var a=this._pages[this._curPageIdx];if(a){var b=a.getPosition(),a=this._pages.length,b=b.x,c=this.getSize().width/2;-c>=b?this._curPageIdx>=a-1?this._scrollPages(-b):this.scrollToPage(this._curPageIdx+1):b>=c?0>=this._curPageIdx?this._scrollPages(-b):this.scrollToPage(this._curPageIdx-1):this.scrollToPage(this._curPageIdx)}}},
interceptTouchEvent:function(a,b,c){var d=c.getLocation();switch(a){case ccui.Widget.TOUCH_BEGAN:this._touchBeganPosition.x=d.x;this._touchBeganPosition.y=d.y;break;case ccui.Widget.TOUCH_MOVED:this._touchMovePosition.x=d.x;this._touchMovePosition.y=d.y;a=0;a=Math.abs(b.getTouchBeganPosition().x-d.x);a>this._childFocusCancelOffset&&(b.setFocused(!1),this._handleMoveLogic(c));break;case ccui.Widget.TOUCH_ENDED:this._touchEndPosition.x=d.x;this._touchEndPosition.y=d.y;break;case ccui.Widget.TOUCH_CANCELED:this._handleReleaseLogic(c)}},
_pageTurningEvent:function(){this._pageViewEventListener&&this._pageViewEventSelector&&this._pageViewEventSelector.call(this._pageViewEventListener,this,ccui.PageView.EVENT_TURNING);this._eventCallback&&this._eventCallback(this,ccui.PageView.EVENT_TURNING)},addEventListenerPageView:function(a,b){this._pageViewEventSelector=a;this._pageViewEventListener=b},addEventListener:function(a){this._eventCallback=a},getCurPageIndex:function(){return this._curPageIdx},getPages:function(){return this._pages},
getPage:function(a){return 0>a||a>=this.getPages().size()?null:this._pages[a]},getDescription:function(){return"PageView"},_createCloneInstance:function(){return ccui.PageView.create()},_copyClonedWidgetChildren:function(a){a=a.getPages();for(var b=0;b<a.length;b++)this.addPage(a[b].clone())},_copySpecialProperties:function(a){ccui.Layout.prototype._copySpecialProperties.call(this,a);this._eventCallback=a._eventCallback;this._pageViewEventListener=a._pageViewEventListener;this._pageViewEventSelector=
a._pageViewEventSelector}});ccui.PageView.create=function(){return new ccui.PageView};ccui.PageView.EVENT_TURNING=0;ccui.PageView.TOUCH_DIR_LEFT=0;ccui.PageView.TOUCH_DIR_RIGHT=1;ccui.PageView.DIRECTION_LEFT=0;ccui.PageView.DIRECTION_RIGHT=1;var battlelayer,toastLayer,teamlayer,jsonData,gameModle,selectFriend=0,bestScore=0,showBossNum=3,shareContent="\u5b88\u62a4\u68a6\u60f3\uff0c\u4fdd\u536b\u5076\u50cf\uff01\u4e2d\u56fd\u68a6\u4e4b\u58f0\uff0c\u5076\u50cf\u9700\u8981\u4f60\u6765\u4fdd\u62a4\uff01",shareTitle="\u4fdd\u536b\u5076\u50cf",shareImg="http://api.51wala.com/h5/wala/img/icon.png",shareUrl="http://api.51wala.com/h5/wala/bwox.html",hanhList=["\u54e6\uff0c\u55d3\u97f3\u4e0d\u9519\u54e6\uff01","\u54c8\u54c8\uff0c\u8c22\u8c22\uff01",
"\u4e48\u4e48\u54d2\uff01","\u662f\u5417\uff0c\u54c8\u54c8\u54c8\uff01","\u771f\u7684\u5417\uff0c\u54c8\u54c8\uff01"],renxqList=["\u8c22\u8c22\u4f60\u7684\u652f\u6301\u5566\uff01","\u662f\u5417\uff0c\u4f60\u4e5f\u53ef\u4ee5\uff01","\u90a3\u662f\u5f53\u7136\u54af\uff01","\u4f60\u8fd9\u4e48\u8bf4\u6211\u5f88\u5f00\u5fc3\uff01"],hateList=["\u5c0f\u4f19\u5b50\u836f\u4e0d\u80fd\u505c\u554a\u3002","\u5c0f\u4f19\u5b50\u836f\u4e0d\u80fd\u505c\u554a\u3002","\u5c0f\u4f19\u5b50\u522b\u653e\u5f03\u6cbb\u7597\uff01"],
goodList=["\u8001\u5e08\u4f60\u4e00\u76f4\u662f\u6211\u7684\u5076\u50cf\uff01","\u8001\u5e08\uff0c\u6211\u7231\u4f60\uff0c\u4e48\u4e48\u54d2\uff01","\u8001\u5e08\u4f60\u662f\u6211\u7684\u6307\u8def\u660e\u706f\uff01","\u6211\u542c\u4f60\u7684\u6b4c\u957f\u5927\u7684\uff01","\u4f60\u7684\u6b4c\u6211\u767e\u542c\u4e0d\u538c\uff01"],badList=["\u6211\u53cc\u811a\u5b83\u8bf4\u4e5f\u8981\u63e1\uff01","\u8981\u63e1\u5de6\u624b\u8fd8\u662f\u53f3\u624b\uff1f","\u6211\u5c31\u662f\u4f4f\u4f60\u9694\u58c1\u7684\u8001\u738b\uff1f",
"\u7b7e\u540d\u3001\u62e5\u62b1\u3001\u5408\u5531\u6211\u90fd\u8981\u3002","(\u2299o\u2299)\u2026\uff0c\u4f60\u662f\u8c01\uff1f"],countShare=function(){var a=cc.loader.getXMLHttpRequest();a.open("GET","http://api.51wala.com/guardIdol/share.json?src=wala");a.onreadystatechange=function(){};a.send()},bossPeople=cc.Sprite.extend({state:1,animation_hate:null,animation_like:null,animation_wait:null,animation_fly:null,labelDialogue:null,sprDialogue:null,ctor:function(a){this._super("img/boss_wait_1.png");
this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation()},showDialogue:function(a){},hideDialogue:function(){},addAnimation:function(){this.animation_hate=new cc.Animation;this.animation_hate.addSpriteFrameWithFile("img/boss_hate_1.png");this.animation_hate.setDelayPerUnit(.1);this.animation_hate.setRestoreOriginalFrame(!1);this.animation_fly=new cc.Animation;this.animation_fly.addSpriteFrameWithFile("img/boss_fly_1.png");this.animation_fly.setDelayPerUnit(.1);this.animation_fly.setRestoreOriginalFrame(!1)},
like:function(){},hate:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},wait:function(){var a=cc.animate(this.animation_wait);this.runAction(a)},hand:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},fly:function(){var a=cc.animate(this.animation_fly);return cc.spawn(a,cc.rotateTo(1,1080),cc.scaleTo(1,.5))},playAction:function(a){1==a?this.like():0==a?this.hate():2==a&&this.wait()},isBoss:function(){return!0}});bossPeople.getFromPool=function(){return new bossPeople};
var liyPeople=cc.Sprite.extend({state:1,animation_liy_hate:null,animation_liy_like:null,ctor:function(a){this._super("#liy_wait_2.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation()},addAnimation:function(){this.animation_liy_hate=new cc.Animation;for(i=2;6>i;i++)str="img/liy_hate_"+i+".png",this.animation_liy_hate.addSpriteFrameWithFile(str);this.animation_liy_hate.setDelayPerUnit(.05);this.animation_liy_hate.setRestoreOriginalFrame(!0);var a=[];for(i=1;5>i;i++){str="liy_like_"+
i+".png";var b=cc.spriteFrameCache.getSpriteFrame(str);a.push(b)}this.animation_liy_like=new cc.Animation(a,.03);this.animation_liy_like.setRestoreOriginalFrame(!0)},like:function(){var a=cc.animate(this.animation_liy_like);this.runAction(a)},hate:function(){var a=cc.animate(this.animation_liy_hate);this.runAction(a)},playAction:function(a){1==a||2==a?this.like():0==a&&this.hate()}});liyPeople.getFromPool=function(){return new liyPeople};
var guojmPeople=cc.Sprite.extend({state:1,animation_hate:null,animation_like:null,animation_wait:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#guojm_hate_1.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_1.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(30,this.getContentSize().height+80);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("",
"Arial",24);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(30,this.getContentSize().height+80);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(a){0==parseInt(2*Math.random())?(1==a?this.labelDialogue.setString(renxqList[parseInt(4*Math.random())]):this.labelDialogue.setString(hateList[parseInt(3*Math.random())]),this.sprDialogue.setVisible(!0)):(a=parseInt(20*Math.random())+1,this.imgDialogue.setTexture("img/expression_"+a+".png"),this.expDialogue.setVisible(!0))},hideDialogue:function(){this.sprDialogue.setVisible(!1);
this.expDialogue.setVisible(!1)},addAnimation:function(){this.animation_hate=new cc.Animation;this.animation_like=new cc.Animation;var a=[];for(i=2;4>i;i++){str="guojm_hate_"+i+".png";var b=cc.spriteFrameCache.getSpriteFrame(str);a.push(b)}this.animation_hate=new cc.Animation(a,.1);this.animation_hate.setRestoreOriginalFrame(!1);a=[];for(i=2;0<i;i--)str="guojm_like_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(str),a.push(b);this.animation_like=new cc.Animation(a,.1);this.animation_like.setRestoreOriginalFrame(!1)},
like:function(){var a=cc.animate(this.animation_like);this.runAction(a)},hate:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},wait:function(){var a=cc.animate(this.animation_wait);this.runAction(a)},playAction:function(a){1==a?this.like():0==a?this.hate():5==a&&this.hate()}});guojmPeople.getFromPool=function(){return new guojmPeople};
var xurxPeople=cc.Sprite.extend({state:1,animation_hate:null,animation_like:null,animation_wait:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#xurx_hate_1.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_1.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(30,this.getContentSize().height+80);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("",
"Arial",24);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(50,this.getContentSize().height+80);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(a){0==parseInt(2*Math.random())?(1==a?this.labelDialogue.setString(renxqList[parseInt(4*Math.random())]):this.labelDialogue.setString(hateList[parseInt(3*Math.random())]),this.sprDialogue.setVisible(!0)):(a=parseInt(20*Math.random())+1,this.imgDialogue.setTexture("img/expression_"+a+".png"),this.expDialogue.setVisible(!0))},hideDialogue:function(){this.sprDialogue.setVisible(!1);
this.expDialogue.setVisible(!1)},addAnimation:function(){this.animation_hate=new cc.Animation;this.animation_like=new cc.Animation;var a=[];for(i=2;4>i;i++){str="xurx_hate_"+i+".png";var b=cc.spriteFrameCache.getSpriteFrame(str);a.push(b)}this.animation_hate=new cc.Animation(a,.1);this.animation_hate.setRestoreOriginalFrame(!1);a=[];for(i=1;3>i;i++)str="xurx_like_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(str),a.push(b);this.animation_like=new cc.Animation(a,.1);this.animation_like.setRestoreOriginalFrame(!1)},
like:function(){var a=cc.animate(this.animation_like);this.runAction(a)},hate:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},wait:function(){var a=cc.animate(this.animation_wait);this.runAction(a)},playAction:function(a){1==a?this.like():0==a?this.hate():5==a&&this.hate()}});xurxPeople.getFromPool=function(){return new xurxPeople};
var hanhPeople=cc.Sprite.extend({state:1,animation_hate:null,animation_like:null,animation_wait:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#hanh_hate_1.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_1.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(60,this.getContentSize().height+50);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("",
"Arial",24);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(50,this.getContentSize().height+80);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(a){0==parseInt(2*Math.random())?(1==a?this.labelDialogue.setString(renxqList[parseInt(4*Math.random())]):this.labelDialogue.setString(hateList[parseInt(3*Math.random())]),this.sprDialogue.setVisible(!0)):(a=parseInt(20*Math.random())+1,this.imgDialogue.setTexture("img/expression_"+a+".png"),this.expDialogue.setVisible(!0))},hideDialogue:function(){this.sprDialogue.setVisible(!1);
this.expDialogue.setVisible(!1)},addAnimation:function(){var a=[];for(i=1;4>i;i++){str="hanh_hate_"+i+".png";var b=cc.spriteFrameCache.getSpriteFrame(str);a.push(b)}this.animation_hate=new cc.Animation(a,.1);this.animation_hate.setRestoreOriginalFrame(!1);a=[];for(i=1;3>i;i++)str="hanh_like_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(str),a.push(b);this.animation_like=new cc.Animation(a,.1);this.animation_like.setRestoreOriginalFrame(!1)},like:function(){var a=cc.animate(this.animation_like);
this.runAction(a)},hate:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},wait:function(){var a=cc.animate(this.animation_wait);this.runAction(a)},playAction:function(a){1==a?this.like():0==a?this.hate():5==a&&this.hate()}});hanhPeople.getFromPool=function(){return new hanhPeople};
var renxqPeople=cc.Sprite.extend({state:1,animation_hate:null,animation_like:null,animation_wait:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#renxq_hate_1.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_1.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(30,this.getContentSize().height+80);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("",
"Arial",24);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(30,this.getContentSize().height+80);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(a){0==parseInt(2*Math.random())?(1==a?this.labelDialogue.setString(renxqList[parseInt(4*Math.random())]):this.labelDialogue.setString(hateList[parseInt(3*Math.random())]),this.sprDialogue.setVisible(!0)):(a=parseInt(20*Math.random())+1,this.imgDialogue.setTexture("img/expression_"+a+".png"),this.expDialogue.setVisible(!0))},hideDialogue:function(){this.sprDialogue.setVisible(!1);
this.expDialogue.setVisible(!1)},addAnimation:function(){this.animation_hate=new cc.Animation;this.animation_like=new cc.Animation;var a=[];for(i=2;4>i;i++){str="renxq_hate_"+i+".png";var b=cc.spriteFrameCache.getSpriteFrame(str);a.push(b)}this.animation_hate=new cc.Animation(a,.1);this.animation_hate.setRestoreOriginalFrame(!1);a=[];for(i=1;3>i;i++)str="renxq_like_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(str),a.push(b);this.animation_like=new cc.Animation(a,.1);this.animation_like.setRestoreOriginalFrame(!1)},
like:function(){var a=cc.animate(this.animation_like);this.runAction(a)},hate:function(){var a=cc.animate(this.animation_hate);this.runAction(a)},wait:function(){var a=cc.animate(this.animation_wait);this.runAction(a)},playAction:function(a){1==a?this.like():0==a?this.hate():5==a&&this.hate()}});renxqPeople.getFromPool=function(){return new renxqPeople};
var goodPeople=cc.Sprite.extend({state:1,animation_hand:null,animation_fly:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#good_waiting.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_2.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(100,this.getContentSize().height+60);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("","Arial",
24);this.labelDialogue.setColor(0,0,0);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(100,this.getContentSize().height+60);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(){if(0==parseInt(2*Math.random()))this.labelDialogue.setString(goodList[parseInt(5*Math.random())]),this.sprDialogue.setVisible(!0);else{var a=parseInt(20*Math.random())+1;this.imgDialogue.setTexture("img/expression_"+a+".png");this.expDialogue.setVisible(!0)}},hideDialogue:function(){this.sprDialogue.setVisible(!1);this.expDialogue.setVisible(!1)},addAnimation:function(){var a=
[];for(i=1;3>i;i++)b="good_hand_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(b),a.push(b);this.animation_hand=new cc.Animation(a,.1);this.animation_hand.setRestoreOriginalFrame(!1);var b;b=cc.spriteFrameCache.getSpriteFrame("good_fly_1.png");this.animation_fly=new cc.Animation([b],.1);this.animation_fly.setRestoreOriginalFrame(!1)},hand:function(){var a=cc.animate(this.animation_hand);this.runAction(a)},fly:function(){return cc.animate(this.animation_fly)},isBoss:function(){return!1}});
goodPeople.getFromPool=function(){return new goodPeople};
var badPeople=cc.Sprite.extend({state:1,animation_hand:null,animation_fly:null,labelDialogue:null,sprDialogue:null,expDialogue:null,imgDialogue:null,ctor:function(a){this._super("#bad_hand_1.png");this.attr({anchorX:.5,anchorY:.5,target:a});this.addAnimation();this.sprDialogue=cc.Sprite.create("img/dialogue_2.png");this.sprDialogue.setAnchorPoint(0,1);this.sprDialogue.setPosition(50,this.getContentSize().height+40);this.addChild(this.sprDialogue);this.labelDialogue=cc.LabelTTF.create("","Arial",24);
this.labelDialogue.setColor(0,0,0);this.labelDialogue.setPosition(this.sprDialogue.getContentSize().width/2,this.sprDialogue.getContentSize().height/2+15);this.sprDialogue.addChild(this.labelDialogue);this.sprDialogue.setVisible(!1);this.expDialogue=cc.Sprite.create("img/dialogue_5.png");this.expDialogue.setAnchorPoint(0,1);this.expDialogue.setPosition(50,this.getContentSize().height+40);this.addChild(this.expDialogue);this.imgDialogue=cc.Sprite.create("img/expression_1.png");this.imgDialogue.setPosition(this.expDialogue.getContentSize().width/
2,this.expDialogue.getContentSize().height/2+15);this.expDialogue.addChild(this.imgDialogue);this.expDialogue.setVisible(!1)},showDialogue:function(){if(0==parseInt(2*Math.random()))this.labelDialogue.setString(goodList[parseInt(5*Math.random())]),this.sprDialogue.setVisible(!0);else{var a=parseInt(20*Math.random())+1;this.imgDialogue.setTexture("img/expression_"+a+".png");this.expDialogue.setVisible(!0)}},hideDialogue:function(){this.sprDialogue.setVisible(!1);this.expDialogue.setVisible(!1)},addAnimation:function(){var a=
[];for(i=2;4>i;i++)b="bad_hand_"+i+".png",b=cc.spriteFrameCache.getSpriteFrame(b),a.push(b);this.animation_hand=new cc.Animation(a,.1);this.animation_hand.setRestoreOriginalFrame(!1);var b;b=cc.spriteFrameCache.getSpriteFrame("bad_fly_1.png");this.animation_fly=new cc.Animation([b],.1);this.animation_fly.setRestoreOriginalFrame(!1)},hand:function(){var a=cc.animate(this.animation_hand);this.runAction(a)},fly:function(){return cc.animate(this.animation_fly)},isBoss:function(){return!1}});
badPeople.getFromPool=function(){return new badPeople};
var HelloLayer=cc.Layer.extend({init:function(){this._super();var a=cc.director.getWinSize(),b=cc.Sprite.create("img/backgroud.png");b.setPosition(a.width/2,a.height/2);this.addChild(b,0);b=cc.Sprite.create("img/people_all.png");b.setAnchorPoint(.5,0);b.setPosition(a.width/2,0);this.addChild(b,0);b=cc.MenuItemImage.create("img/buttonsingle.png","img/buttonsingle.png",this.onMenuCallbackBegin,this);b.setPosition(a.width/2,300);var c=cc.MenuItemImage.create("img/buttonteam.png","img/buttonteam.png",
this.onMenuCallbackTeam,this);c.setPosition(a.width/2,150);var d=cc.MenuItemImage.create("img/buttonHelp.png","img/buttonHelp.png",this.onMenuCallbackHelp,this);d.setPosition(a.width-120,50);a=cc.Menu.create(b,d,c);this.addChild(a,5);a.setPosition(0,0)},sendGetRequest:function(){var a=this;cc.director.getWinSize();var b=cc.loader.getXMLHttpRequest();b.open("GET","http://api.51wala.com/guardIdol/group.json");b.onreadystatechange=function(){if(4==b.readyState&&200<=b.status&&207>=b.status){jsonData=
JSON.parse(b.responseText);a.removeFromParent(!0);var c=cc.director.getRunningScene();teamlayer=new teamLayer;teamlayer.init();c.addChild(teamlayer)}};b.send()},onMenuCallbackBegin:function(){gameModle=0;this.removeFromParent(!0);var a=cc.director.getRunningScene();battlelayer=new battleLayer;battlelayer.init();a.addChild(battlelayer)},onMenuCallbackHelp:function(){var a=new helpLayer;a.init();this.addChild(a,5)},onMenuCallbackTeam:function(){gameModle=1;this.sendGetRequest()}}),battleLayer=cc.Layer.extend({isMouseDown:!1,
helloImg:null,helloLabel:null,circle:null,sprite:null,starttLocation:null,labelTitle:null,tableArray:null,sprJudges:null,sprBroker:null,spritePlayer:[],sprPointUp:null,sprPointDown:null,isShowPointDown:!1,isShowPointUp:!1,MoveDirectionUp:0,MoveDirectionDown:1,MoveDirectionRight:2,MoveDirectionLeft:3,touchEnabled:!0,MoveDirect:null,textureGood:null,textureGoodPass:null,textureGoodWaiting:null,sprCountdown:null,curCountdown:null,countdownTime:2,labelTime:null,strTotalNum:0,labelTotalNum:null,labelBestScore:null,
randNum:3,bossNum:0,limitTime_1:0,limitTime_2:0,limitTime_3:0,limitTime_4:0,limitTimeAdd_1:-1E3,limitTimeAdd_2:-1E3,limitTimeAdd_3:-1E3,limitTimeAdd_4:-1E3,energyNum:0,isCrazyModle:!1,crazyTime:10,nextPeople:null,sprCrazy:null,sprCrazyModel:null,sprCrazyTime:null,curJudges:null,sprBossDialogue:null,init:function(){if(this._super()){var a=cc.director.getWinSize(),b;this.curCountdown=this.countdownTime;b=new CountdownLayer;b.init();this.addChild(b,99);b=cc.Sprite.create("img/backgroud.png");b.setPosition(a.width/
2,a.height/2);this.addChild(b,0);b=cc.Sprite.create("img/time_1.png");b.setPosition(a.width/2,200);this.addChild(b,8);var c=cc.Sprite.create("img/topBackgroud.png");c.setAnchorPoint(.5,1);c.setPosition(a.width/2,a.height);this.addChild(c,1);this.labelTotalNum=new cc.LabelAtlas("0","img/num.png",36,41,".");this.labelTotalNum.setPosition(c.getContentSize().width-200,12);c.addChild(this.labelTotalNum,1);this.labelBestScore=new cc.LabelAtlas("0","img/num_blue.png",33,38,"0");this.labelBestScore.setString(bestScore);
this.labelBestScore.setPosition(c.getContentSize().width/2-20,65);c.addChild(this.labelBestScore,1);this.sprCountdown=cc.Sprite.create("img/time_2.png");this.sprCountdown.setAnchorPoint(0,0);this.sprCountdown.setPosition(5,5);b.addChild(this.sprCountdown,1);this.labelTime=new cc.LabelAtlas(this.curCountdown+".0","img/num.png",36,41,".");this.labelTime.setPosition(b.getContentSize().width-100,b.getContentSize().height-10);b.addChild(this.labelTime,1);b=cc.Sprite.create("img/backCrazyTime.png");b.setPosition(a.width/
2,130);this.addChild(b,8);this.sprCrazy=cc.Sprite.create("img/crazyEnergy.png");this.sprCrazy.setAnchorPoint(0,0);this.sprCrazy.setPosition(5,5);this.sprCrazy.setScaleX(0);b.addChild(this.sprCrazy,1);b=parseInt(3*Math.random());1==b?(this.sprJudges=xurxPeople.getFromPool(),this.curJudges=1):0==b?(this.sprJudges=renxqPeople.getFromPool(),this.curJudges=0):2==b?(this.sprJudges=hanhPeople.getFromPool(),this.curJudges=2):3==b&&(this.sprJudges=guojmPeople.getFromPool(),this.curJudges=3);this.sprJudges.setPosition(a.width/
2-210,a.height/2);this.addChild(this.sprJudges,5);this.sprBroker=liyPeople.getFromPool();this.sprBroker.setPosition(a.width-150,350);this.addChild(this.sprBroker,5);this.sprPointUp=cc.Sprite.create("img/pointto.png");this.sprPointUp.setPosition(a.width/2-100,a.height/2+50);this.sprPointUp.setVisible(!1);this.addChild(this.sprPointUp,8);b=cc.Sprite.create("img/finger.png");b.setPosition(this.sprPointUp.getContentSize().width/2+40,this.sprPointUp.getContentSize().height/2-20);this.sprPointUp.addChild(b,
1);b=cc.Sprite.create("img/dialogue_3.png");b.setPosition(this.sprPointUp.getContentSize().width+50,this.sprPointUp.getContentSize().height/2+80);this.sprPointUp.addChild(b,1);c=cc.LabelTTF.create("\u6000\u94f6\u51fa\u73b0\uff0c\u8e22\u98de\u4ed6\uff01","Arial",28);c.setPosition(b.getContentSize().width/2,b.getContentSize().height/2+15);b.addChild(c,1);this.sprPointDown=cc.Sprite.create("img/pointto.png");this.sprPointDown.setPosition(a.width/2-70,a.height/2-140);this.sprPointDown.setRotation(180);
this.sprPointDown.setVisible(!1);this.addChild(this.sprPointDown,8);b=cc.Sprite.create("img/finger.png");b.setRotation(180);b.setPosition(20,this.sprPointUp.getContentSize().height/2-20);this.sprPointDown.addChild(b,1);b=cc.Sprite.create("img/dialogue_3.png");b.setPosition(-100,0);b.setRotation(180);this.sprPointDown.addChild(b,1);c=cc.LabelTTF.create("\u7c89\u4e1d\u6765\u54af\uff0c\u8bf7\u8fdb","Arial",28);c.setPosition(b.getContentSize().width/2,b.getContentSize().height/2+15);b.addChild(c,1);for(c=
0;3>c;c++)b=parseInt(2*Math.random()),this.MoveDirectionUp==b?this.spritePlayer[c]=badPeople.getFromPool():this.MoveDirectionDown==b&&(this.spritePlayer[c]=goodPeople.getFromPool()),this.spritePlayer[c].moveDirect=b,this.spritePlayer[c].setAnchorPoint(.5,.5),this.spritePlayer[c].setPosition(a.width/2+30+120*c,a.height/2+80*c),this.addChild(this.spritePlayer[c],3-c,5);this.spritePlayer[1].setScale(.85);this.spritePlayer[2].setScale(.6);this.spritePlayer[0].hand();cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:!0,onTouchBegan:function(a,b){battlelayer.starttLocation=a.getLocation();return!0},onTouchMoved:function(a,b){a.getLocation()},onTouchEnded:function(a,b){if(!(0>=a.length)){var c=a.getLocation(),c=battlelayer.starttLocation.y-c.y;0>c?battlelayer.MoveDirect=battlelayer.MoveDirectionUp:0<c&&(battlelayer.MoveDirect=battlelayer.MoveDirectionDown);battlelayer.updatePlayer(battlelayer.MoveDirect)}}},this);return!0}return!1},onMenuCallbackAdvertising:function(){cc.sys.isNative||window.open("http://www.baidu.com",
"_blank")},updatePlayer:function(a){var b=cc.director.getWinSize(),c;if(this.touchEnabled)if(5==this.spritePlayer[0].moveDirect)this.sprBroker.playAction(0);else{this.touchEnabled=!1;var d=2-Math.round(10*this.curCountdown)/10;0==this.isCrazyModle&&(0<d&&.3>d?this.limitTime_1+=1:.2<d&&.5>d?this.limitTime_2+=1:.4<d&&.9>d?this.limitTime_3+=1:.8<d&&2>d&&(this.limitTime_4+=1));1==this.isCrazyModle?(c=cc.MoveTo.create(.1,cc.p(20,20)),c=cc.spawn(this.spritePlayer[0].fly(),c),a=cc.MoveTo.create(.1,cc.p(b.width/
2+30,b.height/2)),this.spritePlayer[1].runAction(a),b=cc.MoveTo.create(.1,cc.p(b.width/2+150,b.height/2+80)),this.spritePlayer[2].runAction(b),this.sprBroker.playAction(this.spritePlayer[0].moveDirect),this.spritePlayer[0].runAction(cc.Sequence.create(c,cc.CallFunc.create(this.callBackAction,this))),this.sprJudges.hideDialogue(),this.spritePlayer[0].hideDialogue()):this.spritePlayer[0].moveDirect==a?(this.spritePlayer[0].moveDirect==this.MoveDirectionDown?(c=cc.MoveTo.create(.2,cc.p(20,20)),c=cc.spawn(this.spritePlayer[0].fly(),
c)):this.spritePlayer[0].moveDirect==this.MoveDirectionUp&&(this.spritePlayer[0].isBoss()?(this.sprBossDialogue=cc.Sprite.create("img/boss_dialogue.png"),this.sprBossDialogue.setPosition(b.width/2+100,b.height-150),this.addChild(this.sprBossDialogue,10),c=cc.MoveTo.create(1,cc.p(20,b.height-20))):c=cc.MoveTo.create(.2,cc.p(20,b.height-20)),c=cc.spawn(this.spritePlayer[0].fly(),c)),a=cc.MoveTo.create(.1,cc.p(b.width/2+30,b.height/2)),this.spritePlayer[1].runAction(a),b=cc.MoveTo.create(.1,cc.p(b.width/
2+150,b.height/2+80)),this.spritePlayer[2].runAction(b),this.sprBroker.playAction(this.spritePlayer[0].moveDirect),this.spritePlayer[0].runAction(cc.Sequence.create(c,cc.CallFunc.create(this.callBackAction,this))),this.sprJudges.hideDialogue(),this.spritePlayer[0].hideDialogue()):this.callBackGameEnd()}},callBackGameEnd:function(){this.sprCountdown.setScaleX(0);this.labelTime.setString("0.0");this.touchEnabled=!0;this.unschedule(this.callBackTime);var a=0==gameModle?new gameEndLayer:new teamEndLayer;
a.init();this.addChild(a,99);this.sendPlayerRequest()},sendPlayerRequest:function(a){a=cc.loader.getXMLHttpRequest();a.open("GET","http://api.51wala.com/guardIdol/play.json?src=wala");a.onreadystatechange=function(){};a.send()},callBackTime:function(){.1<=this.curCountdown?(this.curCountdown-=.1,this.sprCountdown.setScaleX(this.curCountdown/this.countdownTime),this.labelTime.setString(Math.round(10*this.curCountdown)/10),1.9==Math.round(10*this.curCountdown)/10&&(1!=this.spritePlayer[0].moveDirect||
this.isShowPointDown?1==this.spritePlayer[0].moveDirect&&this.isShowPointDown?this.sprPointDown.removeFromParent(!0):0!=this.spritePlayer[0].moveDirect||this.isShowPointUp?0==this.spritePlayer[0].moveDirect&&this.isShowPointUp&&this.sprPointUp.removeFromParent(!0):(this.sprPointUp.setVisible(!0),this.isShowPointUp=!0):(this.sprPointDown.setVisible(!0),this.isShowPointDown=!0))):(this.sprPointUp.setVisible(!1),this.sprPointDown.setVisible(!1),this.callBackGameEnd())},callBackAction:function(){var a=
cc.director.getWinSize();this.strTotalNum+=1;this.curCountdown=this.countdownTime;this.spritePlayer[0].isBoss()&&(this.sprBossDialogue.removeFromParentAndCleanup(),this.schedule(this.callBackTime,.1));if(0==this.isCrazyModle){if(50==this.energyNum){.5!=this.countdownTime&&(this.countdownTime-=.5);this.sprCrazyModel=cc.Sprite.create("img/crazyModel.png");this.sprCrazyModel.setPosition(a.width/2,a.height-150);this.addChild(this.sprCrazyModel,5);this.sprCrazyTime=new cc.LabelAtlas(this.crazyTime,"img/num.png",
36,41,".");this.sprCrazyTime.setPosition(a.width/2-30,a.height-260);this.addChild(this.sprCrazyTime,10);this.isCrazyModle=!0;this.labelTime.setVisible(!1);this.sprCountdown.setScaleX(1);this.sprCrazy.setScaleX(1);this.unschedule(this.callBackTime);var b=new CountdownLayer;b.init(5);this.addChild(b,99)}else this.energyNum+=1,this.sprCrazy.setScaleX(this.energyNum/50);this.nextPeople=49==this.energyNum||50==this.energyNum?this.MoveDirectionDown:parseInt(2*Math.random())}else this.nextPeople=this.MoveDirectionDown;
a=cc.director.getWinSize();this.spritePlayer[0].removeFromParent();this.spritePlayer[0]=null;this.MoveDirectionUp==this.nextPeople?this.spritePlayer[0]=badPeople.getFromPool():this.MoveDirectionDown==this.nextPeople&&(this.spritePlayer[0]=goodPeople.getFromPool());this.spritePlayer[0].moveDirect=this.nextPeople;if(98==this.limitTime_1||58==this.limitTime_2||38==this.limitTime_3||18==this.limitTime_4)this.spritePlayer[0]=bossPeople.getFromPool(),this.spritePlayer[0].moveDirect=5,98==this.limitTime_1&&
(this.limitTimeAdd_1=this.strTotalNum),58==this.limitTime_2&&(this.limitTimeAdd_2=this.strTotalNum),38==this.limitTime_3&&(this.limitTimeAdd_3=this.strTotalNum),18==this.limitTime_4&&(this.limitTimeAdd_4=this.strTotalNum),this.limitTime_4=this.limitTime_3=this.limitTime_2=this.limitTime_1=0;if(this.strTotalNum==this.limitTimeAdd_1+2||this.strTotalNum==this.limitTimeAdd_2+2||this.strTotalNum==this.limitTimeAdd_3+2||this.strTotalNum==this.limitTimeAdd_4+2)this.limitTimeAdd_4=this.limitTimeAdd_3=this.limitTimeAdd_2=
this.limitTimeAdd_1=-1E3,this.bossNum+=1,this.unschedule(this.callBackTime),b=new bossPauseLayer,b.init(),this.addChild(b,99);this.addChild(this.spritePlayer[0],1);this.spritePlayer[0].setOpacity(255);this.spritePlayer[0].setPosition(a.width/2+270,a.height/2+160);this.spritePlayer[0].setScale(.6);this.spritePlayer[1].setScale(1);this.spritePlayer[1].setZOrder(3);this.spritePlayer[1].hand();this.sprJudges.playAction(this.spritePlayer[1].moveDirect);this.spritePlayer[2].setScale(.85);this.spritePlayer[2].setZOrder(2);
this.spritePlayer.push(this.spritePlayer.shift());this.touchEnabled=!0;this.sprPointUp.setVisible(!1);this.sprPointDown.setVisible(!1);this.strTotalNum==this.randNum&&(this.randNum+=parseInt(3*Math.random()+3),this.sprJudges.showDialogue(this.spritePlayer[0].moveDirect),this.spritePlayer[0].showDialogue());this.labelTotalNum.setString(this.strTotalNum)},callBackCrazyTime:function(){this.crazyTime-=1;this.sprCrazy.setScaleX(this.crazyTime/10);this.sprCrazyTime.setString(this.crazyTime);if(0==this.crazyTime){this.unschedule(this.callBackCrazyTime);
var a=new CountdownLayer;a.init(6);this.addChild(a,99)}},startGame:function(){this.schedule(this.callBackTime,.1);this.sprBroker.setTexture("img/liy_wait_1.png");this.sprJudges.playAction(this.spritePlayer[0].moveDirect);this.sprJudges.showDialogue(this.spritePlayer[0].moveDirect);this.spritePlayer[0].showDialogue()}}),bossPauseLayer=cc.LayerColor.extend({sprGameEnd:null,init:function(){var a=cc.director.getWinSize();if(this._super(cc.color(0,0,0,255))){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:!0,onTouchBegan:function(a,b){return!0},onTouchEnded:function(b,d){d.getCurrentTarget().removeFromParent(!0);battlelayer.spritePlayer[0].moveDirect=0;1==battlelayer.bossNum&&(battlelayer.isShowPointUp=!1,battlelayer.sprPointUp=cc.Sprite.create("img/pointto.png"),battlelayer.sprPointUp.setPosition(a.width/2-70,a.height/2-140),battlelayer.addChild(battlelayer.sprPointUp,8))},onTouchMoved:function(){}},this);this.setOpacity(150);this.sprGameEnd=new cc.Sprite("img/backgroudbuy.png");this.sprGameEnd.setPosition(a.width/
2,a.height/2);this.addChild(this.sprGameEnd,1);var b=cc.MoveBy.create(.8,cc.p(0,100)),b=cc.Sequence.create(b,cc.CallFunc.create(this.callBackAction,this)).repeatForever();this.sprGameEnd.runAction(b);b=new cc.Sprite("img/boss_tip.png");b.setPosition(a.width/2,a.height/2+300);this.addChild(b,2)}},callBackAction:function(){var a=cc.director.getWinSize();this.sprGameEnd.setPosition(a.width/2,a.height/2)},onMenuCallbackbuttonBack:function(){},onMenuCallbackbuttonShare:function(){this.removeFromParent(!0);
var a=new CountdownLayer;a.init(1);battlelayer.addChild(a,99)}}),teamLayer=cc.Layer.extend({itemBeginTeam:null,itemBegin:null,sprIcon_1:null,sprIcon_3:null,sprIcon_4:null,label_1:null,label_2:null,label_3:null,label_4:null,setFriend:!1,backteam_1:null,labelMatch:null,init:function(){var a=this,b=cc.director.getWinSize(),c=cc.Sprite.create("img/backgroud.png");c.setPosition(b.width/2,b.height/2);this.addChild(c,0);b=cc.director.getWinSize();this.backteam_1=new cc.Sprite("img/backteam.png");this.backteam_1.setPosition(b.width/
2,b.height/2-200);this.addChild(this.backteam_1,1);c=new cc.Sprite("img/backteam.png");c.setPosition(b.width/2,b.height/2+150);this.addChild(c,1);var d=new cc.Sprite("img/vs.png");d.setPosition(b.width/2,b.height/2-20);this.addChild(d,1);d=new cc.Sprite("img/backavatar.png");d.setPosition(400,95);this.backteam_1.addChild(d,1);d=new cc.Sprite("img/backavatar.png");d.setPosition(100,95);this.backteam_1.addChild(d,1);d=new cc.Sprite("img/backavatar.png");d.setPosition(100,95);c.addChild(d,1);d=new cc.Sprite("img/backavatar.png");
d.setPosition(400,95);c.addChild(d,1);this.itemBegin=cc.MenuItemImage.create("img/beginButton.png","img/beginButton.png",this.onMenuCallbackBegin,this);this.itemBegin.setPosition(b.width/2,90);this.itemBeginTeam=cc.MenuItemImage.create("img/buttonadd.png","img/buttonadd.png",this.onMenuCallbackTeam,this);this.itemBeginTeam.setPosition(470,300);b=cc.Menu.create(this.itemBegin,this.itemBeginTeam);b.setPosition(0,0);this.addChild(b,0);this.sprIcon_1=new cc.Sprite("img/baseavatar.png");this.sprIcon_1.setPosition(100,
110);this.backteam_1.addChild(this.sprIcon_1,0);cc.loader.loadImg(jsonData.self.avatar,{isCrossOrigin:!1},function(b,c){this.sprIcon_1=new cc.Sprite(c);var d=117/this.sprIcon_1.getContentSize().width,h=117/this.sprIcon_1.getContentSize().height;this.sprIcon_1.setScaleX(d);this.sprIcon_1.setScaleY(h);this.sprIcon_1.setPosition(100,110);a.backteam_1.addChild(this.sprIcon_1,0)});this.sprIcon_3=new cc.Sprite("img/baseavatar.png");this.sprIcon_3.setPosition(100,110);c.addChild(this.sprIcon_3,0);this.sprIcon_4=
new cc.Sprite("img/baseavatar.png");this.sprIcon_4.setPosition(400,110);c.addChild(this.sprIcon_4,0);this.label_1=cc.LabelTTF.create(jsonData.self.nickname,"Arial",25);this.label_1.setPosition(100,38);this.backteam_1.addChild(this.label_1,2);this.label_2=cc.LabelTTF.create("\u6635\u79f0","Arial",25);this.label_2.setPosition(400,38);this.backteam_1.addChild(this.label_2,2);this.label_3=cc.LabelTTF.create("\u6635\u79f0","Arial",25);this.label_3.setPosition(100,38);c.addChild(this.label_3,2);this.label_4=
cc.LabelTTF.create("\u6635\u79f0","Arial",25);this.label_4.setPosition(400,38);c.addChild(this.label_4,2)},onMenuCallbackBegin:function(){this.itemBegin.setVisible(!1);this.itemBeginTeam.setVisible(!1);this.labelMatch=cc.LabelTTF.create("\u5339\u914d\u4e2d\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7","Arial",40);this.labelMatch.setPosition(320,90);this.addChild(this.labelMatch,1);this.schedule(this.callBackTime,2)},callBackTime:function(){var a=this;this.unschedule(this.callBackTime);this.labelMatch.setVisible(!1);
0==this.setFriend&&(this.label_2.setString(jsonData.friend[0].nickname),cc.loader.loadImg(jsonData.friend[0].avatar,{isCrossOrigin:!1},function(b,d){var e=new cc.Sprite(d),f=117/e.getContentSize().width,g=117/e.getContentSize().height;e.setScaleX(f);e.setScaleY(g);e.setPosition(400,110);a.backteam_1.addChild(e,0)}));cc.loader.loadImg(jsonData.vsgroup[0].avatar,{isCrossOrigin:!1},function(b,d){var e=new cc.Sprite(d);e.setAnchorPoint(0,0);var f=117/e.getContentSize().width,g=117/e.getContentSize().height;
e.setScaleX(f);e.setScaleY(g);a.sprIcon_3.addChild(e,2)});cc.loader.loadImg(jsonData.vsgroup[1].avatar,{isCrossOrigin:!1},function(b,d){var e=new cc.Sprite(d);e.setAnchorPoint(0,0);var f=117/e.getContentSize().width,g=117/e.getContentSize().height;e.setScaleX(f);e.setScaleY(g);a.sprIcon_4.addChild(e,2)});a.label_3.setString(jsonData.vsgroup[0].nickname);a.label_4.setString(jsonData.vsgroup[1].nickname);var b=new CountdownLayer;b.init(2);this.addChild(b,10)},onMenuCallbackTeam:function(){var a=new chooseFriendLayer;
a.init();this.addChild(a,1)}}),chooseFriendLayer=cc.LayerColor.extend({labelDialogue:null,init:function(){if(this._super(cc.color(0,0,0,255))){var a=cc.director.getWinSize();cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(a,b){return!0},onTouchEnded:function(a,b){},onTouchMoved:function(){return!0}},this);var b=cc.Sprite.create("img/backgroud.png");b.setPosition(a.width/2,a.height/2);this.addChild(b,0);b=cc.Sprite.create("img/backgroudfriend.png");
b.setPosition(a.width/2,a.height/2+30);this.addChild(b,0);b=cc.MenuItemImage.create("img/buttonback.png","img/buttonback.png",this.onMenuCallback,this);b.setPosition(a.width/2,70);var c=new ccui.ScrollView;c.setDirection(ccui.ScrollView.DIR_VERTICAL);c.setTouchEnabled(!0);c.setContentSize(cc.size(540,640));c.setInnerContainerSize(cc.size(540,960));c.x=50;c.y=160;this.addChild(c,2);for(var a=cc.Sprite.create("img/backavatar.png"),d=a.getContentSize(),e=0,f=0;f<jsonData.friend.length;f++){a=cc.Sprite.create("img/backavatar.png");
a.setAnchorPoint(0,1);a.setPosition(0+f%3*(d.width+10),c.getInnerContainerSize().height-(d.width+10)*(Math.ceil((f+1)/3)-1));c.addChild(a,2);cc.loader.loadImg(jsonData.friend[f].avatar,{isCrossOrigin:!1},function(a,b){var f=new cc.Sprite(b);f.setAnchorPoint(0,1);var g=117/f.getContentSize().width,q=117/f.getContentSize().height;f.setScaleX(g);f.setScaleY(q);f.setPosition(26+e%3*(d.width+10),c.getInnerContainerSize().height-5-(d.width+10)*(Math.ceil((e+1)/3)-1));c.addChild(f,1);e+=1});var g=ccui.Button.create();
g.loadTextures("img/back.png","img/back.png","");g.setTag(f);g.x=d.width/2;g.y=d.height/2+18;g.addTouchEventListener(this.buttonCallBack,this);a.addChild(g,-5);g=cc.LabelTTF.create(jsonData.friend[f].nickname,"Arial",25);g.setPosition(d.width/2,24);a.addChild(g,1)}b=cc.Menu.create(b);b.setPosition(0,0);this.addChild(b,0)}},buttonCallBack:function(a,b){var c=a.getTag();selectFriend=c;teamlayer.setFriend=!0;teamlayer.itemBeginTeam.removeAllChildren(!1);teamlayer.label_2.setString(jsonData.friend[c].nickname);
cc.loader.loadImg(jsonData.friend[c].avatar,{isCrossOrigin:!1},function(a,b){var c=new cc.Sprite(b),g=117/c.getContentSize().width,h=117/c.getContentSize().height;c.setScaleX(g);c.setScaleY(h);c.setAnchorPoint(.5,0);c.setPosition(400,53);teamlayer.backteam_1.addChild(c,0)});this.removeFromParent(!0)},onMenuCallback:function(){this.removeFromParent(!0)}}),gameEndLayer=cc.LayerColor.extend({sprGameEnd:null,init:function(){var a=cc.director.getWinSize();if(this._super(cc.color(0,0,0,255))){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:!0,onTouchBegan:function(a,b){return!0},onTouchEnded:function(a,b){},onTouchMoved:function(){return!0}},this);var b="";0==battlelayer.curJudges?b="\u5c0f\u9f50\u9f50":1==battlelayer.curJudges?b="\u5c0f\u7444\u7444":2==battlelayer.curJudges?b="\u5c0f\u7ea2\u7ea2":3==battlelayer.curJudges&&(b="\u5c0f\u660e\u660e");shareContent=0==parseInt(2*Math.random())?"\u6211\u64b8\u4e86"+b+"\u7684"+battlelayer.strTotalNum+"\u4e2a\u7c89\u4e1d\uff0c\u6211\u4e0d\u662floser\uff01\u8c01\u662f\u64b8sir\uff1f":
"\u6211\u64b8\u4e86"+b+"\u7684"+battlelayer.strTotalNum+"\u4e2a\u7c89\u4e1d\uff0c\u53eb\u6211\u64b8sir\uff01\u8c01\u662floser\uff1f";this.setOpacity(150);this.sprGameEnd=new cc.Sprite;this.sprGameEnd.setContentSize(cc.size(623,625));this.sprGameEnd.setPosition(a.width/2,a.height/2);this.addChild(this.sprGameEnd,0);b=new cc.LabelAtlas("0","img/num.png",36,41,".");b.setString(battlelayer.strTotalNum);battlelayer.strTotalNum>bestScore&&(bestScore=battlelayer.strTotalNum,this.sendScoreRequest(bestScore));
b.setPosition(a.width/2+60,a.height/2-100);this.sprGameEnd.addChild(b,0);b=cc.Sprite.create("img/str_gameend.png");b.setPosition(a.width/2,a.height/2+50);this.sprGameEnd.addChild(b,0);b=cc.Sprite.create("img/str_popularity.png");b.setPosition(a.width/2-140,a.height/2-80);this.sprGameEnd.addChild(b,0);a=cc.MenuItemImage.create("img/buttonAgain.png","img/buttonAgain.png",this.onMenuCallbackbuttonBack,this);a.setPosition(-150,-80);b=cc.MenuItemImage.create("img/buttonshare.png","img/buttonshare.png",
this.onMenuCallbackbuttonShare,this);b.setPosition(150,-80);a=cc.Menu.create(a,b);this.sprGameEnd.addChild(a,5);a.setPosition(this.sprGameEnd.getContentSize().width/2,this.sprGameEnd.getContentSize().height/2-80)}},onMenuCallbackbuttonBack:function(){var a=cc.director.getRunningScene();a.removeAllChildren();var b=new HelloLayer;b.init();a.addChild(b)},onMenuCallbackbuttonTx:function(){cc.sys.isNative||(countShare(),window.open("http://v.t.qq.com/share/share.php?title="+shareContent+"&pic="+shareImg+
"&url="+shareUrl,"_blank"))},sendScoreRequest:function(a){var b=cc.loader.getXMLHttpRequest();b.open("GET","http://api.51wala.com/guardIdol/sync.json?res="+a);b.onreadystatechange=function(){};b.send()},onMenuCallbackbuttonWeibo:function(){cc.sys.isNative||(countShare(),window.open("http://v.t.sina.com.cn/share/share.php?pic="+shareImg+"&title="+shareContent+"&url="+shareUrl,"_blank"))},onMenuCallbackbuttonWeixinOne:function(){if(!cc.sys.isNative){countShare();var a="wala://weixin.shareToFriend?link="+
encodeURIComponent(shareUrl)+"&imgUrl="+encodeURIComponent(shareImg)+"&title="+encodeURIComponent(shareTitle)+"&desc="+encodeURIComponent(shareContent);window.open(a,"_blank")}},onMenuCallbackbuttonWeixinTwo:function(){if(!cc.sys.isNative){countShare();var a="wala://weixin.shareToTimeline?link="+encodeURIComponent(shareUrl)+"&imgUrl="+encodeURIComponent(shareImg)+"&title="+encodeURIComponent(shareTitle)+"&desc="+encodeURIComponent(shareContent);window.open(a,"_blank")}},onMenuCallbackbuttonCancel:function(){var a=
cc.director.getRunningScene();a.removeAllChildren();var b=new HelloLayer;b.init();a.addChild(b)},onMenuCallbackbuttonShare:function(){var a=cc.director.getWinSize();this.sprGameEnd.removeFromParent(!0);toastLayer=new cc.Layer;this.addChild(toastLayer,10);var b=cc.Sprite.create("img/backGroudShare.png");b.setAnchorPoint(.5,0);b.setPosition(a.width/2,0);toastLayer.addChild(b,1);var c=cc.MenuItemImage.create("img/buttonQuitShare.png","img/buttonQuitShare.png",this.onMenuCallbackbuttonCancel,this);c.setPosition(a.width/
2,80);a=cc.MenuItemImage.create("img/txweibo.png","img/txweibo.png",this.onMenuCallbackbuttonTx,this);a.setPosition(550,250);var d=cc.LabelTTF.create("\u5206\u4eab\u817e\u8baf\u5fae\u535a","Arial",24);d.setPosition(a.getContentSize().width/2,-20);a.addChild(d,1);d=cc.MenuItemImage.create("img/weibo.png","img/weibo.png",this.onMenuCallbackbuttonWeibo,this);d.setPosition(400,250);var e=cc.LabelTTF.create("\u5206\u4eab\u65b0\u6d6a\u5fae\u535a","Arial",24);e.setPosition(d.getContentSize().width/2,-20);
d.addChild(e,1);e=cc.MenuItemImage.create("img/weixin_1.png","img/weixin_1.png",this.onMenuCallbackbuttonWeixinOne,this);e.setPosition(100,250);var f=cc.LabelTTF.create("\u5206\u4eab\u5fae\u4fe1\u670b\u53cb","Arial",24);f.setPosition(d.getContentSize().width/2,-20);e.addChild(f,1);f=cc.MenuItemImage.create("img/weixin_2.png","img/weixin_2.png",this.onMenuCallbackbuttonWeixinTwo,this);f.setPosition(250,250);var g=cc.LabelTTF.create("\u5206\u4eab\u5230\u670b\u53cb\u5708","Arial",24);g.setPosition(f.getContentSize().width/
2,-20);f.addChild(g,1);c=cc.Menu.create(a,d,e,f,c);c.setPosition(0,0);b.addChild(c,5)}}),teamEndLayer=cc.LayerColor.extend({sprGameEnd:null,backteam_1:null,sprIcon_1:null,label_1:null,label_2:null,label_3:null,label_4:null,labelTotolNum_1:null,labelTotolNum_2:null,curTime:0,totolNum_1:0,totolNum_2:0,numAdd_1:0,numAdd_2:0,buttonBack:null,buttonShare:null,init:function(){var a=cc.director.getWinSize(),b=this;if(this._super(cc.color(0,0,0,255))){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,
swallowTouches:!0,onTouchBegan:function(a,b){return!0},onTouchEnded:function(a,b){},onTouchMoved:function(){return!0}},this);var c="";0==battlelayer.curJudges?c="\u5c0f\u9f50\u9f50":1==battlelayer.curJudges?c="\u5c0f\u7444\u7444":2==battlelayer.curJudges?c="\u5c0f\u7ea2\u7ea2":3==battlelayer.curJudges&&(c="\u5c0f\u660e\u660e");shareContent=0==parseInt(2*Math.random())?"\u6211\u64b8\u4e86"+c+"\u7684"+battlelayer.strTotalNum+"\u4e2a\u7c89\u4e1d\uff0c\u6211\u4e0d\u662floser\uff01\u8c01\u662f\u64b8sir\uff1f":
"\u6211\u64b8\u4e86"+c+"\u7684"+battlelayer.strTotalNum+"\u4e2a\u7c89\u4e1d\uff0c\u53eb\u6211\u64b8sir\uff01\u8c01\u662floser\uff1f";this.setOpacity(150);this.sprGameEnd=new cc.Sprite;this.sprGameEnd.setContentSize(cc.size(623,625));this.sprGameEnd.setPosition(a.width/2,a.height/2);this.addChild(this.sprGameEnd,0);this.backteam_1=new cc.Sprite("img/backteam.png");this.backteam_1.setPosition(a.width/2,a.height/2-100);this.addChild(this.backteam_1,1);var d=new cc.Sprite("img/backteam.png");d.setPosition(a.width/
2,a.height/2+250);this.addChild(d,1);a=new cc.Sprite("img/backavatar.png");a.setPosition(400,95);this.backteam_1.addChild(a,1);a=new cc.Sprite("img/backavatar.png");a.setPosition(100,95);this.backteam_1.addChild(a,1);a=new cc.Sprite("img/backavatar.png");a.setPosition(100,95);d.addChild(a,1);a=new cc.Sprite("img/backavatar.png");a.setPosition(400,95);d.addChild(a,1);cc.loader.loadImg(jsonData.self.avatar,{isCrossOrigin:!1},function(a,c){this.sprIcon_1=new cc.Sprite(c);var d=117/this.sprIcon_1.getContentSize().width,
h=117/this.sprIcon_1.getContentSize().height;this.sprIcon_1.setScaleX(d);this.sprIcon_1.setScaleY(h);this.sprIcon_1.setPosition(100,110);b.backteam_1.addChild(this.sprIcon_1,0)});cc.loader.loadImg(jsonData.friend[selectFriend].avatar,{isCrossOrigin:!1},function(a,c){var d=new cc.Sprite(c),h=117/d.getContentSize().width,k=117/d.getContentSize().height;d.setScaleX(h);d.setScaleY(k);d.setPosition(400,110);b.backteam_1.addChild(d,0)});cc.loader.loadImg(jsonData.vsgroup[0].avatar,{isCrossOrigin:!1},function(a,
b){var c=new cc.Sprite(b),h=117/c.getContentSize().width,k=117/c.getContentSize().height;c.setScaleX(h);c.setScaleY(k);c.setPosition(100,110);d.addChild(c,2)});cc.loader.loadImg(jsonData.vsgroup[1].avatar,{isCrossOrigin:!1},function(a,b){var c=new cc.Sprite(b),h=117/c.getContentSize().width,k=117/c.getContentSize().height;c.setScaleX(h);c.setScaleY(k);c.setPosition(400,110);d.addChild(c,2)});this.label_1=cc.LabelTTF.create(jsonData.self.nickname,"Arial",25);this.label_1.setPosition(100,38);this.backteam_1.addChild(this.label_1,
2);this.label_2=cc.LabelTTF.create(jsonData.friend[selectFriend].nickname,"Arial",25);this.label_2.setPosition(400,38);this.backteam_1.addChild(this.label_2,2);this.label_3=cc.LabelTTF.create(jsonData.vsgroup[0].nickname,"Arial",25);this.label_3.setPosition(100,38);d.addChild(this.label_3,2);this.label_4=cc.LabelTTF.create(jsonData.vsgroup[1].nickname,"Arial",25);this.label_4.setPosition(400,38);d.addChild(this.label_4,2);a=cc.LabelTTF.create("\u4eba\u6c14\u503c\uff1a "+battlelayer.strTotalNum,"Arial",
32);a.setPosition(100,-20);this.backteam_1.addChild(a,2);0==jsonData.friend[selectFriend].gameScore?(jsonData.friend[selectFriend].gameScore=battlelayer.strTotalNum+Math.floor(41*Math.random()-20),0>jsonData.friend[selectFriend].gameScore&&(jsonData.friend[selectFriend].gameScore=0)):jsonData.friend[selectFriend].gameScore=Math.abs(jsonData.friend[selectFriend].gameScore+Math.floor(61*Math.random()-30));a=cc.LabelTTF.create("\u4eba\u6c14\u503c\uff1a "+jsonData.friend[selectFriend].gameScore,"Arial",
32);a.setPosition(400,-20);this.backteam_1.addChild(a,2);0==jsonData.vsgroup[0].gameScore?(jsonData.vsgroup[0].gameScore=battlelayer.strTotalNum+Math.floor(41*Math.random()-20),0>jsonData.vsgroup[0].gameScore&&(jsonData.vsgroup[0].gameScore=0)):jsonData.vsgroup[0].gameScore=Math.abs(jsonData.vsgroup[0].gameScore+Math.floor(61*Math.random()-30));a=cc.LabelTTF.create("\u4eba\u6c14\u503c\uff1a "+jsonData.vsgroup[0].gameScore,"Arial",32);a.setPosition(100,-20);d.addChild(a,2);0==jsonData.vsgroup[1].gameScore?
(jsonData.vsgroup[1].gameScore=battlelayer.strTotalNum+Math.floor(41*Math.random()-20),0>jsonData.vsgroup[1].gameScore&&(jsonData.vsgroup[1].gameScore=0)):jsonData.vsgroup[1].gameScore=Math.abs(jsonData.vsgroup[1].gameScore+Math.floor(61*Math.random()-30));a=cc.LabelTTF.create("\u4eba\u6c14\u503c\uff1a "+jsonData.vsgroup[1].gameScore,"Arial",32);a.setPosition(400,-20);d.addChild(a,2);a=new cc.Sprite("img/label_popularity.png");a.setPosition(250,140);this.backteam_1.addChild(a,2);this.labelTotolNum_1=
new cc.LabelAtlas("0","img/num.png",36,41,".");this.labelTotolNum_1.setAnchorPoint(.5,.5);this.labelTotolNum_1.setPosition(250,60);this.backteam_1.addChild(this.labelTotolNum_1,2);a=new cc.Sprite("img/label_popularity.png");a.setPosition(250,140);d.addChild(a,2);this.labelTotolNum_2=new cc.LabelAtlas("0","img/num.png",36,41,".");this.labelTotolNum_2.setAnchorPoint(.5,.5);this.labelTotolNum_2.setPosition(250,60);d.addChild(this.labelTotolNum_2,2);this.buttonBack=cc.MenuItemImage.create("img/buttonAgain.png",
"img/buttonAgain.png",this.onMenuCallbackbuttonBack,this);this.buttonBack.setPosition(-150,-250);this.buttonBack.setVisible(!1);this.buttonShare=cc.MenuItemImage.create("img/buttonshare.png","img/buttonshare.png",this.onMenuCallbackbuttonShare,this);this.buttonShare.setPosition(150,-250);this.buttonShare.setVisible(!1);a=cc.Menu.create(this.buttonBack,this.buttonShare);this.sprGameEnd.addChild(a,5);a.setPosition(this.sprGameEnd.getContentSize().width/2,this.sprGameEnd.getContentSize().height/2-80);
this.numAdd_1=Math.floor((battlelayer.strTotalNum+jsonData.friend[selectFriend].gameScore)/8);1>this.numAdd_1&&(this.numAdd_1=1);this.numAdd_2=Math.floor((jsonData.vsgroup[1].gameScore+jsonData.vsgroup[0].gameScore)/8);1>this.numAdd_2&&(this.numAdd_2=1);this.schedule(this.callBackTime,.1)}},callBackTime:function(){var a=cc.director.getWinSize();this.curTime+=.1;if(!(.5>Math.round(10*this.curTime)/10)){var b=battlelayer.strTotalNum+jsonData.friend[selectFriend].gameScore,c=jsonData.vsgroup[1].gameScore+
jsonData.vsgroup[0].gameScore,d=null;this.totolNum_1<b&&(this.totolNum_1+=this.numAdd_1);this.labelTotolNum_1.setString(this.totolNum_1);this.totolNum_2<c&&(this.totolNum_2+=this.numAdd_2);this.labelTotolNum_2.setString(this.totolNum_2);.8==Math.round(10*this.curTime)/10&&(this.labelTotolNum_1.setString(b),this.labelTotolNum_2.setString(c),this.unschedule(this.callBackTime),d=b>=c?new cc.Sprite("img/label_win.png"):new cc.Sprite("img/label_lose.png"),d.setPosition(a.width/2,a.height/2+50),a=cc.ScaleTo.create(.8,
1.3),d.runAction(cc.Sequence.create(a,cc.CallFunc.create(this.callBackAction,this))),this.addChild(d,5))}},callBackAction:function(){this.buttonBack.setVisible(!0);this.buttonShare.setVisible(!0)},sendScoreRequest:function(a){var b=cc.loader.getXMLHttpRequest();b.open("GET","http://api.51wala.com/guardIdol/sync.json?res="+a);b.onreadystatechange=function(){};b.send()},onMenuCallbackbuttonBack:function(){var a=cc.director.getRunningScene();a.removeAllChildren();var b=new HelloLayer;b.init();a.addChild(b)},
onMenuCallbackbuttonTx:function(){cc.sys.isNative||(countShare(),window.open("http://v.t.qq.com/share/share.php?title="+shareContent+"&pic="+shareImg+"&url="+shareUrl,"_blank"))},onMenuCallbackbuttonWeibo:function(){cc.sys.isNative||(countShare(),window.open("http://v.t.sina.com.cn/share/share.php?pic="+shareImg+"&title="+shareContent+"&url="+shareUrl,"_blank"))},onMenuCallbackbuttonWeixinOne:function(){if(!cc.sys.isNative){countShare();var a="wala://weixin.shareToFriend?link="+encodeURIComponent(shareUrl)+
"&imgUrl="+encodeURIComponent(shareImg)+"&title="+encodeURIComponent(shareTitle)+"&desc="+encodeURIComponent(shareContent);window.open(a,"_blank")}},onMenuCallbackbuttonWeixinTwo:function(){if(!cc.sys.isNative){countShare();var a="wala://weixin.shareToTimeline?link="+encodeURIComponent(shareUrl)+"&imgUrl="+encodeURIComponent(shareImg)+"&title="+encodeURIComponent(shareTitle)+"&desc="+encodeURIComponent(shareContent);window.open(a,"_blank")}},onMenuCallbackbuttonCancel:function(){var a=cc.director.getRunningScene();
a.removeAllChildren();var b=new HelloLayer;b.init();a.addChild(b)},onMenuCallbackbuttonShare:function(){var a=cc.director.getWinSize();this.sprGameEnd.removeFromParent(!0);toastLayer=new cc.Layer;this.addChild(toastLayer,10);var b=cc.Sprite.create("img/backGroudShare.png");b.setAnchorPoint(.5,0);b.setPosition(a.width/2,0);toastLayer.addChild(b,1);var c=cc.MenuItemImage.create("img/buttonQuitShare.png","img/buttonQuitShare.png",this.onMenuCallbackbuttonCancel,this);c.setPosition(a.width/2,80);a=cc.MenuItemImage.create("img/txweibo.png",
"img/txweibo.png",this.onMenuCallbackbuttonTx,this);a.setPosition(550,250);var d=cc.LabelTTF.create("\u5206\u4eab\u817e\u8baf\u5fae\u535a","Arial",24);d.setPosition(a.getContentSize().width/2,-20);a.addChild(d,1);d=cc.MenuItemImage.create("img/weibo.png","img/weibo.png",this.onMenuCallbackbuttonWeibo,this);d.setPosition(400,250);var e=cc.LabelTTF.create("\u5206\u4eab\u65b0\u6d6a\u5fae\u535a","Arial",24);e.setPosition(d.getContentSize().width/2,-20);d.addChild(e,1);e=cc.MenuItemImage.create("img/weixin_1.png",
"img/weixin_1.png",this.onMenuCallbackbuttonWeixinOne,this);e.setPosition(100,250);var f=cc.LabelTTF.create("\u5206\u4eab\u5fae\u4fe1\u670b\u53cb","Arial",24);f.setPosition(d.getContentSize().width/2,-20);e.addChild(f,1);f=cc.MenuItemImage.create("img/weixin_2.png","img/weixin_2.png",this.onMenuCallbackbuttonWeixinTwo,this);f.setPosition(250,250);var g=cc.LabelTTF.create("\u5206\u4eab\u5230\u670b\u53cb\u5708","Arial",24);g.setPosition(f.getContentSize().width/2,-20);f.addChild(g,1);c=cc.Menu.create(a,
d,e,f,c);c.setPosition(0,0);b.addChild(c,5)}}),CountdownLayer=cc.Layer.extend({labelTime:null,strTime:4,index:null,init:function(a){this.index=a;a=cc.director.getWinSize();this._super()&&(cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(a,c){return!0},onTouchEnded:function(a,c){},onTouchMoved:function(){return!0}},this),5==this.index||6==this.index?(this.strTime=2,this.labelTime=cc.Sprite.create("img/go.png")):this.labelTime=cc.Sprite.create("img/num_3.png"),
this.labelTime.setPosition(a.width/2,a.height/2),this.addChild(this.labelTime,1),this.schedule(this.callBackCountTime,1))},callBackCountTime:function(){this.strTime-=1;var a=cc.director.getWinSize();0==this.strTime?1==this.index?(this.unschedule(this.callBackCountTime),this.removeFromParent(!0),battlelayer.schedule(battlelayer.callBackTime,.1),battlelayer.spritePlayer[0].moveDirect=0,showBossNum==battlelayer.strTotalNum&&(battlelayer.isShowPointUp=!1,battlelayer.sprPointUp=cc.Sprite.create("img/pointto.png"),
battlelayer.sprPointUp.setPosition(a.width/2-70,a.height/2-140),battlelayer.addChild(battlelayer.sprPointUp,8))):2==this.index?(a=cc.director.getRunningScene(),a.removeAllChildren(),battlelayer=new battleLayer,battlelayer.init(),a.addChild(battlelayer)):5==this.index?(this.unschedule(this.callBackCountTime),this.removeFromParent(!0),battlelayer.schedule(battlelayer.callBackCrazyTime,1)):6==this.index?(this.unschedule(this.callBackCountTime),this.removeFromParent(!0),battlelayer.isCrazyModle=!1,battlelayer.sprCrazyTime.removeFromParentAndCleanup(),
battlelayer.sprCrazyModel.removeFromParentAndCleanup(),battlelayer.schedule(battlelayer.callBackTime,.1),battlelayer.crazyTime=10,battlelayer.energyNum=0,battlelayer.labelTime.setVisible(!0)):(this.unschedule(this.callBackCountTime),this.removeFromParent(!0),battlelayer.startGame()):1==this.strTime?(this.labelTime.setTexture("img/go.png"),this.labelTime.runAction(cc.spawn(cc.FadeOut.create(.7),cc.scaleTo(.7,1.5)))):2==this.strTime?this.labelTime.setTexture("img/num_1.png"):3==this.strTime&&this.labelTime.setTexture("img/num_2.png")}}),
helpLayer=cc.Layer.extend({init:function(){var a=cc.director.getWinSize();if(this._super()){cc.eventManager.addListener({event:cc.EventListener.TOUCH_ONE_BY_ONE,swallowTouches:!0,onTouchBegan:function(a,b){return!0},onTouchEnded:function(a,b){b.getCurrentTarget().removeFromParentAndCleanup()},onTouchMoved:function(){return!0}},this);var b=cc.Sprite.create("img/help_wala.png");b.setPosition(a.width/2,a.height/2);this.addChild(b,8)}}}),HelloWorldScene=cc.Scene.extend({onEnter:function(a){this._super();
cc.spriteFrameCache.addSpriteFrames("img/badpeople.plist");cc.spriteFrameCache.addSpriteFrames("img/hanhpeople.plist");cc.spriteFrameCache.addSpriteFrames("img/liypeople.plist");cc.spriteFrameCache.addSpriteFrames("img/guojmpeople.plist");a=new HelloLayer;a.init();this.addChild(a)}});
